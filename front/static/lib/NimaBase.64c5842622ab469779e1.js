(window.webpackJsonp = window.webpackJsonp || []).push([[3], Array(201).concat([function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = h(n(1)), a = n(2), s = h(n(203)), l = h(n(237)), u = h(n(315)), c = h(n(243)), d = h(n(381));
    function h(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function f(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var p = [1, 1, 1, .5]
      , y = [1, 1, 1, 1]
      , m = [198 / 255, 198 / 255, 198 / 255, .5]
      , v = [10 / 255, 10 / 255, 10 / 255, .5]
      , g = [50 / 255, 50 / 255, 50 / 255, .5]
      , _ = [1, 1, 1, 1]
      , b = [0, 139 / 255, 1, .8]
      , w = [1, 1, 1, 1]
      , O = [198 / 255, 198 / 255, 198 / 255, 1]
      , S = [1, 185 / 255, 0, 1]
      , k = (f((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n._ActorBone = e,
            n._ParentJoint = null,
            n._Joint = null,
            n._UpdateRequired = true,
            n._IsConnected = false,
            n._OverrideTransform = null,
            n._OverrideLength = null,
            n._IsPainting = false,
            n.customSelectionAction = t.RangeSelect,
            e.parent && (e.parent.constructor === l.default ? n._ParentJoint = e.parent.stageItem.joint : e.parent.constructor === u.default && (n._ParentJoint = e.parent.stageItem)),
            n._Joint = new c.default,
            n._Joint.setBone(n),
            n._FromSize = 1,
            n._Length = 0,
            n._Size = 0,
            n._EdgeLine = null,
            n._VertexBuffer = null,
            n._IndexBuffer = null,
            n._ParentJointSize = 0,
            n._JointSize = 0,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "onVisibilityChanged",
            value: function(e) {
                this._ParentJoint && this._ParentJoint.updateVisibility(),
                this._Joint && this._Joint.updateVisibility(),
                this._JellyIn && (this._JellyIn.isVisible = e),
                this._JellyOut && (this._JellyOut.isVisible = e)
            }
        }, {
            key: "updateConnectionState",
            value: function() {
                var e = this.node && this.node.skins;
                if (e) {
                    for (var t = 0; t < e.length; t++)
                        if (e[t].stageItem.isSelected)
                            return void (this.isConnected = true);
                    this.isConnected = false
                } else
                    this.isConnected = false
            }
        }, {
            key: "updateJelly",
            value: function(e) {
                if (this._ActorBone.isJelly) {
                    var t = e || this.stage;
                    this._JellyIn || (this._JellyIn = new d.default(this._ActorBone,true),
                    t && this._JellyIn.addToStage(t)),
                    this._JellyOut || (this._JellyOut = new d.default(this._ActorBone,false),
                    t && this._JellyOut.addToStage(t))
                } else
                    this._JellyIn && (this._JellyIn.removeFromStage(),
                    this._JellyIn = null),
                    this._JellyOut && (this._JellyOut.removeFromStage(),
                    this._JellyOut = null);
                this.onVisibilityChanged(this.isVisible)
            }
        }, {
            key: "onAddedToStage",
            value: function(e) {
                this._ParentJoint && this._ParentJoint.addChild(this),
                this.updateJelly(e),
                this._Joint.addToStage(e);
                var t = this._ActorBone;
                t.addEventListener("minAngleChange", this.updateTransform),
                t.addEventListener("maxAngleChange", this.updateTransform),
                t.addEventListener("worldTransform", this.updateTransform),
                t.addEventListener("lengthChanged", this.updateTransform),
                t.addEventListener("sizeChanged", this.updateTransform),
                t.addEventListener("jellyChange", this.updateJelly),
                this.updateConnectionState()
            }
        }, {
            key: "onRemovedFromStage",
            value: function(e) {
                this._ParentJoint && this._ParentJoint.removeChild(this),
                this._JellyIn && (this._JellyIn.removeFromStage(),
                this._JellyIn = null),
                this._JellyOut && (this._JellyOut.removeFromStage(),
                this._JellyOut = null),
                this._Joint.removeFromStage();
                var t = this._ActorBone;
                t.removeEventListener("minAngleChange", this.updateTransform),
                t.removeEventListener("maxAngleChange", this.updateTransform),
                t.removeEventListener("worldTransform", this.updateTransform),
                t.removeEventListener("lengthChanged", this.updateTransform),
                t.removeEventListener("lengthChanged", this.updateTransform),
                t.removeEventListener("jellyChange", this.updateJelly)
            }
        }, {
            key: "updateTransform",
            value: function() {
                this._UpdateRequired = true
            }
        }, {
            key: "update",
            value: function(e) {
                var t = this._ActorBone.worldTransform
                  , n = this._ActorBone.size
                  , i = a.vec2.create()
                  , r = a.vec2.set(a.vec2.create(), this._ActorBone.length, 0);
                a.vec2.transformMat2d(i, i, t),
                a.vec2.transformMat2d(r, r, t);
                var o = a.vec2.subtract(a.vec2.create(), r, i)
                  , s = Math.max(2.22 * n, a.vec2.length(o));
                this._OverrideLength && (s *= this._OverrideLength / this._ActorBone.length);
                var l = a.mat2d.create();
                a.mat2d.fromRotation(l, Math.atan2(o[1], o[0])),
                l[4] = i[0],
                l[5] = i[1],
                this.renderTransform = this._OverrideTransform || l;
                var u = .9 * (this._ParentJoint ? this._ParentJoint.scaledSize : 8)
                  , c = .9 * this._Joint.scaledSize;
                if (Math.abs(s - this._Length) > .5 || n != this._Size || !this._VertexBuffer || u != this._ParentJointSize || c != this._JointSize) {
                    this._JointSize = c,
                    this._ParentJointSize = u,
                    this._Size = n,
                    this._Length = s;
                    var d = .7 * this._Size
                      , h = d / 3.22
                      , f = [u, 0, d + u, d, this._Length - c - h, h, this._Length - c, 0, this._Length - c - h, -h, d + u, -d]
                      , p = [0, 1, 2, 0, 2, 3, 0, 3, 4, 0, 4, 5];
                    this._EdgeLine = e.makeThickLine([[u, 0], [d + u, d], [this._Length - c - h, h], [this._Length - c, 0], [this._Length - c - h, -h], [d + u, -d]], true),
                    this._VertexBuffer || (this._VertexBuffer = e.makeVertexBuffer()),
                    this._IndexBuffer || (this._IndexBuffer = e.makeIndexBuffer()),
                    this._VertexBuffer.update(f),
                    this._IndexBuffer.update(p),
                    this.setMesh(f, 2, p)
                }
            }
        }, {
            key: "draw",
            value: function(e, t, n) {
                if (this._UpdateRequired && (this.update(e),
                this._UpdateRequired = false),
                this._VertexBuffer && !t && !n) {
                    var i = this._ActorBone
                      , r = this.renderViewTransform
                      , o = i.hasContrast
                      , s = this._FillColor || (o ? g : m)
                      , l = this._Highlight
                      , u = this.stage;
                    if (!i.hideBone) {
                        var c = this._IsPainting ? 1 / u.scale : l ? 2 / u.scale : .5 / u.scale;
                        e.drawColor(r, this._VertexBuffer, this._IndexBuffer, 1, s),
                        e.drawThickLine(r, this._EdgeLine, c, 1, this._IsPainting ? y : l ? S : o ? v : p)
                    }
                    if (!this._HideHelpers) {
                        var d = i.jelly;
                        if (!d || d.hideJellies)
                            return;
                        if (!d._GraphicsCurve && d._CurvePoints && (d._GraphicsCurve = e.makeThickLine(d._CurvePoints, false)),
                        d._GraphicsCurve) {
                            var h = a.mat2d.mul(a.mat2d.create(), u.viewTransform, i.worldTransform);
                            e.drawThickLine(h, d._GraphicsCurve, .5 / this.stage.scale, 1, this.isSelected ? _ : l ? S : w)
                        }
                    }
                }
            }
        }, {
            key: "drawSelection",
            value: function(e, t) {
                this._UpdateRequired && (this.update(e),
                this._UpdateRequired = false);
                var n = this._ActorBone
                  , i = this.renderViewTransform
                  , r = this._Highlight
                  , o = this.stage;
                if (n.hideBone || (e.drawColor(i, this._VertexBuffer, this._IndexBuffer, 1, this.isSelected ? b : O),
                e.drawThickLine(i, this._EdgeLine, .5 / o.scale, 1, this.isSelected ? _ : r ? S : w)),
                !this._HideHelpers) {
                    var s = n.jelly;
                    if (!s || s.hideJellies)
                        return;
                    if (!s._GraphicsCurve && s._CurvePoints && (s._GraphicsCurve = e.makeThickLine(s._CurvePoints, false)),
                    s._GraphicsCurve) {
                        var l = a.mat2d.mul(a.mat2d.create(), o.viewTransform, n.worldTransform);
                        e.drawThickLine(l, s._GraphicsCurve, .5 / this.stage.scale, 1, this.isSelected ? _ : r ? S : w)
                    }
                }
            }
        }, {
            key: "parentJoint",
            get: function() {
                return this._ParentJoint
            }
        }, {
            key: "joint",
            get: function() {
                return this._Joint
            }
        }, {
            key: "actorBone",
            get: function() {
                return this._ActorBone
            }
        }, {
            key: "isConnected",
            get: function() {
                return this._IsConnected
            },
            set: function(e) {
                this._IsConnected != e && (this._IsConnected = e,
                this.stage && this.stage.redraw())
            }
        }, {
            key: "fillColor",
            get: function() {
                return this._FillColor
            },
            set: function(e) {
                this._FillColor = e || null
            }
        }, {
            key: "isPainting",
            get: function() {
                return this._IsPainting
            },
            set: function(e) {
                e != this._IsPainting && (this._IsPainting = e,
                this.stage && this.stage.redraw())
            }
        }, {
            key: "overrideTransform",
            get: function() {
                return this._OverrideTransform
            },
            set: function(e) {
                this._OverrideTransform = e && a.mat2d.clone(e) || null,
                this._UpdateRequired = true
            }
        }, {
            key: "overrideLength",
            get: function() {
                return this._OverrideLength
            },
            set: function(e) {
                this._OverrideLength = e || null,
                this._UpdateRequired = true
            }
        }, {
            key: "hideHelpers",
            get: function() {
                return this._HideHelpers
            },
            set: function(e) {
                this._HideHelpers = e;
                var t = this.stage;
                t && this._ActorBone.isJelly && (e ? (this._JellyIn.removeFromStage(),
                this._JellyOut.removeFromStage()) : (this._JellyIn.addToStage(t),
                this._JellyOut.addToStage(t)))
            }
        }, {
            key: "isSelectable",
            set: function(e) {
                !function e(t, n, i, r) {
                    var o = Object.getOwnPropertyDescriptor(t, n);
                    if (void 0 === o) {
                        var a = Object.getPrototypeOf(t);
                        null !== a && e(a, n, i, r)
                    } else if ("value"in o && o.writable)
                        o.value = i;
                    else {
                        var s = o.set;
                        void 0 !== s && s.call(r, i)
                    }
                    return i
                }(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "isSelectable", e, this)
            },
            get: function() {
                return !this._ActorBone.hideBone && function e(t, n, i) {
                    null === t && (t = Function.prototype);
                    var r = Object.getOwnPropertyDescriptor(t, n);
                    if (void 0 === r) {
                        var o = Object.getPrototypeOf(t);
                        return null === o ? void 0 : e(o, n, i)
                    }
                    if ("value"in r)
                        return r.value;
                    var a = r.get;
                    return void 0 !== a ? a.call(i) : void 0
                }(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "isSelectable", this)
            }
        }]),
        t
    }(s.default)).prototype, "updateJelly", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "updateJelly"), i.prototype),
    f(i.prototype, "updateTransform", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "updateTransform"), i.prototype),
    i);
    t.default = k,
    k.Colors = [[109, 145, 255], [144, 90, 238], [255, 106, 147], [255, 214, 106], [104, 254, 217], [212, 222, 255], [209, 183, 255], [255, 153, 182], [255, 238, 195], [201, 255, 241], [18, 76, 255], [255, 0, 255], [244, 46, 100], [251, 188, 20], [0, 190, 143]];
    for (var P = 0; P < k.Colors.length; P++) {
        var E = k.Colors[P];
        k.Colors[P] = new Float32Array([E[0] / 255, E[1] / 255, E[2] / 255, 1])
    }
    k.RangeSelect = function(e, t) {
        if (!t)
            return false;
        var n = e.stage.selectedItems;
        if (n.length > 0) {
            var i = n[n.length - 1]
              , r = e
              , o = []
              , a = null;
            if (i.constructor === k || r.constructor === k || i.constructor === c.default || r.constructor === c.default) {
                if (i.node.treeDepth < r.node.treeDepth) {
                    var s = i;
                    i = r,
                    r = s
                }
                r.constructor === c.default && (r = r.node.stageItem),
                i.constructor === c.default && (i = i.node.stageItem,
                o.push(i));
                for (var l = i; (l = l.node.parent) && (l = l.stageItem); ) {
                    if (l == r) {
                        a = o;
                        break
                    }
                    l.constructor === k && o.push(l)
                }
            }
        }
        return a && e.stage.selectItems(a, true, false),
        false
    }
}
, , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = l(n(12))
      , o = n(2)
      , a = l(n(693))
      , s = l(n(380));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var u = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this));
            return n._RecomputeAABB = false,
            n._AABB = new a.default,
            n._StageContext = null,
            n._Stage = null,
            n._HitDetectOnMesh = true,
            n._CustomRectIntsersect = null,
            n._MinPoint = o.vec2.create(),
            n._MaxPoint = o.vec2.create(),
            n._MeshPoints = null,
            n._MeshStride = 0,
            n._MeshIndices = null,
            n._RecomputeContour = false,
            n._MeshContourIndices = null,
            n._Contour = null,
            n._IsSelected = false,
            n._IsVisible = true,
            n._IsLocked = false,
            n._IsSelectable = true,
            n._IsFiltered = false,
            n._Node = e || null,
            n._WorldPoints = [o.vec2.create(), o.vec2.create(), o.vec2.create(), o.vec2.create()],
            n._Highlight = false,
            n._RenderTransform = o.mat2d.create(),
            n._InverseRenderTransform = o.mat2d.create(),
            n._TempOverPoint = o.vec2.create(),
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "updateHighlights",
            value: function(e) {
                var t = this.node;
                if (t) {
                    var n = t.actor;
                    if (n) {
                        var i = t.constraints;
                        if (i) {
                            var r = true
                              , o = false
                              , a = void 0;
                            try {
                                for (var l, u = i[Symbol.iterator](); !(r = (l = u.next()).done); r = true) {
                                    var c = l.value;
                                    c.stageItem && c.stageItem.updateHighlights(e)
                                }
                            } catch (e) {
                                o = true,
                                a = e
                            } finally {
                                try {
                                    !r && u.return && u.return()
                                } finally {
                                    if (o)
                                        throw a
                                }
                            }
                        }
                        var d = n.dependencyGraph.getDependents(t);
                        if (d) {
                            var h = true
                              , f = false
                              , p = void 0;
                            try {
                                for (var y, m = d[Symbol.iterator](); !(h = (y = m.next()).done); h = true) {
                                    var v = y.value.constraints;
                                    if (v) {
                                        var g = true
                                          , _ = false
                                          , b = void 0;
                                        try {
                                            for (var w, O = v[Symbol.iterator](); !(g = (w = O.next()).done); g = true) {
                                                var S = w.value;
                                                S instanceof s.default && S.target === t && S.stageItem && S.stageItem.updateHighlights(e)
                                            }
                                        } catch (e) {
                                            _ = true,
                                            b = e
                                        } finally {
                                            try {
                                                !g && O.return && O.return()
                                            } finally {
                                                if (_)
                                                    throw b
                                            }
                                        }
                                    }
                                }
                            } catch (e) {
                                f = true,
                                p = e
                            } finally {
                                try {
                                    !h && m.return && m.return()
                                } finally {
                                    if (f)
                                        throw p
                                }
                            }
                        }
                    }
                }
            }
        }, {
            key: "setNode",
            value: function(e) {
                this._Node = e
            }
        }, {
            key: "dispatchSelectionChanged",
            value: function() {
                var e = this._IsSelected;
                this.onSelectedChange && this.onSelectedChange(e),
                this.dispatch("selectedChange", e)
            }
        }, {
            key: "setSelected",
            value: function(e, t) {
                return this._IsSelected != e && (this._IsSelected = e,
                t || this.dispatch("selectedChange", e),
                true)
            }
        }, {
            key: "computeAABB",
            value: function() {
                for (var e = Number.MAX_VALUE, t = Number.MAX_VALUE, n = -Number.MAX_VALUE, i = -Number.MAX_VALUE, r = [o.vec2.set(this._WorldPoints[0], this._MinPoint[0], this._MinPoint[1]), o.vec2.set(this._WorldPoints[1], this._MaxPoint[0], this._MinPoint[1]), o.vec2.set(this._WorldPoints[2], this._MaxPoint[0], this._MaxPoint[1]), o.vec2.set(this._WorldPoints[3], this._MinPoint[0], this._MaxPoint[1])], a = 0; a < r.length; a++) {
                    var s = r[a]
                      , l = o.vec2.transformMat2d(s, s, this._RenderTransform);
                    l[0] < e && (e = l[0]),
                    l[1] < t && (t = l[1]),
                    l[0] > n && (n = l[0]),
                    l[1] > i && (i = l[1])
                }
                this._AABB.set([e, t], [n, i])
            }
        }, {
            key: "getLocalPoint",
            value: function(e) {
                return this._TempOverPoint[0] = e[0],
                this._TempOverPoint[1] = e[1],
                o.vec2.transformMat2d(this._TempOverPoint, this._TempOverPoint, this._InverseRenderTransform),
                this._TempOverPoint
            }
        }, {
            key: "getWorldPoint",
            value: function(e) {
                return this._TempOverPoint[0] = e[0],
                this._TempOverPoint[1] = e[1],
                o.vec2.transformMat2d(this._TempOverPoint, this._TempOverPoint, this._RenderTransform),
                this._TempOverPoint
            }
        }, {
            key: "isPointOver",
            value: function(e, t) {
                if (this.customHitDetectEarly)
                    return this.customHitDetectEarly(e, t);
                if (!this.aabb.isPointInside(e, t))
                    return false;
                if (this._TempOverPoint[0] = e,
                this._TempOverPoint[1] = t,
                o.vec2.transformMat2d(this._TempOverPoint, this._TempOverPoint, this._InverseRenderTransform),
                e = this._TempOverPoint[0],
                t = this._TempOverPoint[1],
                !(e >= this._MinPoint[0] && e <= this._MaxPoint[0] && t >= this._MinPoint[1] && t <= this._MaxPoint[1]))
                    return false;
                if (!this._MeshIndices || !this._HitDetectOnMesh)
                    return !this.customHitDetect || this.customHitDetect(e, t);
                for (var n = 0; n < this._MeshIndices.length; n += 3) {
                    var i = this._MeshIndices[n] * this._MeshStride
                      , r = this._MeshPoints[i]
                      , a = this._MeshPoints[i + 1];
                    i = this._MeshIndices[n + 1] * this._MeshStride;
                    var s = this._MeshPoints[i]
                      , l = this._MeshPoints[i + 1];
                    i = this._MeshIndices[n + 2] * this._MeshStride;
                    var u = this._MeshPoints[i]
                      , c = this._MeshPoints[i + 1]
                      , d = a * u - r * c + (c - a) * e + (r - u) * t
                      , h = r * l - a * s + (a - l) * e + (s - r) * t;
                    if (!(d * h < 0)) {
                        var f = -l * u + a * (u - s) + r * (l - c) + s * c;
                        if (f < 0 && (d = -d,
                        h = -h,
                        f = -f),
                        d > 0 && h > 0 && d + h < f)
                            return true
                    }
                }
                return false
            }
        }, {
            key: "setMesh",
            value: function(e, t, n, i) {
                this._MeshPoints = e,
                this._MeshStride = t,
                this._MeshIndices = n,
                this._MeshContourIndices = i;
                for (var r = Number.MAX_VALUE, o = Number.MAX_VALUE, a = -Number.MAX_VALUE, s = -Number.MAX_VALUE, l = 0; l < e.length; l += t) {
                    var u = e[l]
                      , c = e[l + 1];
                    u < r && (r = u),
                    c < o && (o = c),
                    u > a && (a = u),
                    c > s && (s = c)
                }
                r === a && (r -= 10,
                a += 10),
                o === s && (o -= 10,
                s += 10),
                this._MinPoint[0] = r,
                this._MinPoint[1] = o,
                this._MaxPoint[0] = a,
                this._MaxPoint[1] = s,
                this._RecomputeAABB = true,
                this._RecomputeContour = true
            }
        }, {
            key: "addToStage",
            value: function(e) {
                null == this._Stage && (this._Stage = e,
                e && (this._StageContext = e.getStageItemContext(this),
                e.addItem(this),
                this.dispatch("addedToStage", e, this),
                this._IsSelected = e.isItemSelected(this)),
                this.onAddedToStage && this.onAddedToStage(e))
            }
        }, {
            key: "removeFromStage",
            value: function() {
                if (this._Stage) {
                    this._Stage.removeItem(this);
                    var e = this._Stage;
                    this._Stage = null,
                    this.dispatch("removedFromStage", e, this),
                    this.onRemovedFromStage && this.onRemovedFromStage(e)
                }
            }
        }, {
            key: "drawOBB",
            value: function(e, t, n) {
                this._RecomputeAABB && (this.computeAABB(),
                o.mat2d.invert(this._InverseRenderTransform, this._RenderTransform),
                this._RecomputeAABB = false);
                for (var i = [o.vec2.set(o.vec2.create(), this._MinPoint[0], this._MinPoint[1]), o.vec2.set(o.vec2.create(), this._MaxPoint[0], this._MinPoint[1]), o.vec2.set(o.vec2.create(), this._MaxPoint[0], this._MaxPoint[1]), o.vec2.set(o.vec2.create(), this._MinPoint[0], this._MaxPoint[1])], r = 0; r < i.length; r++) {
                    var a = i[r];
                    o.vec2.transformMat2d(a, a, this._RenderTransform)
                }
                var s = [i[0][0], i[0][1], i[1][0], i[1][1], i[1][0], i[1][1], i[2][0], i[2][1], i[2][0], i[2][1], i[3][0], i[3][1], i[3][0], i[3][1], i[0][0], i[0][1]];
                e.drawLine(this._Stage.viewTransform, s, t, n)
            }
        }, {
            key: "drawAABB",
            value: function(e, t, n) {
                var i = this.aabb
                  , r = [i.min[0], i.min[1], i.max[0], i.min[1], i.max[0], i.min[1], i.max[0], i.max[1], i.max[0], i.max[1], i.min[0], i.max[1], i.min[0], i.max[1], i.min[0], i.min[1]];
                e.drawLine(this._Stage.viewTransform, r, t, n)
            }
        }, {
            key: "drawContour",
            value: function(e) {
                if (this._RecomputeContour && this._MeshContourIndices) {
                    this._RecomputeContour = false;
                    for (var t = [], n = 0; n < this._MeshContourIndices.length; n++) {
                        var i = this._MeshContourIndices[n] * this._MeshStride;
                        t.push([this._MeshPoints[i], this._MeshPoints[i + 1]])
                    }
                    this._Contour = e.makeThickLine(t, true)
                }
                if (this._Contour) {
                    var r = this._Stage
                      , o = this.renderViewTransform;
                    e.drawThickLine(o, this._Contour, r.settings.contourThickness / r.scale * r.screenScale, r.settings.contourOpacity, this._IsSelected ? r.settings.selectionColor : r.settings.highlightColor)
                }
            }
        }, {
            key: "rectIntersects",
            value: function(e) {
                return this._CustomRectIntsersect ? this._CustomRectIntsersect(e) : (this._RecomputeAABB && (this.computeAABB(),
                o.mat2d.invert(this._InverseRenderTransform, this._RenderTransform),
                this._RecomputeAABB = false),
                t.polygonsIntersect(this._WorldPoints, e))
            }
        }, {
            key: "setTranslation",
            value: function(e) {
                this._RenderTransform[4] = e[0],
                this._RenderTransform[5] = e[1],
                this._RecomputeAABB = true
            }
        }, {
            key: "draw",
            value: function(e, t) {}
        }, {
            key: "drawSelection",
            value: function(e, t) {}
        }, {
            key: "highlight",
            get: function() {
                return this._Highlight
            },
            set: function(e) {
                this._Highlight !== e && (this._Highlight = e,
                this.stage && this.stage.redraw())
            }
        }, {
            key: "doesCustomSelection",
            get: function() {
                return false
            }
        }, {
            key: "isFiltered",
            set: function(e) {
                this._IsFiltered != e && (this._IsFiltered = e,
                this.onFilteredChanged && this.onFilteredChanged(e))
            },
            get: function() {
                return this._IsFiltered
            }
        }, {
            key: "node",
            get: function() {
                return this._Node
            }
        }, {
            key: "hitDetectOnMesh",
            get: function() {
                return this._HitDetectOnMesh
            },
            set: function(e) {
                this._HitDetectOnMesh = e
            }
        }, {
            key: "customRectIntsersect",
            get: function() {
                return this._CustomRectIntsersect
            },
            set: function(e) {
                this._CustomRectIntsersect = e
            }
        }, {
            key: "isVisible",
            get: function() {
                return this._IsVisible
            },
            set: function(e) {
                this._IsVisible != e && (this._IsVisible = e,
                this.dispatch("visibilityChange"),
                this._Stage && this._Stage.onItemVisibilityChanged(this),
                this.onVisibilityChanged && this.onVisibilityChanged(e))
            }
        }, {
            key: "isLocked",
            get: function() {
                return this._IsLocked
            },
            set: function(e) {
                this._IsLocked != e && (this._IsLocked = e,
                this.dispatch("lockedChange"),
                !this._IsLocked && this._Stage && this._Stage.deSelectItem(this),
                this.onLockedChange && this.onLockedChange(e))
            }
        }, {
            key: "isSelectable",
            get: function() {
                return this._IsSelectable && !this._IsLocked
            },
            set: function(e) {
                this._IsSelectable = e
            }
        }, {
            key: "renderTransform",
            get: function() {
                return this._RenderTransform
            },
            set: function(e) {
                o.mat2d.copy(this._RenderTransform, e),
                this._RecomputeAABB = true
            }
        }, {
            key: "worldTranslation",
            get: function() {
                return o.mat2d.getTranslation(o.vec2.create(), this._RenderTransform)
            }
        }, {
            key: "worldPoints",
            get: function() {
                return this._WorldPoints
            }
        }, {
            key: "renderViewTransform",
            get: function() {
                return o.mat2d.mul(t._RenderViewTransform, this._Stage.viewTransform, this._RenderTransform)
            }
        }, {
            key: "aabb",
            get: function() {
                return this._RecomputeAABB && (this.computeAABB(),
                o.mat2d.invert(this._InverseRenderTransform, this._RenderTransform),
                this._RecomputeAABB = false),
                this._AABB
            }
        }, {
            key: "stageContext",
            get: function() {
                return this._StageContext
            }
        }, {
            key: "stage",
            get: function() {
                return this._Stage
            }
        }, {
            key: "isSelected",
            get: function() {
                return this._IsSelected
            },
            set: function(e) {
                this._IsSelected != e && (this._IsSelected = e,
                this.onSelectedChange && this.onSelectedChange(e),
                this.dispatch("selectedChange", e))
            }
        }, {
            key: "min",
            get: function() {
                return this._MinPoint
            }
        }, {
            key: "max",
            get: function() {
                return this._MaxPoint
            }
        }], [{
            key: "polygonsIntersect",
            value: function(e, t) {
                var n, i, r, a, s, l, u, c, d = [e, t];
                for (a = 0; a < d.length; a++) {
                    var h = d[a];
                    for (s = 0; s < h.length; s++) {
                        var f = (s + 1) % h.length
                          , p = h[s]
                          , y = h[f]
                          , m = o.vec2.set(o.vec2.create(), y[1] - p[1], p[0] - y[0]);
                        for (n = i = null,
                        l = 0; l < e.length; l++)
                            r = m[0] * e[l][0] + m[1] * e[l][1],
                            (null === n || r < n) && (n = r),
                            (null === i || r > i) && (i = r);
                        for (u = c = null,
                        l = 0; l < t.length; l++)
                            r = m[0] * t[l][0] + m[1] * t[l][1],
                            (null === u || r < u) && (u = r),
                            (null === c || r > c) && (c = r);
                        if (i < u || c < n)
                            return false
                    }
                }
                return true
            }
        }]),
        t
    }(r.default);
    t.default = u,
    u._RenderViewTransform = o.mat2d.create()
}
, , , , , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }
      , o = c(n(581))
      , a = n(2)
      , s = c(n(443))
      , l = c(n(263))
      , u = c(n(582));
    function c(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var d = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n._Transform = a.mat2d.create(),
            n._WorldTransform = a.mat2d.create(),
            n._Translation = a.vec2.create(),
            n._Rotation = 0,
            n._Scale = a.vec2.set(a.vec2.create(), 1, 1),
            n._Opacity = 1,
            n._RenderOpacity = 1,
            n._AnimationTranslation = a.vec2.create(),
            n._AnimationRotation = 0,
            n._AnimationScale = a.vec2.set(a.vec2.create(), 1, 1),
            n._AnimationOpacity = 1,
            n._UseAnimationValues = false,
            n._KeyStatePosX = 0,
            n._KeyStatePosY = 0,
            n._KeyStateRotation = 0,
            n._KeyStateOpacity = 0,
            n._KeyStateScaleX = 0,
            n._KeyStateScaleY = 0,
            n._OverrideWorldTransform = false,
            n._IsVisible = true,
            n._IsCollapsedVisibility = false,
            n._RenderCollapsed = false,
            n._Constraints = null,
            n._PeerConstraints = null,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "clearKeyStates",
            value: function() {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "clearKeyStates", this).call(this),
                this.framePosXKS = 0,
                this.framePosYKS = 0,
                this.frameScaleXKS = 0,
                this.frameScaleYKS = 0,
                this.frameRotationKS = 0,
                this.frameOpacityKS = 0
            }
        }, {
            key: "removePeerConstraint",
            value: function(e) {
                if (this._PeerConstraints) {
                    var t = this._PeerConstraints.indexOf(e);
                    -1 !== t && this._PeerConstraints.splice(t, 1),
                    0 === this._PeerConstraints.length && (this._PeerConstraints = null)
                }
            }
        }, {
            key: "addPeerConstraint",
            value: function(e) {
                this._PeerConstraints || (this._PeerConstraints = []),
                this._PeerConstraints.push(e)
            }
        }, {
            key: "setParent",
            value: function(e) {
                var n = this._Parent;
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "setParent", this).call(this, e),
                e !== n && this._Actor.markDependenciesDirty()
            }
        }, {
            key: "updateDependencies",
            value: function(e) {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "updateDependencies", this).call(this, e);
                var n = this._Parent;
                n && e.addDependency(this, n);
                var i = true
                  , o = false
                  , a = void 0;
                try {
                    for (var s, l = this._Children[Symbol.iterator](); !(i = (s = l.next()).done); i = true) {
                        s.value.updateDependencies(e)
                    }
                } catch (e) {
                    o = true,
                    a = e
                } finally {
                    try {
                        !i && l.return && l.return()
                    } finally {
                        if (o)
                            throw a
                    }
                }
            }
        }, {
            key: "onDirty",
            value: function(e) {}
        }, {
            key: "markTransformDirty",
            value: function() {
                var e = this._Actor._DependencyGraph;
                e && e.addDirt(this, 1) && e.addDirtRecursive(this, 2)
            }
        }, {
            key: "updateWorldTransform",
            value: function() {
                var e = this.parent
                  , t = e && e.isNode;
                if (t) {
                    var n = this._IsCollapsedVisibility || e.renderCollapsed;
                    this._RenderCollapsed != n && (this._RenderCollapsed = n,
                    this.dispatch("renderCollapseChange")),
                    this.setStageItemVisibility()
                }
                var i = this._UseAnimationValues ? this._AnimationOpacity : this._Opacity;
                this._OverrideWorldTransform || a.mat2d.copy(this._WorldTransform, this.transform),
                t && (i *= e.renderOpacity,
                this._OverrideWorldTransform || a.mat2d.mul(this._WorldTransform, e.rawWorldTransform, this._WorldTransform)),
                this.renderOpacity = i;
                var r = this._Constraints;
                if (r) {
                    var o = true
                      , s = false
                      , l = void 0;
                    try {
                        for (var u, c = r[Symbol.iterator](); !(o = (u = c.next()).done); o = true) {
                            var d = u.value;
                            d.isEnabled && d.constrain(this)
                        }
                    } catch (e) {
                        s = true,
                        l = e
                    } finally {
                        try {
                            !o && c.return && c.return()
                        } finally {
                            if (s)
                                throw l
                        }
                    }
                }
                return this.dispatch("worldTransform", this._WorldTransform),
                this.onWorldTransform(),
                true
            }
        }, {
            key: "update",
            value: function(e, t) {
                1 == (1 & t) && this.updateTransform(),
                2 == (2 & t) && this.updateWorldTransform()
            }
        }, {
            key: "onWorldTransform",
            value: function() {}
        }, {
            key: "updateTransform",
            value: function() {
                var e = this._Rotation
                  , t = this._Translation
                  , n = this._Scale;
                this._UseAnimationValues && (e = this._AnimationRotation,
                t = this._AnimationTranslation,
                n = this._AnimationScale);
                var i = this._Transform;
                return 0 !== e ? a.mat2d.fromRotation(i, e) : a.mat2d.identity(i),
                i[4] = t[0],
                i[5] = t[1],
                a.mat2d.scale(i, i, n),
                this.dispatch("transform", this._Transform),
                this.onTransform && this.onTransform(),
                true
            }
        }, {
            key: "calculateWorldTransform",
            value: function() {
                for (var e = this.parent, n = [this]; e; )
                    n.unshift(e),
                    e = e.parent;
                var i = true
                  , r = false
                  , o = void 0;
                try {
                    for (var a, s = n[Symbol.iterator](); !(i = (a = s.next()).done); i = true) {
                        var l = a.value;
                        l instanceof t && (l.updateTransform(),
                        l.updateWorldTransform())
                    }
                } catch (e) {
                    r = true,
                    o = e
                } finally {
                    try {
                        !i && s.return && s.return()
                    } finally {
                        if (r)
                            throw o
                    }
                }
                return this._WorldTransform
            }
        }, {
            key: "forceRedraw",
            value: function() {
                this._Actor.forceRedraw()
            }
        }, {
            key: "onSetStageItem",
            value: function(e) {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "onSetStageItem", this).call(this, e),
                this.setStageItemVisibility()
            }
        }, {
            key: "setStageItemVisibility",
            value: function() {
                this.stageItem && (this.stageItem.isVisible = this.isVisible && !this._RenderCollapsed)
            }
        }, {
            key: "onParentChanged",
            value: function() {
                this.markTransformDirty()
            }
        }, {
            key: "onChildrenChanged",
            value: function() {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "onChildrenChanged", this).call(this),
                this.updateConstraints()
            }
        }, {
            key: "onChildAdded",
            value: function(e) {
                if (e.allNodes) {
                    var t = this;
                    e.allNodes((function(e) {
                        t.actor.onNodeAdded(e)
                    }
                    ))
                }
            }
        }, {
            key: "onChildRemoved",
            value: function(e) {
                if (e.allNodes) {
                    var t = this;
                    e.allNodes((function(e) {
                        t.actor.onNodeRemoved(e)
                    }
                    ))
                }
            }
        }, {
            key: "updateConstraints",
            value: function() {
                var e = []
                  , t = true
                  , n = false
                  , i = void 0;
                try {
                    for (var r, o = this.children[Symbol.iterator](); !(t = (r = o.next()).done); t = true) {
                        var a = r.value;
                        a instanceof s.default && e.push(a)
                    }
                } catch (e) {
                    n = true,
                    i = e
                } finally {
                    try {
                        !t && o.return && o.return()
                    } finally {
                        if (n)
                            throw i
                    }
                }
                (0,
                l.default)(e, this._Constraints) || (this._Constraints = e)
            }
        }, {
            key: "eachNodeRecursive",
            value: function(e) {
                for (var n = this.children, i = 0; i < n.length; i++) {
                    var r = n[i];
                    r instanceof t && false !== e(r) && r.eachNodeRecursive(e)
                }
            }
        }, {
            key: "allNodes",
            value: function(e) {
                if (false !== e(this))
                    for (var n = this.children, i = 0; i < n.length; i++) {
                        var r = n[i];
                        r instanceof t && false !== e(r) && (r.eachNodeRecursive && r.eachNodeRecursive(e))
                    }
            }
        }, {
            key: "read",
            value: function(e, n) {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "read", this).call(this, e, n),
                n.hidden && (this._IsVisible = false);
                var i = n.translation;
                i && i.constructor === Array && 2 == i.length && (this._Translation[0] = i[0],
                this._Translation[1] = i[1]),
                (i = n.scale) && i.constructor === Array && 2 == i.length && (this._Scale[0] = i[0],
                this._Scale[1] = i[1]),
                (i = n.rotation) && i.constructor === Number && (this._Rotation = i / 180 * Math.PI),
                this.markTransformDirty();
                var o = n.opacity;
                if (void 0 !== o && (this._Opacity = o),
                this.constructor === t) {
                    var a = n.displayType;
                    void 0 !== a && (this._DisplayType = u.default.fromString(a))
                }
            }
        }, {
            key: "compensate",
            value: function(e) {
                if (this.parent && !this._OverrideWorldTransform) {
                    e || (e = this._WorldTransform);
                    var t = this.parent.calculateWorldTransform()
                      , n = a.mat2d.invert(a.mat2d.create(), t)
                      , i = a.mat2d.mul(a.mat2d.create(), n, e)
                      , r = a.mat2d.getTranslation(a.vec2.create(), i)
                      , o = a.vec2.create()
                      , s = a.mat2d.decompose(o, i);
                    this.scale = o,
                    this.translation = r,
                    this.rotation = s
                }
            }
        }, {
            key: "serializeTransform",
            value: function(e) {
                e.translation = a.vec2.clone(this._Translation),
                e.rotation = this._Rotation,
                e.scale = a.vec2.clone(this._Scale)
            }
        }, {
            key: "serializeProperties",
            value: function(e) {
                var n = r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeProperties", this).call(this, e);
                this.stageItem && !this.isVisible && (n.hidden = true),
                this.stageItem && this.stageItem.isLocked && (n.locked = true),
                void 0 !== n.rotation && (n.rotation = n.rotation / Math.PI * 180),
                0 === n.rotation && delete n.rotation,
                1 === n.opacity && delete n.opacity;
                var i = n.scale;
                i && 1 === i[0] && 1 === i[1] && delete n.scale;
                var o = n.translation;
                return o && 0 === o[0] && 0 === o[1] && delete n.translation,
                this.constructor === t && (n.displayType = this.displayType.toString()),
                n
            }
        }, {
            key: "serializeInteractive",
            value: function() {
                var e = r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeInteractive", this).call(this);
                return this.serializeTransform(e),
                e.opacity = this._Opacity,
                this.constructor === t && (e.displayType = this.displayType),
                e
            }
        }, {
            key: "serialize",
            value: function(e) {
                return r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serialize", this).call(this, e)
            }
        }, {
            key: "nullFrame",
            value: function() {
                return {
                    framePosX: null,
                    framePosY: null,
                    frameScaleX: null,
                    frameScaleY: null,
                    frameOpacity: null,
                    frameRotation: null
                }
            }
        }, {
            key: "displayType",
            get: function() {
                return this._DisplayType || u.default.Empty
            },
            set: function(e) {
                if (this._DisplayType !== e) {
                    this._DisplayType = e,
                    this.dispatch("displayChange"),
                    this.forceRedraw();
                    var t = this.stageItem;
                    t && t.updateDisplayType(e)
                }
            }
        }, {
            key: "uiHierIconClass",
            get: function() {
                return this.parent ? this.displayType === u.default.Target ? "HierarchyIKTargetIcon" : "HierarchyNodeIcon" : "HierarchyCharIcon"
            }
        }, {
            key: "uiSelectionIconClass",
            get: function() {
                return "SelectionNodeIcon"
            }
        }, {
            key: "isConstrained",
            get: function() {
                return !(!this._Constraints || !this._Constraints.find((function(e) {
                    return e.isEnabled
                }
                ))) || !(!this._PeerConstraints || !this._PeerConstraints.find((function(e) {
                    return e.isEnabled
                }
                )))
            }
        }, {
            key: "uiIcon",
            get: function() {
                return this.parent ? this.displayType === u.default.Target ? "icon-iktarget" : "icon-node" : "icon-character"
            }
        }, {
            key: "allowDragDrop",
            get: function() {
                return true
            }
        }, {
            key: "typeName",
            get: function() {
                return "Node"
            }
        }, {
            key: "dirtInfo",
            get: function() {
                var e = this._Actor._DependencyGraph;
                if (!e)
                    return "no graph";
                var t = e.getDirt(this)
                  , n = [];
                return 1 == (1 & t) && n.push("TransformDirty"),
                2 == (2 & t) && n.push("WorldTransformDirty"),
                0 === n.length ? "Clean" : n.join(",")
            }
        }, {
            key: "constraints",
            get: function() {
                return this._Constraints
            }
        }, {
            key: "allConstraints",
            get: function() {
                return new Set((this._Constraints || []).concat(this._PeerConstraints || []))
            }
        }, {
            key: "isNode",
            get: function() {
                return true
            }
        }, {
            key: "rigTranslation",
            get: function() {
                return this._Translation
            }
        }, {
            key: "translation",
            get: function() {
                if (this._OverrideWorldTransform && this.parent) {
                    var e = a.mat2d.invert(a.mat2d.create(), this.parent.worldTransform)
                      , t = a.mat2d.mul(a.mat2d.create(), e, this._WorldTransform);
                    return a.mat2d.getTranslation(a.vec2.create(), t)
                }
                return this._OverrideTransform ? a.mat2d.getTranslation(a.vec2.create(), this._Transform) : this._UseAnimationValues ? this._AnimationTranslation : this._Translation
            },
            set: function(e) {
                if (this._UseAnimationValues) {
                    var n = e[0];
                    if (Math.abs(n - this._AnimationTranslation[0]) > t.EPSILON) {
                        var i = this.framePosX;
                        this.framePosX = n,
                        this.dispatch("animatePosX", {
                            from: i,
                            to: n
                        })
                    }
                    var r = e[1];
                    if (Math.abs(r - this._AnimationTranslation[1]) > t.EPSILON) {
                        var o = this.framePosY;
                        this.framePosY = r,
                        this.dispatch("animatePosY", {
                            from: o,
                            to: r
                        })
                    }
                } else
                    a.vec2.isEqual(this._Translation, e) || (a.vec2.copy(this._Translation, e),
                    this.markTransformDirty())
            }
        }, {
            key: "overrideWorldTransform",
            get: function() {
                return this._OverrideWorldTransform
            },
            set: function(e) {
                null === e ? this._OverrideWorldTransform = false : (this._OverrideWorldTransform = true,
                a.mat2d.copy(this._WorldTransform, e)),
                this.markTransformDirty()
            }
        }, {
            key: "hasTransformOverride",
            get: function() {
                return this._OverrideTransform
            }
        }, {
            key: "hasWorldTransformOverride",
            get: function() {
                return this._OverrideWorldTransform
            }
        }, {
            key: "worldTranslation",
            get: function() {
                var e = this.worldTransform;
                return a.mat2d.getTranslation(a.vec2.create(), e)
            }
        }, {
            key: "rigRotation",
            get: function() {
                return this._Rotation
            }
        }, {
            key: "rotation",
            get: function() {
                return this._UseAnimationValues ? this._AnimationRotation : this._Rotation
            },
            set: function(e) {
                if (this._UseAnimationValues) {
                    if (Math.abs(e - this._AnimationRotation) > t.EPSILON) {
                        var n = this.frameRotation;
                        this.frameRotation = e,
                        this.dispatch("animateRotation", {
                            from: n,
                            to: e
                        })
                    }
                } else
                    e != this._Rotation && (this._Rotation = e,
                    this.markTransformDirty())
            }
        }, {
            key: "rigScale",
            get: function() {
                return this._Scale
            }
        }, {
            key: "scale",
            get: function() {
                return this._UseAnimationValues ? this._AnimationScale : this._Scale
            },
            set: function(e) {
                if (this._UseAnimationValues) {
                    if (e[0] != this._AnimationScale[0]) {
                        var t = this.frameScaleX;
                        this.frameScaleX = e[0],
                        this.dispatch("animateScaleX", {
                            from: t,
                            to: e[0]
                        })
                    }
                    if (e[1] != this._AnimationScale[1]) {
                        var n = this.frameScaleY;
                        this.frameScaleY = e[1],
                        this.dispatch("animateScaleY", {
                            from: n,
                            to: e[1]
                        })
                    }
                } else
                    a.vec2.isEqual(this._Scale, e) || (a.vec2.copy(this._Scale, e),
                    this.markTransformDirty())
            }
        }, {
            key: "transform",
            get: function() {
                return this._Transform
            }
        }, {
            key: "rawTransform",
            get: function() {
                return this._Transform
            }
        }, {
            key: "rawWorldTransform",
            get: function() {
                return this._WorldTransform
            }
        }, {
            key: "worldTransform",
            get: function() {
                return this._WorldTransform
            }
        }, {
            key: "useAnimationValues",
            get: function() {
                return this._UseAnimationValues
            },
            set: function(e) {
                e != this._UseAnimationValues && (this._UseAnimationValues = e,
                this.markTransformDirty(),
                this.onUseAnimationValuesChange && this.onUseAnimationValuesChange(e))
            }
        }, {
            key: "rigPosX",
            get: function() {
                return this._Translation[0]
            }
        }, {
            key: "rigPosY",
            get: function() {
                return this._Translation[1]
            }
        }, {
            key: "rigScaleX",
            get: function() {
                return this._Scale[0]
            }
        }, {
            key: "rigScaleY",
            get: function() {
                return this._Scale[1]
            }
        }, {
            key: "framePosX",
            get: function() {
                return this._AnimationTranslation[0]
            },
            set: function(e) {
                this._AnimationTranslation[0] != e && (this._AnimationTranslation[0] = e,
                this.markTransformDirty())
            }
        }, {
            key: "framePosXWorld",
            get: function() {
                return this.worldTransform[4]
            }
        }, {
            key: "framePosYWorld",
            get: function() {
                return this.worldTransform[5]
            }
        }, {
            key: "framePosXParent",
            get: function() {
                var e = this.worldTransform;
                if (this.parent && this.parent.parent) {
                    var t = this.parent.parent.worldTransform
                      , n = a.mat2d.invert(a.mat2d.create(), t);
                    e = a.mat2d.mul(a.mat2d.create(), n, e)
                }
                return e[4]
            }
        }, {
            key: "framePosYParent",
            get: function() {
                var e = this.worldTransform;
                if (this.parent && this.parent.parent) {
                    var t = this.parent.parent.worldTransform
                      , n = a.mat2d.invert(a.mat2d.create(), t);
                    e = a.mat2d.mul(a.mat2d.create(), n, e)
                }
                return e[5]
            }
        }, {
            key: "framePosY",
            get: function() {
                return this._AnimationTranslation[1]
            },
            set: function(e) {
                this._AnimationTranslation[1] != e && (this._AnimationTranslation[1] = e,
                this.markTransformDirty())
            }
        }, {
            key: "frameScaleX",
            get: function() {
                return this._AnimationScale[0]
            },
            set: function(e) {
                this._AnimationScale[0] != e && (this._AnimationScale[0] = e,
                this.markTransformDirty())
            }
        }, {
            key: "frameScaleY",
            get: function() {
                return this._AnimationScale[1]
            },
            set: function(e) {
                this._AnimationScale[1] != e && (this._AnimationScale[1] = e,
                this.markTransformDirty())
            }
        }, {
            key: "frameRotation",
            get: function() {
                return this._AnimationRotation
            },
            set: function(e) {
                this._AnimationRotation != e && (this._AnimationRotation = e,
                this.markTransformDirty())
            }
        }, {
            key: "renderOpacity",
            get: function() {
                return this._RenderOpacity
            },
            set: function(e) {
                this._RenderOpacity !== e && (this._RenderOpacity = e,
                this.dispatch("opacityChange", this._RenderOpacity))
            }
        }, {
            key: "renderCollapsed",
            get: function() {
                return this._RenderCollapsed
            }
        }, {
            key: "rigOpacity",
            get: function() {
                return this._Opacity
            }
        }, {
            key: "opacity",
            get: function() {
                return this._UseAnimationValues ? this._AnimationOpacity : this._Opacity
            },
            set: function(e) {
                if (this._UseAnimationValues) {
                    if (this._AnimationOpacity != e) {
                        var t = this.frameOpacity;
                        this.frameOpacity = e,
                        this.dispatch("animateOpacity", {
                            from: t,
                            to: e
                        })
                    }
                } else
                    this._Opacity = e,
                    this.forceRedraw(),
                    this.markTransformDirty()
            }
        }, {
            key: "frameOpacity",
            get: function() {
                return this._AnimationOpacity
            },
            set: function(e) {
                this._AnimationOpacity != e && (this._AnimationOpacity = e,
                this.markTransformDirty())
            }
        }, {
            key: "frameRotationKS",
            get: function() {
                return this._KeyStateRotation
            },
            set: function(e) {
                this._KeyStateRotation != e && (this._KeyStateRotation = e,
                this.markKeyStateDirty())
            }
        }, {
            key: "frameOpacityKS",
            get: function() {
                return this._KeyStateOpacity
            },
            set: function(e) {
                this._KeyStateOpacity != e && (this._KeyStateOpacity = e,
                this.markKeyStateDirty())
            }
        }, {
            key: "framePosXKS",
            get: function() {
                return this._KeyStatePosX
            },
            set: function(e) {
                this._KeyStatePosX != e && (this._KeyStatePosX = e,
                this.markKeyStateDirty())
            }
        }, {
            key: "framePosYKS",
            get: function() {
                return this._KeyStatePosY
            },
            set: function(e) {
                this._KeyStatePosY != e && (this._KeyStatePosY = e,
                this.markKeyStateDirty())
            }
        }, {
            key: "frameScaleXKS",
            get: function() {
                return this._KeyStateScaleX
            },
            set: function(e) {
                this._KeyStateScaleX != e && (this._KeyStateScaleX = e,
                this.markKeyStateDirty())
            }
        }, {
            key: "frameScaleYKS",
            get: function() {
                return this._KeyStateScaleY
            },
            set: function(e) {
                this._KeyStateScaleY != e && (this._KeyStateScaleY = e,
                this.markKeyStateDirty())
            }
        }, {
            key: "isVisible",
            get: function() {
                return this._IsVisible
            },
            set: function(e) {
                this._IsVisible !== e && (this._IsVisible = e,
                this.dispatch("visibilityChange"),
                this.setStageItemVisibility(),
                this._Actor.revise())
            }
        }, {
            key: "isCollapsedVisibility",
            get: function() {
                return this._IsCollapsedVisibility
            },
            set: function(e) {
                this._IsCollapsedVisibility !== e && (this._IsCollapsedVisibility = e,
                this.forceRedraw(),
                this.markTransformDirty(),
                this.dispatch("collapseChange"),
                this._UseAnimationValues || this._Actor.revise())
            }
        }, {
            key: "isLocked",
            get: function() {
                return this.stageItem && this.stageItem.isLocked
            },
            set: function(e) {
                this.stageItem && (this.stageItem.isLocked = e),
                this._Actor.revise()
            }
        }, {
            key: "visibilityItem",
            get: function() {
                return this.stageItem
            }
        }]),
        t
    }(o.default);
    t.default = d,
    d.EPSILON = .001
}
, , , , , , , , , , , , , , , , , , , , , , , , , , , , , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }
      , o = l(n(462))
      , a = l(n(208))
      , s = l(n(510));
    l(n(463));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var u = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.name = "Bone",
            n._AnimationLength = 0,
            n._KeyStateLength = 0,
            n._Size = t.DefaultSize,
            n._HasContrast = false,
            n._Targets = null,
            n._Jelly = null,
            n._KeyStateLength = 0,
            n.treeOrderFactor = 99999,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "clearKeyStates",
            value: function() {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "clearKeyStates", this).call(this),
                this.frameLengthKS = 0
            }
        }, {
            key: "onChildrenChanged",
            value: function() {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "onChildrenChanged", this).call(this);
                var e = null
                  , n = this.children
                  , i = true
                  , o = false
                  , a = void 0;
                try {
                    for (var l, u = n[Symbol.iterator](); !(i = (l = u.next()).done); i = true) {
                        var c = l.value;
                        if (c instanceof s.default) {
                            e = c;
                            break
                        }
                    }
                } catch (e) {
                    o = true,
                    a = e
                } finally {
                    try {
                        !i && u.return && u.return()
                    } finally {
                        if (o)
                            throw a
                    }
                }
                this._Jelly !== e && (this._Jelly = e,
                this.dispatch("jellyChange"))
            }
        }, {
            key: "recurseChangeSize",
            value: function() {
                this.dispatch("sizeChanged", this._Size);
                for (var e = 0; e < this.children.length; e++) {
                    var n = this.children[e];
                    n.constructor === t && n.recurseChangeSize()
                }
            }
        }, {
            key: "eachNodeRecursive",
            value: function(e) {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "eachNodeRecursive", this).call(this, e);
                var n = this._Jelly
                  , i = n && n.bones;
                if (i) {
                    var o = true
                      , a = false
                      , s = void 0;
                    try {
                        for (var l, u = i[Symbol.iterator](); !(o = (l = u.next()).done); o = true) {
                            var c = l.value;
                            false !== e(c) && c.eachNodeRecursive(e)
                        }
                    } catch (e) {
                        a = true,
                        s = e
                    } finally {
                        try {
                            !o && u.return && u.return()
                        } finally {
                            if (a)
                                throw s
                        }
                    }
                }
            }
        }, {
            key: "eachChildRecursive",
            value: function(e) {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "eachChildRecursive", this).call(this, e);
                var n = this._Jelly
                  , i = n && n.bones;
                if (i) {
                    var o = true
                      , a = false
                      , s = void 0;
                    try {
                        for (var l, u = i[Symbol.iterator](); !(o = (l = u.next()).done); o = true) {
                            var c = l.value;
                            false !== e(c) && c.eachChildRecursive(e)
                        }
                    } catch (e) {
                        a = true,
                        s = e
                    } finally {
                        try {
                            !o && u.return && u.return()
                        } finally {
                            if (a)
                                throw s
                        }
                    }
                }
            }
        }, {
            key: "read",
            value: function(e, n) {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "read", this).call(this, e, n);
                var i = n.length;
                i && i.constructor === Number && (this._Length = i);
                var o = n.size;
                o && o.constructor === Number && (this._Size = o);
                var a = n.contrast;
                a && (this._HasContrast = a)
            }
        }, {
            key: "serializeProperties",
            value: function(e) {
                var n = r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeProperties", this).call(this, e);
                return delete n.targets,
                delete n.hasContrast,
                this._HasContrast && (n.contrast = this._HasContrast),
                n
            }
        }, {
            key: "serializeInteractive",
            value: function() {
                var e = r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeInteractive", this).call(this);
                return e.length = this._Length,
                e.size = this._Size,
                e.hasContrast = this._HasContrast,
                this._Targets && (e.targets = this._Targets.slice(0)),
                e
            }
        }, {
            key: "nullFrame",
            value: function() {
                var e = r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "nullFrame", this).call(this);
                return e.frameLength = null,
                e
            }
        }, {
            key: "uiHierIconClass",
            get: function() {
                return "HierarchyBoneIcon"
            }
        }, {
            key: "uiIcon",
            get: function() {
                return "icon-bone"
            }
        }, {
            key: "typeName",
            get: function() {
                return "Bone"
            }
        }, {
            key: "jelly",
            get: function() {
                return this._Jelly
            }
        }, {
            key: "hideJellies",
            get: function() {
                var e = this._Jelly;
                return !e || e.hideJellies
            }
        }, {
            key: "hideBone",
            get: function() {
                var e = this._Jelly;
                return !!e && e.hideBone
            }
        }, {
            key: "jellyBones",
            get: function() {
                var e = this._Jelly;
                return e ? e.bones : null
            }
        }, {
            key: "isJelly",
            get: function() {
                return null !== this._Jelly
            },
            set: function(e) {
                if (e) {
                    var t = this.actor.addNodeType(s.default, this, null, true);
                    t && t.setDefaults()
                } else
                    this._Jelly && this.remove(this._Jelly)
            }
        }, {
            key: "hierarchyChildren",
            get: function() {
                var e = this._Jelly
                  , t = e && e.bones;
                return t ? t.concat(this._Children) : this._Children
            }
        }, {
            key: "size",
            get: function() {
                return this._Size
            },
            set: function(e) {
                e != this._Size && (this._Size = e,
                this.recurseChangeSize(),
                this.forceRedraw())
            }
        }, {
            key: "length",
            get: function() {
                return this.useAnimationValues ? this._AnimationLength : r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "length", this)
            },
            set: function(e) {
                if (this.useAnimationValues) {
                    if (Math.abs(e - this._AnimationLength) > a.default.EPSILON) {
                        var n = this.frameLength;
                        this.frameLength = e,
                        this.dispatch("animateLength", {
                            from: n,
                            to: e
                        })
                    }
                } else
                    !function e(t, n, i, r) {
                        var o = Object.getOwnPropertyDescriptor(t, n);
                        if (void 0 === o) {
                            var a = Object.getPrototypeOf(t);
                            null !== a && e(a, n, i, r)
                        } else if ("value"in o && o.writable)
                            o.value = i;
                        else {
                            var s = o.set;
                            void 0 !== s && s.call(r, i)
                        }
                        return i
                    }(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "length", e, this)
            }
        }, {
            key: "frameLength",
            get: function() {
                return this._AnimationLength
            },
            set: function(e) {
                this._AnimationLength != e && this.dispatch("lengthChanged", {
                    from: e,
                    to: this._AnimationLength
                }),
                this._AnimationLength !== e && (this._AnimationLength = e,
                this.markTransformDirty());
                for (var n = 0; n < this.children.length; n++) {
                    this.children[n].constructor === t && (this.children[n].framePosX = e)
                }
            }
        }, {
            key: "frameLengthKS",
            get: function() {
                return this._KeyStateLength
            },
            set: function(e) {
                this._KeyStateLength != e && (this._KeyStateLength = e,
                this.markKeyStateDirty())
            }
        }, {
            key: "targets",
            get: function() {
                return this._Targets || (this._Targets = []),
                this._Targets
            },
            set: function(e) {
                e && e.constructor === Array && (this._Targets = e)
            }
        }, {
            key: "hasContrast",
            get: function() {
                return this._HasContrast
            },
            set: function(e) {
                this._HasContrast != e && (this._HasContrast = e,
                this.dispatch("hasContrastChange", e),
                this.forceRedraw())
            }
        }]),
        t
    }(o.default);
    t.default = u,
    u.DefaultSize = 10,
    u.MinimumSize = 1,
    u.MaximumSize = 30,
    u.getBoneSizeScale = function(e) {
        return .15 + .85 * (e - u.MinimumSize) / (u.MaximumSize - u.MinimumSize) / ((u.DefaultSize - u.MinimumSize) / (u.MaximumSize - u.MinimumSize))
    }
}
, , , , , , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = d(n(1)), a = n(2), s = d(n(203)), l = d(n(201)), u = d(n(315)), c = d(n(237));
    function d(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var h, f, p, y, m, v, g = [1, 1, 1, .5], _ = [198 / 255, 198 / 255, 198 / 255, .5], b = [10 / 255, 10 / 255, 10 / 255, .5], w = [50 / 255, 50 / 255, 50 / 255, .5], O = [1, 1, 1, 1], S = [0, 139 / 255, 1, .8], k = [1, 1, 1, 1], P = [198 / 255, 198 / 255, 198 / 255, 1], E = (i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n._Children = [],
            n._Bone = null,
            n._IsRoot = e && e.constructor === u.default,
            n._IsRoot && (n._Bone = e),
            n.addEventListener("addedToStage", n.onAddedToStage),
            n.customSelectionAction = l.default.RangeSelect,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "onAddedToStage",
            value: function() {
                this._IsRoot ? this.setMesh(this.stageContext.rootSelectionPoints, 2, this.stageContext.selectionIndices) : this.setMesh(this.stageContext.selectionPoints, 2, this.stageContext.selectionIndices)
            }
        }, {
            key: "updateTransform",
            value: function() {
                var e, t = a.vec2.create();
                if (this._Bone.constructor === u.default) {
                    var n = a.mat2d.create()
                      , i = this.node.worldTransform;
                    a.mat2d.fromRotation(n, a.mat2d.getRotation(i)),
                    n[4] = i[4],
                    n[5] = i[5],
                    e = n
                } else {
                    a.vec2.set(t, this._Bone.length, 0),
                    a.vec2.transformMat2d(t, t, this.node.worldTransform);
                    var r = a.mat2d.create();
                    r[4] = t[0],
                    r[5] = t[1],
                    e = r
                }
                if (this._Bone) {
                    var o = c.default.getBoneSizeScale(this._Bone.size);
                    if (1 != o) {
                        var s = a.mat2d.fromScaling(a.mat2d.create(), [o, o]);
                        a.mat2d.mul(e, e, s)
                    }
                }
                this.renderTransform = e
            }
        }, {
            key: "align",
            value: function() {
                this.updateTransform()
            }
        }, {
            key: "draw",
            value: function(e, t, n) {
                if (!t && !n) {
                    this.updateTransform();
                    var i = this.renderViewTransform
                      , r = this.stageContext
                      , o = false;
                    this.node && (o = this.node.hasContrast),
                    this._IsRoot ? (e.drawColor(i, r.rootVertexBuffer, r.rootIndexBuffer, 1, o ? w : _),
                    e.drawThickLine(i, r.rootEdgeLine, .5 / this.stage.scale, 1, o ? b : g)) : (e.drawColor(i, r.vertexBuffer, r.indexBuffer, 1, o ? w : _),
                    e.drawThickLine(i, r.edgeLine, .5 / this.stage.scale, 1, o ? b : g))
                }
            }
        }, {
            key: "drawSelection",
            value: function(e, t) {
                this.updateTransform();
                var n = this.renderViewTransform
                  , i = this.stageContext;
                this._IsRoot ? (e.drawColor(n, i.rootVertexBuffer, i.rootIndexBuffer, 1, this.isSelected ? S : P),
                e.drawThickLine(n, i.rootEdgeLine, .5 / this.stage.scale, 1, this.isSelected ? O : k)) : (e.drawColor(n, i.vertexBuffer, i.indexBuffer, 1, this.isSelected ? S : P),
                e.drawThickLine(n, i.edgeLine, .5 / this.stage.scale, 1, this.isSelected ? O : k))
            }
        }, {
            key: "addChild",
            value: function(e) {
                !this._Bone && null == this.stage && e.stage && this.addToStage(e.stage),
                this._Children.push(e)
            }
        }, {
            key: "removeChild",
            value: function(e) {
                var t = this._Children.indexOf(e);
                -1 != t && this._Children.splice(t, 1),
                !this._Bone && 0 == this._Children.length && this.stage && this.removeFromStage()
            }
        }, {
            key: "setBone",
            value: function(e) {
                this._Bone = e.node,
                this.setNode(e.actorBone)
            }
        }, {
            key: "updateVisibility",
            value: function() {
                if (!this._IsRoot) {
                    var e = false;
                    if (this._Bone.stageItem && this._Bone.stageItem.isVisible)
                        e = true;
                    else
                        for (var t = 0; t < this._Children.length; t++) {
                            if (this._Children[t].isVisible) {
                                e = true;
                                break
                            }
                        }
                    this.isVisible = e
                }
            }
        }, {
            key: "selectionIcon",
            get: function() {
                return this.parentJoint ? "icon-joint" : "icon-root"
            }
        }, {
            key: "typeName",
            get: function() {
                return this.parentJoint ? "Joint" : "Root Bone"
            }
        }, {
            key: "uiSelectionIconClass",
            get: function() {
                return "SelectionRootBoneIcon"
            }
        }, {
            key: "parentJoint",
            get: function() {
                return this._Bone && this._Bone.constructor === c.default && this._Bone.stageItem.parentJoint || null
            }
        }, {
            key: "bone",
            get: function() {
                return this._Bone
            }
        }, {
            key: "children",
            get: function() {
                return this._Children
            }
        }, {
            key: "scaledSize",
            get: function() {
                var e = 8;
                this._Bone && (e *= c.default.getBoneSizeScale(this._Bone.size));
                return e
            }
        }, {
            key: "isRoot",
            get: function() {
                return this._IsRoot
            }
        }]),
        t
    }(s.default),
    h = i.prototype,
    f = "onAddedToStage",
    p = [o.default],
    y = Object.getOwnPropertyDescriptor(i.prototype, "onAddedToStage"),
    m = i.prototype,
    v = {},
    Object.keys(y).forEach((function(e) {
        v[e] = y[e]
    }
    )),
    v.enumerable = !!v.enumerable,
    v.configurable = !!v.configurable,
    ("value"in v || v.initializer) && (v.writable = true),
    v = p.slice().reverse().reduce((function(e, t) {
        return t(h, f, e) || e
    }
    ), v),
    m && void 0 !== v.initializer && (v.value = v.initializer ? v.initializer.call(m) : void 0,
    v.initializer = void 0),
    void 0 === v.initializer && (Object.defineProperty(h, f, v),
    v = null),
    i);
    t.default = E,
    E.initializeStageContext = function(e, t) {
        var n = [0, 16, 16, 0, 0, -16, -16, 0]
          , i = [0, 1, 2, 2, 3, 0];
        t.rootSelectionPoints = n,
        t.rootSelectionIndices = i;
        for (var r = [], o = [0, 0], a = [], s = 4, l = 2 * Math.PI / s, u = 16 * Math.sin(.25 * Math.PI), c = 0, d = 0; d < s; d++) {
            var h = Math.cos(c) * u
              , f = Math.sin(c) * u;
            r.push([h, f]),
            o.push(h, f),
            c += l,
            a.push(0, d + 1, d + 2 > s ? 1 : d + 2)
        }
        t.rootEdgeLine = e.makeThickLine(r, true),
        t.rootVertexBuffer = e.makeVertexBuffer(o),
        t.rootIndexBuffer = e.makeIndexBuffer(a);
        var p = [0, 8, 8, 0, 0, -8, -8, 0];
        t.selectionPoints = p,
        t.selectionIndices = i,
        r = [],
        o = [0, 0],
        a = [],
        s = 20,
        l = 2 * Math.PI / s,
        u = 8 * Math.sin(.25 * Math.PI),
        c = 0;
        for (var y = 0; y < s; y++) {
            var m = Math.cos(c) * u
              , v = Math.sin(c) * u;
            r.push([m, v]),
            o.push(m, v),
            c += l,
            a.push(0, y + 1, y + 2 > s ? 1 : y + 2)
        }
        t.edgeLine = e.makeThickLine(r, true),
        t.vertexBuffer = e.makeVertexBuffer(o),
        t.indexBuffer = e.makeIndexBuffer(a)
    }
    ,
    E.transformChain = function(e) {
        e.updateTransform();
        for (var t = 0; t < e.children.length; t++) {
            var n = e.children[t];
            E.transformChain(n.joint)
        }
    }
    ,
    E.alignChain = function(e, t) {
        E.align(e, t);
        for (var n = 0; n < e.children.length; n++) {
            var i = e.children[n];
            E.alignChain(i.joint, t)
        }
    }
    ,
    E.compensateSkinnedImages = function(e, t) {
        if (e.skins) {
            t || (t = a.mat2d.clone(e.rawWorldTransform));
            for (var n = e.skins, i = 0; i < n.length; i++)
                for (var r = n[i], o = 0; o < r.connectedBones.length; o++) {
                    var s = r.connectedBones[o];
                    if (s.node === e) {
                        var l = e.calculateWorldTransform()
                          , u = a.mat2d.invert(a.mat2d.create(), l)
                          , c = a.mat2d.mul(a.mat2d.create(), t, s.ibind)
                          , d = a.mat2d.mul(a.mat2d.create(), u, c)
                          , h = a.mat2d.invert(a.mat2d.create(), d);
                        r.connectedBones[o] = {
                            node: e,
                            bind: h,
                            ibind: d
                        };
                        break
                    }
                }
        }
    }
    ,
    E.align = function(e, t) {
        var n = e.bone;
        if (n) {
            var i = void 0;
            t && (t = n.skins && n.skins.length > 0),
            t && (i = a.mat2d.clone(n.rawWorldTransform));
            var r = n.parent.calculateWorldTransform()
              , o = n.scale
              , s = (n.translation,
            a.mat2d.invert(a.mat2d.create(), r))
              , l = n.stageItem.parentJoint;
            if (l) {
                for (var u = l.renderTransform, c = e.renderTransform, d = a.vec2.transformMat2d(a.vec2.create(), a.vec2.set(a.vec2.create(), u[4], u[5]), s), h = a.vec2.transformMat2d(a.vec2.create(), a.vec2.set(a.vec2.create(), c[4], c[5]), s), f = a.vec2.subtract(a.vec2.create(), h, d), p = a.vec2.length(f), y = Math.atan2(f[1], f[0]), m = y - n.rotation; m > Math.PI; )
                    m = (y -= 2 * Math.PI) - n.rotation;
                for (; m < -Math.PI; )
                    m = (y += 2 * Math.PI) - n.rotation;
                n.length = p / o[0],
                n.rotation = y,
                n.translation = d
            } else {
                var v = e.renderTransform
                  , g = a.vec2.transformMat2d(a.vec2.create(), a.vec2.set(a.vec2.create(), v[4], v[5]), s);
                n.translation = g
            }
            t && E.compensateSkinnedImages(n, i)
        }
    }
}
, , , , , , , , , , , , , , , , , , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = d(n(1)), a = d(n(203)), s = (d(n(444)),
    d(n(369)),
    d(n(1095))), l = n(2), u = d(n(267)), c = d(n(370));
    function d(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var h, f, p, y, m, v, g = [1, 1, 1, 1], _ = [1, 1, 1, .5], b = [198 / 255, 198 / 255, 198 / 255, .1], w = [198 / 255, 0, 0, .8], O = [0, 139 / 255, 1, 1], S = [1, 1, 1, 1], k = (i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n._ActorImage = e,
            n._VertexBuffer = null,
            n._WeightBuffer = null,
            n._PaintWeightBuffer = null,
            n._PaintWeightData = null,
            n._IndexBuffer = null,
            n._IsSolo = false,
            n.hitDetectOnMesh = false,
            n._LastWeightDataDelta = null,
            n._VertexDeformer = null,
            n._UseVertexDeform = false,
            n._DrawDeformed = false,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "updateHighlights",
            value: function(e) {
                (function e(t, n, i) {
                    null === t && (t = Function.prototype);
                    var r = Object.getOwnPropertyDescriptor(t, n);
                    if (void 0 === r) {
                        var o = Object.getPrototypeOf(t);
                        return null === o ? void 0 : e(o, n, i)
                    }
                    if ("value"in r)
                        return r.value;
                    var a = r.get;
                    return void 0 !== a ? a.call(i) : void 0
                }
                )(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "updateHighlights", this).call(this, e);
                var n = this.node.connectedBones;
                if (n) {
                    var i = true
                      , r = false
                      , o = void 0;
                    try {
                        for (var a, s = n[Symbol.iterator](); !(i = (a = s.next()).done); i = true) {
                            var l = a.value.node.stageItem;
                            l && e.highlight(l)
                        }
                    } catch (e) {
                        r = true,
                        o = e
                    } finally {
                        try {
                            !i && s.return && s.return()
                        } finally {
                            if (r)
                                throw o
                        }
                    }
                }
            }
        }, {
            key: "updatePaintWeightData",
            value: function(e) {
                this._PaintWeightData = e
            }
        }, {
            key: "updateMesh",
            value: function() {
                if (!this.isEditingMesh && this.node.useCustomMesh && this.node.meshData) {
                    for (var e = this.node.meshData, t = e.loverts.length / 2, n = [], i = 0; i < t; i++)
                        n.push(i);
                    if (this.setMesh(this.node.deformedLoVerts || e.loverts, 2, e.lotris, n),
                    this.hitDetectOnMesh = true,
                    this._VertexBuffer)
                        this._VertexBuffer.update(this.node.vertexBufferData),
                        this._IndexBuffer.update(e.tris);
                    else {
                        var r = this.stage.graphics;
                        this._VertexBuffer = r.makeVertexBuffer(this.node.vertexBufferData),
                        this._IndexBuffer = r.makeIndexBuffer(e.tris)
                    }
                } else
                    this._VertexBuffer && (this._VertexBuffer.dispose(),
                    this._IndexBuffer.dispose(),
                    this._VertexBuffer = this._IndexBuffer = null),
                    this.hitDetectOnMesh = false,
                    this.setMesh(this.stageContext.points, 4, this.stageContext.index)
            }
        }, {
            key: "onUseVertexDeformChange",
            value: function(e) {
                this._UseVertexDeform = e,
                this.stage && (null == this._VertexDeformer && e && (this._VertexDeformer = new s.default(this)),
                this.updateDeformerEnabled())
            }
        }, {
            key: "updateDeformerEnabled",
            value: function() {
                this._VertexDeformer && (this._VertexDeformer.isEnabled = this.stage.selectionFilter.canSelectType(c.default) && this._UseVertexDeform && !this._IsSolo && this.isSelected)
            }
        }, {
            key: "onSelectedChange",
            value: function(e) {
                if (this.node) {
                    var t = this.node.connectedBones;
                    if (t)
                        for (var n = 0; n < t.length; n++) {
                            var i = t[n];
                            i.node.stageItem && i.node.stageItem.updateConnectionState()
                        }
                }
                this.updateDeformerEnabled()
            }
        }, {
            key: "onFilteredChanged",
            value: function(e) {
                this.updateDeformerEnabled()
            }
        }, {
            key: "onSelectionFilterChanged",
            value: function() {
                this.updateDeformerEnabled()
            }
        }, {
            key: "onAddedToStage",
            value: function(e) {
                this.updateMesh(),
                this.onUseVertexDeformChange(this._UseVertexDeform),
                e.addEventListener("selectionFilterChanged", this.onSelectionFilterChanged),
                this._VertexDeformer && (this._VertexDeformer.isEnabled = this._UseVertexDeform && !this._IsSolo && this.isSelected)
            }
        }, {
            key: "onRemovedFromStage",
            value: function(e) {
                e.removeEventListener("selectionFilterChanged", this.onSelectionFilterChanged),
                this._VertexDeformer && (this._VertexDeformer.cleanup(),
                this._VertexDeformer = null)
            }
        }, {
            key: "customHitDetect",
            value: function(e, t) {
                var n = this._ActorImage.width
                  , i = this._ActorImage.height;
                if (e = Math.round((e + .5) * n),
                t = Math.round((1 - (t + .5)) * i),
                e < 0 || e > this._ActorImage.width || t < 0 || t > this._ActorImage.height)
                    return false;
                var r = this._ActorImage.bitmap;
                if (r) {
                    var o = (t * r.width + e) * r.channels;
                    return r.bytes[o + r.channels - 1] > 2
                }
                return true
            }
        }, {
            key: "hasCustomMesh",
            value: function() {
                return !this.isEditingMesh && this.node.useCustomMesh && this._VertexBuffer
            }
        }, {
            key: "draw",
            value: function(e, t) {
                var n = this._ActorImage
                  , i = n.getTexture(e)
                  , r = this.stageContext
                  , o = this.stage
                  , a = this.hasCustomMesh()
                  , s = false
                  , c = false;
                if (a) {
                    var d = this.node
                      , h = null;
                    if (n.actor.hasPlayingAnimations || (h = d.updateDeform(false, !o.isSelectionDisabled)) && this._VertexDeformer && this._VertexDeformer.updateItems(),
                    d.isVertexDeformMeshDirty && (this.updateMesh(),
                    d.markVertexDeformMeshClean()),
                    d.weightData && this._LastWeightDataDelta != d.weightDataDelta && (this._LastWeightDataDelta = d.weightDataDelta,
                    this._WeightBuffer ? this._WeightBuffer.update(d.weightData) : this._WeightBuffer = e.makeVertexBuffer(d.weightData)),
                    c = (s = d.weightData && this._WeightBuffer && d.connectedBones.length) && d.isEditingWeights,
                    h) {
                        for (var f = d.meshData, p = h.length / 2, y = [], m = 0; m < p; m++)
                            y.push(m);
                        this.setMesh(h, 2, f.lotris, y),
                        this.hitDetectOnMesh = true
                    }
                    this.renderTransform = n.worldTransform
                } else
                    this.renderTransform = l.mat2d.scale(l.mat2d.create(), n.worldTransform, [n.width, n.height]);
                if (i) {
                    switch (n.blendMode) {
                    case u.default.BlendModes.Normal:
                        e.enableNormalBlending();
                        break;
                    case u.default.BlendModes.Multiply:
                        e.enableMultiplyBlending();
                        break;
                    case u.default.BlendModes.Screen:
                        e.enableScreenBlending();
                        break;
                    case u.default.BlendModes.Additive:
                        e.enableAdditiveBlending()
                    }
                    var v = r.vertexBuffer
                      , O = r.indexBuffer;
                    if (a && (v = this._VertexBuffer,
                    O = this._IndexBuffer),
                    c) {
                        var k = this._PaintWeightData;
                        k && (this._PaintWeightBuffer ? this._PaintWeightBuffer.update(k) : this._PaintWeightBuffer = e.makeVertexBuffer(k),
                        this._PaintWeightData = null);
                        var P = this.renderViewTransform;
                        1 === n.colorMapOpacity && null === n.showBoneColorIndex || (this._DrawDeformed ? e.drawTexturedSkin(o.viewTransform, this.renderTransform, v, this._WeightBuffer, O, this.node.boneTransformsArray, n.renderOpacity, g, i) : e.drawTextured(P, v, O, n.renderOpacity, g, i)),
                        e.enableBlending(),
                        this._DrawDeformed ? e.drawColorCodedSkinDeformed(o.viewTransform, this.renderTransform, v, this._WeightBuffer, this._PaintWeightBuffer, O, this.node.boneTransformsArray, this.node.boneColorsArray, n.colorMapOpacity) : e.drawColorCodedSkin(P, v, this._PaintWeightBuffer, O, this.node.boneColorsArray, n.colorMapOpacity)
                    } else
                        s ? e.drawTexturedSkin(o.viewTransform, this.renderTransform, v, this._WeightBuffer, O, this.node.boneTransformsArray, n.renderOpacity, g, i) : e.drawTextured(this.renderViewTransform, v, O, n.renderOpacity, g, i);
                    e.enableBlending(),
                    this.isEditingMesh && this.drawOBB(e, 1, this.isSelected ? S : _)
                } else {
                    var E = r.cVertexBuffer
                      , T = r.indexBuffer
                      , C = false;
                    a && (E = this._VertexBuffer,
                    T = this._IndexBuffer,
                    C = true);
                    var x = this.renderViewTransform;
                    !n.asset || n.asset.isMissing ? e.drawColor(x, E, T, 1, w, C) : e.drawColor(x, E, T, 1, b, C)
                }
            }
        }, {
            key: "drawSelection",
            value: function(e, t) {
                var n = this._ActorImage
                  , i = n.getDistanceFieldTexture(e);
                e.enableBlending();
                var r = this.stageContext;
                if (r) {
                    var o = r.vertexBuffer
                      , a = r.indexBuffer
                      , s = false;
                    if (this.hasCustomMesh()) {
                        o = this._VertexBuffer,
                        a = this._IndexBuffer;
                        var l = this.node;
                        s = l.weightData && this._WeightBuffer && l.connectedBones.length,
                        this._VertexDeformer && this._VertexDeformer.isEnabled || this.drawContour(e)
                    }
                    if (!this.stage.settings.disableImageContour && i) {
                        var u = this.renderViewTransform
                          , c = 20 * Math.min(1, Math.pow(this.stage.scale, 1.75)) / this.stage.screenScale;
                        s ? e.drawContouredSkin(this.stage.viewTransform, this.renderTransform, o, this._WeightBuffer, a, this.node.boneTransformsArray, c, this._Opacity, this.isSelected ? O : S, i) : e.drawContoured(u, o, a, c, 1, this.isSelected ? O : S, i)
                    } else
                        this.drawAABB(e, 1, this.isSelected ? O : S);
                    n.bitmap || this.drawOBB(e, 1, this.isSelected ? S : _)
                }
            }
        }, {
            key: "drawDeformed",
            get: function() {
                return this._DrawDeformed
            },
            set: function(e) {
                this._DrawDeformed !== e && (this._DrawDeformed = e,
                this.stage.redraw())
            }
        }, {
            key: "actorImage",
            get: function() {
                return this._ActorImage
            }
        }, {
            key: "isSolo",
            get: function() {
                return this._IsSolo
            },
            set: function(e) {
                this._IsSolo != e && (this._IsSolo = e,
                this.updateMesh(),
                this._VertexDeformer && (this._VertexDeformer.isEnabled = this._UseVertexDeform && !this._IsSolo && this.isSelected))
            }
        }]),
        t
    }(a.default),
    h = i.prototype,
    f = "onSelectionFilterChanged",
    p = [o.default],
    y = Object.getOwnPropertyDescriptor(i.prototype, "onSelectionFilterChanged"),
    m = i.prototype,
    v = {},
    Object.keys(y).forEach((function(e) {
        v[e] = y[e]
    }
    )),
    v.enumerable = !!v.enumerable,
    v.configurable = !!v.configurable,
    ("value"in v || v.initializer) && (v.writable = true),
    v = p.slice().reverse().reduce((function(e, t) {
        return t(h, f, e) || e
    }
    ), v),
    m && void 0 !== v.initializer && (v.value = v.initializer ? v.initializer.call(m) : void 0,
    v.initializer = void 0),
    void 0 === v.initializer && (Object.defineProperty(h, f, v),
    v = null),
    i);
    t.default = k,
    k.initializeStageContext = function(e, t, n) {
        var i = [-.5, -.5, 0, 1, .5, -.5, 1, 1, .5, .5, 1, 0, -.5, .5, 0, 0]
          , r = [-.5, -.5, .5, -.5, .5, .5, -.5, .5]
          , o = [0, 1, 2, 2, 3, 0];
        t.vertexBuffer = e.makeVertexBuffer(i),
        t.cVertexBuffer = e.makeVertexBuffer(r),
        t.indexBuffer = e.makeIndexBuffer(o),
        t.points = i,
        t.index = o,
        n.setLayerRenderExtensions(0, {
            mode: k.RenderModes.Regular,
            overrideItems: function(e, t) {
                var n = t.appContext.actor
                  , i = n && n.drawOrder;
                if (i) {
                    for (var r = i.images, o = new Array(r.length), a = 0, s = 0; s < r.length; s++) {
                        var l = r[s].stageItem;
                        l && l.stage && (o[a] = l,
                        a++)
                    }
                    return o.length != a && (o.length = a),
                    o
                }
                var u = e.slice(0);
                return u.sort((function(e, t) {
                    return e = e.node,
                    t = t.node,
                    e.drawOrder === t.drawOrder ? e.treeIndex - t.treeIndex : e.drawOrder - t.drawOrder
                }
                )),
                u
            },
            drawPrep: function(e, t, n) {
                if (this.mode == k.RenderModes.Dim) {
                    if (!this.framebuffer) {
                        this.framebuffer = t.makeFrameBuffer();
                        this.vertexBuffer = t.makeVertexBuffer([0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0]),
                        this.indexBuffer = t.makeIndexBuffer([0, 1, 2, 2, 3, 0]),
                        this.transform = l.mat2d.create()
                    }
                    this.framebuffer.bind()
                }
                return e
            },
            drawCleanup: function(e) {
                e.enableBlending(),
                this.mode == k.RenderModes.Dim && (this.framebuffer.unbind(),
                l.mat2d.fromScaling(this.transform, [e.viewportWidth, e.viewportHeight]),
                e.drawTextured(this.transform, this.vertexBuffer, this.indexBuffer, 1, [.5, .5, .5, .5], this.framebuffer.texture))
            }
        })
    }
    ,
    k.RenderModes = {
        Regular: 1,
        Dim: 2
    }
}
, , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = function(e, t) {
        if (e == t)
            return true;
        if (!e && t || e && !t)
            return false;
        if (e.length !== t.length)
            return false;
        for (var n = 0; n < e.length; n++)
            if (e[n] !== t[n])
                return false;
        return true
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = u(n(0)), a = u(n(1)), s = u(n(4)), l = u(n(3));
    function u(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function c(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var d = (c((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                expanded: true
            },
            n._Preferences = null,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "setPanelGroupContent",
            value: function(e) {
                this.panelGroupContent = e
            }
        }, {
            key: "setPanelGroup",
            value: function(e) {
                this.panelGroup = e
            }
        }, {
            key: "collapseToggle",
            value: function() {
                this.h = this.panelGroupContent.getBoundingClientRect().height;
                var e = !this.state.expanded;
                if (this.panelGroup.style.height)
                    clearTimeout(this.collapseTimeout),
                    this.setState({
                        expanded: e
                    });
                else {
                    this.panelGroup.style.height = this.h + "px";
                    var t = this;
                    clearTimeout(this.collapseTimeout),
                    this.collapseTimeout = setTimeout((function() {
                        t.setState({
                            expanded: e
                        })
                    }
                    ), 1)
                }
                if (this.props._key) {
                    var n = this._Preferences;
                    n[this.props._key] = e,
                    this.context.nima.setCharacterPreference("selection_panel_groups", n)
                }
            }
        }, {
            key: "updateHeight",
            value: function() {
                this.h = this.panelGroupContent.getBoundingClientRect().height,
                this.panelGroup.style.height = this.h + "px"
            }
        }, {
            key: "componentDidUpdate",
            value: function(e, t) {
                e != this.props && t.expanded && this.updateHeight()
            }
        }, {
            key: "componentWillMount",
            value: function() {
                this._Preferences = this.context.nima.getPreference("selection_panel_groups") || {};
                var e = this.props._key;
                if (e && this._Preferences.hasOwnProperty(e)) {
                    var t = Boolean(this._Preferences[e]);
                    this.setState({
                        expanded: t
                    })
                }
            }
        }, {
            key: "componentDidMount",
            value: function() {
                this.state.expanded && this.updateHeight()
            }
        }, {
            key: "render",
            value: function() {
                return o.default.createElement("div", {
                    className: "SelectionPanelGroup",
                    ref: this.setPanelGroup,
                    style: {
                        height: this.state.expanded ? this.h : 11
                    }
                }, o.default.createElement("div", {
                    ref: this.setPanelGroupContent,
                    className: this.props.className
                }, o.default.createElement("div", {
                    className: "SelectionPanelGroupHeader"
                }, o.default.createElement("div", {
                    onMouseDown: this.collapseToggle,
                    className: "HierarchyExpandBtn"
                }, o.default.createElement("svg", {
                    className: "ExpandArrow",
                    style: {
                        transform: this.state.expanded ? null : "rotate(-90deg)",
                        marginTop: this.state.expanded ? "5px" : null
                    }
                }, o.default.createElement("use", {
                    xlinkHref: l.default.make("/images/symbol-defs.svg#icon-arrow")
                }))), o.default.createElement("div", {
                    className: "GroupHeaderTxt"
                }, this.props.label), this.props.action ? this.props.action : null), this.props.children))
            }
        }]),
        t
    }(o.default.Component)).prototype, "setPanelGroupContent", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setPanelGroupContent"), i.prototype),
    c(i.prototype, "setPanelGroup", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setPanelGroup"), i.prototype),
    c(i.prototype, "collapseToggle", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "collapseToggle"), i.prototype),
    i);
    t.default = d,
    d.contextTypes = {
        nima: s.default.object
    }
}
, , , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }, a = p(n(694)), s = p(n(208)), l = p(n(1)), u = n(2), c = p(n(509)), d = p(n(201)), h = p(n(445)), f = p(n(462));
    function p(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var y, m, v, g, _, b, w = (i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.name = "Image",
            n._Asset = null,
            n._DrawOrder = 0,
            n._AnimationDrawOrder = 0,
            n._KeyStateDrawOrder = 0,
            n._KeyStateDeform = 0,
            n._Width = 0,
            n._Height = 0,
            n._BlendMode = t.BlendModes.Normal,
            n._MeshData = null,
            n._WeightData = null,
            n._NumVertices = 4,
            n._WeightDataDelta = 0,
            n._WeightDataUndoDelta = 0,
            n._VertexDeformDataDelta = 0,
            n._VertexDeformDataUndoDelta = 0,
            n._UseCustomMesh = false,
            n._UseVertexDeform = false,
            n._ConnectedBones = [],
            n._ShowBoneColorIndex = null,
            n._ColorMapOpacity = 1,
            n._BoneColorsArray = null,
            n._BoneTransformsArray = null,
            n._LoToHiIndex = null,
            n._IsDeformDirty = false,
            n._IsVertexDeformMeshDirty = false,
            n._IsVertexDeformDirty = false,
            n._DeformedLoVerts = null,
            n._HaveNewLoVerts = false,
            n._Sequence = 0,
            n._AnimationSequence = 0,
            n._KeyStateSequence = 0,
            n._HasFrameSequence = false,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "read",
            value: function(e, n) {
                o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "read", this).call(this, e, n);
                var i = n.asset;
                void 0 !== i && this.setAsset(e.getAsset(i));
                var r = n.drawOrder;
                void 0 !== r && (this._DrawOrder = r);
                var a = n.sequence;
                void 0 !== a && (this._Sequence = a);
                var s = n.width;
                void 0 !== s && (this._Width = s);
                var l = n.height;
                void 0 !== l && (this._Height = l);
                var c = n.blendMode;
                void 0 !== c && (this._BlendMode = t.BlendModes[c] || t.BlendModes.Normal);
                var d = n.connectedBones;
                if (d) {
                    var h = n.overrideWorldTransform;
                    if (!h) {
                        var p = n.overrideParentWorld;
                        p && (h = u.mat2d.mul(u.mat2d.create(), p, this.transform))
                    }
                    var y = this;
                    e.whenNodesLoaded((function() {
                        for (var t = 0; t < d.length; t++) {
                            var n = d[t];
                            if (n.constructor === Object) {
                                var i = e.getNodeWithRefId(n.id);
                                i ? i instanceof f.default ? (y._ConnectedBones.push({
                                    node: i,
                                    length: n.length || i.length,
                                    bind: new Float32Array(n.bind),
                                    ibind: u.mat2d.invert(u.mat2d.create(), n.bind)
                                }),
                                -1 === i.skins.indexOf(y) && i.skins.push(y)) : console.log("NON BONE IN BONE LIST?") : console.log("NO NODE WITH REFID WHILE LOOKING FOR BONE", n)
                            }
                        }
                        h && y._ConnectedBones.length && (y.overrideWorldTransform = new Float32Array(h),
                        y._IsDeformDirty = true)
                    }
                    ))
                }
                this._UseCustomMesh = true === n.useCustomMesh,
                this._UseVertexDeform = true === n.useVertexDeform;
                var m = n.mesh;
                if (void 0 !== m) {
                    var v = m.editor;
                    this._MeshData = {
                        editor: {
                            c: new Float32Array(v.c),
                            cc: v.cc,
                            ie: new Uint16Array(v.ie),
                            cl: v.cl,
                            a: v.a
                        },
                        verts: new Float32Array(m.verts),
                        tris: new Uint16Array(m.tris),
                        loverts: new Float32Array(m.loverts),
                        lotris: new Uint16Array(m.lotris)
                    };
                    var g = this._MeshData.verts.length / 4;
                    if (this._NumVertices = g,
                    m.deform) {
                        this._IsVertexDeformDirty = true,
                        this._IsVertexDeformMeshDirty = true;
                        var _ = new Float32Array(m.deform);
                        if (m.deform.length === this._MeshData.verts.length)
                            for (var b = this._MeshData.verts, w = _, O = b.length / 4, S = 0, k = 0; k < O; k++)
                                w[S + 2] = b[S + 2],
                                w[S + 3] = b[S + 3],
                                S += 4;
                        else if (m.deform.length == this._MeshData.verts.length / 2) {
                            for (var P = this._MeshData.verts, E = new Float32Array(this._MeshData.verts.length), T = P.length / 4, C = 0, x = 0, I = 0; I < T; I++)
                                E[C + 0] = _[x++],
                                E[C + 1] = _[x++],
                                E[C + 2] = P[C + 2],
                                E[C + 3] = P[C + 3],
                                C += 4;
                            _ = E
                        } else
                            console.log("Unknown length of deform data."),
                            _ = null;
                        _ && (this._MeshData.deform = {
                            verts: _
                        })
                    } else
                        this._UseVertexDeform && (console.log("WAS MISSING DEFORM, USING ORIGINAL MESH", this.name),
                        this._MeshData.deform = {
                            verts: new Float32Array(this._MeshData.verts)
                        });
                    this.buildLoFiIndex()
                }
                var D = n.weightData;
                D && (this._WeightData = new Float32Array(D))
            }
        }, {
            key: "serializeProperties",
            value: function(e) {
                var n = o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeProperties", this).call(this, e);
                if (this._MeshData) {
                    var i = this._MeshData.editor
                      , r = {
                        editor: {
                            c: Array.prototype.slice.call(i.c),
                            cc: i.cc,
                            ie: Array.prototype.slice.call(i.ie),
                            cl: i.cl,
                            a: i.a
                        }
                    };
                    if (e || (r.verts = Array.prototype.slice.call(this._MeshData.verts),
                    r.tris = Array.prototype.slice.call(this._MeshData.tris),
                    r.loverts = Array.prototype.slice.call(this._MeshData.loverts),
                    r.lotris = Array.prototype.slice.call(this._MeshData.lotris)),
                    this._MeshData.deform)
                        if (e)
                            r.deform = this._VertexDeformDataDelta;
                        else {
                            for (var a = new Array(this._MeshData.deform.verts.length / 2), s = 0, l = 0, u = this._MeshData.deform.verts, c = this._MeshData.deform.verts.length / 4, d = 0; d < c; d++)
                                a[s++] = u[l],
                                a[s++] = u[l + 1],
                                l += 4;
                            r.deform = a
                        }
                    n.mesh = r
                }
                if (delete n.connectedBones,
                this._ConnectedBones.length) {
                    for (var h = [], f = 0; f < this._ConnectedBones.length; f++) {
                        var p = this._ConnectedBones[f];
                        h.push({
                            id: p.node.refId,
                            bind: Array.prototype.slice.call(p.bind),
                            length: p.length
                        })
                    }
                    n.connectedBones = h
                }
                return n.blendMode = t.BlendModeLookup[this._BlendMode],
                delete n.weightDataInteractive,
                this._WeightData && (n.weightData = e ? this._WeightDataDelta : Array.prototype.slice.call(this._WeightData)),
                delete n.deformDataInteractive,
                this._Asset && this._Asset.id ? n.asset = this._Asset.id : delete n.asset,
                n
            }
        }, {
            key: "serializeInteractive",
            value: function() {
                var e = o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeInteractive", this).call(this);
                this.hasWorldTransformOverride ? e.overrideWorldTransform = this.worldTransform : e.overrideWorldTransform = null,
                e.drawOrder = this._DrawOrder,
                e.sequence = this._Sequence,
                e.useCustomMesh = this._UseCustomMesh,
                e.useVertexDeform = this._UseVertexDeform,
                e.asset = this._Asset,
                e.width = this._Width,
                e.height = this._Height,
                e.blendMode = this._BlendMode,
                e.connectedBones = this._ConnectedBones.slice(0),
                e.weightDataInteractive = new a.default(this._WeightDataUndoDelta,this._WeightData);
                var n = new a.default(this._VertexDeformDataUndoDelta,this._MeshData && this._MeshData.deform && this._MeshData.deform.verts);
                return n.ref = this._MeshData && this._MeshData.deform,
                e.deformDataInteractive = n,
                e
            }
        }, {
            key: "nullFrame",
            value: function() {
                var e = o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "nullFrame", this).call(this);
                return e.frameDrawOrder = null,
                e.sequence = null,
                e
            }
        }, {
            key: "onSetStageItem",
            value: function(e) {
                o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "onSetStageItem", this).call(this, e),
                this.stageItem.onUseVertexDeformChange(this._UseVertexDeform)
            }
        }, {
            key: "onUseAnimationValuesChange",
            value: function(e) {
                this._MeshData && this._MeshData.deform && this._MeshData.deform.verts && (this._MeshData.deform.animatedVerts && this._MeshData.deform.animatedVerts.length == this._MeshData.deform.verts.length || (this._MeshData.deform.animatedVerts = new Float32Array(this._MeshData.deform.verts)),
                this._IsVertexDeformMeshDirty = true,
                this._IsVertexDeformDirty = true)
            }
        }, {
            key: "repositionImportedAsset",
            value: function(e, t) {
                var n = void 0 === e.left || void 0 === t.left ? 0 : t.left - e.left
                  , i = void 0 === e.top || void 0 === t.top ? 0 : t.top - e.top;
                t.width,
                e.width,
                t.height,
                e.height;
                if (this._UseCustomMesh) {
                    for (var r = this._MeshData, o = r.verts.length / 4, a = 0, s = t.width / 2, l = t.height / 2, c = 0; c < o; c++) {
                        var d = r.verts[a] -= n
                          , h = r.verts[a + 1] -= i;
                        r.verts[a + 2] = (d + s) / t.width,
                        r.verts[a + 3] = 1 - (h + l) / t.height,
                        a += 4
                    }
                    o = r.loverts.length / 2,
                    a = 0;
                    for (var f = 0; f < o; f++)
                        r.loverts[a] -= n,
                        r.loverts[a + 1] -= i,
                        a += 2;
                    o = r.editor.c.length / 2,
                    a = 0;
                    for (var p = 0; p < o; p++)
                        r.editor.c[a] -= n,
                        r.editor.c[a + 1] -= i,
                        a += 2;
                    if (r.deform) {
                        o = r.deform.verts.length / 4,
                        a = 0;
                        for (var y = 0; y < o; y++) {
                            r.deform.verts[a] -= n,
                            r.deform.verts[a + 1] -= i;
                            r.deform.verts[a + 2] = r.verts[a + 2],
                            r.deform.verts[a + 3] = r.verts[a + 3],
                            a += 4
                        }
                        if (r.deform.animatedVerts) {
                            o = r.deform.animatedVerts.length / 4,
                            a = 0;
                            for (var m = 0; m < o; m++) {
                                r.deform.animatedVerts[a] -= n,
                                r.deform.animatedVerts[a + 1] -= i;
                                r.deform.animatedVerts[a + 2] = r.verts[a + 2],
                                r.deform.animatedVerts[a + 3] = r.verts[a + 3],
                                a += 4
                            }
                        }
                        for (var v = this.actor.animations, g = 0; g < v.length; g++) {
                            var _ = v[g].getKeyedNode(this);
                            if (_) {
                                var b = _.props.frameVertices;
                                if (b)
                                    for (var w = b.keyFrames, O = 0; O < w.length; O++) {
                                        var S = w[O].value;
                                        o = S.length / 2,
                                        a = 0;
                                        for (var k = 0; k < o; k++)
                                            S[a] -= n,
                                            S[a + 1] -= i,
                                            a += 2
                                    }
                            }
                        }
                        this._IsVertexDeformDirty = true
                    }
                    this.stageItem && this.stageItem.updateMesh()
                }
                if (!this.actor.isTimeTraveling) {
                    var P = u.mat2d.fromRotation(u.mat2d.create(), this.rotation);
                    u.mat2d.scale(P, P, this.scale);
                    var E = [n, i];
                    if (u.vec2.transformMat2d(E, E, P),
                    this.isConnectedToBones) {
                        var T = this.worldTransform
                          , C = u.mat2d.clone(T)
                          , x = u.mat2d.fromTranslation(u.mat2d.create(), E);
                        this.overrideWorldTransform = u.mat2d.mul(u.mat2d.create(), x, T),
                        this.compensateConnectedBones(C),
                        this.overrideWorldTransform = C
                    }
                    this.translation = u.vec2.add(u.vec2.create(), this.translation, E)
                }
                this._Width = t.width,
                this._Height = t.height
            }
        }, {
            key: "filteringChanged",
            value: function() {
                this.dispatch("assetChanged", this._Asset),
                this.forceRedraw()
            }
        }, {
            key: "clearKeyStates",
            value: function() {
                o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "clearKeyStates", this).call(this),
                this.frameVerticesKS = 0,
                this.frameSequenceKS = 0
            }
        }, {
            key: "getTexture",
            value: function(e) {
                return this._HasFrameSequence ? this._Asset && this._Asset.getTexture(e, this.useAnimationValues ? this._AnimationSequence : this._Sequence) : this._Asset && this._Asset.getTexture(e)
            }
        }, {
            key: "getDistanceFieldTexture",
            value: function(e) {
                return this._HasFrameSequence ? this._Asset && this._Asset.getDistanceFieldTexture(e, this.useAnimationValues ? this._AnimationSequence : this._Sequence) : this._Asset && this._Asset.getDistanceFieldTexture(e)
            }
        }, {
            key: "setAsset",
            value: function(e) {
                this._Asset && this._Asset.removeEventListener("filteringChange", this.filteringChanged),
                this._Asset = e,
                this._HasFrameSequence = e instanceof h.default,
                this._Asset && this._Asset.addEventListener("filteringChange", this.filteringChanged)
            }
        }, {
            key: "updateWeightData",
            value: function() {
                this._WeightDataDelta++,
                this._WeightDataUndoDelta++,
                this.dispatch("weightDataChanged")
            }
        }, {
            key: "findConnectedBone",
            value: function(e) {
                for (var t = 0; t < this._ConnectedBones.length; t++)
                    if (this._ConnectedBones[t].node == e)
                        return t;
                return -1
            }
        }, {
            key: "updateBoneArrays",
            value: function() {
                var e = this._ConnectedBones.length + 1;
                this._BoneColorsArray && this._BoneColorsArray.length == 4 * e || (this._BoneColorsArray = new Float32Array(4 * e)),
                this._BoneTransformsArray && this._BoneTransformsArray.length == 6 * e || (this._BoneTransformsArray = new Float32Array(6 * e));
                var t = this._BoneTransformsArray;
                t[0] = 1,
                t[1] = 0,
                t[2] = 0,
                t[3] = 1,
                t[4] = 0,
                t[5] = 0;
                var n = d.default.Colors
                  , i = 0
                  , r = this._BoneColorsArray;
                if (r[i++] = 0,
                r[i++] = 0,
                r[i++] = 0,
                r[i++] = 1,
                null === this._ShowBoneColorIndex)
                    for (var o = 0; o < this._ConnectedBones.length; o++) {
                        var a = n[o % n.length];
                        r[i++] = a[0],
                        r[i++] = a[1],
                        r[i++] = a[2],
                        r[i++] = a[3]
                    }
                else
                    for (var s = 0; s < this._ConnectedBones.length; s++) {
                        var l = n[this._ShowBoneColorIndex % n.length];
                        r[i++] = l[0],
                        r[i++] = l[1],
                        r[i++] = l[2],
                        r[i++] = this._ShowBoneColorIndex === s ? l[3] : 0
                    }
            }
        }, {
            key: "connectBone",
            value: function(e, t) {
                return !!(e && e instanceof f.default) && (-1 === this.findConnectedBone(e) && (0 == this._ConnectedBones.length && (this.overrideWorldTransform = this.worldTransform,
                this.setFullWeightToIndex(0)),
                this._ConnectedBones.push({
                    node: e,
                    length: e.length,
                    bind: u.mat2d.clone(e.worldTransform),
                    ibind: u.mat2d.invert(u.mat2d.create(), e.worldTransform)
                }),
                -1 === e.skins.indexOf(this) && e.skins.push(this),
                e.stageItem && e.stageItem.updateConnectionState(),
                t || this.dispatch("connectedBoneChange"),
                this.forceRedraw(),
                this.updateBoneArrays(),
                true))
            }
        }, {
            key: "disconnectBone",
            value: function(e, t) {
                var n = this.findConnectedBone(e);
                if (-1 !== n) {
                    var i = e.skins.indexOf(this);
                    -1 !== i && e.skins.splice(i, 1),
                    this.dispatch("boneDisconnected", e),
                    this._ConnectedBones.splice(n, 1),
                    this.removeWeightedBoneIndex(n),
                    0 === this._ConnectedBones.length && (this.overrideWorldTransform = null,
                    this.compensate(),
                    this._DeformedLoVerts = null,
                    this.stageItem && this.stageItem.updateMesh()),
                    e.stageItem && e.stageItem.updateConnectionState(),
                    t || this.dispatch("connectedBoneChange"),
                    this.forceRedraw()
                }
                this.updateBoneArrays()
            }
        }, {
            key: "compensateConnectedBones",
            value: function(e) {
                if (this.hasWorldTransformOverride) {
                    var t = this.calculateWorldTransform()
                      , n = u.mat2d.invert(u.mat2d.create(), t)
                      , i = u.mat2d.mul(u.mat2d.create(), e, n);
                    if (this._ConnectedBones.length)
                        for (var r = 0; r < this._ConnectedBones.length; r++) {
                            var o = this._ConnectedBones[r]
                              , a = o.node.worldTransform
                              , s = u.mat2d.mul(u.mat2d.create(), i, a)
                              , l = u.mat2d.invert(u.mat2d.create(), s)
                              , c = u.mat2d.mul(u.mat2d.create(), a, o.ibind)
                              , d = u.mat2d.mul(u.mat2d.create(), l, c)
                              , h = u.mat2d.invert(u.mat2d.create(), d);
                            this._ConnectedBones[r] = {
                                node: o.node,
                                bind: h,
                                ibind: d
                            }
                        }
                    this.markDeformDirty()
                }
            }
        }, {
            key: "copyBind",
            value: function() {
                if (!this._ConnectedBones.length)
                    return null;
                var e = new Map
                  , t = true
                  , n = false
                  , i = void 0;
                try {
                    for (var r, o = this._ConnectedBones[Symbol.iterator](); !(t = (r = o.next()).done); t = true) {
                        var a = r.value;
                        e.set(a.node, {
                            bind: a.bind,
                            ibind: a.ibind
                        })
                    }
                } catch (e) {
                    n = true,
                    i = e
                } finally {
                    try {
                        !t && o.return && o.return()
                    } finally {
                        if (n)
                            throw i
                    }
                }
                return e
            }
        }, {
            key: "setBind",
            value: function(e) {
                if (this._ConnectedBones.length) {
                    new Map;
                    var t = true
                      , n = false
                      , i = void 0;
                    try {
                        for (var r, o = this._ConnectedBones[Symbol.iterator](); !(t = (r = o.next()).done); t = true) {
                            var a = r.value
                              , s = e.get(a.node);
                            s && (a.bind = s.bind,
                            a.ibind = s.ibind)
                        }
                    } catch (e) {
                        n = true,
                        i = e
                    } finally {
                        try {
                            !t && o.return && o.return()
                        } finally {
                            if (n)
                                throw i
                        }
                    }
                    this.markDeformDirty()
                }
            }
        }, {
            key: "buildLoFiIndex",
            value: function() {
                var e = this;
                c.default.call("buildLoToHiIndex", [this._MeshData.verts, this._MeshData.loverts], (function(t) {
                    e._LoToHiIndex = t
                }
                ))
            }
        }, {
            key: "markDeformDirty",
            value: function() {
                this._IsDeformDirty = true,
                this._IsVertexDeformDirty = true
            }
        }, {
            key: "markVertexDeformMeshDirty",
            value: function() {
                this.useAnimationValues && this.dispatch("animateVertexDeform", this.frameVertices),
                this._IsVertexDeformMeshDirty = true,
                this._IsVertexDeformDirty = true,
                this._VertexDeformDataDelta++,
                this._VertexDeformDataUndoDelta++
            }
        }, {
            key: "markVertexDeformMeshClean",
            value: function() {
                this._IsVertexDeformMeshDirty = false
            }
        }, {
            key: "markVertexDeformClean",
            value: function() {
                this._IsVertexDeformDirty = false
            }
        }, {
            key: "computeWorldVertices",
            value: function() {
                return this.deform(this.worldTransform, u.mat2d.invert(u.mat2d.create(), this.worldTransform), this._MeshData.verts, this._WeightData, this.boneTransformsArray)
            }
        }, {
            key: "deform",
            value: function(e, t, n, i, r) {
                for (var o = n.length / 4, a = new Float32Array(2 * o), s = 0, l = 0, u = 0, c = 0; c < o; c++) {
                    var d = n[s]
                      , h = n[s + 1];
                    s += 4;
                    for (var f = e[0] * d + e[2] * h + e[4], p = e[1] * d + e[3] * h + e[5], y = new Float32Array(6), m = 0; m < 4; m++)
                        for (var v = i[u + m], g = i[u + m + 4], _ = 6 * v, b = 0; b < 6; b++)
                            y[b] += r[_ + b] * g;
                    u += 8,
                    d = y[0] * f + y[2] * p + y[4],
                    h = y[1] * f + y[3] * p + y[5],
                    a[l++] = d,
                    a[l++] = h
                }
                return a
            }
        }, {
            key: "deformLo",
            value: function(e, t, n, i, r, o) {
                for (var a = n.length / 2, s = new Float32Array(2 * a), l = 0, u = 0, c = 0; c < a; c++) {
                    for (var d = n[l++], h = n[l++], f = e[0] * d + e[2] * h + e[4], p = e[1] * d + e[3] * h + e[5], y = new Float32Array(6), m = 0; m < 4; m++)
                        for (var v = 8 * r[c], g = i[v + m], _ = i[v + m + 4], b = 6 * g, w = 0; w < 6; w++)
                            y[w] += o[b + w] * _;
                    d = y[0] * f + y[2] * p + y[4],
                    h = y[1] * f + y[3] * p + y[5],
                    s[u++] = t[0] * d + t[2] * h + t[4],
                    s[u++] = t[1] * d + t[3] * h + t[5]
                }
                return s
            }
        }, {
            key: "getCentroidTransform",
            value: function() {
                var e = this.worldTransform
                  , t = 0
                  , n = 0;
                if (this._DeformedLoVerts) {
                    this.updateDeform(true);
                    for (var i = this._DeformedLoVerts.length / 2, r = 0, o = 0, a = 0, s = 0; s < i; s++)
                        o += this._DeformedLoVerts[r++],
                        a += this._DeformedLoVerts[r++];
                    o /= i,
                    a /= i,
                    t = e[0] * o + e[2] * a + e[4],
                    n = e[1] * o + e[3] * a + e[5]
                } else if (this.useCustomMesh && this._MeshData && this._MeshData.loverts && this._MeshData.loverts.length) {
                    for (var l = this._MeshData, c = l.loverts, d = l.loverts.length / 2, h = 0, f = 0; f < d; f++) {
                        var p = c[h++]
                          , y = c[h++];
                        t += e[0] * p + e[2] * y + e[4],
                        n += e[1] * p + e[3] * y + e[5]
                    }
                    t /= d,
                    n /= d
                } else
                    t = e[4],
                    n = e[5];
                var m = u.mat2d.create();
                return m[4] = t,
                m[5] = n,
                m
            }
        }, {
            key: "updateDeform",
            value: function(e, t) {
                if (this._IsVertexDeformDirty && this._LoToHiIndex && this._MeshData.deform) {
                    this._IsVertexDeformDirty = false,
                    this._DeformedLoVerts = new Float32Array(this._MeshData.loverts.length);
                    var n = this._MeshData.loverts.length / 2
                      , i = 0
                      , r = this._MeshData.deform.verts;
                    this.useAnimationValues && this._MeshData.deform.animatedVerts && (r = this._MeshData.deform.animatedVerts);
                    for (var o = 0; o < n; o++) {
                        var a = 4 * this._LoToHiIndex[o];
                        this._DeformedLoVerts[i] = r[a],
                        this._DeformedLoVerts[i + 1] = r[a + 1],
                        i += 2
                    }
                    this._HaveNewLoVerts = true
                }
                if (this._IsDeformDirty && this._LoToHiIndex && (this._IsDeformDirty = false,
                this._ConnectedBones.length))
                    if (e)
                        this._DeformedLoVerts = this.deformLo(this.worldTransform, u.mat2d.invert(u.mat2d.create(), this.worldTransform), this._MeshData.loverts, this._WeightData, this._LoToHiIndex, this.boneTransformsArray),
                        this._HaveNewLoVerts = true;
                    else {
                        var s = this;
                        c.default.call("deformLo", [this.worldTransform, u.mat2d.invert(u.mat2d.create(), this.worldTransform), this._MeshData.loverts, this._WeightData, this._LoToHiIndex, this.boneTransformsArray], (function(e) {
                            s._DeformedLoVerts = e,
                            s._HaveNewLoVerts = true,
                            s.forceRedraw()
                        }
                        ))
                    }
                return t && this._HaveNewLoVerts ? (this._HaveNewLoVerts = false,
                this._DeformedLoVerts) : null
            }
        }, {
            key: "normalizeVertexWeight",
            value: function(e) {
                for (var t = 8 * e, n = 0, i = this._WeightData, r = 0; r < 4; r++)
                    0 != i[t + r] ? n += i[t + r + 4] : i[t + r + 4] = 0;
                if (1 == n)
                    return false;
                if (0 == n)
                    return i[t] = 1,
                    i[t + 1] = 0,
                    i[t + 2] = 0,
                    i[t + 3] = 0,
                    i[t + 4] = 1,
                    i[t + 5] = 0,
                    i[t + 6] = 0,
                    i[t + 7] = 0,
                    true;
                var o = 1 / n;
                return i[t + 4] *= o,
                i[t + 5] *= o,
                i[t + 6] *= o,
                i[t + 7] *= o,
                0 === i[t + 4] && (i[t] = 0),
                0 === i[t + 5] && (i[t + 1] = 0),
                0 === i[t + 6] && (i[t + 2] = 0),
                0 === i[t + 7] && (i[t + 3] = 0),
                true
            }
        }, {
            key: "heaviestVertexWeight",
            value: function(e) {
                for (var t = 8 * e, n = 0, i = 0, r = this._WeightData, o = 0; o < 4; o++) {
                    var a = r[t + o + 4];
                    a > n && (n = a,
                    i = r[t + o])
                }
                return {
                    w: n,
                    i: i
                }
            }
        }, {
            key: "addVertexBoneWeight",
            value: function(e, t, n) {
                for (var i = 8 * e, r = 1e3, o = 0, a = false, s = this._WeightData, l = 0; l < 4; l++) {
                    if (s[i + l] == t) {
                        var u = Math.max(0, s[i + l + 4] + n);
                        s[i + l + 4] = u,
                        a = true;
                        break
                    }
                    var c = s[i + l + 4];
                    c < r && (r = c,
                    o = l)
                }
                a || (s[i + o] = t,
                s[i + o + 4] = Math.max(0, n)),
                this.normalizeVertexWeight(e)
            }
        }, {
            key: "removeWeightedBoneIndex",
            value: function(e) {
                for (var t = false, n = 0, i = e + 1, r = this._WeightData, o = 0; o < this._NumVertices; o++) {
                    for (var a = 0; a < 4; a++) {
                        var s = r[n + a];
                        s === i ? (r[n + a] = 0,
                        this.normalizeVertexWeight(o),
                        t = true) : s > i && (r[n + a] = s - 1)
                    }
                    n += 8
                }
                t && (this._WeightDataDelta++,
                this._WeightDataUndoDelta++,
                this._IsDeformDirty = true,
                this._IsVertexDeformDirty = true)
            }
        }, {
            key: "setFullWeightToIndex",
            value: function(e) {
                for (var t = 0, n = e + 1, i = this._WeightData, r = 0; r < this._NumVertices; r++)
                    i[t++] = n,
                    i[t++] = 0,
                    i[t++] = 0,
                    i[t++] = 0,
                    i[t++] = 1,
                    i[t++] = 0,
                    i[t++] = 0,
                    i[t++] = 0;
                this._WeightDataDelta++,
                this._WeightDataUndoDelta++,
                this._IsDeformDirty = true,
                this._IsVertexDeformDirty = true
            }
        }, {
            key: "paintWeight",
            value: function(e, t, n, i, r, o) {
                for (var a = e[0], s = e[1], l = n - t, u = this._MeshData.verts, c = u.length / 4, d = 0, h = 0; h < c; h++) {
                    var f = u[d] - a
                      , p = u[d + 1] - s
                      , y = Math.sqrt(f * f + p * p);
                    if (y > n)
                        d += 4;
                    else {
                        var m = void 0;
                        if (y <= t)
                            m = i;
                        else {
                            var v = (y - t) / l;
                            m = i * (1 - v) + r * v
                        }
                        this.addVertexBoneWeight(h, o, m),
                        d += 4
                    }
                }
                this._WeightDataDelta++,
                this._WeightDataUndoDelta++
            }
        }, {
            key: "uiHierIconClass",
            get: function() {
                return this.asset && this.asset.isMissing ? "HierarchyMissingImageIcon" : "HierarchyImageIcon"
            }
        }, {
            key: "uiSelectionIconClass",
            get: function() {
                return "SelectionImageIcon"
            }
        }, {
            key: "typeName",
            get: function() {
                return "Image"
            }
        }, {
            key: "uiIcon",
            get: function() {
                return this.asset && this.asset.isMissing ? "icon-missing" : "icon-picture"
            }
        }, {
            key: "bitmap",
            get: function() {
                return this._Asset && this._Asset.bitmap || null
            }
        }, {
            key: "vertexBufferData",
            get: function() {
                return this._MeshData ? this._MeshData.deform && this._MeshData.deform.verts ? this.useAnimationValues ? (this._MeshData.deform.animatedVerts || (this._MeshData.deform.animatedVerts = new Float32Array(this._MeshData.deform.verts)),
                this._MeshData.deform.animatedVerts) : this._MeshData.deform.verts : this._MeshData.verts : null
            }
        }, {
            key: "asset",
            get: function() {
                return this._Asset
            },
            set: function(e) {
                if (!e || e.constructor !== String && e.constructor !== Number || (e = this.actor.getAsset(e)),
                this._Asset != e) {
                    var t = this._Asset
                      , n = e;
                    t && !t.isMissing && n && this.repositionImportedAsset(t, n),
                    this.setAsset(n),
                    this.dispatch("assetChanged", e),
                    this.forceRedraw()
                }
            }
        }, {
            key: "rigSequence",
            get: function() {
                return this._Sequence
            },
            set: function(e) {
                this._Sequence = e
            }
        }, {
            key: "rigDrawOrder",
            get: function() {
                return this._DrawOrder
            },
            set: function(e) {
                this._DrawOrder = e
            }
        }, {
            key: "rigVertices",
            get: function() {
                for (var e = this._MeshData.deform.verts, t = e.length / 4, n = new Float32Array(2 * t), i = 0, r = 0, o = 0; o < t; o++)
                    n[r++] = e[i],
                    n[r++] = e[i + 1],
                    i += 4;
                return n
            }
        }, {
            key: "frameVertices",
            get: function() {
                for (var e = this._MeshData.deform.animatedVerts, t = e.length / 4, n = new Float32Array(2 * t), i = 0, r = 0, o = 0; o < t; o++)
                    n[r++] = e[i],
                    n[r++] = e[i + 1],
                    i += 4;
                return n
            },
            set: function(e) {
                if (e) {
                    var t = this._MeshData.deform.animatedVerts
                      , n = e.length / 2;
                    if (e.length == t.length / 2)
                        for (var i = 0, r = 0, o = 0; o < n; o++)
                            t[r] = e[i++],
                            t[r + 1] = e[i++],
                            r += 4;
                    this._IsVertexDeformMeshDirty = true,
                    this._IsVertexDeformDirty = true,
                    this.useAnimationValues && this.forceRedraw()
                } else
                    this._MeshData.deform.animatedVerts = new Float32Array(this._MeshData.deform.verts)
            }
        }, {
            key: "frameVerticesKS",
            get: function() {
                return this._KeyStateDeform
            },
            set: function(e) {
                this._KeyStateDeform != e && (this._KeyStateDeform = e,
                this.markKeyStateDirty())
            }
        }, {
            key: "hierarchySortOrder",
            get: function() {
                return this.drawOrder
            },
            set: function(e) {
                this.drawOrder = e
            }
        }, {
            key: "sequence",
            get: function() {
                return this.useAnimationValues ? this._AnimationSequence : this._Sequence
            },
            set: function(e) {
                if (this.useAnimationValues) {
                    if (e != this._AnimationSequence) {
                        var t = this._AnimationSequence;
                        this.frameSequence = e,
                        this.dispatch("animateSequence", {
                            from: t,
                            to: e
                        }),
                        this.dispatch("sequenceChange")
                    }
                } else
                    this._Sequence != e && (this.dispatch("sequenceChange"),
                    this._Sequence = e,
                    this.forceRedraw())
            }
        }, {
            key: "frameSequence",
            get: function() {
                return this._AnimationSequence
            },
            set: function(e) {
                this._AnimationSequence != e && (this._AnimationSequence = e,
                this.dispatch("sequenceChange"),
                this.forceRedraw())
            }
        }, {
            key: "frameSequenceKS",
            get: function() {
                return this._KeyStateSequence
            },
            set: function(e) {
                this._KeyStateSequence != e && (this._KeyStateSequence = e,
                this.markKeyStateDirty())
            }
        }, {
            key: "drawOrder",
            get: function() {
                return this.useAnimationValues ? this._AnimationDrawOrder : this._DrawOrder
            },
            set: function(e) {
                if (this.useAnimationValues) {
                    if (e != this._AnimationDrawOrder) {
                        var t = this._AnimationDrawOrder;
                        this.frameDrawOrder = e,
                        this.dispatch("animateDrawOrder", {
                            from: t,
                            to: e
                        }),
                        this.dispatch("drawOrderChange")
                    }
                } else
                    this._DrawOrder != e && (this.dispatch("drawOrderChange"),
                    this._DrawOrder = e,
                    this.forceRedraw())
            }
        }, {
            key: "frameDrawOrder",
            get: function() {
                return this._AnimationDrawOrder
            },
            set: function(e) {
                this._AnimationDrawOrder != e && (this._AnimationDrawOrder = e,
                this.dispatch("drawOrderChange"))
            }
        }, {
            key: "isSequence",
            get: function() {
                return this._HasFrameSequence
            }
        }, {
            key: "width",
            get: function() {
                return this._Width
            },
            set: function(e) {
                this._Width = e
            }
        }, {
            key: "height",
            get: function() {
                return this._Height
            },
            set: function(e) {
                this._Height = e
            }
        }, {
            key: "blendMode",
            get: function() {
                return this._BlendMode
            },
            set: function(e) {
                this._BlendMode = e,
                this.forceRedraw()
            }
        }, {
            key: "isConnectedToBones",
            get: function() {
                return this._ConnectedBones && this._ConnectedBones.length
            }
        }, {
            key: "connectedBones",
            get: function() {
                return this._ConnectedBones
            },
            set: function(e) {
                var t = this._ConnectedBones;
                this._ConnectedBones = e,
                this.dispatch("connectedBoneChange"),
                this.forceRedraw(),
                this.markDeformDirty(),
                this.updateBoneArrays(),
                setTimeout((function() {
                    var n = true
                      , i = false
                      , r = void 0;
                    try {
                        for (var o, a = t[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                            (h = o.value.node).stageItem && h.stageItem.updateConnectionState()
                        }
                    } catch (e) {
                        i = true,
                        r = e
                    } finally {
                        try {
                            !n && a.return && a.return()
                        } finally {
                            if (i)
                                throw r
                        }
                    }
                    var s = true
                      , l = false
                      , u = void 0;
                    try {
                        for (var c, d = e[Symbol.iterator](); !(s = (c = d.next()).done); s = true) {
                            var h;
                            (h = c.value.node).stageItem && h.stageItem.updateConnectionState()
                        }
                    } catch (e) {
                        l = true,
                        u = e
                    } finally {
                        try {
                            !s && d.return && d.return()
                        } finally {
                            if (l)
                                throw u
                        }
                    }
                }
                ), 0)
            }
        }, {
            key: "meshData",
            get: function() {
                return this._MeshData
            },
            set: function(e) {
                this._MeshData = e,
                this.actor.removeAnimatedProperty(this, "frameVertices");
                var t = e.verts.length / 4;
                this._NumVertices = t;
                var n = 8 * t;
                this._WeightData && this._WeightData.length == n || (this.weightData = new Float32Array(n),
                this._ConnectedBones.length && this.setFullWeightToIndex(0)),
                this.buildLoFiIndex(),
                this.actor.revise(),
                this.stageItem && this.stageItem.updateMesh()
            }
        }, {
            key: "isVertexDeformDirty",
            get: function() {
                return this._IsVertexDeformDirty
            }
        }, {
            key: "isVertexDeformMeshDirty",
            get: function() {
                return this._IsVertexDeformMeshDirty
            }
        }, {
            key: "deformDataInteractive",
            set: function(e) {
                if (e && (this._VertexDeformDataUndoDelta = e.id),
                this._MeshData)
                    if (e && e.data || !this._MeshData) {
                        if (e.data.length == this._MeshData.verts.length) {
                            if (e.ref !== this._MeshData.deform)
                                return;
                            this._MeshData.deform.verts = new Float32Array(e.data),
                            this._IsVertexDeformDirty = true,
                            this._IsVertexDeformMeshDirty = true,
                            this._VertexDeformDataDelta++,
                            this.actor.revise(),
                            this.forceRedraw()
                        }
                    } else
                        delete this._MeshData.deform
            }
        }, {
            key: "weightDataInteractive",
            set: function(e) {
                if (this._MeshData && e && e.data) {
                    var t = e.data
                      , n = t
                      , i = t.length / 8;
                    i != this._MeshData.verts.length / 4 && (console.log("Attempting to undo/redo to weights that don't match."),
                    n = this._WeightData);
                    for (var r = 0, o = this._ConnectedBones.length, a = 0; a < i; a++) {
                        for (var s = 0; s < 4; s++)
                            n[r + s] > o && (n[r + s] = 0);
                        r += 8
                    }
                    this._WeightData = n,
                    this._WeightDataDelta++,
                    this._IsDeformDirty = true,
                    this._IsVertexDeformDirty = true,
                    this.actor.revise()
                }
            }
        }, {
            key: "weightData",
            get: function() {
                return this._WeightData
            },
            set: function(e) {
                this._WeightData = e,
                this._WeightDataDelta++,
                this._IsDeformDirty = true,
                this._IsVertexDeformDirty = true,
                this.actor.revise()
            }
        }, {
            key: "weightDataDelta",
            get: function() {
                return this._WeightDataDelta
            }
        }, {
            key: "weightDataUndoDelta",
            get: function() {
                return this._WeightDataUndoDelta
            }
        }, {
            key: "useCustomMesh",
            get: function() {
                return this._UseCustomMesh
            },
            set: function(e) {
                if (this._UseCustomMesh != e) {
                    if (this._UseCustomMesh = e,
                    this._UseCustomMesh && !this._MeshData) {
                        this._Width || console.log("USE CUSTOM MESH WITH NO WIDTH?");
                        var t = this._Width / 2
                          , n = this._Height / 2
                          , i = new Float32Array([-t, -n, t, -n, t, n, -t, n])
                          , r = new Float32Array([-t, -n, 0, 1, t, -n, 1, 1, t, n, 1, 0, -t, n, 0, 0])
                          , o = new Uint16Array([0, 1, 2, 2, 3, 0]);
                        this.meshData = {
                            editor: {
                                c: new Float32Array(i),
                                cc: 4,
                                ie: new Uint16Array([]),
                                cl: true,
                                a: 0
                            },
                            verts: r,
                            tris: o,
                            loverts: i,
                            lotris: o
                        }
                    } else if (!this._UseCustomMesh) {
                        for (var a = 0; a < this._ConnectedBones.length; a++) {
                            var s = this._ConnectedBones[a].node
                              , l = s.skins.indexOf(this);
                            -1 !== l && s.skins.splice(l, 1)
                        }
                        this._ConnectedBones = [],
                        this.overrideWorldTransform = null,
                        this.compensate(),
                        this._DeformedLoVerts = null,
                        this.stageItem && this.stageItem.updateMesh(),
                        this.updateBoneArrays(),
                        this.useVertexDeform = false
                    }
                    this.stageItem.updateMesh(),
                    this.dispatch("useCustomMeshChange"),
                    this.forceRedraw()
                }
            }
        }, {
            key: "useVertexDeform",
            get: function() {
                return this._UseVertexDeform
            },
            set: function(e) {
                this._UseVertexDeform != e && (this._UseVertexDeform = e,
                e && this._MeshData && (this._MeshData.deform || (this._MeshData.deform = {}),
                this._MeshData.deform.verts && this._MeshData.deform.verts.length == this._MeshData.verts.length || (this._MeshData.deform.verts = new Float32Array(this._MeshData.verts))),
                this.stageItem.onUseVertexDeformChange(e),
                this.dispatch("useVertexDeformChange"),
                this.forceRedraw())
            }
        }, {
            key: "deformedLoVerts",
            get: function() {
                return this._DeformedLoVerts
            }
        }, {
            key: "boneColorsArray",
            get: function() {
                return this._BoneColorsArray || this.updateBoneArrays(),
                this._BoneColorsArray
            }
        }, {
            key: "colorMapOpacity",
            get: function() {
                return this._ColorMapOpacity
            },
            set: function(e) {
                e < 0 && (e = 0),
                this._ColorMapOpacity != e && (this._ColorMapOpacity = e,
                this.stageItem && this.stageItem.stage.redraw())
            }
        }, {
            key: "showBoneColorIndex",
            get: function() {
                return this._ShowBoneColorIndex
            },
            set: function(e) {
                this._ShowBoneColorIndex !== e && (this._ShowBoneColorIndex = e,
                this.stageItem && this.stageItem.stage.redraw()),
                this.updateBoneArrays()
            }
        }, {
            key: "boneTransformsArray",
            get: function() {
                this._BoneTransformsArray || this.updateBoneArrays();
                for (var e = 6, t = this._BoneTransformsArray, n = 0; n < this._ConnectedBones.length; n++) {
                    var i = this._ConnectedBones[n]
                      , r = i.node.worldTransform
                      , o = u.mat2d.mul(u.mat2d.create(), r, i.ibind);
                    t[e++] = o[0],
                    t[e++] = o[1],
                    t[e++] = o[2],
                    t[e++] = o[3],
                    t[e++] = o[4],
                    t[e++] = o[5]
                }
                return t
            }
        }]),
        t
    }(s.default),
    y = i.prototype,
    m = "filteringChanged",
    v = [l.default],
    g = Object.getOwnPropertyDescriptor(i.prototype, "filteringChanged"),
    _ = i.prototype,
    b = {},
    Object.keys(g).forEach((function(e) {
        b[e] = g[e]
    }
    )),
    b.enumerable = !!b.enumerable,
    b.configurable = !!b.configurable,
    ("value"in b || b.initializer) && (b.writable = true),
    b = v.slice().reverse().reduce((function(e, t) {
        return t(y, m, e) || e
    }
    ), b),
    _ && void 0 !== b.initializer && (b.value = b.initializer ? b.initializer.call(_) : void 0,
    b.initializer = void 0),
    void 0 === b.initializer && (Object.defineProperty(y, m, b),
    b = null),
    i);
    for (var O in t.default = w,
    w.BlendModes = {
        Normal: 0,
        Multiply: 1,
        Screen: 2,
        Additive: 3
    },
    w.BlendModeLookup = {},
    w.BlendModes)
        w.BlendModeLookup[w.BlendModes[O]] = O
}
, , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = s(n(0)), a = s(n(1));
    function s(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function l(e, t) {
        if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function")
    }
    function u(e, t) {
        if (!e)
            throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    function c(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var d = (c((i = function(e) {
        function t() {
            return l(this, t),
            u(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "click",
            value: function() {
                this.props.disabled || this.props.onToggle && this.props.onToggle(!this.props.isOn)
            }
        }, {
            key: "setKey",
            value: function(e) {
                e.stopPropagation(),
                this.props.onSetKey && this.props.onSetKey(this.props.isOn)
            }
        }, {
            key: "render",
            value: function() {
                var e, t = this.props, n = t.disabled, i = t.isAnimating;
                if (i)
                    switch (this.props.keyState) {
                    case 0:
                        e = "SelectionPanelKey";
                        break;
                    case 1:
                        e = "SelectionPanelKeyChanged";
                        break;
                    case 2:
                        e = "SelectionPanelKeyed"
                    }
                return o.default.createElement("div", {
                    className: this.props.addClass ? "SelectionPanelToggleField " + this.props.addClass : "SelectionPanelToggleField",
                    onMouseDown: this.click,
                    style: {
                        opacity: n ? .5 : null
                    }
                }, o.default.createElement("div", {
                    className: "SelectionPanelToggle",
                    style: {
                        right: i ? "15px" : null
                    }
                }, o.default.createElement("div", {
                    className: "SelectionPanelToggleHandle" + (this.props.isOn ? " SelectionPanelToggleHandleSelected" : "")
                })), i ? o.default.createElement("div", {
                    className: e,
                    onMouseDown: this.setKey
                }, o.default.createElement("div", null)) : null)
            }
        }]),
        t
    }(o.default.Component)).prototype, "click", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "click"), i.prototype),
    c(i.prototype, "setKey", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setKey"), i.prototype),
    i);
    t.default = d
}
, , , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = s(n(261))
      , o = s(n(243))
      , a = s(n(201));
    function s(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var l = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this));
            return n._Stage = e,
            n._IsDragging = false,
            n._ActiveTransformers = [],
            n._SuppressTransformers = [],
            n._Snap = false,
            n._AllowSnap = false,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "blockMarquee",
            value: function(e) {
                return false
            }
        }, {
            key: "clearSelections",
            value: function() {}
        }, {
            key: "onKeyDown",
            value: function(e) {
                this._AllowSnap && (this.snap = e.shiftKey)
            }
        }, {
            key: "onKeyUp",
            value: function(e) {
                this._AllowSnap && (this.snap = e.shiftKey)
            }
        }, {
            key: "enable",
            value: function() {}
        }, {
            key: "cancel",
            value: function() {}
        }, {
            key: "disable",
            value: function() {
                this._IsDragging && this.endDrag()
            }
        }, {
            key: "click",
            value: function(e) {}
        }, {
            key: "release",
            value: function(e) {
                this._ActiveTransformers = [],
                this._Stage.appContext.captureJournalEntry()
            }
        }, {
            key: "updateSelection",
            value: function(e, t) {}
        }, {
            key: "startDrag",
            value: function(e, t) {
                this._SuppressTransformers.length = 0,
                this._IsDragging = true,
                this.filterDragSelection && (t = this.filterDragSelection(t));
                var n = this.transformers;
                if (!n)
                    return false;
                for (var i = 0; i < n.length; i++) {
                    var r = n[i];
                    if (this._SuppressTransformers.length) {
                        for (var o = false, a = 0; a < this._SuppressTransformers.length; a++)
                            if (this._SuppressTransformers[a] === r) {
                                o = true;
                                break
                            }
                        if (o)
                            continue
                    }
                    var s = r.make(this, t);
                    s && this._ActiveTransformers.push(s)
                }
                return 0 != this._ActiveTransformers.length
            }
        }, {
            key: "advanceDrag",
            value: function(e, t, n, i) {
                for (var r = 0; r < this._ActiveTransformers.length; r++)
                    this._ActiveTransformers[r].advance(e, t, n, i)
            }
        }, {
            key: "validate",
            value: function() {
                return true
            }
        }, {
            key: "suppressTransformer",
            value: function(e) {
                this._SuppressTransformers.push(e);
                for (var t = 0; t < this._ActiveTransformers.length; t++) {
                    var n = this._ActiveTransformers[t];
                    n.constructor === e && (n.complete(),
                    this._ActiveTransformers.splice(t, 1),
                    t--)
                }
            }
        }, {
            key: "endDrag",
            value: function() {
                this._IsDragging = false;
                for (var e = 0; e < this._ActiveTransformers.length; e++)
                    this._ActiveTransformers[e].complete();
                this._ActiveTransformers = []
            }
        }, {
            key: "drawPrep",
            value: function(e) {}
        }, {
            key: "addActiveTransformer",
            value: function(e) {
                this._ActiveTransformers.push(e)
            }
        }, {
            key: "snap",
            get: function() {
                return this._Snap
            },
            set: function(e) {
                if (this._Snap !== e) {
                    this._Snap = e;
                    var t = true
                      , n = false
                      , i = void 0;
                    try {
                        for (var r, o = this._ActiveTransformers[Symbol.iterator](); !(t = (r = o.next()).done); t = true) {
                            var a = r.value;
                            a.onSnapChange && a.onSnapChange(e)
                        }
                    } catch (e) {
                        n = true,
                        i = e
                    } finally {
                        try {
                            !t && o.return && o.return()
                        } finally {
                            if (n)
                                throw i
                        }
                    }
                }
            }
        }, {
            key: "stage",
            get: function() {
                return this._Stage
            }
        }]),
        t
    }(s(n(12)).default);
    t.default = l,
    l.filterChildren = function(e) {
        for (var t = e.slice(0), n = 0; n < t.length; n++) {
            var i = t[n].node;
            if (i && (i.isLocked || i.stageItem && i.stageItem.isFake))
                t.splice(n, 1),
                n--;
            else
                for (; i && i.parent; ) {
                    if (-1 != t.indexOf(i.parent.stageItem)) {
                        t.splice(n, 1),
                        n--;
                        break
                    }
                    i = i.parent
                }
        }
        function s(e, t) {
            if (e == t)
                return true;
            if (e.children)
                for (var n = 0; n < e.children.length; n++) {
                    if (s(e.children[n], t))
                        return true
                }
            return false
        }
        for (var l = [], u = 0; u < t.length; u++) {
            var c = t[u];
            switch (c.constructor) {
            case r.default:
                if (-1 === l.indexOf(c)) {
                    var d = true
                      , h = c.node.connectedBones;
                    if (h)
                        for (var f = 0; f < h.length; f++) {
                            for (var p = h[f], y = 0; y < t.length; y++) {
                                var m = t[y]
                                  , v = null;
                                switch (m.constructor) {
                                case o.default:
                                    v = m.bone;
                                    break;
                                case a.default:
                                    v = m.node
                                }
                                if (v && s(v, p.node)) {
                                    d = false;
                                    break
                                }
                            }
                            if (!d)
                                break
                        }
                    d && l.push(c)
                }
                break;
            default:
                -1 === l.indexOf(c) && l.push(c)
            }
        }
        return l
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    });
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }();
    var r = function() {
        function e(t, n) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e),
            this._Stage = t,
            this._Actor = n
        }
        return i(e, [{
            key: "end",
            value: function() {
                this._Stage.endOperation(this)
            }
        }, {
            key: "start",
            value: function() {
                this._Stage.startOperation(this)
            }
        }]),
        e
    }();
    t.default = r
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }
      , o = s(n(208))
      , a = s(n(237));
    function s(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var l = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.name = "Root Bone",
            n._HasContrast = false,
            n._Size = 10,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "recurseChangeSize",
            value: function() {
                this.dispatch("sizeChanged", this._Size);
                for (var e = 0; e < this.children.length; e++) {
                    var t = this.children[e];
                    t.constructor === a.default && t.recurseChangeSize()
                }
            }
        }, {
            key: "read",
            value: function(e, n) {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "read", this).call(this, e, n);
                var i = n.contrast;
                i && (this._HasContrast = i);
                var o = n.size;
                o && o.constructor === Number && (this._Size = o)
            }
        }, {
            key: "serializeProperties",
            value: function(e) {
                var n = r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeProperties", this).call(this, e);
                return delete n.hasContrast,
                this._HasContrast && (n.contrast = this._HasContrast),
                n
            }
        }, {
            key: "serializeInteractive",
            value: function() {
                var e = r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeInteractive", this).call(this);
                return e.hasContrast = this._HasContrast,
                e.size = this._Size,
                e
            }
        }, {
            key: "uiHierIconClass",
            get: function() {
                return "HierarchyRootIcon"
            }
        }, {
            key: "uiIcon",
            get: function() {
                return "icon-root"
            }
        }, {
            key: "size",
            get: function() {
                return this._Size
            },
            set: function(e) {
                e != this._Size && (this._Size = e,
                this.recurseChangeSize(),
                this.forceRedraw())
            }
        }, {
            key: "hasContrast",
            get: function() {
                return this._HasContrast
            },
            set: function(e) {
                this._HasContrast != e && (this._HasContrast = e,
                this.dispatch("hasContrastChange", e),
                this.forceRedraw())
            }
        }]),
        t
    }(o.default);
    t.default = l
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = c(n(0)), a = c(n(23)), s = c(n(4)), l = c(n(1)), u = c(n(3));
    function c(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function d(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var h = (d((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                isOpen: false
            },
            n._Dropdowns = [],
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "setDropdown",
            value: function(e) {
                this.dropdown = e
            }
        }, {
            key: "open",
            value: function() {
                if (!this.props.disabled) {
                    this.setState({
                        isOpen: true
                    });
                    for (var e = [], t = 0; t < this.props.options.length; t++) {
                        var n = this.props.options[t]
                          , i = n.hoverTitle
                          , r = n.hoverDesc
                          , o = n.hoverIcon;
                        n && n.constructor !== String && (n = n.label),
                        e.push({
                            label: n,
                            active: t === this.props.selectedIndex,
                            hoverTitle: i || false,
                            hoverDesc: r || false,
                            hoverIcon: o || false
                        })
                    }
                    var s = void 0;
                    this.props.dropdownClass && (s = this.props.dropdownClass);
                    var l = a.default.findDOMNode(this.dropdown).getBoundingClientRect()
                      , u = this.context.nima.showDropDownMenu({
                        onClosed: this.closed,
                        onSelectionChanged: this.props.onSelectionChanged,
                        options: e,
                        rect: l,
                        dropdownClass: s
                    });
                    this._Dropdowns.push(u)
                }
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                var e = true
                  , t = false
                  , n = void 0;
                try {
                    for (var i, r = this._Dropdowns[Symbol.iterator](); !(e = (i = r.next()).done); e = true) {
                        var o = i.value;
                        this.context.nima.removeDropdownMenu(o)
                    }
                } catch (e) {
                    t = true,
                    n = e
                } finally {
                    try {
                        !e && r.return && r.return()
                    } finally {
                        if (t)
                            throw n
                    }
                }
            }
        }, {
            key: "closed",
            value: function() {
                this.setState({
                    isOpen: false
                })
            }
        }, {
            key: "setKey",
            value: function(e) {
                if (e.stopPropagation(),
                this.props.onSetKey) {
                    var t = this.props.options[this.props.selectedIndex];
                    this.props.onSetKey(t)
                }
            }
        }, {
            key: "render",
            value: function() {
                var e, t = this.props.options[this.props.selectedIndex];
                t && t.constructor !== String && (t = t.label);
                var n = this.props
                  , i = n.disabled
                  , r = n.isAnimating;
                if (r)
                    switch (this.props.keyState) {
                    case 0:
                        e = "SelectionPanelKey";
                        break;
                    case 1:
                        e = "SelectionPanelKeyChanged";
                        break;
                    case 2:
                        e = "SelectionPanelKeyed"
                    }
                return o.default.createElement("div", {
                    className: this.props.addClass ? "Dropdown " + this.props.addClass : "Dropdown",
                    ref: this.setDropdown,
                    style: {
                        opacity: i ? .2 : null
                    }
                }, o.default.createElement("div", {
                    className: "DropdownCurrent",
                    onClick: this.open
                }, o.default.createElement("span", {
                    style: {
                        top: this.state.isOpen ? "15px" : "0px",
                        opacity: this.state.isOpen ? "0" : "1"
                    }
                }, t), i ? null : o.default.createElement("svg", {
                    className: "DropdownArrow",
                    style: {
                        right: r ? "20px" : null
                    }
                }, o.default.createElement("use", {
                    xlinkHref: u.default.make("/images/symbol-defs.svg#icon-arrow")
                })), r ? o.default.createElement("div", {
                    className: e,
                    onMouseDown: this.setKey
                }, o.default.createElement("div", null)) : null))
            }
        }]),
        t
    }(o.default.Component)).prototype, "setDropdown", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "setDropdown"), i.prototype),
    d(i.prototype, "open", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "open"), i.prototype),
    d(i.prototype, "closed", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "closed"), i.prototype),
    d(i.prototype, "setKey", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "setKey"), i.prototype),
    i);
    t.default = h,
    h.contextTypes = {
        nima: s.default.object
    }
}
, , , , , , , , , , , , , , , , , , , , , , , , , , , , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }, a = n(208);
    var s = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.name = "Solo",
            n._ActiveChild = void 0,
            n._AnimationActiveChild = void 0,
            n._KeyStateActiveChild = 0,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "onUseAnimationValuesChange",
            value: function() {
                this.updateActiveChild()
            }
        }, {
            key: "updateActiveChild",
            value: function() {
                var e = true
                  , t = false
                  , n = void 0;
                try {
                    for (var i, r = this.children[Symbol.iterator](); !(e = (i = r.next()).done); e = true) {
                        var o = i.value;
                        o.isCollapsedVisibility = o !== this.activeChild
                    }
                } catch (e) {
                    t = true,
                    n = e
                } finally {
                    try {
                        !e && r.return && r.return()
                    } finally {
                        if (t)
                            throw n
                    }
                }
            }
        }, {
            key: "onChildrenChanged",
            value: function() {
                this.children.length || (this.activeChild = null),
                o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "onChildrenChanged", this).call(this),
                this.updateActiveChild()
            }
        }, {
            key: "onChildRemoved",
            value: function(e) {
                e.isCollapsedVisibility = false,
                o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "onChildRemoved", this).call(this, e),
                this.children.length || (this.activeChild = null)
            }
        }, {
            key: "onChildAdded",
            value: function(e) {
                null === this.activeChild && 1 === this.children.length ? this.activeChild = e : e.isCollapsedVisibility = true,
                o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "onChildAdded", this).call(this, e)
            }
        }, {
            key: "read",
            value: function(e, n) {
                o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "read", this).call(this, e, n);
                var i = n.activeChildIndex;
                if (void 0 !== i) {
                    var r = parseInt(i) || 0
                      , a = this;
                    e.whenNodesLoaded((function() {
                        a.updateActiveChild(),
                        a.activeChild = r >= 0 ? a.children[r] : null
                    }
                    ))
                }
            }
        }, {
            key: "serializeInteractive",
            value: function() {
                var e = o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeInteractive", this).call(this);
                return e.activeChild = this._ActiveChild,
                e
            }
        }, {
            key: "serializeProperties",
            value: function(e) {
                var n = o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeProperties", this).call(this, e);
                delete n.activeChild;
                var i = this.children.indexOf(this._ActiveChild);
                return -1 !== i && (n.activeChildIndex = i),
                n
            }
        }, {
            key: "isSolo",
            value: function() {
                return true
            }
        }, {
            key: "nullFrame",
            value: function() {
                var e = o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "nullFrame", this).call(this);
                return e.frameActiveChild = null,
                e
            }
        }, {
            key: "uiHierIconClass",
            get: function() {
                return "HierarchySoloIcon"
            }
        }, {
            key: "uiIcon",
            get: function() {
                return "icon-solo"
            }
        }, {
            key: "rigActiveChildIndex",
            get: function() {
                return this.children.indexOf(this._ActiveChild) + 1
            }
        }, {
            key: "frameActiveChildIndex",
            get: function() {
                return this.children.indexOf(this._AnimationActiveChild) + 1
            },
            set: function(e) {
                var t = this.children[e];
                this._AnimationActiveChild !== t && (this._AnimationActiveChild = t,
                this.dispatch("activeChildChanged"),
                this.updateActiveChild())
            }
        }, {
            key: "frameActiveChild",
            get: function() {
                return this._AnimationActiveChild
            },
            set: function(e) {
                this._AnimationActiveChild !== e && (this._AnimationActiveChild = e,
                this.dispatch("activeChildChanged"),
                this.updateActiveChild())
            }
        }, {
            key: "rigActiveChild",
            get: function() {
                return this._ActiveChild
            }
        }, {
            key: "frameActiveChildKS",
            get: function() {
                return this._KeyStateActiveChild
            },
            set: function(e) {
                this._KeyStateActiveChild != e && (this._KeyStateActiveChild = e,
                this.markKeyStateDirty())
            }
        }, {
            key: "activeChild",
            get: function() {
                return this._UseAnimationValues ? this._AnimationActiveChild : this._ActiveChild
            },
            set: function(e) {
                if (e && e.parent !== this)
                    console.log("SOLO ERROR: NOT A CHILD", this, e);
                else if (this._UseAnimationValues) {
                    var t = this._AnimationActiveChild;
                    this._AnimationActiveChild = e,
                    this.updateActiveChild(),
                    this.dispatch("animateActiveChild", {
                        from: t,
                        to: this._AnimationActiveChild
                    })
                } else
                    this._ActiveChild = e,
                    this.updateActiveChild(),
                    this.dispatch("activeChildChanged")
            }
        }, {
            key: "activeChildIndex",
            get: function() {
                return this._UseAnimationValues ? this.children.indexOf(this._AnimationActiveChild) : this.children.indexOf(this._ActiveChild)
            },
            set: function(e) {
                if (e > this.children.length)
                    console.log("ERROR: CHILD INDEX OUT OF BOUNDS", this, e);
                else {
                    var t = this.children[e];
                    this.activeChild = t
                }
            }
        }, {
            key: "isNode",
            get: function() {
                return true
            }
        }]),
        t
    }(((i = a) && i.__esModule ? i : {
        default: i
    }).default);
    t.default = s
}
, , , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = l(n(0)), a = l(n(1)), s = l(n(1100));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function u(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var c = (u((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                isFocused: false,
                input: ""
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "componentWillMount",
            value: function() {
                this.moveAccum = 0
            }
        }, {
            key: "inputText",
            value: function(e) {
                this.setState({
                    input: e.target.value
                })
            }
        }, {
            key: "keyDown",
            value: function(e) {
                switch (e.keyCode) {
                case 13:
                    this.textInput.blur();
                    break;
                case 27:
                    this.state.input = null,
                    this.textInput.blur()
                }
            }
        }, {
            key: "setTextInput",
            value: function(e) {
                this.textInput = e
            }
        }, {
            key: "inputBlurred",
            value: function() {
                if (null !== this.state.input) {
                    var e = this.state.input;
                    if (e !== t.InvalidValueMarker) {
                        var n = this.props.converter;
                        if (n) {
                            var i = void 0;
                            try {
                                i = n.fromDisplayValue(e)
                            } catch (t) {
                                console.log("Input converter failed, using old good.", e, this.props.value),
                                i = this.props.value
                            }
                            this.props.onValueChanged && this.props.onValueChanged(i, false)
                        } else if (this.props.isText)
                            this.props.onValueChanged && this.props.onValueChanged(e, false);
                        else {
                            var r = this.enforce(parseFloat(e));
                            this.props.onValueChanged && !isNaN(r) && this.props.onValueChanged(r, false)
                        }
                    }
                }
                this.setState({
                    isFocused: false
                }),
                this.props.onEdit && this.props.onEdit(this, false)
            }
        }, {
            key: "inputFocused",
            value: function() {
                var e = this.props.value
                  , n = this.props.converter;
                n ? e = n.toInputValue(e) : false === e ? e = t.InvalidValueMarker : this.props.isText || (e = Number.parseFloat(e)),
                this.setState({
                    isFocused: true,
                    input: e
                });
                var i = this.textInput;
                setTimeout((function() {
                    i.setSelectionRange(0, i.value.length)
                }
                ), 0),
                this.props.onEdit && this.props.onEdit(this, true)
            }
        }, {
            key: "click",
            value: function(e) {
                if (!(this.state.isFocused || this.props.disabled || this.props.readOnly)) {
                    this.lastY = e.clientY,
                    this.moved = false;
                    var n = this.textInput.value
                      , i = this.props.converter;
                    if (i)
                        try {
                            n = i.fromInputValue(n)
                        } catch (e) {
                            n = i.defaultValue
                        }
                    else
                        this.props.isText || (n = t.InvalidValueMarker === n ? 0 : Number.parseFloat(n));
                    this.valueAtClick = n,
                    this.valueMoveAccum = 0,
                    this.moveAccum = 0,
                    window.addEventListener("mouseup", this.mouseUp, true),
                    i && !i.allowDrag || window.addEventListener("mousemove", this.mouseMove, true)
                }
            }
        }, {
            key: "mouseMove",
            value: function(e) {
                var t = this.props.converter;
                if (!this.moved) {
                    var n = e.clientY - this.lastY;
                    if (this.lastY = e.clientY,
                    this.valueMoveAccum -= n * (this.props.dragScale || .1),
                    this.moveAccum += Math.abs(n),
                    !(this.moveAccum > 4))
                        return;
                    this.moved = true,
                    this.props.onEdit && this.props.onEdit(this, true)
                }
                var i = e.clientY - this.lastY;
                if (this.lastY = e.clientY,
                this.valueMoveAccum -= i * (t && t.dragScale || this.props.dragScale || .1),
                this.props.onValueChanged) {
                    var r = t || {}
                      , o = r.dragMin
                      , a = r.dragMax
                      , s = this.valueAtClick + this.valueMoveAccum;
                    this.valueAtClick > a ? s = this.valueMoveAccum > 0 ? this.valueAtClick : s : void 0 !== o && s < o ? s = o : void 0 !== a && s > a && (s = a),
                    this.props.onValueChanged(this.enforce(s), true)
                }
            }
        }, {
            key: "enforce",
            value: function(e) {
                if (this.props.converter)
                    return e;
                if (this.props.isText)
                    return e;
                if (void 0 !== this.props.decimalPlaces) {
                    var t = Math.pow(10, this.props.decimalPlaces);
                    e = Math.floor(e * t) / t
                }
                return e
            }
        }, {
            key: "mouseUp",
            value: function(e) {
                this.moved ? this.props.onValueCommit && this.props.onValueCommit() : this.textInput.focus(),
                this.moved && this.props.onEdit && this.props.onEdit(this, false),
                window.removeEventListener("mousemove", this.mouseMove, true),
                window.removeEventListener("mouseup", this.mouseUp, true)
            }
        }, {
            key: "setKey",
            value: function(e) {
                this.state.isFocused && this.inputBlurred(),
                e.stopPropagation(),
                this.props.onSetKey && this.props.onSetKey(this.props.value)
            }
        }, {
            key: "colorChanged",
            value: function(e) {
                this.props.onValueChanged && this.props.onValueChanged(e)
            }
        }, {
            key: "render",
            value: function() {
                var e, n = "", i = this.isColor;
                if (this.state.isFocused)
                    n = this.state.input;
                else {
                    var r = this.props.converter;
                    if (r)
                        n = r.toDisplayValue(this.props.value);
                    else if (false === this.props.value)
                        n = t.InvalidValueMarker;
                    else if (this.props.isText)
                        n = this.props.value;
                    else {
                        var a = this.props.decimals;
                        null == a && (a = 2);
                        var l = Math.pow(10, a);
                        n = Math.round(this.props.value * l),
                        n /= l,
                        this.props.unit && (n += this.props.unit)
                    }
                }
                switch (this.props.keyState) {
                default:
                case 0:
                    e = "SelectionPanelKey";
                    break;
                case 1:
                    e = "SelectionPanelKeyChanged";
                    break;
                case 2:
                    e = "SelectionPanelKeyed"
                }
                return o.default.createElement("div", {
                    className: "SelectionPanelInputField" + (this.props.disabled ? " SelectionPanelInputFieldDisabled" : "") + (this.props.addClass ? " " + this.props.addClass : ""),
                    onMouseDown: this.click
                }, o.default.createElement("div", {
                    className: "SelectionPanelInputLabel"
                }, this.props.label), o.default.createElement("span", {
                    className: "InputSpan"
                }, o.default.createElement("input", {
                    placeholder: this.props.placeholder,
                    ref: this.setTextInput,
                    style: {
                        pointerEvents: this.state.isFocused ? null : "none",
                        paddingRight: this.props.isAnimating ? "12px" : "0px"
                    },
                    type: "text",
                    value: n,
                    onChange: this.inputText,
                    onFocus: this.inputFocused,
                    onBlur: this.inputBlurred,
                    onKeyDown: this.keyDown
                })), i ? o.default.createElement(s.default, {
                    color: this.props.value,
                    onColorChange: this.colorChanged
                }) : null, o.default.createElement("div", {
                    className: e,
                    onMouseDown: this.setKey,
                    style: {
                        display: this.props.isAnimating ? null : "none"
                    }
                }, o.default.createElement("div", null)))
            }
        }, {
            key: "isColor",
            get: function() {
                var e = this.props.value;
                return null != e && e.constructor === Uint8Array
            }
        }]),
        t
    }(o.default.Component)).prototype, "inputText", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "inputText"), i.prototype),
    u(i.prototype, "keyDown", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "keyDown"), i.prototype),
    u(i.prototype, "setTextInput", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setTextInput"), i.prototype),
    u(i.prototype, "inputBlurred", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "inputBlurred"), i.prototype),
    u(i.prototype, "inputFocused", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "inputFocused"), i.prototype),
    u(i.prototype, "click", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "click"), i.prototype),
    u(i.prototype, "mouseMove", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseMove"), i.prototype),
    u(i.prototype, "mouseUp", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseUp"), i.prototype),
    u(i.prototype, "setKey", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setKey"), i.prototype),
    u(i.prototype, "colorChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "colorChanged"), i.prototype),
    i);
    t.default = c,
    c.InvalidValueMarker = "-"
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = ie(n(0)), a = ie(n(4)), s = ie(n(1)), l = ie(n(13)), u = ie(n(316)), c = ie(n(197)), d = ie(n(718)), h = ie(n(347)), f = ie(n(1134)), p = ie(n(264)), y = ie(n(1135)), m = ie(n(1136)), v = ie(n(1139)), g = ie(n(1140)), _ = ie(n(1143)), b = ie(n(1144)), w = ie(n(1145)), O = ie(n(1146)), S = ie(n(1147)), k = ie(n(1148)), P = ie(n(1149)), E = ie(n(1151)), T = ie(n(1152)), C = ie(n(1154)), x = ie(n(1156)), I = ie(n(1157)), D = ie(n(1158)), M = ie(n(1159)), A = ie(n(1160)), j = ie(n(1161)), L = ie(n(201)), R = ie(n(372)), F = ie(n(243)), B = ie(n(261)), V = ie(n(383)), N = ie(n(371)), z = ie(n(382)), W = ie(n(604)), H = ie(n(519)), U = ie(n(722)), K = ie(n(609)), G = ie(n(723)), X = ie(n(610)), J = ie(n(611)), Y = ie(n(724)), q = ie(n(725)), Q = ie(n(448)), Z = ie(n(384)), $ = ie(n(358)), ee = ie(n(410)), te = ie(n(612)), ne = (ie(n(594)),
    ie(n(3)));
    function ie(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function re(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var oe = (re((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                isAnimationOpen: false,
                items: null,
                isPickingParent: false,
                isEditingMesh: false,
                isEditingWeights: false,
                testColor: new Uint8Array([255, 0, 0])
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "componentWillMount",
            value: function() {
                this.bones = [],
                this.items = [],
                this.itemEditors = [],
                this.registerEditor(L.default, g.default),
                this.registerEditor(F.default, g.default),
                this.registerEditor(B.default, g.default),
                this.registerEditor(V.default, g.default),
                this.registerEditor(R.default, g.default),
                this.registerEditor(L.default, M.default),
                this.registerEditor(F.default, M.default),
                this.registerEditor(B.default, M.default),
                this.registerEditor(V.default, M.default),
                this.registerEditor(R.default, M.default),
                this.registerEditor(L.default, y.default),
                this.registerEditor(L.default, m.default),
                this.registerEditor(R.default, m.default),
                this.registerEditor(F.default, y.default),
                this.registerEditor(N.default, v.default),
                this.registerEditor(z.default, _.default),
                this.registerEditor(B.default, b.default),
                this.registerEditor(L.default, w.default),
                this.registerEditor(R.default, w.default),
                this.registerEditor(F.default, w.default),
                this.registerEditor(B.default, w.default),
                this.registerEditor(V.default, w.default),
                this.registerEditor(K.default, I.default),
                this.registerEditor(K.default, O.default),
                this.registerEditor(G.default, I.default),
                this.registerEditor(G.default, S.default),
                this.registerEditor(X.default, I.default),
                this.registerEditor(X.default, k.default),
                this.registerEditor(J.default, I.default),
                this.registerEditor(J.default, P.default),
                this.registerEditor(Y.default, I.default),
                this.registerEditor(Y.default, P.default),
                this.registerEditor(q.default, I.default),
                this.registerEditor(q.default, E.default),
                this.registerEditor(L.default, T.default),
                this.registerEditor(F.default, T.default),
                this.registerEditor(B.default, T.default),
                this.registerEditor(N.default, T.default),
                this.registerEditor(V.default, T.default),
                this.registerEditor(B.default, C.default),
                this.registerEditor(U.default, C.default),
                this.registerEditor(L.default, C.default),
                this.registerEditor(F.default, C.default),
                this.registerEditor(V.default, C.default),
                this.registerEditor(N.default, C.default),
                this.registerEditor(R.default, C.default),
                this.registerEditor(B.default, x.default),
                this.registerEditor(L.default, x.default),
                this.registerEditor(F.default, x.default),
                this.registerEditor(V.default, x.default),
                this.registerEditor(N.default, x.default),
                this.registerEditor(R.default, x.default),
                this.registerEditor(V.default, D.default);
                for (var e = 0; e < this.itemEditors.length; e++) {
                    this.itemEditors[e].__editors.sort((function(e, t) {
                        return (e.panelOrder || 0) - (t.panelOrder || 0)
                    }
                    ))
                }
                this.context.nima && (this.context.nima.addEventListener("pickParent", this.onPickParentChanged),
                this.context.nima.stage.addEventListener("toolChanged", this.toolChanged)),
                this._FilePanelWidth = this.props.filePanelWidth
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                if (this.context.nima) {
                    this.context.nima.removeEventListener("pickParent", this.onPickParentChanged),
                    this.context.nima.stage.removeEventListener("toolChanged", this.toolChanged);
                    var e = this.context.nima.stage.findTool(te.default);
                    e && e.removeEventListener("selectionChanged", this.updateWeightVertexSelection)
                }
            }
        }, {
            key: "debouncedForceUpdate",
            value: function() {
                this.forceUpdate()
            }
        }, {
            key: "updateWeightVertexSelection",
            value: function() {
                (0,
                l.default)(this.debouncedForceUpdate)
            }
        }, {
            key: "toolChanged",
            value: function() {
                var e = this.context.nima.stage
                  , t = e.findTool(te.default);
                t && (e.tool === t ? t.addEventListener("selectionChanged", this.updateWeightVertexSelection) : t.removeEventListener("selectionChanged", this.updateWeightVertexSelection)),
                this.state.isEditingWeights && this.forceUpdate()
            }
        }, {
            key: "onPickParentChanged",
            value: function(e) {
                this.setState({
                    isPickingParent: e
                })
            }
        }, {
            key: "registerEditor",
            value: function(e, t) {
                -1 === this.itemEditors.indexOf(e) && this.itemEditors.push(e),
                e.__editors || (e.__editors = []),
                e.__editors.push(t)
            }
        }, {
            key: "setAnimationMode",
            value: function(e) {
                var t = !!e;
                this.state.isAnimationOpen != t && this.setState({
                    isAnimationOpen: t
                })
            }
        }, {
            key: "itemPropertiesUpdated",
            value: function() {
                this.isRendering || this.forceUpdate(),
                this.itemPropertiesUpdateDelay()
            }
        }, {
            key: "itemPropertiesUpdateDelay",
            value: function() {
                var e = this;
                clearTimeout(this.t),
                this.t = setTimeout((function() {
                    e.forceUpdate()
                }
                ), 0)
            }
        }, {
            key: "setItems",
            value: function(e) {
                if (this.items)
                    for (var n = 0; n < this.items.length; n++) {
                        var i = this.items[n];
                        i.node && i.node.removeEventListener("update", this.itemPropertiesUpdated)
                    }
                if (this.items = e,
                this.setState({
                    items: e
                }),
                e)
                    for (var r = 0; r < e.length; r++) {
                        var o = e[r];
                        o.node && o.node.addEventListener("update", this.itemPropertiesUpdated)
                    }
                t.validate(t.Validation, e).hasReplace ? this.context.nima.setReplaceTarget(e) : this.context.nima.setReplaceTarget(null)
            }
        }, {
            key: "addEvent",
            value: function() {
                this.items && this.items.length && this.context.nima.actor.addNodeType(Q.default, this.items[0].node, {})
            }
        }, {
            key: "setSelectedItem",
            value: function(e) {
                e ? e.constructor !== Array && (e = [e]) : e = [];
                for (var t = false, n = false, i = [], r = 0; r < e.length; r++) {
                    var o = e[r]
                      , a = true;
                    if (o)
                        switch (o.constructor) {
                        case F.default:
                            t = true;
                            break;
                        case $.default:
                            a = false;
                            continue;
                        default:
                            n = true
                        }
                    o.selectionPanelItem && (o = o.selectionPanelItem),
                    a && -1 === i.indexOf(o) && i.push(o)
                }
                if (t && n)
                    for (var s = 0; s < i.length; s++) {
                        var l = i[s];
                        l && l.constructor === F.default && !l.isRoot && (i.splice(s, 1),
                        s--)
                    }
                var u = !this.items || this.items.length != i.length;
                if (!u)
                    for (var c = 0; c < i.length; c++)
                        if (-1 === this.items.indexOf(i[c])) {
                            u = true;
                            break
                        }
                u && this.setItems(i)
            }
        }, {
            key: "componentDidMount",
            value: function() {
                this.setItems(this.state.items)
            }
        }, {
            key: "setFilePanelWidth",
            value: function(e) {
                this._FilePanelWidth = e
            }
        }, {
            key: "commit",
            value: function() {
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "meshQualityChanged",
            value: function(e) {
                this.meshEditor && this.meshEditor.setQuality(e)
            }
        }, {
            key: "meshQualityChangeRelease",
            value: function() {
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "setMeshQuality",
            value: function(e) {
                this.meshQualitySlider && this.meshQualitySlider.setValue(e)
            }
        }, {
            key: "setMeshQualitySlider",
            value: function(e) {
                this.meshQualitySlider = e
            }
        }, {
            key: "translateMesh",
            value: function(e) {
                this.selectionPanel.style.transform = e ? "translate3D(-" + this._FilePanelWidth + "px, 0, 0)" : "translate3D(0px, 0, 0)"
            }
        }, {
            key: "translatePanelOut",
            value: function(e) {
                this.selectionPanel.style.transform = e ? "translate3D(-" + (this._FilePanelWidth + this.props.width) + "px, 0, 0)" : "translate3D(0px, 0, 0)"
            }
        }, {
            key: "setSelectionPanel",
            value: function(e) {
                this.selectionPanel = e
            }
        }, {
            key: "editMeshOn",
            value: function() {
                if (1 === this.state.items.length) {
                    this.translateMesh(true),
                    this.preMeshTool = this.context.nima.stage.toolType;
                    var e = this.state.items[0];
                    e.isEditingMesh = true,
                    this.meshEditor = e.meshEditor || new j.default(this.context.nima,e,this),
                    this.context.nima.editingMesh = this.meshEditor,
                    this.setState({
                        isEditingMesh: true
                    }),
                    this.props.onMeshMode && this.props.onMeshMode(true);
                    var t = this;
                    setTimeout((function() {
                        t.context.nima.stage.setViewOrigin(e.node.worldTransform),
                        t.context.nima.stage.setSoloItems([e], true),
                        t.context.nima.stage.clearSelections(),
                        e.isSelectable = false,
                        t.meshEditor.activate()
                    }
                    ), 0)
                }
            }
        }, {
            key: "editMeshReset",
            value: function() {
                this.meshEditor && (this.meshEditor.reset(),
                this.context.nima.captureJournalEntry())
            }
        }, {
            key: "editMeshNewContour",
            value: function() {
                this.meshEditor && (this.meshEditor.startNewContour(),
                this.context.nima.captureJournalEntry())
            }
        }, {
            key: "editMeshAutoGenerate",
            value: function() {
                this.meshEditor && this.meshEditor.autoGenerate()
            }
        }, {
            key: "editMeshOff",
            value: function() {
                this.meshEditor && this.meshEditor.close()
            }
        }, {
            key: "closeMeshEditor",
            value: function() {
                this.translateMesh(false);
                var e = this
                  , t = null;
                this.meshEditor && (t = this.meshEditor.stageItem,
                this.meshEditor.deactivate(),
                this.meshEditor.stageItem.isEditingMesh = false,
                this.meshEditor = null),
                this.context.nima.editingMesh = null,
                this.setState({
                    isEditingMesh: false
                }),
                this.props.onMeshMode && this.props.onMeshMode(false),
                setTimeout((function() {
                    var n = e.context.nima.stage;
                    n.setViewOrigin(null),
                    n.clearSoloItems(),
                    t && (t.isSelectable = true,
                    n.selectItem(t)),
                    e.context.nima.stage.toolType = e.preMeshTool
                }
                ), 0)
            }
        }, {
            key: "selectBoneIndex",
            value: function(e) {
                if (this.weightEditor) {
                    var t = this.weightEditor.node;
                    e = Math.max(0, Math.min(e, t.connectedBones.length - 1));
                    var n = this.context.nima.stage.findTool(ee.default);
                    n.selectedBoneIndex = e;
                    for (var i = t.connectedBones, r = 0; r < i.length; r++) {
                        i[r].node.stageItem.isPainting = r === e
                    }
                    null !== t.showBoneColorIndex && (t.showBoneColorIndex = n.selectedBoneIndex),
                    this.forceUpdate()
                }
            }
        }, {
            key: "selectNextBone",
            value: function() {
                if (this.weightEditor) {
                    var e = this.context.nima.stage.findTool(ee.default);
                    this.selectBoneIndex(e.selectedBoneIndex + 1)
                }
            }
        }, {
            key: "selectPreviousBone",
            value: function() {
                if (this.weightEditor) {
                    var e = this.context.nima.stage.findTool(ee.default);
                    this.selectBoneIndex(e.selectedBoneIndex - 1)
                }
            }
        }, {
            key: "incBrushSize",
            value: function(e) {
                this.context.nima.stage.findTool(ee.default).brush.size += e,
                this.forceUpdate()
            }
        }, {
            key: "incBrushFeather",
            value: function(e) {
                this.context.nima.stage.findTool(ee.default).brush.feather += e,
                this.forceUpdate()
            }
        }, {
            key: "incBrushStrength",
            value: function(e) {
                this.context.nima.stage.findTool(ee.default).brush.strength += e,
                this.forceUpdate()
            }
        }, {
            key: "editWeightsOn",
            value: function() {
                if (1 === this.state.items.length) {
                    var e = this.state.items[0].node;
                    this.translateMesh(true),
                    this.preWeightTool = this.context.nima.stage.toolType,
                    e.isEditingWeights = true,
                    this.weightEditor = e.weightEditor || (e.weightEditor = new A.default(this.context.nima,e,this)),
                    e.addEventListener("weightDataChanged", this.updateWeightVertexSelection),
                    this.context.nima.editingWeights = this.weightEditor,
                    this.weightEditor.activate();
                    var t = this.context.nima.stage.findTool(ee.default);
                    t && this.selectBoneIndex(t.selectedBoneIndex),
                    this.setState({
                        isEditingWeights: true
                    }),
                    this.props.onWeightsMode && this.props.onWeightsMode(true);
                    var n = this;
                    setTimeout((function() {
                        n.context.nima.stage.setSoloItems([e.stageItem], false),
                        n.context.nima.stage.clearSelections(),
                        e.stageItem.isSelectable = false
                    }
                    ), 0),
                    this.context.nima.setSelectionCallbacks(this.selectBoneIndex, this.selectNextBone, this.selectPreviousBone),
                    this.context.nima.setBrushCallbacks(this.incBrushSize, this.incBrushFeather, this.incBrushStrength)
                }
            }
        }, {
            key: "autoCalculateWeights",
            value: function() {
                this.weightEditor && this.weightEditor.calculateAutoWeights()
            }
        }, {
            key: "editWeightsOff",
            value: function() {
                this.translateMesh(false);
                var e = this
                  , t = null;
                if (this.weightEditor) {
                    t = this.weightEditor.stageItem,
                    this.weightEditor.deactivate();
                    var n = this.weightEditor.node;
                    n.removeEventListener("weightDataChanged", this.updateWeightVertexSelection),
                    n.isEditingWeights = false;
                    for (var i = n.connectedBones, r = 0; r < i.length; r++) {
                        i[r].node.stageItem.isPainting = null
                    }
                    this.weightEditor = null
                }
                this.context.nima.editingWeights = null,
                this.setState({
                    isEditingWeights: false
                }),
                this.props.onWeightsMode && this.props.onWeightsMode(false),
                setTimeout((function() {
                    var n = e.context.nima.stage;
                    n.clearSoloItems(),
                    t && (t.isSelectable = true,
                    n.selectItem(t)),
                    e.context.nima.stage.toolType = e.preWeightTool,
                    e.context.nima.captureJournalEntry()
                }
                ), 0),
                this.context.nima.setSelectionCallbacks(),
                this.context.nima.setBrushCallbacks()
            }
        }, {
            key: "replaceImage",
            value: function() {
                var e = document.createElement("input")
                  , t = this;
                e.addEventListener("change", (function(e) {
                    t.context.nima.replaceAssets(t.state.items, e.target.files)
                }
                )),
                e.setAttribute("type", "file"),
                e.click()
            }
        }, {
            key: "resizeWeightBrush",
            value: function(e, t) {
                this.context.nima.stage.findTool(ee.default).brush.size = e,
                this.forceUpdate()
            }
        }, {
            key: "changeColorMapOpacity",
            value: function(e) {
                this.weightEditor && (this.weightEditor.node.colorMapOpacity = e),
                this.forceUpdate()
            }
        }, {
            key: "changePoseIndex",
            value: function(e) {
                var t = this.weightEditor;
                t && (t.showDeformed = 1 === e,
                this.forceUpdate())
            }
        }, {
            key: "changePaintColorMap",
            value: function(e) {
                if (this.weightEditor)
                    if (1 === e) {
                        var t = this.context.nima.stage.findTool(ee.default);
                        this.weightEditor.node.showBoneColorIndex = t.selectedBoneIndex
                    } else
                        this.weightEditor.node.showBoneColorIndex = null;
                this.forceUpdate()
            }
        }, {
            key: "changeBrushMode",
            value: function(e) {
                this.context.nima.stage.findTool(ee.default).brush.mode = e,
                this.forceUpdate()
            }
        }, {
            key: "featherBrush",
            value: function(e, t) {
                this.context.nima.stage.findTool(ee.default).brush.feather = e,
                this.forceUpdate()
            }
        }, {
            key: "setBrushStrength",
            value: function(e, t) {
                this.context.nima.stage.findTool(ee.default).brush.strength = e,
                this.forceUpdate()
            }
        }, {
            key: "selectPaintBone",
            value: function(e) {
                this.selectBoneIndex(e.props.index)
            }
        }, {
            key: "onEditBrush",
            value: function(e, t) {
                var n = this.context.nima.stage.findTool(ee.default);
                t ? (n.brush.isInEditingPosition = true,
                this.editingBrushControl = e) : this.editingBrushControl === e && (n.brush.isInEditingPosition = false,
                this.editingBrushControl = null)
            }
        }, {
            key: "setLeft",
            value: function(e) {
                this.selectionPanel.style.left = e + "px"
            }
        }, {
            key: "setWidth",
            value: function(e) {
                this.selectionPanel.style.width = e + "px"
            }
        }, {
            key: "setBottom",
            value: function(e) {
                this.selectionPanel.style.bottom = e + "px"
            }
        }, {
            key: "changeTestColor",
            value: function(e) {
                this.setState({
                    testColor: e
                })
            }
        }, {
            key: "changeVertexWeight",
            value: function(e, t) {
                this.weightEditor && (this.context.nima.stage.findTool(te.default).setSelectedVertexWeight(e, t),
                this.forceUpdate())
            }
        }, {
            key: "render",
            value: function() {
                this.isRendering = true;
                var e = this.state.items && this.state.items.length
                  , n = this.state.items && this.state.items.length > 1 ? "Multiple Selection" : "No selection"
                  , i = !e
                  , r = t.validate(t.Validation, this.state.items);
                r.name || (r.name = n);
                var a = !e
                  , s = this.state.isAnimationOpen;
                this.isRendering = false;
                var l = this.context.nima.stage
                  , y = l.findTool(ee.default)
                  , m = []
                  , v = 0
                  , g = 1
                  , _ = 0
                  , b = this.weightEditor;
                if (b) {
                    var w = l.findTool(te.default)
                      , O = b.node;
                    null !== O.showBoneColorIndex && (v = 1),
                    g = O.colorMapOpacity;
                    var S = O.connectedBones
                      , k = y.selectedBoneIndex;
                    _ = y.brush.mode;
                    var P = null;
                    l.toolType === te.default && (P = w.selectedWeights);
                    for (var E = 0; E < S.length; E++) {
                        var T = S[E];
                        m.push(o.default.createElement(f.default, {
                            value: P ? P.get(E) : null,
                            onSelect: this.selectPaintBone,
                            index: E,
                            key: E,
                            bone: T.node,
                            color: L.default.Colors[E % L.default.Colors.length],
                            isSelected: k == E,
                            onWeightChanged: this.changeVertexWeight
                        }))
                    }
                }
                var C = null;
                if (this.state.items && this.state.items.length)
                    for (var x = 0; x < this.state.items.length; x++) {
                        var I = this.state.items[x];
                        if (I && I.constructor.__editors)
                            if (C)
                                for (var D = 0; D < C.length; D++) {
                                    var M = C[D];
                                    -1 !== I.constructor.__editors.indexOf(M.type) && M.type.canMultiEdit ? M.stageItems.push(I) : (C.splice(D, 1),
                                    D--)
                                }
                            else {
                                C = [];
                                for (var A = 0; A < I.constructor.__editors.length; A++) {
                                    var j = I.constructor.__editors[A];
                                    C.push({
                                        type: j,
                                        stageItems: [I]
                                    })
                                }
                            }
                    }
                if (C) {
                    for (var R = [], F = 0; F < C.length; F++) {
                        var B = C[F]
                          , V = null
                          , N = true;
                        B.type.validate && ((V = B.type.validate(this, B.stageItems)) || (N = false)),
                        N && R.push(o.default.createElement(B.type, {
                            stageItems: B.stageItems,
                            disableInput: a,
                            validation: V,
                            key: F,
                            isAnimating: s,
                            selectionPanel: this
                        }))
                    }
                    C = R
                } else
                    C = [];
                var z = false;
                return this.state.isEditingMesh && (z = this.meshEditor.node.constructor === Z.default),
                o.default.createElement("div", {
                    id: "SelectionPanel",
                    ref: this.setSelectionPanel,
                    style: {
                        width: this.props.width + "px",
                        bottom: s ? this.props.animationPanelHeight + "px" : null,
                        left: this._FilePanelWidth,
                        transition: this.props.animationIsResizing ? "bottom 0s" : null
                    }
                }, o.default.createElement("div", {
                    className: "SelectionPanelShadow",
                    style: {
                        visibility: s ? null : "hidden"
                    }
                }, o.default.createElement("img", {
                    src: ne.default.make("/images/selection_panel_shadow.png")
                })), o.default.createElement("div", {
                    className: "SelectionPanelContent",
                    style: {
                        display: this.state.isEditingMesh ? "block" : "none"
                    }
                }, o.default.createElement("div", {
                    className: "SelectionPanelGroup"
                }, z ? o.default.createElement("div", {
                    className: "SelectionPanelTitle"
                }, "Edit Shape") : o.default.createElement("div", {
                    className: "SelectionPanelTitle"
                }, "Edit Mesh"), o.default.createElement(c.default, {
                    label: "OK",
                    onPress: this.editMeshOff
                }), o.default.createElement(c.default, {
                    label: "NEW",
                    onPress: this.editMeshNewContour
                }), z ? null : o.default.createElement(c.default, {
                    label: "AUTO GENERATE",
                    onPress: this.editMeshAutoGenerate
                }), o.default.createElement(c.default, {
                    label: "RESET",
                    onPress: this.editMeshReset
                })), z ? null : o.default.createElement("div", {
                    className: "SelectionPanelGroup"
                }, o.default.createElement(d.default, {
                    ref: this.setMeshQualitySlider,
                    label: "Subdivide (Max Area)",
                    minValue: 0,
                    maxValue: 1,
                    displayScale: 100,
                    onValueChanged: this.meshQualityChanged,
                    onValueChangeComplete: this.meshQualityChangeRelease
                }))), b ? o.default.createElement("div", {
                    className: "SelectionPanelContent"
                }, o.default.createElement("div", {
                    className: "SelectionPanelGroup"
                }, o.default.createElement("div", {
                    className: "SelectionPanelTitle"
                }, "Edit Weights"), o.default.createElement(c.default, {
                    label: "OK",
                    onPress: this.editWeightsOff
                }), o.default.createElement(c.default, {
                    label: "AUTO CALCULATE",
                    onPress: this.autoCalculateWeights
                })), o.default.createElement(p.default, {
                    label: "Options"
                }, o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Pose"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(u.default, {
                    options: ["Bind", "Setup"],
                    selectedIndex: b.showDeformed ? 1 : 0,
                    onSelectionChanged: this.changePoseIndex
                }))), o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Map"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(u.default, {
                    options: ["All", "Selected"],
                    selectedIndex: v,
                    onSelectionChanged: this.changePaintColorMap
                }))), o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Map Opacity"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(h.default, {
                    value: g,
                    dragScale: .01,
                    onValueChanged: this.changeColorMapOpacity
                })))), l.tool === y ? o.default.createElement(p.default, {
                    label: "Brush Options"
                }, o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Operation"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(u.default, {
                    options: ["Add", "Subtract"],
                    selectedIndex: _,
                    onSelectionChanged: this.changeBrushMode
                }))), o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Size"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(h.default, {
                    onEdit: this.onEditBrush,
                    value: y && y.brush.size,
                    onValueChanged: this.resizeWeightBrush
                }))), o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Feather"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(h.default, {
                    onEdit: this.onEditBrush,
                    value: y && y.brush.feather,
                    onValueChanged: this.featherBrush
                }))), o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Strength"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(h.default, {
                    onEdit: this.onEditBrush,
                    dragScale: .01,
                    value: y && y.brush.strength,
                    onValueChanged: this.setBrushStrength
                })))) : null, o.default.createElement(p.default, {
                    label: l.toolType === te.default ? "Vertex Weights" : "Paint With"
                }, m)) : null, o.default.createElement("div", {
                    className: "SelectionPanelContent",
                    style: {
                        display: this.state.isEditingMesh || this.state.isEditingWeights ? "none" : "block"
                    }
                }, o.default.createElement("div", {
                    className: "SelectionPanelGroup"
                }, r.className && r.icon ? o.default.createElement("svg", {
                    className: "SelectionPanelCurrentIcon " + r.className
                }, o.default.createElement("use", {
                    xlinkHref: r.icon || null
                })) : null, o.default.createElement("div", {
                    className: i ? "SelectedName SelectionPanelEmptyMsg" : "SelectedName"
                }, r.name), i ? o.default.createElement("div", {
                    className: "SelectionPanelEmptyNote"
                }, "Select something to view its properties and options.") : null, o.default.createElement("div", {
                    className: "SelectedItemType"
                }, r.typeName), r.hasReplace ? o.default.createElement(c.default, {
                    onPress: this.replaceImage,
                    label: "Replace"
                }) : null), C, r.hasReparent && !s ? o.default.createElement("div", {
                    className: "SelectionPanelGroup"
                }, o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitleSwitch",
                    style: {
                        color: this.state.isPickingParent ? "#fff" : null
                    }
                }, "Pick Parent"), o.default.createElement("svg", {
                    className: this.state.isPickingParent ? "PickParentActive" : "PickParent",
                    onMouseDown: this.context.nima.pickParent
                }, o.default.createElement("use", {
                    xlinkHref: ne.default.make("/images/symbol-defs.svg#icon-aim")
                })))) : null, null))
            }
        }]),
        t
    }(o.default.Component)).prototype, "debouncedForceUpdate", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "debouncedForceUpdate"), i.prototype),
    re(i.prototype, "updateWeightVertexSelection", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "updateWeightVertexSelection"), i.prototype),
    re(i.prototype, "toolChanged", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "toolChanged"), i.prototype),
    re(i.prototype, "onPickParentChanged", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "onPickParentChanged"), i.prototype),
    re(i.prototype, "itemPropertiesUpdated", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "itemPropertiesUpdated"), i.prototype),
    re(i.prototype, "commit", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "commit"), i.prototype),
    re(i.prototype, "meshQualityChanged", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "meshQualityChanged"), i.prototype),
    re(i.prototype, "meshQualityChangeRelease", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "meshQualityChangeRelease"), i.prototype),
    re(i.prototype, "setMeshQualitySlider", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setMeshQualitySlider"), i.prototype),
    re(i.prototype, "setSelectionPanel", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setSelectionPanel"), i.prototype),
    re(i.prototype, "editMeshOn", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "editMeshOn"), i.prototype),
    re(i.prototype, "editMeshReset", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "editMeshReset"), i.prototype),
    re(i.prototype, "editMeshNewContour", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "editMeshNewContour"), i.prototype),
    re(i.prototype, "editMeshAutoGenerate", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "editMeshAutoGenerate"), i.prototype),
    re(i.prototype, "editMeshOff", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "editMeshOff"), i.prototype),
    re(i.prototype, "selectBoneIndex", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "selectBoneIndex"), i.prototype),
    re(i.prototype, "selectNextBone", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "selectNextBone"), i.prototype),
    re(i.prototype, "selectPreviousBone", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "selectPreviousBone"), i.prototype),
    re(i.prototype, "incBrushSize", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "incBrushSize"), i.prototype),
    re(i.prototype, "incBrushFeather", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "incBrushFeather"), i.prototype),
    re(i.prototype, "incBrushStrength", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "incBrushStrength"), i.prototype),
    re(i.prototype, "editWeightsOn", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "editWeightsOn"), i.prototype),
    re(i.prototype, "autoCalculateWeights", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "autoCalculateWeights"), i.prototype),
    re(i.prototype, "editWeightsOff", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "editWeightsOff"), i.prototype),
    re(i.prototype, "replaceImage", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "replaceImage"), i.prototype),
    re(i.prototype, "resizeWeightBrush", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "resizeWeightBrush"), i.prototype),
    re(i.prototype, "changeColorMapOpacity", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "changeColorMapOpacity"), i.prototype),
    re(i.prototype, "changePoseIndex", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "changePoseIndex"), i.prototype),
    re(i.prototype, "changePaintColorMap", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "changePaintColorMap"), i.prototype),
    re(i.prototype, "changeBrushMode", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "changeBrushMode"), i.prototype),
    re(i.prototype, "featherBrush", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "featherBrush"), i.prototype),
    re(i.prototype, "setBrushStrength", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setBrushStrength"), i.prototype),
    re(i.prototype, "selectPaintBone", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "selectPaintBone"), i.prototype),
    re(i.prototype, "onEditBrush", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "onEditBrush"), i.prototype),
    re(i.prototype, "changeTestColor", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "changeTestColor"), i.prototype),
    re(i.prototype, "changeVertexWeight", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "changeVertexWeight"), i.prototype),
    i);
    t.default = oe,
    oe.isValue = function(e) {
        return null != e
    }
    ,
    oe.validate = function(e, t) {
        var n = {};
        for (var i in e) {
            var r = e[i]
              , o = null
              , a = true;
            if (t)
                for (var s = 0; s < t.length; s++) {
                    var l = t[s];
                    if (a)
                        o = r.validate(l),
                        a = false;
                    else if (r.equals ? !r.equals(r.validate(l), o) : r.validate(l) !== o) {
                        o = false;
                        break
                    }
                }
            n[i] = o
        }
        return n
    }
    ,
    oe.Validation = {
        hasReplace: {
            validate: function(e) {
                switch (e.constructor) {
                case B.default:
                    return !e.node.asset || e.node.asset.isMissing;
                case H.default:
                case W.default:
                case z.default:
                    return true
                }
                return false
            }
        },
        hasReparent: {
            validate: function(e) {
                switch (e.constructor) {
                case V.default:
                case B.default:
                case N.default:
                    return true;
                case F.default:
                    return !e.parentJoint
                }
                return false
            }
        },
        disableInput: {
            validate: function(e) {
                return e.constructor !== $.default
            }
        },
        name: {
            validate: function(e) {
                return e.node ? e.node.name : e.name
            }
        },
        typeName: {
            validate: function(e) {
                return e.typeName || e.node && e.node.typeName
            }
        },
        className: {
            validate: function(e) {
                return e.uiSelectionIconClass || e.node && e.node.uiSelectionIconClass
            }
        },
        icon: {
            validate: function(e) {
                var t = e.selectionIcon;
                return !t && e.node && (t = e.node.uiIcon),
                t ? ne.default.make("/images/symbol-defs.svg#" + t) : null
            }
        }
    },
    oe.contextTypes = {
        nima: a.default.object
    }
}
, , , , , , , , , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    });
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }();
    var r = new Map
      , o = function() {
        function e(t, n) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e),
            this._Label = t,
            this._ID = n,
            r.set(t, this)
        }
        return i(e, [{
            key: "toString",
            value: function() {
                return this._Label
            }
        }, {
            key: "id",
            get: function() {
                return this._ID
            }
        }], [{
            key: "fromString",
            value: function(t) {
                return r.get(t) || e.World
            }
        }]),
        e
    }();
    t.default = o,
    o.Local = new o("local",0),
    o.World = new o("world",1)
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = w(n(704)), a = w(n(695)), s = w(n(1)), l = w(n(399)), u = w(n(510)), c = w(n(448)), d = w(n(208)), h = w(n(237)), f = w(n(344)), p = w(n(398)), y = w(n(267)), m = w(n(384)), v = w(n(712)), g = w(n(445)), _ = w(n(443)), b = w(n(13));
    function w(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function O(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var S = (O((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this));
            n._Actor = e,
            n._Order = 0,
            n._ListeningActor = null,
            n._Editor = null,
            n._AutoKey = false,
            n._IsUndoOrRedo = false,
            n._IsPlaying = false,
            n._Position = 0,
            n._Duration = 10,
            n._OldDuration = 10,
            n._DisplayStart = 0,
            n._DisplayEnd = 10,
            n._WorkAreaStart = 0,
            n._WorkAreaEnd = 10,
            n._IsWorkAreaActive = false,
            n._Loop = false,
            n._FPS = 60,
            n._OldFPS = 60,
            n._PositionDirty = false,
            n._Items = [],
            n._ItemToKeyFrames = {},
            n._ID = t.ID++,
            n._IsEditingCurves = false,
            n._ShowSelectionOnly = false,
            n._Journal = [],
            n._JournalIndex = -1,
            n._LastFullState = null,
            n._Changes = {},
            n._KeyFramePropertyChanges = {},
            n._KeyFrameSortPropertyChanges = {},
            n._AddedKeyframes = [],
            n._RemovedKeyframes = [],
            n._KeyedNodes = [],
            n._ActualKeyedNodes = [],
            n._EditableKeyedNodes = [],
            n._KeyedNodeLookup = {},
            n._HiddenKeyedNodeLookup = {},
            n._OrderKeyState = 0,
            n._UpdateNodesTimeout,
            n._SelectedItems = [],
            n._IsStable = false,
            n._UIMasterKeyFrameGroups = {},
            n._IsVisible = false;
            var i = n;
            return n.onAnimatePosX = function(e) {
                i.change(this, "framePosX", e.to)
            }
            ,
            n.onAnimatePosY = function(e) {
                i.change(this, "framePosY", e.to)
            }
            ,
            n.onAnimateScaleX = function(e) {
                i.change(this, "frameScaleX", e.to)
            }
            ,
            n.onAnimateScaleY = function(e) {
                i.change(this, "frameScaleY", e.to)
            }
            ,
            n.onAnimateRotation = function(e) {
                i.change(this, "frameRotation", e.to)
            }
            ,
            n.onAnimateOpacity = function(e) {
                i.change(this, "frameOpacity", e.to)
            }
            ,
            n.onAnimateSequence = function(e) {
                i.change(this, "frameSequence", e.to)
            }
            ,
            n.onAnimateDrawOrder = function(e) {
                i.change(this, "frameDrawOrder", e.to)
            }
            ,
            n.onAnimateVertexDeform = function(e) {
                i.change(this, "frameVertices", e)
            }
            ,
            n.onAnimateLength = function(e) {
                i.change(this, "frameLength", e.to)
            }
            ,
            n.onAnimateStrength = function(e) {
                i.change(this, "frameStrength", e.to)
            }
            ,
            n.onAnimateIntValue = function(e) {
                i.change(this, "frameIntValue", e.to)
            }
            ,
            n.onAnimateFloatValue = function(e) {
                i.change(this, "frameFloatValue", e.to)
            }
            ,
            n.onAnimateStringValue = function(e) {
                i.change(this, "frameStringValue", e.to)
            }
            ,
            n.onAnimateBooleanValue = function(e) {
                i.change(this, "frameBooleanValue", e.to)
            }
            ,
            n.onAnimateIsCollisionEnabled = function(e) {
                i.change(this, "frameIsCollisionEnabled", e.to)
            }
            ,
            n.onAnimateActiveChild = function(e) {
                i.change(this, "frameActiveChild", e.to)
            }
            ,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "uiHierIconClass",
            get: function() {
                return this.isPlaying ? "HierarchyPauseIcon" : "HierarchyPlayIcon"
            }
        }, {
            key: "uiSelectionIconClass",
            get: function() {
                return "SelectionAnimationIcon"
            }
        }, {
            key: "uiIcon",
            get: function() {
                return "icon-" + (this.isPlaying ? "pause" : "play") + "-small"
            }
        }, {
            key: "selectionIcon",
            get: function() {
                return "icon-animations"
            }
        }, {
            key: "typeName",
            get: function() {
                return "Animation"
            }
        }]),
        r(t, [{
            key: "assignID",
            value: function() {
                this._ID = t.ID++
            }
        }, {
            key: "clearSelection",
            value: function(e) {
                this.selectItem(null, false, e)
            }
        }, {
            key: "selectItem",
            value: function(e, t, n) {
                var i = false;
                if (!t) {
                    for (var r = 0; r < this._SelectedItems.length; r++)
                        this._SelectedItems[r].isSelected = false;
                    this._SelectedItems.length = 0,
                    i = true
                }
                if (e)
                    if (e.constructor === Array)
                        for (var o = 0; o < e.length; o++) {
                            var a = e[o];
                            a.isSelected || (a.isSelected = true,
                            this._SelectedItems.push(a),
                            i = true)
                        }
                    else
                        e.isSelected || (e.isSelected = true,
                        this._SelectedItems.push(e),
                        i = true);
                i && !n && this.dispatch("itemSelected")
            }
        }, {
            key: "doUpdateNodes",
            value: function(e) {
                this._ActualKeyedNodes.length = 0;
                for (var t = 0; t < this._KeyedNodes.length; t++) {
                    var n = this._KeyedNodes[t];
                    (e || !n.node.stageItem || n.node.stageItem.stage) && this._ActualKeyedNodes.push(n)
                }
                this._ActualKeyedNodes.sort((function(e, t) {
                    return e.node.treeIndex - t.node.treeIndex
                }
                )),
                this.updateEditableKeyedNodes(),
                this.dispatch("nodesUpdate", this._ActualKeyedNodes),
                this.dispatch("update"),
                this._IsStable = true,
                this._PositionDirty = true
            }
        }, {
            key: "updateEditableKeyedNodes",
            value: function() {
                for (var e in this._UIMasterKeyFrameGroups)
                    this._UIMasterKeyFrameGroups[e].clear();
                this._EditableKeyedNodes.length = 0;
                for (var n = 0; n < this._ActualKeyedNodes.length; n++) {
                    var i = this._ActualKeyedNodes[n]
                      , r = i.node
                      , a = !this._ShowSelectionOnly;
                    if (this._ShowSelectionOnly && (r.stageItem ? a = r.stageItem.isSelected : r === t.OrderObject && (a = true)),
                    !r.stageItem || r.isVisible || r.stageItem.isFake || (a = false),
                    a)
                        if (r.constructor === l.default) {
                            var s = this._UIMasterKeyFrameGroups[r.parent.refId];
                            s || (s = new o.default(r.parent,this),
                            this._UIMasterKeyFrameGroups[r.parent.refId] = s),
                            s.addGroup(i),
                            -1 === this._EditableKeyedNodes.indexOf(s) && this._EditableKeyedNodes.push(s)
                        } else {
                            var u = this._UIMasterKeyFrameGroups[r.refId];
                            u || (u = new o.default(r,this),
                            this._UIMasterKeyFrameGroups[r.refId] = u),
                            u.addGroup(i),
                            -1 === this._EditableKeyedNodes.indexOf(u) && this._EditableKeyedNodes.push(u)
                        }
                }
                this.dispatchUpdateEditableRows()
            }
        }, {
            key: "doDispatchUpdateEditableRows",
            value: function() {
                this.dispatch("updateEditableRows")
            }
        }, {
            key: "dispatchUpdateEditableRows",
            value: function() {
                (0,
                b.default)(this.doDispatchUpdateEditableRows)
            }
        }, {
            key: "updateNodes",
            value: function() {
                this._IsStable = false,
                clearTimeout(this._UpdateNodesTimeout),
                this._UpdateNodesTimeout = setTimeout(this.doUpdateNodes, 1)
            }
        }, {
            key: "deleteSelection",
            value: function() {
                this.dispatch("delete"),
                this._Editor.captureJournalEntry(),
                this.updateFrameValues()
            }
        }, {
            key: "onKeyFrameDeleted",
            value: function(e) {
                this._RemovedKeyframes.push(e)
            }
        }, {
            key: "onKeyFrameAdded",
            value: function(e) {
                this._AddedKeyframes.push(e)
            }
        }, {
            key: "onKeyFramePropChanged",
            value: function(e, t, n, i, r) {
                if (!this._IsUndoOrRedo) {
                    var o = r ? this._KeyFrameSortPropertyChanges : this._KeyFramePropertyChanges
                      , a = o[e.refId];
                    a || (o[e.refId] = a = {
                        kf: e,
                        changes: {}
                    }),
                    (o = a.changes[t]) || (a.changes[t] = o = {
                        from: n
                    }),
                    o.to = i,
                    this._PositionDirty = true
                }
            }
        }, {
            key: "showKeyedNode",
            value: function(e) {
                this._HiddenKeyedNodeLookup[e.node.refId] && (delete this._HiddenKeyedNodeLookup[e.node.refId],
                this._KeyedNodeLookup[e.node.refId] = e,
                this._KeyedNodes.push(e),
                this.updateNodes())
            }
        }, {
            key: "hideKeyedNode",
            value: function(e) {
                this._HiddenKeyedNodeLookup[e.node.refId] = e;
                var t = this._KeyedNodes.indexOf(e);
                -1 != t && (this._KeyedNodes.splice(t, 1),
                delete this._KeyedNodeLookup[e.node.refId],
                this.doUpdateNodes())
            }
        }, {
            key: "getKeyedNode",
            value: function(e) {
                return this._KeyedNodeLookup[e.refId]
            }
        }, {
            key: "triggerEvents",
            value: function(e, t) {
                for (var n = 0; n < this._ActualKeyedNodes.length; n++) {
                    var i = this._ActualKeyedNodes[n];
                    i.node.constructor === c.default && i.triggerEvents(e, t)
                }
            }
        }, {
            key: "interpolate",
            value: function(e) {
                for (var t = 0; t < this._ActualKeyedNodes.length; t++) {
                    this._ActualKeyedNodes[t].interpolate(e)
                }
            }
        }, {
            key: "getOrMakeKeyedNode",
            value: function(e) {
                var t = this._KeyedNodeLookup[e.refId];
                return t || (t = this._HiddenKeyedNodeLookup[e.refId]) && (delete this._HiddenKeyedNodeLookup[e.refId],
                this._KeyedNodeLookup[e.refId] = t,
                this._KeyedNodes.push(t),
                this.updateNodes()),
                t || (t = this._KeyedNodeLookup[e.refId] = new v.default(e,this),
                this._KeyedNodes.push(t),
                this.updateNodes()),
                t
            }
        }, {
            key: "toggleKey",
            value: function(e, t) {
                var n = this.getKeyedNode(e);
                if (n && n.getKeyFrames(t).removeKey())
                    return this.updateFrameValues(),
                    false;
                this.setKey(e, t)
            }
        }, {
            key: "setKey",
            value: function(e, t) {
                var n = this.getOrMakeKeyedNode(e).getKeyFrames(t);
                if (n) {
                    n.setKey();
                    var i = this._Changes[e.refId];
                    i && delete i.delta[t]
                }
            }
        }, {
            key: "setOrderKey",
            value: function() {
                var e = this.getOrMakeKeyedNode(t.OrderObject).getKeyFrames("frameDrawOrder")
                  , n = e.getValue(this._Position);
                n || (n = {});
                var i = this._Actor.drawOrder
                  , r = true
                  , o = false
                  , a = void 0;
                try {
                    for (var s, l = i.images[Symbol.iterator](); !(r = (s = l.next()).done); r = true) {
                        var u = s.value;
                        n[u.refId] = {
                            obj: u,
                            v: u.frameDrawOrder
                        }
                    }
                } catch (e) {
                    o = true,
                    a = e
                } finally {
                    try {
                        !r && l.return && l.return()
                    } finally {
                        if (o)
                            throw a
                    }
                }
                e.updateValue(this._Position, n),
                this.orderKeyState = 2
            }
        }, {
            key: "change",
            value: function(e, n, i, r) {
                var o = this._AutoKey
                  , a = this._Position;
                if (void 0 !== r && (a = r,
                o = true),
                null !== i) {
                    if (!o || this._IsUndoOrRedo) {
                        var s = this._Changes[e.refId];
                        s || (s = this._Changes[e.refId] = {
                            obj: e,
                            delta: {}
                        }),
                        s.delta[n] = i,
                        e[n + "KS"] = 1,
                        "frameDrawOrder" == n && (this.orderKeyState = 1)
                    }
                    var l = null;
                    if (!this._IsUndoOrRedo && o) {
                        if ("frameDrawOrder" == n) {
                            var u = this.getOrMakeKeyedNode(t.OrderObject).getKeyFrames(n)
                              , c = u.getValue(a);
                            c || (c = {}),
                            c[e.refId] = {
                                obj: e,
                                v: i
                            },
                            l = u.updateValue(a, c),
                            0 == this.orderKeyState && (this.orderKeyState = 2)
                        } else {
                            l = this.getOrMakeKeyedNode(e).getKeyFrames(n).updateValue(a, i)
                        }
                        e[n + "KS"] = 2
                    }
                    return this.dispatch("keyedPropertyChange"),
                    l
                }
            }
        }, {
            key: "captureJournalEntry",
            value: function(e) {
                var t = {}
                  , n = this;
                this._Actor.root.all((function(e) {
                    var i = e.nullFrame()
                      , r = n._Changes[e.refId];
                    if (r && r.delta)
                        for (var o in r = r.delta,
                        i)
                            r && void 0 !== r[o] && (i[o] = r[o]);
                    t[e.refId] = {
                        item: e,
                        frame: i
                    }
                }
                ));
                var i = false;
                if (this._LastFullState)
                    for (var r in t) {
                        t[r].item;
                        var o = t[r].frame
                          , a = this._LastFullState[r];
                        if (a) {
                            a = a.frame;
                            var s = o;
                            for (var l in s) {
                                if (s[l] !== a[l]) {
                                    i = true;
                                    break
                                }
                            }
                            if (i)
                                break
                        }
                    }
                if ((i || this._AddedKeyframes.length > 0 || this._RemovedKeyframes.length > 0 || Object.keys(this._KeyFramePropertyChanges).length > 0 || Object.keys(this._KeyFrameSortPropertyChanges).length > 0 || this._OldFPS != this._FPS || this._OldDuration != this._Duration) && this._LastFullState && !e) {
                    var u = {
                        time: this._Position,
                        lastState: this._LastFullState,
                        currentState: t,
                        keyFrameSortPropertyChanges: this._KeyFrameSortPropertyChanges,
                        keyFramePropertyChanges: this._KeyFramePropertyChanges,
                        addedKeyframes: this._AddedKeyframes.slice(0),
                        removedKeyframes: this._RemovedKeyframes.slice(0),
                        fps: {
                            from: this._OldFPS,
                            to: this._FPS
                        },
                        duration: {
                            from: this._OldDuration,
                            to: this._Duration
                        }
                    };
                    return this._KeyFramePropertyChanges = {},
                    this._KeyFrameSortPropertyChanges = {},
                    this._AddedKeyframes.length = 0,
                    this._RemovedKeyframes.length = 0,
                    this._OldFPS = this._FPS,
                    this._OldDuration = this._Duration,
                    u
                }
                return this._LastFullState = t,
                null
            }
        }, {
            key: "updateOrderKeyState",
            value: function() {
                for (var e in this._Changes) {
                    if (void 0 !== this._Changes[e].delta.frameDrawOrder)
                        return void (this.orderKeyState = 1)
                }
                2 != this.orderKeyState && (this.orderKeyState = 0)
            }
        }, {
            key: "applyEntry",
            value: function(e, t) {
                this._IsUndoOrRedo = true;
                var n = [];
                if (e.keyFrameSortPropertyChanges)
                    for (var i in e.keyFrameSortPropertyChanges) {
                        var r = e.keyFrameSortPropertyChanges[i]
                          , o = r.kf
                          , a = r.changes;
                        for (var s in a) {
                            var l = a[s];
                            o["_" + s] = t ? l.from : l.to
                        }
                        -1 === n.indexOf(o.row) && n.push(o.row),
                        o.prv && (o.prv._Dirty = true),
                        o.nxt && (o.nxt._Dirty = true),
                        o._Dirty = true
                    }
                for (var u = t ? e.removedKeyframes : e.addedKeyframes, c = t ? e.addedKeyframes : e.removedKeyframes, d = 0; d < c.length; d++) {
                    var h = c[d];
                    h.row.remove(h)
                }
                for (var f = 0; f < u.length; f++) {
                    var p = u[f];
                    p.row.add(p),
                    -1 === n.indexOf(p.row) && n.push(p.row)
                }
                for (var y = 0; y < n.length; y++)
                    n[y].reSort();
                if (e.keyFramePropertyChanges)
                    for (var m in e.keyFramePropertyChanges) {
                        var v = e.keyFramePropertyChanges[m]
                          , g = v.kf
                          , _ = v.changes;
                        for (var b in _) {
                            var w = _[b];
                            g["_" + b] = t ? w.from : w.to
                        }
                        g.prv && (g.prv._Dirty = true),
                        g.nxt && (g.nxt._Dirty = true),
                        g._Dirty = true
                    }
                this._Position = e.time,
                this._PositionDirty = true;
                var O = t ? e.fps.from : e.fps.to;
                O != this._FPS && (this._FPS = O,
                this.dispatch("fpsChange"));
                var S = t ? e.duration.from : e.duration.to;
                if (S != this._OldDuration && (this._Duration = S,
                this.dispatch("durationChange")),
                this.updateFrameValues(),
                e.currentState)
                    for (var k in this._Changes = {},
                    e.currentState) {
                        var P = e.currentState[k]
                          , E = P.item
                          , T = P.frame;
                        for (var C in T) {
                            if (null !== T[C]) {
                                var x = T[C];
                                E[C] = x,
                                this.change(E, C, x)
                            } else
                                this.change(E, C, null)
                        }
                    }
                this._IsUndoOrRedo = false,
                this.dispatch("position", this._Position),
                this.dispatch("update"),
                this.updateOrderKeyState()
            }
        }, {
            key: "activateListeners",
            value: function(e, t) {
                var n = this;
                e.root.all((function(e) {
                    e.clearKeyStates();
                    var i = t ? e.addEventListener : e.removeEventListener
                      , r = e instanceof d.default
                      , o = r
                      , a = false
                      , s = false
                      , v = false
                      , b = false
                      , w = r
                      , O = r
                      , S = r
                      , k = false
                      , P = false
                      , E = false
                      , T = false;
                    switch (e instanceof _.default && (w = false,
                    o = false,
                    S = false,
                    b = true),
                    e.constructor) {
                    case f.default:
                        T = true;
                        break;
                    case m.default:
                        P = true;
                        break;
                    case u.default:
                        w = false,
                        o = false,
                        S = false;
                        break;
                    case l.default:
                        w = false,
                        o = false,
                        k = true,
                        S = false;
                        break;
                    case c.default:
                        w = false,
                        o = false,
                        S = false;
                        break;
                    case p.default:
                        w = true,
                        O = false,
                        o = false;
                        break;
                    case h.default:
                        a = true,
                        e.parent.constructor === h.default && (o = false);
                        break;
                    case y.default:
                        s = true,
                        e.useVertexDeform && (v = true),
                        E = e.asset instanceof g.default
                    }
                    w && (o && (i.call(e, "animatePosX", n.onAnimatePosX),
                    i.call(e, "animatePosY", n.onAnimatePosY)),
                    O && (i.call(e, "animateScaleX", n.onAnimateScaleX),
                    i.call(e, "animateScaleY", n.onAnimateScaleY),
                    i.call(e, "animateRotation", n.onAnimateRotation)),
                    t && (e.framePosX = e.translation[0],
                    e.framePosY = e.translation[1],
                    e.frameScaleX = e.scale[0],
                    e.frameScaleY = e.scale[1],
                    e.frameRotation = e.rotation)),
                    S && i.call(e, "animateOpacity", n.onAnimateOpacity),
                    T && i.call(e, "animateActiveChild", n.onAnimateActiveChild),
                    E && i.call(e, "animateSequence", n.onAnimateSequence),
                    t && S && (e.frameOpacity = e.opacity),
                    t && E && (e.frameSequence = e.sequence),
                    s && (i.call(e, "animateDrawOrder", n.onAnimateDrawOrder),
                    t && (e.frameDrawOrder = e.drawOrder)),
                    v && i.call(e, "animateVertexDeform", n.onAnimateVertexDeform),
                    a && (i.call(e, "animateLength", n.onAnimateLength),
                    t && (e.frameLength = e.length)),
                    b && (i.call(e, "animateStrength", n.onAnimateStrength),
                    t && (e.frameStrength = e.strength)),
                    k && (i.call(e, "animateIntValue", n.onAnimateIntValue),
                    i.call(e, "animateFloatValue", n.onAnimateFloatValue),
                    i.call(e, "animateStringValue", n.onAnimateStringValue),
                    i.call(e, "animateBooleanValue", n.onAnimateBooleanValue),
                    t && (e.frameIntValue = e.intValue,
                    e.frameFloatValue = e.floatValue,
                    e.frameStringValue = e.stringValue,
                    e.frameBooleanValue = e.booleanValue)),
                    P && (i.call(e, "animateCollisionEnabled", n.onAnimateIsCollisionEnabled),
                    t && (e.frameIsCollisionEnabled = e.isCollisionEnabled))
                }
                ))
            }
        }, {
            key: "updateFrameValues",
            value: function() {
                this._ListeningActor && (this._ListeningActor.stopAnimations(),
                this._ListeningActor.updateAnimations([{
                    animation: this,
                    mix: 1,
                    position: this._Position
                }]))
            }
        }, {
            key: "advance",
            value: function(e, t) {
                var n = false;
                if (this._IsPlaying) {
                    var i = this._Position;
                    this._Position += e;
                    var r = this._Duration;
                    if (this._IsWorkAreaActive && (r = this._WorkAreaEnd),
                    this._Position >= r)
                        if (this._Loop || t) {
                            var o = this._Position - r;
                            this._Position = o + (this._IsWorkAreaActive ? this._WorkAreaStart : 0),
                            this.triggerEvents(i, r),
                            this.triggerEvents((this._IsWorkAreaActive ? this._WorkAreaStart : 0) - .001, this._Position)
                        } else
                            this._Position = r,
                            this.isPlaying = false,
                            this._PositionDirty = false,
                            n = true,
                            this.triggerEvents(i, this._Position);
                    else
                        this.triggerEvents(i, this._Position)
                }
                var a = this._IsPlaying || this._PositionDirty;
                return (this._IsPlaying || this._PositionDirty) && (this._PositionDirty = false,
                n = true),
                n && this.dispatch("position", this._Position),
                a
            }
        }, {
            key: "showPlayhead",
            value: function() {
                if (this._Position < this._DisplayStart) {
                    var e = this._Position - this._DisplayStart;
                    this._DisplayStart += e,
                    this._DisplayEnd += e,
                    this.dispatch("update"),
                    this.dispatch("scrollChange")
                } else if (this._Position > this._DisplayEnd) {
                    var t = this._Position - this._DisplayEnd;
                    this._DisplayStart += t,
                    this._DisplayEnd += t,
                    this.dispatch("update"),
                    this.dispatch("scrollChange")
                }
            }
        }, {
            key: "moveFrames",
            value: function(e) {
                var t = this._Position + e / this._FPS;
                this.position = Math.round(t * this._FPS) / this._FPS,
                this.showPlayhead()
            }
        }, {
            key: "moveKeyFrames",
            value: function(e) {
                for (var t = this.position, n = null, i = 999999999, r = this._ShowSelectionOnly, o = 0; o < this._ActualKeyedNodes.length; o++) {
                    var a = this._ActualKeyedNodes[o]
                      , s = a.node;
                    if (!r || s.stageItem.isSelected)
                        for (var l = a.propsList, u = 0; u < l.length; u++)
                            for (var c = l[u].keyFrames, d = 0; d < c.length; d++) {
                                var h = c[d];
                                if (e && h.time > t) {
                                    var f = h.time - t;
                                    f < i && (i = f,
                                    n = h)
                                } else if (!e && h.time < t) {
                                    var p = t - h.time;
                                    p < i && (i = p,
                                    n = h)
                                }
                            }
                }
                n && (this.position = n.time)
            }
        }, {
            key: "setActor",
            value: function(e, t) {
                if (e || (this.isVisible = false),
                t && (this._Editor = t),
                this.updateNodes(),
                this._ListeningActor != e) {
                    if (this._ListeningActor && this.activateListeners(this._ListeningActor, false),
                    this._ListeningActor = e,
                    e && this.activateListeners(e, true),
                    this._LastFullState || this._Editor.captureJournalEntry(),
                    null != this._ListeningActor)
                        for (var n in this._Changes) {
                            var i = this._Changes[n];
                            if (i && i.delta)
                                for (var r in i.delta)
                                    i.obj[r] = i.delta[r]
                        }
                    this.dispatch("activeChange")
                }
            }
        }, {
            key: "read",
            value: function(e, n) {
                var i = this
                  , r = n.name;
                if (void 0 !== r && this.setName(r),
                void 0 !== (r = n.order) ? this._Order = r : e.whenNodesLoaded((function() {
                    i._Order = e.animations.indexOf(i)
                }
                )),
                void 0 !== (r = n.id) && (this._ID = r,
                this._ID >= t.ID && (t.ID = this._ID + 1)),
                void 0 !== (r = n.fps) && (this._OldFPS = this._FPS = r),
                void 0 !== (r = n.duration) && (this._OldDuration = this._Duration = r),
                void 0 !== (r = n.displayStart) && (this._DisplayStart = r),
                void 0 !== (r = n.displayEnd) && (this._DisplayEnd = r),
                void 0 !== (r = n.position) && (this._Position = r),
                void 0 !== (r = n.workAreaStart) && (this._WorkAreaStart = r),
                void 0 !== (r = n.workAreaEnd) && (this._WorkAreaEnd = r),
                void 0 !== (r = n.isWorkAreaActive) && (this._IsWorkAreaActive = r),
                void 0 !== (r = n.loop) && (this._Loop = r),
                r = n.nodes) {
                    for (var o in r) {
                        var a = o == t.OrderObject.refId ? t.OrderObject : e.getNode(o);
                        if (a) {
                            var s = this._KeyedNodeLookup[a.refId] = new v.default(a,this);
                            this._KeyedNodes.push(s),
                            s.deserialize(e, r[o])
                        }
                    }
                    this._ActualKeyedNodes.length = 0;
                    for (var l = 0; l < this._KeyedNodes.length; l++) {
                        var u = this._KeyedNodes[l];
                        this._ActualKeyedNodes.push(u)
                    }
                    this._ActualKeyedNodes.sort((function(e, t) {
                        return e.node.treeIndex - t.node.treeIndex
                    }
                    )),
                    this.updateNodes()
                }
                this.clampWorkArea()
            }
        }, {
            key: "clampWorkArea",
            value: function() {
                this._WorkAreaStart = Math.min(this._Duration, Math.max(0, this._WorkAreaStart)),
                this._WorkAreaEnd = Math.min(this._Duration, Math.max(1 / this._FPS, this._WorkAreaEnd)),
                this._WorkAreaStart > this._WorkAreaEnd && (this._WorkAreaStart = this._WorkAreaEnd - 1 / this._FPS)
            }
        }, {
            key: "clampDisplayArea",
            value: function() {
                var e = this._DisplayStart
                  , t = this._DisplayEnd;
                return this._DisplayStart = Math.min(this._Duration, Math.max(0, this._DisplayStart)),
                this._DisplayEnd = Math.min(this._Duration, Math.max(1 / this._FPS, this._DisplayEnd)),
                this._DisplayStart > this._DisplayEnd && (this._DisplayStart = this._DisplayEnd - 1 / this._FPS),
                e != this._DisplayStart || t != this._DisplayEnd
            }
        }, {
            key: "serialize",
            value: function() {
                for (var e = {
                    displayEnd: this._DisplayEnd,
                    displayStart: this._DisplayStart,
                    duration: this._Duration,
                    fps: this._FPS,
                    id: this._ID,
                    isWorkAreaActive: this._IsWorkAreaActive,
                    loop: this._Loop,
                    name: this.name,
                    order: this._Order,
                    nodes: {},
                    position: this._Position,
                    workAreaEnd: this._WorkAreaEnd,
                    workAreaStart: this._WorkAreaStart
                }, t = 0; t < this._ActualKeyedNodes.length; t++) {
                    var n = this._ActualKeyedNodes[t];
                    e.nodes[n.node.refId] = n.serialize()
                }
                return e
            }
        }, {
            key: "serializeInteractive",
            value: function() {
                return {
                    name: this.name,
                    order: this.order
                }
            }
        }, {
            key: "copy",
            value: function() {
                var e = {};
                return this.dispatch("copy", e),
                {
                    keyframes: e
                }
            }
        }, {
            key: "paste",
            value: function(e) {
                var n = this;
                if (console.log("PASTE", e, e && e.keyframes),
                e.keyframes) {
                    var i = {};
                    this._Actor.root.all((function(e) {
                        i[e.refId] = e
                    }
                    ));
                    var r = e.keyframes.nodes;
                    for (var o in r) {
                        var a = void 0;
                        if (a = o === t.OrderObject.refId ? this._Actor.root : i[o]) {
                            var s = r[o];
                            for (var l in s)
                                for (var u = s[l], c = function(t) {
                                    var r = u[t]
                                      , o = r.v;
                                    if ("frameActiveChild" === l)
                                        n._Actor.root.all((function(e) {
                                            if (e.refId === o)
                                                return o = e,
                                                false
                                        }
                                        ));
                                    else {
                                        if ("frameDrawOrder" === l && o.constructor === Object) {
                                            for (var s in o) {
                                                var c = i[s];
                                                c && n.change(c, l, o[s], n._Position + (r.t - e.keyframes.minTime))
                                            }
                                            return "continue"
                                        }
                                        o.constructor === Array && (o = new Float32Array(o))
                                    }
                                    var d = n.change(a, l, o, n._Position + (r.t - e.keyframes.minTime));
                                    d && (d._Type = r.i,
                                    d.type = r.i,
                                    void 0 !== r.if && Number.isFinite(r.if) && (d._InFactor = r.if),
                                    void 0 !== d.iv && Number.isFinite(r.iv) && (d._InValue = r.iv),
                                    void 0 !== r.of && Number.isFinite(r.of) && (d._OutFactor = r.of),
                                    void 0 !== r.ov && Number.isFinite(r.ov) && (d._OutValue = r.ov),
                                    d._Dirty = true)
                                }, d = 0; d < u.length; d++)
                                    c(d)
                        }
                    }
                    this.doUpdateNodes(),
                    this.updateFrameValues(),
                    this._Editor.captureJournalEntry()
                }
            }
        }, {
            key: "setPosition",
            value: function(e, t) {
                if ((e = Math.min(Math.max(0, e), this._Duration)) != this._Position) {
                    if (!t) {
                        for (var n in this._Changes) {
                            var i = this._Changes[n];
                            if (i && i.delta)
                                for (var r in i.delta)
                                    i.obj[r + "KS"] = 0
                        }
                        this.orderKeyState = 0,
                        this._Changes = {},
                        this._Editor.captureJournalEntry()
                    }
                    this._Position = e,
                    this._PositionDirty = true
                }
            }
        }, {
            key: "setRange",
            value: function(e, t, n) {
                this._DisplayStart = e,
                this._DisplayEnd = t,
                n && this.clampDisplayArea(),
                this.dispatch("update"),
                this.dispatch("scrollChange")
            }
        }, {
            key: "getFpsWithDivisor",
            value: function(e) {
                return e / Math.round(1 / this._FPS * e)
            }
        }, {
            key: "order",
            get: function() {
                return this._Order
            },
            set: function(e) {
                e !== this._Order && (this._Order = e,
                this.dispatch("orderChange"))
            }
        }, {
            key: "editor",
            get: function() {
                return this._Editor
            }
        }, {
            key: "isStable",
            get: function() {
                return this._IsStable
            }
        }, {
            key: "isVisible",
            get: function() {
                return this._IsVisible
            },
            set: function(e) {
                this._IsVisible != e && (this._IsVisible = e,
                this.dispatch("visibilityChange"))
            }
        }, {
            key: "disableVisibilityToggle",
            get: function() {
                return true
            }
        }, {
            key: "visibilityItem",
            get: function() {
                return this
            }
        }, {
            key: "isEditingCurves",
            get: function() {
                return this._IsEditingCurves
            },
            set: function(e) {
                if (this._IsEditingCurves != e) {
                    if (e)
                        for (var t = 0; t < this._SelectedItems.length; t++) {
                            var n = this._SelectedItems[t];
                            n.group && (n.group.isExpanded = true)
                        }
                    this._IsEditingCurves = e,
                    this.dispatch("update"),
                    this.dispatch("isEditingCurvesChange", e)
                }
            }
        }, {
            key: "isPlaying",
            get: function() {
                return this._IsPlaying
            },
            set: function(e) {
                this._IsPlaying != e && (this._IsPlaying = e,
                this._IsPlaying ? this._Actor.addPlayingAnimation(this) : this._Actor.removePlayingAnimation(this),
                e && (this._IsWorkAreaActive && (this._Position < this._WorkAreaStart || this._Position >= this._WorkAreaEnd) ? this._Position = this._WorkAreaStart : this._Position >= this._Duration && (this._Position = 0)),
                this.dispatch("play", this._IsPlaying),
                this.dispatch("update"))
            }
        }, {
            key: "showSelectionOnly",
            get: function() {
                return this._ShowSelectionOnly
            },
            set: function(e) {
                this._ShowSelectionOnly != e && (this._ShowSelectionOnly = e,
                this.updateEditableKeyedNodes(),
                this.dispatch("update"),
                this.dispatch("showSelectionOnlyChange", e))
            }
        }, {
            key: "isActive",
            get: function() {
                return null !== this._ListeningActor
            }
        }, {
            key: "loop",
            get: function() {
                return this._Loop
            },
            set: function(e) {
                this._Loop != e && (this._Loop = e,
                this.dispatch("update"),
                this.dispatch("loopChange", e))
            }
        }, {
            key: "actor",
            get: function() {
                return this._Actor
            }
        }, {
            key: "autoKey",
            get: function() {
                return this._AutoKey
            },
            set: function(e) {
                this._AutoKey = e
            }
        }, {
            key: "duration",
            get: function() {
                return this._Duration
            },
            set: function(e) {
                this._Duration != e && (this._OldDuration = this._Duration,
                this._Duration = e,
                this.clampWorkArea(),
                this.clampDisplayArea(),
                this._Editor.captureJournalEntry(),
                this.dispatch("update"),
                this.dispatch("scrollChange"))
            }
        }, {
            key: "displayStart",
            get: function() {
                return this._DisplayStart
            },
            set: function(e) {
                this._DisplayStart != e && (this._DisplayStart = e,
                this.dispatch("update"),
                this.dispatch("scrollChange"))
            }
        }, {
            key: "displayEnd",
            get: function() {
                return this._DisplayEnd
            },
            set: function(e) {
                this._DisplayEnd != e && (this._DisplayEnd = e,
                this.dispatch("update"),
                this.dispatch("scrollChange"))
            }
        }, {
            key: "workAreaStart",
            get: function() {
                return this._WorkAreaStart
            },
            set: function(e) {
                e = Math.round(e * this._FPS) / this._FPS,
                e = Math.min(this._WorkAreaEnd - 1 / this._FPS, Math.max(0, e)),
                this._WorkAreaStart != e && (this._WorkAreaStart = e,
                this.dispatch("update"),
                this.dispatch("scrollChange"))
            }
        }, {
            key: "workAreaEnd",
            get: function() {
                return this._WorkAreaEnd
            },
            set: function(e) {
                e = Math.round(e * this._FPS) / this._FPS,
                e = Math.min(this._Duration, Math.max(this._WorkAreaStart + 1 / this._FPS, e)),
                this._WorkAreaEnd != e && (this._WorkAreaEnd = e,
                this.dispatch("update"),
                this.dispatch("scrollChange"))
            }
        }, {
            key: "isWorkAreaActive",
            get: function() {
                return this._IsWorkAreaActive
            },
            set: function(e) {
                this._IsWorkAreaActive != e && (this._IsWorkAreaActive = e,
                e && this.clampWorkArea(),
                this.dispatch("update"),
                this.dispatch("isWorkAreaActiveChange", e))
            }
        }, {
            key: "fps",
            get: function() {
                return this._FPS
            },
            set: function(e) {
                this._FPS != e && (this._OldFPS = this._FPS,
                this._FPS = e,
                this._Editor.captureJournalEntry(),
                this.dispatch("update"),
                this.dispatch("scrollChange"),
                this.dispatch("fpsChange"))
            }
        }, {
            key: "refId",
            get: function() {
                return this._ID
            }
        }, {
            key: "position",
            get: function() {
                return this._Position
            },
            set: function(e) {
                this.setPosition(e, false)
            }
        }, {
            key: "orderKeyState",
            get: function() {
                return this._OrderKeyState
            },
            set: function(e) {
                this._OrderKeyState != e && (this._OrderKeyState = e,
                this.dispatch("keyState"))
            }
        }, {
            key: "editableKeyedNodes",
            get: function() {
                return this._EditableKeyedNodes
            }
        }, {
            key: "keyedNodes",
            get: function() {
                return this._ActualKeyedNodes
            }
        }, {
            key: "selectedItems",
            get: function() {
                return this._SelectedItems
            }
        }]),
        t
    }(a.default)).prototype, "doUpdateNodes", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "doUpdateNodes"), i.prototype),
    O(i.prototype, "doDispatchUpdateEditableRows", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "doDispatchUpdateEditableRows"), i.prototype),
    i);
    t.default = S,
    S.KeyFrameLocation = function(e, t, n, i) {
        for (var r, o; n <= i; )
            if ((o = t[r = n + i >> 1].time) < e)
                n = r + 1;
            else {
                if (!(o > e))
                    return r;
                i = r - 1
            }
        return n
    }
    ,
    S.OrderObject = {
        refId: "ORDER",
        treeIndex: Number.MAX_VALUE,
        name: "Draw Order",
        blockExpand: true
    },
    S.ID = 9e3
}
, , , , , , , , , , , , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = (a(n(1)),
    n(2))
      , o = a(n(203));
    function a(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var s = [1, 1, 1, .8]
      , l = [198 / 255, 198 / 255, 198 / 255, .5]
      , u = [1, 1, 1, 1]
      , c = [0, 139 / 255, 1, 1]
      , d = [1, 1, 1, 1]
      , h = [198 / 255, 198 / 255, 198 / 255, 1]
      , f = [198 / 255, 0, 0, 1]
      , p = [1, 0, 0, 1]
      , y = function(e) {
        function t(e, n, i, o) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var a = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, null));
            return a._WorldTransform = e,
            a._InverseWorldTransform = n,
            a._DeformIdx = o,
            a._DeformData = i,
            a._WorldPosition = r.vec2.create(),
            a._Position = r.vec2.create(),
            a._IsDeformer = !!i,
            a._InverseBoneTransform = null,
            a.drawAfterSelections = true,
            a
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "onSelectedChange",
            value: function(e) {
                e && this._IsDeformer && this.stage.selectItem(this.parent, true)
            }
        }, {
            key: "cleanup",
            value: function() {}
        }, {
            key: "customHitDetectEarly",
            value: function(e, t) {
                var n = e - this._WorldPosition[0]
                  , i = t - this._WorldPosition[1]
                  , r = this.stage.scale * this.stage.screenScale;
                return (n * n + i * i) * r * r <= 100
            }
        }, {
            key: "customRectIntsersect",
            value: function(e) {
                return this._WorldPosition[0] >= e[0][0] && this._WorldPosition[0] <= e[2][0] && this._WorldPosition[1] >= e[0][1] && this._WorldPosition[1] <= e[2][1]
            }
        }, {
            key: "draw",
            value: function(e, t) {
                if (!t && !this.isSelected) {
                    var n = this.renderViewTransform
                      , i = this.stageContext;
                    r.mat2d.mul(n, n, i.scaleTransform);
                    var o = this.willDelete;
                    e.drawColor(n, i.vertexBuffer, i.indexBuffer, 1, o ? f : l),
                    e.drawThickLine(n, i.edgeLine, .5, 1 / this.stage.scale, o ? p : s)
                }
            }
        }, {
            key: "drawSelection",
            value: function(e, t) {
                var n = this.renderViewTransform
                  , i = this.stageContext;
                r.mat2d.mul(n, n, i.scaleTransform);
                var o = this.willDelete;
                e.drawColor(n, i.vertexBuffer, i.indexBuffer, 1, o ? f : this.isSelected ? c : h),
                e.drawThickLine(n, i.edgeLine, .5 / this.stage.scale, 1, o ? p : this.isSelected ? u : d)
            }
        }, {
            key: "setDeformBuffer",
            value: function(e) {
                this._DeformData = e
            }
        }, {
            key: "setBoneTransform",
            value: function(e) {
                this._InverseBoneTransform = e ? r.mat2d.invert(r.mat2d.create(), e) : null
            }
        }, {
            key: "position",
            get: function() {
                return this._Position
            },
            set: function(e) {
                r.vec2.copy(this._Position, e),
                r.vec2.transformMat2d(this._WorldPosition, this._Position, this._WorldTransform),
                this.setTranslation(this._WorldPosition)
            }
        }, {
            key: "worldPosition",
            get: function() {
                return this._WorldPosition
            },
            set: function(e) {
                r.vec2.copy(this._WorldPosition, e),
                r.vec2.transformMat2d(this._Position, this._WorldPosition, this._InverseWorldTransform),
                this.setTranslation(this._WorldPosition)
            }
        }, {
            key: "isDeformer",
            get: function() {
                return this._IsDeformer
            }
        }, {
            key: "deformWorld",
            set: function(e) {
                if (r.vec2.copy(this._WorldPosition, e),
                r.vec2.transformMat2d(this._Position, this._WorldPosition, this._InverseWorldTransform),
                this.setTranslation(this._WorldPosition),
                this._IsDeformer) {
                    var t = this._Position;
                    this._InverseBoneTransform && (t = r.vec2.transformMat2d(r.vec2.create(), this._WorldPosition, this._InverseBoneTransform),
                    r.vec2.transformMat2d(t, t, this._InverseWorldTransform)),
                    this._DeformData[this._DeformIdx] = t[0],
                    this._DeformData[this._DeformIdx + 1] = t[1],
                    this.parent.node.markVertexDeformMeshDirty()
                }
            }
        }]),
        t
    }(o.default);
    t.default = y,
    y.initializeStageContext = function(e, t, n) {
        var i = [0, 5, 5, 0, 0, -5, -5, 0];
        t.selectionPoints = i,
        t.selectionIndices = [0, 1, 2, 2, 3, 0];
        for (var o = [], a = [0, 0], s = [], l = 2 * Math.PI / 10, u = 5 * Math.sin(.25 * Math.PI), c = 0, d = 0; d < 10; d++) {
            var h = Math.cos(c) * u
              , f = Math.sin(c) * u;
            o.push([h, f]),
            a.push(h, f),
            c += l,
            s.push(0, d + 1, d + 2 > 10 ? 1 : d + 2)
        }
        t.edgeLine = e.makeThickLine(o, true),
        t.vertexBuffer = e.makeVertexBuffer(a),
        t.indexBuffer = e.makeIndexBuffer(s),
        n.setLayerRenderExtensions(5, {
            context: t,
            scaleTransform: r.mat2d.create(),
            drawPrep: function(e, t, n) {
                if (!n.willSelectionsDraw)
                    return [];
                var i = 1 / n.scale * n.screenScale;
                return this.context.renderScale = i,
                r.mat2d.fromScaling(this.scaleTransform, [i, i]),
                this.context.scaleTransform = this.scaleTransform,
                e
            }
        })
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = u(n(1)), a = u(n(203)), s = u(n(384)), l = u(n(397));
    function u(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function c(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var d = [0, 1, 240 / 255, .6]
      , h = [0, 155 / 255, 140 / 255, .2]
      , f = [0, 235 / 255, 250 / 255, .9]
      , p = [1, 1, 1, 1]
      , y = (c((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n._ActorCollider = e,
            n._IsMeshDirty = true,
            n._IsTransformDirty = true,
            n._VertexBuffer = null,
            n._IndexBuffer = null,
            n._StrokeLine = null,
            n._IsEditing = false,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "markMeshDirty",
            value: function() {
                this._IsMeshDirty = true
            }
        }, {
            key: "updateTransform",
            value: function() {
                this._IsTransformDirty = true
            }
        }, {
            key: "circleHitDetect",
            value: function(e, t) {
                return Math.sqrt(e * e + t * t) <= this._ActorCollider.radius
            }
        }, {
            key: "lineHitDetect",
            value: function(e, t) {
                for (var n = this.node.lineData, i = n.length / 2, r = 0, o = 8 / this.stage.scale, a = o * o, s = 0; s < i - 1; s++) {
                    var u = [n[r], n[r + 1]]
                      , c = [n[r + 2], n[r + 3]];
                    if (r += 2,
                    l.default.squaredDistanceToSegment(u, c, e, t) < a)
                        return true
                }
                return false
            }
        }, {
            key: "updateMesh",
            value: function() {
                var e = []
                  , t = []
                  , n = [];
                this.customHitDetect = null,
                this.hitDetectOnMesh = true;
                var i = this.stage.graphics;
                switch (this._ActorCollider.shape) {
                case s.default.Shape.Rectangle:
                    var r = this._ActorCollider.width / 2
                      , o = this._ActorCollider.height / 2;
                    e.push([-r, o], [r, o], [r, -o], [-r, -o]),
                    t.push(-r, o, r, o, r, -o, -r, -o),
                    n.push(0, 1, 2, 2, 3, 0),
                    this.setMesh(t, 2, n);
                    break;
                case s.default.Shape.Triangle:
                    var a = this._ActorCollider.width / 2
                      , l = this._ActorCollider.height / 2;
                    e.push([-a, -l], [0, l], [a, -l]),
                    t.push(-a, -l, 0, l, a, -l),
                    n.push(0, 1, 2),
                    this.setMesh(t, 2, n);
                    break;
                case s.default.Shape.Circle:
                    var u = this._ActorCollider.radius
                      , c = this._ActorCollider.radius;
                    this.setMesh([-u, c, u, c, u, -c, -u, -c], 2, [0, 1, 2, 2, 3, 0]),
                    this.customHitDetect = this.circleHitDetect,
                    this.hitDetectOnMesh = false;
                    for (var d = this._ActorCollider.radius, h = Math.ceil(Math.min(100, Math.max(20, 2 * Math.PI * d / 10))), f = 2 * Math.PI / h, p = 0, y = -1, m = 0; m < h + 1; m++) {
                        if (m < h) {
                            var v = Math.cos(p) * d
                              , g = Math.sin(p) * d;
                            e.push([v, g])
                        }
                        t.push(0, 0, Math.cos(p) * d, Math.sin(p) * d);
                        var _ = 2 * m;
                        -1 != y && (n.push(_, _ + 1, y),
                        n.push(_ + 1, y, y + 1)),
                        y = _,
                        p += f
                    }
                    break;
                case s.default.Shape.Polygon:
                    var b = this.node.meshData;
                    if (b) {
                        for (var w = b.loverts.length / 2, O = [], S = 0; S < w; S++)
                            O.push(S);
                        this.setMesh(b.loverts, 2, b.lotris, O),
                        w = b.verts.length / 4;
                        for (var k = [], P = 0, E = 0; E < w; E++) {
                            var T = b.verts[P]
                              , C = b.verts[P + 1];
                            k.push(T, C),
                            P += 4
                        }
                        t = k,
                        n = b.tris;
                        var x = b.editor.c;
                        w = x.length / 2,
                        P = 0;
                        for (var I = 0; I < w; I++)
                            e.push([x[P], x[P + 1]]),
                            P += 2
                    }
                    break;
                case s.default.Shape.Line:
                    for (var D = this.node.lineData, M = [], A = D.length / 2, j = 0, L = 0; L < A; L++)
                        M.push([D[j], D[j + 1]]),
                        j += 2;
                    this._StrokeLine = i.makeThickLine(M, false),
                    this.setMesh(D, 2),
                    this.customHitDetect = this.lineHitDetect,
                    this.hitDetectOnMesh = false
                }
                e.length && (this._StrokeLine = i.makeThickLine(e, true)),
                0 === t.length ? this._VertexBuffer && (this._VertexBuffer.dispose(),
                this._IndexBuffer.dispose(),
                this._VertexBuffer = null,
                this._IndexBuffer = null) : this._VertexBuffer ? (this._VertexBuffer.update(t),
                this._IndexBuffer.update(n)) : (this._VertexBuffer = i.makeVertexBuffer(t),
                this._IndexBuffer = i.makeIndexBuffer(n))
            }
        }, {
            key: "onAddedToStage",
            value: function(e) {
                this._ActorCollider.addEventListener("shapeChanged", this.markMeshDirty),
                this._ActorCollider.addEventListener("sizeChanged", this.markMeshDirty),
                this._ActorCollider.addEventListener("worldTransform", this.updateTransform)
            }
        }, {
            key: "onRemovedFromStage",
            value: function(e) {
                this._ActorCollider.removeEventListener("shapeChanged", this.markMeshDirty),
                this._ActorCollider.removeEventListener("sizeChanged", this.markMeshDirty),
                this._ActorCollider.removeEventListener("worldTransform", this.updateTransform)
            }
        }, {
            key: "draw",
            value: function(e, t, n) {
                if (!this._IsEditing && (this._IsTransformDirty && (this._IsTransformDirty = false,
                this.renderTransform = this._ActorCollider.worldTransform),
                this._IsMeshDirty && (this._IsMeshDirty = false,
                this.updateMesh()),
                !t && !n)) {
                    var i = this.renderViewTransform;
                    this._VertexBuffer && e.drawColor(i, this._VertexBuffer, this._IndexBuffer, 1, this._ActorCollider.isCollisionEnabled ? d : h),
                    this._StrokeLine && e.drawThickLine(i, this._StrokeLine, .5, 1, f)
                }
            }
        }, {
            key: "drawSelection",
            value: function(e, t) {
                if (!this._IsEditing) {
                    var n = this.renderViewTransform;
                    this._VertexBuffer && e.drawColor(n, this._VertexBuffer, this._IndexBuffer, 1, this._ActorCollider.isCollisionEnabled ? d : h),
                    this._StrokeLine && e.drawThickLine(n, this._StrokeLine, .5, 1, p)
                }
            }
        }, {
            key: "isEditing",
            get: function() {
                return this._IsEditing
            },
            set: function(e) {
                this._IsEditing = e
            }
        }]),
        t
    }(a.default)).prototype, "markMeshDirty", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "markMeshDirty"), i.prototype),
    c(i.prototype, "updateTransform", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "updateTransform"), i.prototype),
    c(i.prototype, "circleHitDetect", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "circleHitDetect"), i.prototype),
    c(i.prototype, "lineHitDetect", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "lineHitDetect"), i.prototype),
    i);
    t.default = y,
    y.initializeStageContext = function(e, t) {}
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = (a(n(1)),
    n(2))
      , o = a(n(203));
    a(n(201)),
    a(n(237)),
    a(n(398));
    function a(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var s = [198 / 255, 198 / 255, 198 / 255, .5]
      , l = [0, 139 / 255, 1, .8]
      , u = [198 / 255, 198 / 255, 198 / 255, 1]
      , c = [1, 185 / 255, 0, 1]
      , d = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n._VertexBuffer = null,
            n._IndexBuffer = null,
            n._IsConnected = false,
            n._HasCustomFillColor = false,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "onAddedToStage",
            value: function() {
                this.setMesh(this.stageContext.points, 2, this.stageContext.indices)
            }
        }, {
            key: "render",
            value: function(e, t, n) {
                var i = r.mat2d.create();
                i[0] = (this.node.length - 10) / h,
                i[4] = 5,
                this.renderTransform = r.mat2d.multiply(i, this.node.worldTransform, i);
                var o = this.renderViewTransform
                  , a = this.stageContext
                  , d = this._IsConnected ? c : this._FillColor || s;
                n ? d = l : t && (d = u),
                e.drawColor(o, a.vertexBuffer, a.indexBuffer, 1, d)
            }
        }, {
            key: "draw",
            value: function(e, t, n) {
                n || this.render(e, t, n)
            }
        }, {
            key: "drawSelection",
            value: function(e, t) {
                this.isSelected && this.render(e, t, true)
            }
        }, {
            key: "updateConnectionState",
            value: function() {
                var e = this.node && this.node.skins;
                if (e) {
                    for (var t = 0; t < e.length; t++)
                        if (e[t].stageItem.isSelected)
                            return void (this.isConnected = true);
                    this.isConnected = false
                } else
                    this.isConnected = false
            }
        }, {
            key: "isConnected",
            get: function() {
                return this._IsConnected
            },
            set: function(e) {
                this._IsConnected != e && (this._IsConnected = e,
                this.stage && this.stage.redraw())
            }
        }, {
            key: "fillColor",
            get: function() {
                return this._FillColor
            },
            set: function(e) {
                this._FillColor = e || null
            }
        }]),
        t
    }(o.default);
    t.default = d;
    var h = 5;
    d.initializeStageContext = function(e, t) {
        var n = [0, -h / 2, h, -h / 2, h, h / 2, 0, h / 2]
          , i = [0, 1, 2, 2, 3, 0];
        t.points = n,
        t.indices = i,
        t.vertexBuffer = e.makeVertexBuffer(n),
        t.indexBuffer = e.makeIndexBuffer(i)
    }
}
, , , , , , , , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }, a = u(n(443)), s = u(n(580)), l = u(n(1));
    function u(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var c, d, h, f, p, y, m = (i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.name = "Targeted Constraint",
            n._Target = null,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "updateDependencies",
            value: function(e) {
                this._Target && e.addDependency(this.parent, this._Target)
            }
        }, {
            key: "onTargetRemovedFromStage",
            value: function(e, t) {
                this.target && this.target.stageItem === t && (this.target = null)
            }
        }, {
            key: "onTargetOptionChanged",
            value: function() {}
        }, {
            key: "read",
            value: function(e, n) {
                o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "read", this).call(this, e, n);
                var i = n.target;
                if (i) {
                    var r = this;
                    e.whenNodesLoaded((function() {
                        r.target = e.getNode(i)
                    }
                    ))
                }
            }
        }, {
            key: "serializeProperties",
            value: function(e) {
                var n = o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeProperties", this).call(this, e);
                return this._Target ? n.target = this._Target.refId : delete n.target,
                n
            }
        }, {
            key: "serializeInteractive",
            value: function() {
                var e = o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeInteractive", this).call(this);
                return e.target = this._Target,
                e
            }
        }, {
            key: "target",
            get: function() {
                return this._Target
            },
            set: function(e) {
                if (this._Target !== e) {
                    if (e) {
                        var t = this._Actor.dependencyGraph;
                        if (t && (t.addDependency(this.parent, e),
                        !t.sort()))
                            throw t.removeDependency(this.parent, e),
                            new s.default(e)
                    }
                    this._Actor.markDependenciesDirty(),
                    this._Target && this._Target.stageItem.removeEventListener("removedFromStage", this.onTargetRemovedFromStage),
                    this._Target = e,
                    this._Target && this._Target.stageItem.addEventListener("removedFromStage", this.onTargetRemovedFromStage),
                    this.dispatch("targetChange")
                }
            }
        }], [{
            key: "constraintName",
            get: function() {
                return "Targeted Constraint"
            }
        }, {
            key: "targetName",
            get: function() {
                return "IK Target"
            }
        }]),
        t
    }(a.default),
    c = i.prototype,
    d = "onTargetRemovedFromStage",
    h = [l.default],
    f = Object.getOwnPropertyDescriptor(i.prototype, "onTargetRemovedFromStage"),
    p = i.prototype,
    y = {},
    Object.keys(f).forEach((function(e) {
        y[e] = f[e]
    }
    )),
    y.enumerable = !!y.enumerable,
    y.configurable = !!y.configurable,
    ("value"in y || y.initializer) && (y.writable = true),
    y = h.slice().reverse().reduce((function(e, t) {
        return t(c, d, e) || e
    }
    ), y),
    p && void 0 !== y.initializer && (y.value = y.initializer ? y.initializer.call(p) : void 0,
    y.initializer = void 0),
    void 0 === y.initializer && (Object.defineProperty(c, d, y),
    y = null),
    i);
    t.default = m
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = l(n(1)), a = n(2), s = l(n(203));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var u, c, d, h, f, p, y = [1, 1, 1, .8], m = [198 / 255, 198 / 255, 198 / 255, .5], v = [1, 1, 1, 1], g = [0, 139 / 255, 1, 1], _ = [1, 1, 1, 1], b = [198 / 255, 198 / 255, 198 / 255, 1], w = (i = function(e) {
        function t(e, n) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var i = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return i._WorldPosition = a.vec2.create(),
            i._IsIn = n,
            i
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "onAddedToStage",
            value: function() {
                this.node.addEventListener("transform", this.updatePosition),
                this.node.addEventListener("updateInOut", this.updatePosition),
                this.setMesh(this.stageContext.selectionPoints, 2, this.stageContext.selectionIndices),
                this.updatePosition()
            }
        }, {
            key: "onRemovedFromStage",
            value: function() {
                this.node.removeEventListener("transform", this.updatePosition),
                this.node.removeEventListener("updateInOut", this.updatePosition)
            }
        }, {
            key: "updatePosition",
            value: function() {
                var e = this.node
                  , t = e && e.jelly;
                if (t) {
                    var n = this._IsIn ? t.inPoint : t.outPoint;
                    if (n) {
                        a.vec2.transformMat2d(this._WorldPosition, n, e.worldTransform),
                        this.setTranslation(this._WorldPosition);
                        var i = a.mat2d.create();
                        i[4] = this._WorldPosition[0],
                        i[5] = this._WorldPosition[1],
                        this.renderTransform = i,
                        this.stage && this.stage.redraw()
                    }
                }
            }
        }, {
            key: "customHitDetectEarly",
            value: function(e, t) {
                var n = e - this._WorldPosition[0]
                  , i = t - this._WorldPosition[1]
                  , r = this.stage.scale * this.stage.screenScale;
                return (n * n + i * i) * r * r <= 100
            }
        }, {
            key: "customRectIntsersect",
            value: function(e) {
                return this._WorldPosition[0] >= e[0][0] && this._WorldPosition[0] <= e[2][0] && this._WorldPosition[1] >= e[0][1] && this._WorldPosition[1] <= e[2][1]
            }
        }, {
            key: "draw",
            value: function(e, t) {
                if (!t && !this.isSelected) {
                    var n = this.renderViewTransform
                      , i = this.stageContext;
                    a.mat2d.mul(n, n, i.scaleTransform);
                    var r = this._WorldPosition
                      , o = this._IsIn ? this.node.worldTranslation : this.node.tipWorldTranslation;
                    e.drawLine(this.stage.viewTransform, [r[0], r[1], o[0], o[1]], 1, m),
                    e.drawColor(n, i.vertexBuffer, i.indexBuffer, 1, m),
                    e.drawThickLine(n, i.edgeLine, .5, 1 / this.stage.scale, y)
                }
            }
        }, {
            key: "drawSelection",
            value: function(e, t) {
                var n = this.renderViewTransform
                  , i = this.stageContext;
                a.mat2d.mul(n, n, i.scaleTransform);
                var r = this._WorldPosition
                  , o = this._IsIn ? this.node.worldTranslation : this.node.tipWorldTranslation;
                e.drawLine(this.stage.viewTransform, [r[0], r[1], o[0], o[1]], 1, m),
                e.drawColor(n, i.vertexBuffer, i.indexBuffer, 1, this.isSelected ? g : b),
                e.drawThickLine(n, i.edgeLine, .5 / this.stage.scale, 1, this.isSelected ? v : _)
            }
        }, {
            key: "selectionPanelItem",
            get: function() {
                return this.node.stageItem
            }
        }, {
            key: "worldPosition",
            get: function() {
                return this._WorldPosition
            }
        }, {
            key: "isIn",
            get: function() {
                return this._IsIn
            }
        }, {
            key: "worldRotationTransform",
            get: function() {
                var e = this.node
                  , t = e && e.jelly;
                if (t) {
                    var n = this._IsIn ? t.inDirection : t.outDirection;
                    return a.vec2.transformMat2(a.vec2.create(), n, e.worldTransform)
                }
            }
        }]),
        t
    }(s.default),
    u = i.prototype,
    c = "updatePosition",
    d = [o.default],
    h = Object.getOwnPropertyDescriptor(i.prototype, "updatePosition"),
    f = i.prototype,
    p = {},
    Object.keys(h).forEach((function(e) {
        p[e] = h[e]
    }
    )),
    p.enumerable = !!p.enumerable,
    p.configurable = !!p.configurable,
    ("value"in p || p.initializer) && (p.writable = true),
    p = d.slice().reverse().reduce((function(e, t) {
        return t(u, c, e) || e
    }
    ), p),
    f && void 0 !== p.initializer && (p.value = p.initializer ? p.initializer.call(f) : void 0,
    p.initializer = void 0),
    void 0 === p.initializer && (Object.defineProperty(u, c, p),
    p = null),
    i);
    t.default = w,
    w.initializeStageContext = function(e, t, n) {
        var i = [0, 7, 7, 0, 0, -7, -7, 0];
        t.selectionPoints = i,
        t.selectionIndices = [0, 1, 2, 2, 3, 0];
        for (var r = [], o = [0, 0], s = [], l = 2 * Math.PI / 10, u = 7 * Math.sin(.25 * Math.PI), c = 0, d = 0; d < 10; d++) {
            var h = Math.cos(c) * u
              , f = Math.sin(c) * u;
            r.push([h, f]),
            o.push(h, f),
            c += l,
            s.push(0, d + 1, d + 2 > 10 ? 1 : d + 2)
        }
        t.edgeLine = e.makeThickLine(r, true),
        t.vertexBuffer = e.makeVertexBuffer(o),
        t.indexBuffer = e.makeIndexBuffer(s),
        n.setLayerRenderExtensions(8, {
            context: t,
            scaleTransform: a.mat2d.create(),
            drawPrep: function(e, t, n) {
                if (!n.willSelectionsDraw || !e.length)
                    return [];
                var i = 1 / n.scale * n.screenScale;
                return this.context.renderScale = i,
                a.mat2d.fromScaling(this.scaleTransform, [i, i]),
                this.context.scaleTransform = this.scaleTransform,
                e
            }
        })
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }
      , o = u(n(464))
      , a = u(n(369))
      , s = u(n(444))
      , l = u(n(11));
    function u(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var c = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n._Bitmap = null,
            n._Texture = null,
            n._IsFilteringEnabled = true,
            n._ShowBorder = true,
            n._ImgSrc = null,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "read",
            value: function(e, n, i) {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "read", this).call(this, e, n, i);
                var o = n.isFilteringEnabled;
                void 0 !== o && (this._IsFilteringEnabled = o);
                var a = n.showBorder;
                void 0 !== a && (this._ShowBorder = a)
            }
        }, {
            key: "serialize",
            value: function() {
                var e = r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serialize", this).call(this);
                return e.isFilteringEnabled = this._IsFilteringEnabled,
                e.showBorder = this._ShowBorder,
                e
            }
        }, {
            key: "serializeInteractive",
            value: function() {
                var e = r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeInteractive", this).call(this);
                return e.isFilteringEnabled = this._IsFilteringEnabled,
                e.showBorder = this._ShowBorder,
                e
            }
        }, {
            key: "readRaw",
            value: function(e, t, n) {
                if (t.bytes && t.width && t.height && t.channels) {
                    var i = t.width
                      , r = t.height
                      , o = t.channels
                      , a = t.bytes;
                    this._Bitmap = {
                        width: i,
                        height: r,
                        channels: o,
                        bytes: a
                    },
                    this.isMissing = false;
                    var s = document.createElement("canvas");
                    s.width = i,
                    s.height = r;
                    for (var l = s.getContext("2d"), u = l.createImageData(i, r), c = 0; c < i; c++)
                        for (var d = 0; d < r; d++)
                            for (var h = d * i + c, f = 4 * h, p = h * o, y = 0; y < o; y++)
                                u.data[f + y] = a[p + y];
                    l.putImageData(u, 0, 0);
                    var m = this;
                    s.toBlob((function(e) {
                        m.imgSrc = URL.createObjectURL(e);
                        var t = new FileReader;
                        t.onload = function() {
                            m.file = this.result,
                            n(true)
                        }
                        ,
                        t.readAsArrayBuffer(e)
                    }
                    ), "image/png")
                } else
                    n(false)
            }
        }, {
            key: "fromBase64",
            value: function(e) {
                var t = this;
                a.default.fromUrl("data:" + this.type + ";base64," + e, (function(e, n) {
                    t._Bitmap = e,
                    t.isMissing = false,
                    t.imgSrc = n
                }
                ))
            }
        }, {
            key: "fromFile",
            value: function(e, t) {
                var n = this;
                a.default.fromFile(e, (function(e, i) {
                    e ? (n._Bitmap = e,
                    n.imgSrc = i,
                    n.isMissing = false) : n.isMissing = true,
                    t && t()
                }
                ))
            }
        }, {
            key: "getDistanceFieldTexture",
            value: function(e) {
                if (!this._ShowBorder)
                    return null;
                if (this._DistanceFieldTexture)
                    return this._DistanceFieldTexture;
                if (this._Bitmap) {
                    var t = this;
                    a.default.createSignedDistanceField(this._Bitmap, (function(n) {
                        n ? t._DistanceFieldTexture = e.loadBitmapTexture(n, s.default.LinearFilter | s.default.MipMapped | s.default.ClampToEdge) : l.default.debug("Failed to create distance field for bitmap. " + t._Bitmap.width + "x" + t._Bitmap.height)
                    }
                    ))
                }
                return null
            }
        }, {
            key: "getTexture",
            value: function(e) {
                if (this._Texture)
                    return this._Texture;
                if (this._Bitmap) {
                    var t = this._IsFilteringEnabled ? s.default.LinearFilter | s.default.MipMapped | s.default.ClampToEdge | s.default.MultiplyAlpha : s.default.ClampToEdge;
                    this._Texture = e.loadBitmapTexture(this._Bitmap, t)
                }
                return this._Texture
            }
        }, {
            key: "imgSrc",
            get: function() {
                return this._ImgSrc
            },
            set: function(e) {
                this._ImgSrc != e && (this._ImgSrc = e,
                this.dispatch("update"))
            }
        }, {
            key: "uiHierIconClass",
            get: function() {
                return this.isMissing ? "HierarchyMissingImageIcon" : null
            }
        }, {
            key: "uiSelectionIconClass",
            get: function() {
                return "SelectionImageIcon"
            }
        }, {
            key: "selectionIcon",
            get: function() {
                return "icon-picture"
            }
        }, {
            key: "typeName",
            get: function() {
                return "Image Asset"
            }
        }, {
            key: "uiIcon",
            get: function() {
                return this.isMissing ? "icon-missing-large" : "icon-picture"
            }
        }, {
            key: "uiHierThumbClass",
            get: function() {
                return this.isMissing ? null : "imageThumb"
            }
        }, {
            key: "width",
            get: function() {
                return this._Bitmap && this._Bitmap.width || 0
            }
        }, {
            key: "height",
            get: function() {
                return this._Bitmap && this._Bitmap.height || 0
            }
        }, {
            key: "bitmap",
            get: function() {
                return this._Bitmap
            }
        }, {
            key: "isFilteringEnabled",
            get: function() {
                return this._IsFilteringEnabled
            },
            set: function(e) {
                this._IsFilteringEnabled = e,
                this.dispatch("filteringChange", e)
            }
        }, {
            key: "showBorder",
            get: function() {
                return this._ShowBorder
            },
            set: function(e) {
                this._ShowBorder = e,
                this.dispatch("showBorderChange", e)
            }
        }]),
        t
    }(o.default);
    t.default = c
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = a(n(203))
      , o = a(n(582));
    function a(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var s = [1, 1, 1, .5]
      , l = [1, 1, 1, 1]
      , u = [1, 1, 1, 1]
      , c = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n._ActorNode = e,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "onAddedToStage",
            value: function(e) {
                this.setMesh(this.stageContext.points, 2, this.stageContext.index)
            }
        }, {
            key: "doCustomHitDetect",
            value: function(e, t) {
                var n = Math.sqrt(e * e + t * t);
                return Math.abs(15 - n) <= 5
            }
        }, {
            key: "updateDisplayType",
            value: function(e) {
                e === o.default.Target ? (this.hitDetectOnMesh = false,
                this.customHitDetect = this.doCustomHitDetect) : (this.hitDetectOnMesh = true,
                this.customHitDetect = null)
            }
        }, {
            key: "draw",
            value: function(e, t) {
                var n = this._ActorNode;
                this.renderTransform = n.worldTransform;
                var i = this.renderViewTransform
                  , r = this.stageContext
                  , a = t ? l : s;
                switch (n.displayType) {
                case o.default.Empty:
                    e.drawColor(i, r.vertexBuffer, r.indexBuffer, .8, a);
                    break;
                case o.default.Target:
                    e.drawColor(i, r.targetVertexBuffer, r.targetIndexBuffer, .8, a),
                    e.drawThickLine(i, r.targetLine, 1 * this.stage.screenScale, .8, a)
                }
            }
        }, {
            key: "drawSelection",
            value: function(e, t) {
                var n = this._ActorNode;
                this.renderTransform = n.worldTransform;
                var i = this.renderViewTransform
                  , r = this.stageContext
                  , a = t ? l : u;
                switch (n.displayType) {
                case o.default.Empty:
                    e.drawColor(i, r.vertexBuffer, r.indexBuffer, .8, a);
                    break;
                case o.default.Target:
                    e.drawColor(i, r.targetVertexBuffer, r.targetIndexBuffer, .8, a),
                    e.drawThickLine(i, r.targetLine, 1 * this.stage.screenScale, .8, a)
                }
            }
        }]),
        t
    }(r.default);
    t.default = c,
    c.initializeStageContext = function(e, t) {
        var n = [-9, 9, 9, 9, 9, -9, -9, -9];
        t.points = n,
        t.index = [0, 1, 2, 2, 3, 0];
        var i = [-9, 9, -3, 9, -3, 7.5, -7.5, 7.5, -7.5, 3, -9, 3, 9, 9, 3, 9, 3, 7.5, 7.5, 7.5, 7.5, 3, 9, 3, -9, -9, -3, -9, -3, -7.5, -7.5, -7.5, -7.5, -3, -9, -3, 9, -9, 3, -9, 3, -7.5, 7.5, -7.5, 7.5, -3, 9, -3, -1.5, 1.5, 1.5, 1.5, 1.5, -1.5, -1.5, -1.5];
        t.vertexBuffer = e.makeVertexBuffer(i),
        t.indexBuffer = e.makeIndexBuffer([0, 1, 2, 0, 2, 3, 0, 3, 4, 0, 4, 5, 8, 7, 6, 9, 8, 6, 10, 9, 6, 11, 10, 6, 12, 13, 14, 12, 14, 15, 12, 15, 16, 12, 16, 17, 20, 19, 18, 21, 20, 18, 22, 21, 18, 23, 22, 18, 24, 25, 26, 24, 26, 27]);
        var r = [-20, 20, 20, 20, -20, -20, 20, -20];
        t.points = r,
        t.index = [0, 1, 2, 1, 3, 2];
        var o = [-1, 18.75, 1, 18.75, 1, 15, -1, 15, -1, -18.75, 1, -18.75, 1, -15, -1, -15, -18.75, -1, -18.75, 1, -15, 1, -15, -1, 18.75, -1, 18.75, 1, 15, 1, 15, -1];
        t.targetVertexBuffer = e.makeVertexBuffer(o),
        t.targetIndexBuffer = e.makeIndexBuffer([0, 1, 2, 2, 3, 0, 4, 5, 6, 6, 7, 4, 8, 9, 10, 10, 11, 8, 12, 13, 14, 14, 15, 12]);
        for (var a = [], s = 2 * Math.PI / 30, l = 0, u = 0; u < 30; u++) {
            var c = 15 * Math.cos(l)
              , d = 15 * Math.sin(l);
            a.push([c, d]),
            l += s
        }
        t.targetLine = e.makeThickLine(a, true)
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }, a = n(208);
    var s = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.name = "Collider",
            n._Shape = t.Shape.Rectangle,
            n._Width = 100,
            n._Height = 100,
            n._Radius = 100,
            n._MeshData = null,
            n._LineData = null,
            n._IsCollisionEnabled = true,
            n._AnimationIsCollisionEnabled = true,
            n._KeyStateIsCollisionEnabled = 0,
            n.treeOrderFactor = 99999,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "read",
            value: function(e, n) {
                o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "read", this).call(this, e, n);
                var i = n.shape;
                switch (i) {
                case t.Shape.Rectangle:
                case t.Shape.Triangle:
                case t.Shape.Circle:
                case t.Shape.Polygon:
                case t.Shape.Line:
                    this._Shape = i;
                    break;
                default:
                    this._Shape = t.Shape.Rectangle
                }
                this._Width = n.width || 0,
                this._Height = n.height || 0,
                this._Radius = n.radius || 0,
                this._IsCollisionEnabled = !!n.isCollisionEnabled;
                var r = n.mesh;
                if (void 0 !== r) {
                    var a = r.editor;
                    this._MeshData = {
                        editor: {
                            c: new Float32Array(a.c),
                            cc: a.cc,
                            ie: new Uint16Array(a.ie),
                            cl: a.cl,
                            a: a.a
                        },
                        verts: new Float32Array(r.verts),
                        tris: new Uint16Array(r.tris),
                        loverts: new Float32Array(r.loverts),
                        lotris: new Uint16Array(r.lotris)
                    }
                }
                var s = n.line;
                void 0 !== s && (this._LineData = new Float32Array(s))
            }
        }, {
            key: "serializeProperties",
            value: function(e) {
                var n = o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeProperties", this).call(this, e);
                if (this._MeshData) {
                    var i = this._MeshData.editor
                      , r = {
                        editor: {
                            c: Array.prototype.slice.call(i.c),
                            cc: i.cc,
                            ie: Array.prototype.slice.call(i.ie),
                            cl: i.cl,
                            a: i.a
                        }
                    };
                    e || (r.verts = Array.prototype.slice.call(this._MeshData.verts),
                    r.tris = Array.prototype.slice.call(this._MeshData.tris),
                    r.loverts = Array.prototype.slice.call(this._MeshData.loverts),
                    r.lotris = Array.prototype.slice.call(this._MeshData.lotris)),
                    n.mesh = r
                }
                return this._LineData && (n.line = Array.prototype.slice.call(this._LineData)),
                n
            }
        }, {
            key: "serializeInteractive",
            value: function() {
                var e = o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeInteractive", this).call(this);
                return e.shape = this._Shape,
                e.width = this._Width,
                e.height = this._Height,
                e.radius = this._Radius,
                e.isCollisionEnabled = this._IsCollisionEnabled,
                e
            }
        }, {
            key: "uiHierIconClass",
            get: function() {
                return "HierarchyBoneIcon"
            }
        }, {
            key: "uiIcon",
            get: function() {
                return "icon-collider"
            }
        }, {
            key: "typeName",
            get: function() {
                return "Collider"
            }
        }, {
            key: "rigIsCollisionEnabled",
            get: function() {
                return this._IsCollisionEnabled
            }
        }, {
            key: "isCollisionEnabled",
            get: function() {
                return this.useAnimationValues ? this._AnimationIsCollisionEnabled : this._IsCollisionEnabled
            },
            set: function(e) {
                if (this.useAnimationValues) {
                    if (e != this._AnimationIsCollisionEnabled) {
                        var t = this._AnimationIsCollisionEnabled;
                        this.frameIsCollisionEnabled = e,
                        this.dispatch("animateCollisionEnabled", {
                            from: t,
                            to: e
                        }),
                        this.dispatch("collisionEnabledChanged")
                    }
                } else
                    this._IsCollisionEnabled != e && (this._IsCollisionEnabled = e,
                    this.dispatch("collisionEnabledChanged", e),
                    this.forceRedraw())
            }
        }, {
            key: "frameIsCollisionEnabled",
            get: function() {
                return this._AnimationIsCollisionEnabled
            },
            set: function(e) {
                this._AnimationIsCollisionEnabled != e && (this._AnimationIsCollisionEnabled = e,
                this.dispatch("collisionEnabledChanged"))
            }
        }, {
            key: "frameIsCollisionEnabledKS",
            get: function() {
                return this._KeyStateIsCollisionEnabled
            },
            set: function(e) {
                this._KeyStateIsCollisionEnabled != e && (this._KeyStateIsCollisionEnabled = e,
                this.markKeyStateDirty())
            }
        }, {
            key: "shape",
            get: function() {
                return this._Shape
            },
            set: function(e) {
                if (this._Shape != e) {
                    if (this._Shape = e,
                    this.stageItem && this.stageItem.meshEditor && (this.stageItem.meshEditor.empty(),
                    this.stageItem.meshEditor = null),
                    this._Shape !== t.Shape.Line || this._LineData) {
                        if (this._Shape === t.Shape.Polygon && !this._MeshData) {
                            this._Width || (this._Width = 100),
                            this._Height || (this._Height = 100);
                            var n = this._Width / 2
                              , i = this._Height / 2
                              , r = new Float32Array([-n, -i, n, -i, n, i, -n, i])
                              , o = new Float32Array([-n, -i, 0, 1, n, -i, 1, 1, n, i, 1, 0, -n, i, 0, 0])
                              , a = new Uint16Array([0, 1, 2, 2, 3, 0]);
                            this.meshData = {
                                editor: {
                                    c: new Float32Array(r),
                                    cc: 4,
                                    ie: new Uint16Array([]),
                                    cl: true,
                                    a: 0
                                },
                                verts: o,
                                tris: a,
                                loverts: r,
                                lotris: a
                            }
                        }
                    } else {
                        var s = new Float32Array([-50, 0, 50, 0]);
                        this.lineData = s
                    }
                    this.dispatch("shapeChanged", e),
                    this.forceRedraw()
                }
            }
        }, {
            key: "width",
            get: function() {
                return this._Width
            },
            set: function(e) {
                this._Width != e && (this._Width = e,
                this.dispatch("sizeChanged", e),
                this.forceRedraw())
            }
        }, {
            key: "height",
            get: function() {
                return this._Height
            },
            set: function(e) {
                this._Height != e && (this._Height = e,
                this.dispatch("sizeChanged", e),
                this.forceRedraw())
            }
        }, {
            key: "radius",
            get: function() {
                return this._Radius
            },
            set: function(e) {
                this._Radius != e && (this._Radius = e,
                this.dispatch("sizeChanged", e),
                this.forceRedraw())
            }
        }, {
            key: "lineData",
            get: function() {
                return this._LineData
            },
            set: function(e) {
                this._LineData = e,
                this.actor.revise(),
                this.stageItem && (this.stageItem.updateMesh(),
                this.forceRedraw())
            }
        }, {
            key: "meshData",
            get: function() {
                return this._MeshData
            },
            set: function(e) {
                this._MeshData = e,
                this.actor.revise(),
                this.stageItem && (this.stageItem.updateMesh(),
                this.forceRedraw())
            }
        }]),
        t
    }(((i = a) && i.__esModule ? i : {
        default: i
    }).default);
    t.default = s,
    s.Shape = {
        Rectangle: 0,
        Triangle: 1,
        Circle: 2,
        Polygon: 3,
        Line: 4
    },
    s.ShapeNames = ["Rectangle", "Triangle", "Circle", "Polygon", "Line"]
}
, , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = c(n(0)), a = c(n(4)), s = c(n(267)), l = c(n(1)), u = c(n(3));
    function c(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function d(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var h = (d((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                visible: false,
                filterDisplay: false,
                includeBones: true,
                includeImages: true
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "componentWillMount",
            value: function() {
                this.visible = false,
                this.includeBones = true,
                this.includeImages = true,
                this.focusNext = false
            }
        }, {
            key: "componentDidUpdate",
            value: function() {
                this.focusNext && (this.focusNext = false,
                this.input.focus(),
                this.input.setSelectionRange(0, this.input.value.length))
            }
        }, {
            key: "show",
            value: function() {
                if (this.visible)
                    this.input.focus();
                else {
                    this.visible = true,
                    this.setState({
                        visible: true
                    });
                    var e = this;
                    this.context.nima.setCancelCallback((function() {
                        e.hide()
                    }
                    )),
                    this.focusNext = true,
                    this.updateFilter(),
                    clearTimeout(this.myTimeout),
                    this.setState({
                        filterDisplay: true
                    })
                }
            }
        }, {
            key: "hide",
            value: function() {
                if (this.visible) {
                    this.setState({
                        visible: false
                    }),
                    this.visible = false,
                    this.updateFilter();
                    var e = this;
                    this.myTimeout = setTimeout((function() {
                        e.setState({
                            filterDisplay: false
                        })
                    }
                    ), 400)
                }
            }
        }, {
            key: "updateFilter",
            value: function() {
                var e = this.input.value
                  , n = this.context.nima.actor;
                if (n) {
                    if (!this.visible)
                        return n.root.all((function(e) {
                            e.filterState = t.Show
                        }
                        )),
                        h(n.drawOrder.hierarchyChildren, (function(e) {
                            e.filterState = t.Show
                        }
                        )),
                        h(n.assetFolder.hierarchyChildren, (function(e) {
                            e.filterState = t.Show
                        }
                        )),
                        h(n.animationFolder.hierarchyChildren, (function(e) {
                            e.filterState = t.Show
                        }
                        )),
                        void (this.props.onFilter && this.props.onFilter(false));
                    var i = [];
                    h(n.assetFolder.hierarchyChildren, (function(n) {
                        -1 !== n.name.search(new RegExp(e,"i")) ? (n.filterState = t.Show,
                        i.push(n)) : n.filterState = t.Hidden
                    }
                    ));
                    for (var r = 0; r < i.length; r++)
                        for (var o = i[r].parent; o && o !== n.root; )
                            o.filterState === t.Hidden && (o.filterState = t.SemiHidden),
                            o = o.parent;
                    h(n.drawOrder.hierarchyChildren, (function(n) {
                        -1 !== n.name.search(new RegExp(e,"i")) ? n.filterState = t.Show : n.filterState = t.Hidden
                    }
                    )),
                    h(n.animationFolder.hierarchyChildren, (function(n) {
                        -1 !== n.name.search(new RegExp(e,"i")) ? n.filterState = t.Show : n.filterState = t.Hidden
                    }
                    ));
                    var a = []
                      , l = this.includeImages
                      , u = this.includeBones;
                    h(n.root.hierarchyChildren, (function(n) {
                        switch (n.constructor) {
                        case s.default:
                            if (!l)
                                return void (n.filterState = t.Hidden);
                            break;
                        default:
                            if (!u)
                                return void (n.filterState = t.Hidden)
                        }
                        -1 !== n.name.search(new RegExp(e,"i")) ? (n.filterState = t.Show,
                        a.push(n)) : n.filterState = t.Hidden
                    }
                    ));
                    for (var c = 0; c < a.length; c++)
                        for (var d = a[c].parent; d && d !== n.root; )
                            d.filterState === t.Hidden && (d.filterState = t.SemiHidden),
                            d.filterState |= t.Expanded,
                            d = d.parent;
                    this.props.onFilter && this.props.onFilter(true)
                }
                function h(e, t) {
                    var n;
                    if (n = e.constructor === Array ? e : e.hierarchyChildren)
                        for (var i = 0; i < n.length; i++) {
                            var r = n[i];
                            t(r),
                            h(r, t)
                        }
                }
            }
        }, {
            key: "keyDown",
            value: function(e) {
                switch (e.keyCode) {
                case 27:
                    this.hide()
                }
            }
        }, {
            key: "toggleIncludeImages",
            value: function() {
                this.includeImages = !this.state.includeImages,
                this.setState({
                    includeImages: !this.state.includeImages
                }),
                this.updateFilter()
            }
        }, {
            key: "toggleIncludeBones",
            value: function() {
                this.includeBones = !this.state.includeBones,
                this.setState({
                    includeBones: !this.state.includeBones
                }),
                this.updateFilter()
            }
        }, {
            key: "setInput",
            value: function(e) {
                this.input = e
            }
        }, {
            key: "render",
            value: function() {
                return o.default.createElement("div", {
                    style: {
                        display: this.state.filterDisplay ? null : "none",
                        animation: this.state.visible ? null : "bounceFilterOut .1s cubic-bezier(0.000, 0.010, 1.000, 0.000) 0s both"
                    },
                    className: "HierarchyFilter"
                }, o.default.createElement("div", {
                    className: "HierarchyFilterMain"
                }, o.default.createElement("input", {
                    ref: this.setInput,
                    type: "text",
                    onChange: this.updateFilter,
                    onKeyDown: this.keyDown,
                    placeholder: "Type to find..."
                }), o.default.createElement("svg", {
                    className: "CloseButton",
                    onClick: this.hide
                }, o.default.createElement("use", {
                    xlinkHref: u.default.make("/images/symbol-defs.svg#icon-close3")
                }))), o.default.createElement("div", {
                    className: "HierarchyFilterOptions"
                }, o.default.createElement("svg", {
                    onMouseDown: this.toggleIncludeImages,
                    className: "HierarchyIcon HierarchyImageIcon " + (this.state.includeImages ? "HierarchyFilterGroupIconActive" : "HierarchyFilterGroupIcon")
                }, o.default.createElement("use", {
                    xlinkHref: u.default.make("/images/symbol-defs.svg#icon-picture")
                })), o.default.createElement("svg", {
                    onMouseDown: this.toggleIncludeBones,
                    className: "HierarchyIcon HierarchyBoneIcon " + (this.state.includeBones ? "HierarchyFilterGroupIconActive" : "HierarchyFilterGroupIcon")
                }, o.default.createElement("use", {
                    xlinkHref: u.default.make("/images/symbol-defs.svg#icon-bone")
                }))))
            }
        }]),
        t
    }(o.default.Component)).prototype, "hide", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "hide"), i.prototype),
    d(i.prototype, "updateFilter", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "updateFilter"), i.prototype),
    d(i.prototype, "keyDown", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "keyDown"), i.prototype),
    d(i.prototype, "toggleIncludeImages", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleIncludeImages"), i.prototype),
    d(i.prototype, "toggleIncludeBones", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleIncludeBones"), i.prototype),
    d(i.prototype, "setInput", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "setInput"), i.prototype),
    i);
    t.default = h,
    h.Show = 1,
    h.Hidden = 2,
    h.SemiHidden = 4,
    h.Collapsed = 8,
    h.Expanded = 16,
    h.contextTypes = {
        nima: a.default.object
    }
}
, , , , , , , , , , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = n(12);
    var a = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this));
            return n._Actor = e,
            n._RefID = t.ID++,
            n._Name = "Node",
            n._IsKeyStateDirty = false,
            n._Parent = null,
            n._TreeOrderFactor = 1,
            n._StageItem = null,
            n.siblingIndex = 0,
            n._Removed = false,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "clearKeyStates",
            value: function() {}
        }, {
            key: "isValidParent",
            value: function(e) {
                return true
            }
        }, {
            key: "onRemovedFromActor",
            value: function() {
                this._Removed = true
            }
        }, {
            key: "onAddedToActor",
            value: function() {
                this._Removed = false
            }
        }, {
            key: "isChildOf",
            value: function(e) {
                for (var t = this.parent; null != t; ) {
                    if (t == e)
                        return true;
                    t = t.parent
                }
                return false
            }
        }, {
            key: "newRefId",
            value: function() {
                this._RefID = t.ID++
            }
        }, {
            key: "markKeyStateDirty",
            value: function() {
                this._IsKeyStateDirty || (this._IsKeyStateDirty = true,
                this._Actor._IsKeyStateDirty = true)
            }
        }, {
            key: "onSetStageItem",
            value: function(e) {
                this._StageItem = e
            }
        }, {
            key: "updateDependencies",
            value: function(e) {}
        }, {
            key: "setParent",
            value: function(e) {
                this._Parent = e,
                this.onParentChanged && this.onParentChanged()
            }
        }, {
            key: "read",
            value: function(e, n) {
                var i = n.id;
                i && (this._RefID = i,
                t.ID <= this._RefID && (t.ID = this._RefID + 1)),
                (i = n.name) && (this._Name = i)
            }
        }, {
            key: "serializeProperties",
            value: function(e) {
                var t = {
                    type: this.constructor.registeredActorName,
                    id: this._RefID
                }
                  , n = this.serializeInteractive();
                for (var i in n) {
                    var r = n[i];
                    null != r && (r.constructor === Float32Array ? t[i] = Array.prototype.slice.call(r) : t[i] = r)
                }
                return t
            }
        }, {
            key: "serializeInteractive",
            value: function() {
                return {
                    name: this._Name
                }
            }
        }, {
            key: "serializeHistory",
            value: function() {
                return this.serializeInteractive()
            }
        }, {
            key: "serialize",
            value: function(e) {
                return this.serializeProperties(e)
            }
        }, {
            key: "nullFrame",
            value: function() {
                return {}
            }
        }, {
            key: "isRemoved",
            get: function() {
                return this._Removed
            }
        }, {
            key: "actor",
            get: function() {
                return this._Actor
            }
        }, {
            key: "refId",
            get: function() {
                return this._RefID
            }
        }, {
            key: "name",
            get: function() {
                return this._Name
            },
            set: function(e) {
                this._Name = e,
                this.dispatch("update")
            }
        }, {
            key: "parent",
            get: function() {
                return this._Parent
            }
        }, {
            key: "treeOrder",
            get: function() {
                return (this.siblingIndex + 1) * this._TreeOrderFactor
            }
        }, {
            key: "treeOrderFactor",
            get: function() {
                return this._TreeOrderFactor
            },
            set: function(e) {
                this._TreeOrderFactor = e
            }
        }, {
            key: "treeDepth",
            get: function() {
                for (var e = 0, t = this.parent; t; )
                    e++,
                    t = t.parent;
                return e
            }
        }, {
            key: "stageItem",
            get: function() {
                return this._StageItem
            },
            set: function(e) {
                this.onSetStageItem(e)
            }
        }]),
        t
    }(((i = o) && i.__esModule ? i : {
        default: i
    }).default);
    t.default = a,
    a.ID = 1e3
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = l(n(203)), a = l(n(1)), s = n(2);
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var u, c, d, h, f, p, y = [0, 139 / 255, 1, 1], m = [1, 1, 1, 1], v = [198 / 255, 0, 0, 1], g = (i = function(e) {
        function t(e, n, i) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var r = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, null));
            return r._VtxA = e,
            r._VtxB = n,
            r._IsDeformer = i,
            r._CollisionEdge = null,
            r._Highlight = false,
            i && r.addEventListener("selectedChange", r.onSelectedChange),
            r
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "cleanup",
            value: function() {
                this.removeEventListener("selectedChange", this.onSelectedChange),
                this.collisionEdge = null
            }
        }, {
            key: "onSelectedChange",
            value: function(e) {
                e && this.stage.selectItem(this.parent, true)
            }
        }, {
            key: "customHitDetectEarly",
            value: function(e, n) {
                var i = 8 / this.stage.scale
                  , r = i * i;
                return t.squaredDistanceToSegment(this._VtxA.worldPosition, this._VtxB.worldPosition, e, n) < r
            }
        }, {
            key: "draw",
            value: function(e, t) {
                if (!t && !this.isSelected)
                    if (this._Highlight)
                        this.drawSelection(e, t);
                    else {
                        var n = this._VtxA.worldPosition
                          , i = this._VtxB.worldPosition
                          , r = this.willDelete;
                        e.drawLine(this.stage.viewTransform, [n[0], n[1], i[0], i[1]], 1, r ? v : y)
                    }
            }
        }, {
            key: "drawSelection",
            value: function(e, t) {
                var n = this._VtxA.worldPosition
                  , i = this._VtxB.worldPosition
                  , r = e.makeThickLine([n, i], false)
                  , o = this.willDelete;
                e.drawThickLine(this.stage.viewTransform, r, 1 / this.stage.scale * this.stage.screenScale, 1, o ? v : m)
            }
        }, {
            key: "vtxA",
            get: function() {
                return this._VtxA
            },
            set: function(e) {
                this._VtxA = e
            }
        }, {
            key: "vtxB",
            get: function() {
                return this._VtxB
            },
            set: function(e) {
                this._VtxB = e
            }
        }, {
            key: "collisionEdge",
            get: function() {
                return this._CollisionEdge
            },
            set: function(e) {
                this._CollisionEdge != e && (this._CollisionEdge && (this._CollisionEdge.highlight = false),
                this._CollisionEdge = e,
                this._CollisionEdge && (this._CollisionEdge.highlight = true))
            }
        }, {
            key: "highlight",
            get: function() {
                return this._Highlight
            },
            set: function(e) {
                this._Highlight != e && (this._Highlight = e)
            }
        }, {
            key: "isDeformer",
            get: function() {
                return this._IsDeformer
            }
        }]),
        t
    }(o.default),
    u = i.prototype,
    c = "onSelectedChange",
    d = [a.default],
    h = Object.getOwnPropertyDescriptor(i.prototype, "onSelectedChange"),
    f = i.prototype,
    p = {},
    Object.keys(h).forEach((function(e) {
        p[e] = h[e]
    }
    )),
    p.enumerable = !!p.enumerable,
    p.configurable = !!p.configurable,
    ("value"in p || p.initializer) && (p.writable = true),
    p = d.slice().reverse().reduce((function(e, t) {
        return t(u, c, e) || e
    }
    ), p),
    f && void 0 !== p.initializer && (p.value = p.initializer ? p.initializer.call(f) : void 0,
    p.initializer = void 0),
    void 0 === p.initializer && (Object.defineProperty(u, c, p),
    p = null),
    i);
    t.default = g,
    g.initializeStageContext = function(e, t, n) {
        n.setLayerRenderExtensions(4, {
            context: t,
            drawPrep: function(e, t, n) {
                return n.willSelectionsDraw ? e : []
            }
        })
    }
    ,
    g.TempV1 = s.vec2.create(),
    g.TempV2 = s.vec2.create(),
    g.squaredDistanceToSegment = function(e, t, n, i) {
        var r = g.TempV2
          , o = s.vec2.set(g.TempV1, n, i)
          , a = s.vec2.squaredLength(s.vec2.subtract(r, e, t));
        if (0 == a)
            return s.vec2.squaredLength(s.vec2.subtract(r, o, e));
        var l = ((n - e[0]) * (t[0] - e[0]) + (i - e[1]) * (t[1] - e[1])) / a;
        return l < 0 ? s.vec2.squaredLength(s.vec2.subtract(r, o, e)) : l > 1 ? s.vec2.squaredLength(s.vec2.subtract(r, o, t)) : (r[0] = e[0] + l * (t[0] - e[0]),
        r[1] = e[1] + l * (t[1] - e[1]),
        s.vec2.squaredLength(s.vec2.subtract(r, o, r)))
    }
    ,
    g.pointOnSegment = function(e, t, n, i) {
        var r = g.TempV2
          , o = s.vec2.squaredLength(s.vec2.subtract(r, e, t));
        if (0 == o)
            return e;
        var a = ((n - e[0]) * (t[0] - e[0]) + (i - e[1]) * (t[1] - e[1])) / o;
        return a < 0 ? e : a > 1 ? t : (r[0] = e[0] + a * (t[0] - e[0]),
        r[1] = e[1] + a * (t[1] - e[1]),
        r)
    }
    ,
    g.intersection = function(e, t) {
        if (e.vtxA === t.vtxA || e.vtxA === t.vtxB || e.vtxB === t.vtxA || e.vtxB === t.vtxB)
            return false;
        var n = e.vtxA.position
          , i = e.vtxB.position
          , r = t.vtxA.position
          , o = t.vtxB.position
          , a = i[0] - n[0]
          , s = i[1] - n[1]
          , l = o[0] - r[0]
          , u = o[1] - r[1]
          , c = (-s * (n[0] - r[0]) + a * (n[1] - r[1])) / (-l * s + a * u)
          , d = (l * (n[1] - r[1]) - u * (n[0] - r[0])) / (-l * s + a * u);
        return c >= 1e-4 && c <= 1.0001 && d >= 1e-4 && d <= 1.0001 ? [n[0] + d * a, n[1] + d * s] : null
    }
    ,
    g.intersects = function(e, t) {
        if (e.vtxA === t.vtxA || e.vtxA === t.vtxB || e.vtxB === t.vtxA || e.vtxB === t.vtxB)
            return false;
        var n = e.vtxA.position
          , i = e.vtxB.position
          , r = t.vtxA.position
          , o = t.vtxB.position
          , a = i[0] - n[0]
          , s = i[1] - n[1]
          , l = o[0] - r[0]
          , u = o[1] - r[1]
          , c = (-s * (n[0] - r[0]) + a * (n[1] - r[1])) / (-l * s + a * u)
          , d = (l * (n[1] - r[1]) - u * (n[0] - r[0])) / (-l * s + a * u);
        return c >= 1e-4 && c <= 1.0001 && d >= 1e-4 && d <= 1.0001
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = o(n(462));
    n(2),
    o(n(11));
    function o(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var a = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.name = "Jelly Bone",
            n.treeOrderFactor = -9999999,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "serializeTransform",
            value: function(e) {}
        }, {
            key: "setStageItemVisibility",
            value: function() {
                (function e(t, n, i) {
                    null === t && (t = Function.prototype);
                    var r = Object.getOwnPropertyDescriptor(t, n);
                    if (void 0 === r) {
                        var o = Object.getPrototypeOf(t);
                        return null === o ? void 0 : e(o, n, i)
                    }
                    if ("value"in r)
                        return r.value;
                    var a = r.get;
                    return void 0 !== a ? a.call(i) : void 0
                }
                )(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "setStageItemVisibility", this).call(this);
                var e = this.stageItem;
                e.isVisible && this.parent && (e.isVisible = !this.parent.hideJellies)
            }
        }, {
            key: "uiHierIconClass",
            get: function() {
                return "HierarchyBoneIcon"
            }
        }, {
            key: "uiIcon",
            get: function() {
                return "icon-jelly-bone"
            }
        }, {
            key: "typeName",
            get: function() {
                return "Jelly Bone"
            }
        }]),
        t
    }(r.default);
    t.default = a
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }, a = n(396);
    var s = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.name = "Custom Property",
            n._Type = t.Type.Integer,
            n._IntValue = 0,
            n._FloatValue = 0,
            n._StringValue = "",
            n._BooleanValue = false,
            n._AnimationIntValue = 0,
            n._AnimationFloatValue = 0,
            n._AnimationStringValue = "",
            n._AnimationBooleanValue = false,
            n._KeyStateIntValue = 0,
            n._KeyStateFloatValue = 0,
            n._KeyStateStringValue = 0,
            n._KeyStateBooleanValue = 0,
            n._UseAnimationValues = false,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "clearKeyStates",
            value: function() {
                o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "clearKeyStates", this).call(this),
                this.frameBooleanValueKS = 0,
                this.frameStringValueKS = 0,
                this.frameIntValueKS = 0,
                this.frameFloatValueKS = 0
            }
        }, {
            key: "read",
            value: function(e, n) {
                o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "read", this).call(this, e, n);
                var i = n.propertyType;
                switch (i) {
                case t.Type.Integer:
                case t.Type.Float:
                case t.Type.String:
                case t.Type.Boolean:
                    this._Type = i;
                    break;
                default:
                    this._Type = t.Type.Integer
                }
                this._IntValue = n.intValue || 0,
                this._FloatValue = n.floatValue || 0,
                this._StringValue = n.stringValue || "",
                this._BooleanValue = true === n.booleanValue || false
            }
        }, {
            key: "serializeProperties",
            value: function(e) {
                return o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeProperties", this).call(this, e)
            }
        }, {
            key: "serializeInteractive",
            value: function() {
                var e = o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeInteractive", this).call(this);
                return e.propertyType = this._Type,
                e.intValue = this._IntValue,
                e.floatValue = this._FloatValue,
                e.stringValue = this._StringValue,
                e.booleanValue = this._BooleanValue,
                e
            }
        }, {
            key: "nullFrame",
            value: function() {
                return {
                    frameIntValue: null,
                    frameFloatValue: null,
                    frameStringValue: null,
                    frameBooleanValue: null
                }
            }
        }, {
            key: "hideInHierarchy",
            get: function() {
                return true
            }
        }, {
            key: "propertyType",
            get: function() {
                return this._Type
            },
            set: function(e) {
                e != this._Type && (this._Type = e,
                this.dispatch("typeChanged", e))
            }
        }, {
            key: "useAnimationValues",
            get: function() {
                return this._UseAnimationValues
            },
            set: function(e) {
                e != this._UseAnimationValues && (this._UseAnimationValues = e)
            }
        }, {
            key: "rigIntValue",
            get: function() {
                return this._IntValue
            }
        }, {
            key: "intValue",
            get: function() {
                return this._UseAnimationValues ? this._AnimationIntValue : this._IntValue
            },
            set: function(e) {
                if (this._UseAnimationValues) {
                    if (e != this._AnimationIntValue) {
                        var t = this.frameIntValue;
                        this.frameIntValue = e,
                        this.dispatch("animateIntValue", {
                            from: t,
                            to: e
                        })
                    }
                } else
                    e != this._IntValue && (this._IntValue = e,
                    this.dispatch("valueChanged", e))
            }
        }, {
            key: "floatValue",
            get: function() {
                return this._UseAnimationValues ? this._AnimationFloatValue : this._FloatValue
            },
            set: function(e) {
                if (this._UseAnimationValues) {
                    if (e != this._AnimationFloatValue) {
                        var t = this.frameFloatValue;
                        this.frameFloatValue = e,
                        this.dispatch("animateFloatValue", {
                            from: t,
                            to: e
                        })
                    }
                } else
                    e != this._FloatValue && (this._FloatValue = e,
                    this.dispatch("valueChanged", e))
            }
        }, {
            key: "frameIntValue",
            get: function() {
                return this._AnimationIntValue
            },
            set: function(e) {
                this._AnimationIntValue != e && (this._AnimationIntValue = e,
                this.dispatch("valueChanged", e))
            }
        }, {
            key: "frameIntValueKS",
            get: function() {
                return this._KeyStateIntValue
            },
            set: function(e) {
                this._KeyStateIntValue != e && (this._KeyStateIntValue = e,
                this.markKeyStateDirty())
            }
        }, {
            key: "rigFloatValue",
            get: function() {
                return this._FloatValue
            },
            set: function(e) {
                if (this._UseAnimationValues) {
                    if (e != this._AnimationFloatValue) {
                        var t = this.frameFloatValue;
                        this.frameFloatValue = e,
                        this.dispatch("animateFloatValue", {
                            from: t,
                            to: e
                        })
                    }
                } else
                    e != this._FloatValue && (this._FloatValue = e,
                    this.dispatch("valueChanged", e))
            }
        }, {
            key: "frameFloatValue",
            get: function() {
                return this._AnimationFloatValue
            },
            set: function(e) {
                this._AnimationFloatValue != e && (this._AnimationFloatValue = e,
                this.dispatch("valueChanged", e))
            }
        }, {
            key: "frameFloatValueKS",
            get: function() {
                return this._KeyStateFloatValue
            },
            set: function(e) {
                this._KeyStateFloatValue != e && (this._KeyStateFloatValue = e,
                this.markKeyStateDirty())
            }
        }, {
            key: "rigStringValue",
            get: function() {
                return this._StringValue
            }
        }, {
            key: "stringValue",
            get: function() {
                return this._UseAnimationValues ? this._AnimationStringValue : this._StringValue
            },
            set: function(e) {
                if (this._UseAnimationValues) {
                    if (e != this._AnimationStringValue) {
                        var t = this.frameStringValue;
                        this.frameStringValue = e,
                        this.dispatch("animateStringValue", {
                            from: t,
                            to: e
                        })
                    }
                } else
                    e != this._StringValue && (this._StringValue = e,
                    this.dispatch("valueChanged", e))
            }
        }, {
            key: "frameStringValue",
            get: function() {
                return this._AnimationStringValue
            },
            set: function(e) {
                this._AnimationStringValue != e && (this._AnimationStringValue = e,
                this.dispatch("valueChanged", e))
            }
        }, {
            key: "frameStringValueKS",
            get: function() {
                return this._KeyStateStringValue
            },
            set: function(e) {
                this._KeyStateStringValue != e && (this._KeyStateStringValue = e,
                this.markKeyStateDirty())
            }
        }, {
            key: "rigBooleanValue",
            get: function() {
                return this._BooleanValue
            }
        }, {
            key: "booleanValue",
            get: function() {
                return this._UseAnimationValues ? this._AnimationBooleanValue : this._BooleanValue
            },
            set: function(e) {
                if (this._UseAnimationValues) {
                    if (e != this._AnimationBooleanValue) {
                        var t = this.frameBooleanValue;
                        this.frameBooleanValue = e,
                        this.dispatch("animateBooleanValue", {
                            from: t,
                            to: e
                        })
                    }
                } else
                    e != this._BooleanValue && (this._BooleanValue = e,
                    this.dispatch("valueChanged", e))
            }
        }, {
            key: "frameBooleanValue",
            get: function() {
                return this._AnimationBooleanValue
            },
            set: function(e) {
                this._AnimationBooleanValue != e && (this._AnimationBooleanValue = e,
                this.dispatch("valueChanged", e))
            }
        }, {
            key: "frameBooleanValueKS",
            get: function() {
                return this._KeyStateBooleanValue
            },
            set: function(e) {
                this._KeyStateBooleanValue != e && (this._KeyStateBooleanValue = e,
                this.markKeyStateDirty())
            }
        }]),
        t
    }(((i = a) && i.__esModule ? i : {
        default: i
    }).default);
    t.default = s,
    s.Type = {
        Integer: 0,
        Float: 1,
        String: 2,
        Boolean: 3
    },
    s.TypeNames = ["Integer", "Float", "String", "Boolean"]
}
, , , , , , , , , , , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }
      , o = l(n(313))
      , a = l(n(201))
      , s = l(n(699));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var u = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n._Brush = new s.default,
            n._SuppressDragOperation = false,
            n._WasBoneSelectionDisabled = false,
            n._SelectedBoneIndex = 0,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "blockMarquee",
            value: function() {
                return true
            }
        }, {
            key: "cancel",
            value: function() {}
        }, {
            key: "validate",
            value: function() {
                return !!this.stage.appContext.editingWeights
            }
        }, {
            key: "enable",
            value: function() {
                this._Brush.addToStage(this.stage),
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "enable", this).call(this);
                var e = this.stage.getLayerOptions(a.default);
                this._WasBoneSelectionDisabled = e.disableSelection,
                e.disableSelection = true,
                this.stage.setLayerOptions(a.default, e);
                var n = this.stage.appContext.editingWeights;
                n && (this._SelectedBoneIndex %= n.node.connectedBones.length)
            }
        }, {
            key: "disable",
            value: function() {
                this._Brush.removeFromStage(this.stage),
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "disable", this).call(this),
                this.cancel();
                var e = this.stage.getLayerOptions(a.default);
                e.disableSelection = this._WasBoneSelectionDisabled,
                this.stage.setLayerOptions(a.default, e)
            }
        }, {
            key: "updateSelection",
            value: function(e) {}
        }, {
            key: "advanceDrag",
            value: function(e, n, i, o) {
                this._Brush.position = i,
                this.paint(),
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "advanceDrag", this).call(this, e, n, i, o)
            }
        }, {
            key: "mouseMove",
            value: function(e, t, n) {
                return this._Brush.position = n,
                true
            }
        }, {
            key: "release",
            value: function(e, n) {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "release", this).call(this, e, n);
                var i = this.stage.appContext.editingWeights;
                i && i.weightsUpdated()
            }
        }, {
            key: "click",
            value: function(e) {
                this.paint()
            }
        }, {
            key: "paint",
            value: function() {
                var e = this.stage.appContext.editingWeights;
                if (e) {
                    var t = this._Brush.influence;
                    this._Brush.mode === s.default.Mode.Add ? e.paintInfluence(this._Brush.strength, t.index, t.weights, this._SelectedBoneIndex) : e.subtractInfluence(this._Brush.strength, t.index, t.weights, this._SelectedBoneIndex)
                }
            }
        }, {
            key: "brush",
            get: function() {
                return this._Brush
            }
        }, {
            key: "selectedBoneIndex",
            get: function() {
                return this._SelectedBoneIndex
            },
            set: function(e) {
                e != this._SelectedBoneIndex && (this._SelectedBoneIndex = e)
            }
        }]),
        t
    }(o.default);
    t.default = u
}
, , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }, a = n(396);
    var s = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.name = "Constraint",
            n._IsEnabled = true,
            n._Strength = 1,
            n._AnimationStrength = 1,
            n._KeyStateStrength = 0,
            n.treeOrderFactor = 1e-9,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "onAdded",
            value: function() {}
        }, {
            key: "markDirty",
            value: function() {
                this.parent.markTransformDirty()
            }
        }, {
            key: "clearKeyStates",
            value: function() {
                o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "clearKeyStates", this).call(this),
                this.frameStrengthKS = 0
            }
        }, {
            key: "setParent",
            value: function(e) {
                var n = this._Parent;
                o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "setParent", this).call(this, e),
                e !== n && this._Actor.markDependenciesDirty()
            }
        }, {
            key: "read",
            value: function(e, n) {
                o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "read", this).call(this, e, n);
                var i = n.strength;
                void 0 !== i && (this._Strength = Math.min(1, Math.max(0, i)));
                var r = n.isEnabled;
                void 0 !== r && (this._IsEnabled = !!r)
            }
        }, {
            key: "serializeInteractive",
            value: function() {
                var e = o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeInteractive", this).call(this);
                return e.strength = this._Strength,
                e.isEnabled = this._IsEnabled,
                e
            }
        }, {
            key: "typeName",
            get: function() {
                return "Constraint"
            }
        }, {
            key: "uiHierIconClass",
            get: function() {
                return "HierarchyEventIcon"
            }
        }, {
            key: "uiSelectionIconClass",
            get: function() {
                return "HierarchyEventIcon"
            }
        }, {
            key: "uiIcon",
            get: function() {
                return "icon-constraint"
            }
        }, {
            key: "allowDragDrop",
            get: function() {
                return false
            }
        }, {
            key: "frameStrengthKS",
            get: function() {
                return this._KeyStateStrength
            },
            set: function(e) {
                this._KeyStateStrength != e && (this._KeyStateStrength = e,
                this.markKeyStateDirty())
            }
        }, {
            key: "rigStrength",
            get: function() {
                return this._Strength
            }
        }, {
            key: "strength",
            get: function() {
                return this.useAnimationValues ? this._AnimationStrength : this._Strength
            },
            set: function(e) {
                if (e = Math.min(1, Math.max(0, e)),
                this.useAnimationValues) {
                    if (this._AnimationStrength != e) {
                        var t = this.frameStrength;
                        this.frameStrength = e,
                        this.markDirty(),
                        this.dispatch("animateStrength", {
                            from: t,
                            to: e
                        })
                    }
                } else
                    this._Strength != e && (this._Strength = e,
                    this.dispatch("strengthChange"),
                    this.markDirty())
            }
        }, {
            key: "frameStrength",
            get: function() {
                return this._AnimationStrength
            },
            set: function(e) {
                e = Math.min(1, Math.max(0, e)),
                this._AnimationStrength != e && (this._AnimationStrength = e,
                this.markDirty(),
                this.dispatch("strengthChange"))
            }
        }, {
            key: "isEnabled",
            get: function() {
                return this._IsEnabled
            },
            set: function(e) {
                this._IsEnabled !== e && (this._IsEnabled = e,
                this.dispatch("enabledChange"),
                this.markDirty())
            }
        }], [{
            key: "constraintName",
            get: function() {
                return "Constraint"
            }
        }]),
        t
    }(((i = a) && i.__esModule ? i : {
        default: i
    }).default);
    t.default = s
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    });
    t.default = {
        MipMapped: 1,
        ClampToEdge: 2,
        MultiplyAlpha: 4,
        LinearFilter: 8,
        FlipY: 16
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = a(n(511))
      , o = a(n(382));
    function a(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var s = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n._Type = "image/sequence",
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "resolveChildType",
            value: function(e, t) {
                return -1 !== e.constructor.getImageMimeTypes().indexOf(t) ? o.default : null
            }
        }, {
            key: "getDistanceFieldTexture",
            value: function(e, t) {
                var n = this._Children;
                if (0 == n.length)
                    return null;
                var i = t % n.length;
                return i < 0 && (i += n.length),
                n[Math.floor(i)].getDistanceFieldTexture(e)
            }
        }, {
            key: "getTexture",
            value: function(e, t) {
                var n = this._Children;
                if (0 == n.length)
                    return null;
                var i = t % n.length;
                return i < 0 && (i += n.length),
                n[Math.floor(i)].getTexture(e)
            }
        }, {
            key: "uiHierThumbClass",
            get: function() {
                return "seqThumb"
            }
        }, {
            key: "uiIcon",
            get: function() {
                return "icon-seq-asset"
            }
        }, {
            key: "uiSelectionIconClass",
            get: function() {
                return "SelectionImageIcon"
            }
        }, {
            key: "typeName",
            get: function() {
                return "Image Asset"
            }
        }, {
            key: "width",
            get: function() {
                var e = this.bitmap;
                return e && e.width || 0
            }
        }, {
            key: "height",
            get: function() {
                var e = this.bitmap;
                return e && e.height || 0
            }
        }, {
            key: "bitmap",
            get: function() {
                return this._Children && this._Children.length > 0 && this._Children[0].bitmap || null
            }
        }, {
            key: "imgSrc",
            get: function() {
                return this._Children && this._Children.length > 0 && this._Children[0].imgSrc || null
            }
        }]),
        t
    }(r.default);
    t.default = s
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = f(n(267))
      , o = f(n(237))
      , a = f(n(315))
      , s = f(n(208))
      , l = f(n(261))
      , u = f(n(383))
      , c = f(n(243))
      , d = f(n(371))
      , h = n(2);
    function f(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var p = function() {
        function e(t, n, i) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e),
            this._CompensateBones = t,
            this._CompensateImages = n,
            this._ActorNodes = i
        }
        return i(e, [{
            key: "advance",
            value: function(e, t) {
                for (var n = this._CompensateImages, i = this._CompensateBones, a = 0; a < this._ActorNodes.length; a++) {
                    var l = this._ActorNodes[a]
                      , u = t;
                    if (l.parent) {
                        var c = l.parent.worldTransform
                          , d = h.mat2d.invert(h.mat2d.create(), c);
                        u = h.vec2.transformMat2(h.vec2.create(), t, d)
                    }
                    if (l.hasWorldTransformOverride) {
                        var f = l.worldTransform
                          , p = h.mat2d.clone(f)
                          , y = h.mat2d.fromTranslation(h.mat2d.create(), t);
                        l.overrideWorldTransform = h.mat2d.mul(h.mat2d.create(), f, y),
                        l.constructor === r.default && l.isConnectedToBones && (l.compensateConnectedBones(p),
                        l.overrideWorldTransform = p)
                    } else
                        l.translation = h.vec2.add(h.vec2.create(), l.translation, u);
                    (this._CompensateImages || this._CompensateBones) && function() {
                        var e = [];
                        if (l.eachChildRecursive((function(t) {
                            (n && t.constructor === r.default || i && (t.constructor === o.default || t.constructor === s.default)) && -1 == e.indexOf(t) && e.push(t)
                        }
                        )),
                        e.length)
                            for (var t = 0; t < e.length; t++) {
                                e[t].compensate()
                            }
                    }()
                }
            }
        }, {
            key: "complete",
            value: function() {}
        }]),
        e
    }();
    t.default = p,
    p.make = function(e, t) {
        for (var n = e.stage.settings, i = n.compensateBones, r = n.compensateImages, o = [], s = 0; s < t.length; s++) {
            var h = t[s];
            if (h.node)
                switch (h.constructor) {
                case c.default:
                    i || r || h.node.constructor !== a.default || o.push(h.node);
                    break;
                case l.default:
                    if (h.node.isConnectedToBones && e.stage.appContext.editingAnimation)
                        continue;
                case u.default:
                case d.default:
                    o.push(h.node)
                }
        }
        if (0 != o.length)
            return new p(i,r,o)
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }
      , o = n(2)
      , a = E(n(313))
      , s = E(n(261))
      , l = E(n(371))
      , u = E(n(383))
      , c = E(n(201))
      , d = E(n(372))
      , h = E(n(243))
      , f = E(n(397))
      , p = E(n(370))
      , y = E(n(381))
      , m = E(n(512))
      , v = E(n(700))
      , g = E(n(583))
      , _ = E(n(584))
      , b = E(n(513))
      , w = E(n(446))
      , O = E(n(1096))
      , S = E(n(696))
      , k = E(n(585))
      , P = E(n(701));
    function E(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var T = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n._LockToAxis = false,
            n._TransformSpace = o.mat2d.create(),
            n._XHandle = new v.default,
            n._XHandle.color = [236 / 255, 62 / 255, 74 / 255, 1],
            n._XHandle.hoverColor = [1, 1, 1, 1],
            n._XHandle.rotationTransform = o.mat2d.fromRotation(o.mat2d.create(), -Math.PI / 2),
            n._YHandle = new v.default,
            n._YHandle.color = [104 / 255, 254 / 255, 217 / 255, 1],
            n._YHandle.hoverColor = [1, 1, 1, 1],
            n._RotationHandle = new g.default(true),
            n._RotationHandle.customSelectionAction = function() {
                return true
            }
            ,
            n._TranslateItem = null,
            n._XHandle.customSelectionAction = function() {
                return true
            }
            ,
            n._YHandle.customSelectionAction = function() {
                return true
            }
            ,
            n._ScaleXHandle = new _.default,
            n._ScaleXHandle.color = [236 / 255, 62 / 255, 74 / 255, 1],
            n._ScaleXHandle.hoverColor = [1, 1, 1, 1],
            n._ScaleXHandle.rotationTransform = o.mat2d.fromRotation(o.mat2d.create(), -Math.PI / 2),
            n._ScaleYHandle = new _.default,
            n._ScaleYHandle.color = [104 / 255, 254 / 255, 217 / 255, 1],
            n._ScaleYHandle.hoverColor = [1, 1, 1, 1],
            n._ScaleModulation = o.vec2.set(o.vec2.create(), 1, 1),
            n._ScaleXHandle.customSelectionAction = function() {
                return true
            }
            ,
            n._ScaleYHandle.customSelectionAction = function() {
                return true
            }
            ,
            n.filterDragSelection = a.default.filterChildren,
            n._IsRotating = n._IsScaling = false,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "validate",
            value: function() {
                var e = this.stage.soloItem;
                return !e || !e.meshEditor
            }
        }, {
            key: "findValidItem",
            value: function(e) {
                for (var t = null, n = e.length - 1; n >= 0; n--)
                    if (e[n].constructor === p.default) {
                        t = [p.default];
                        break
                    }
                for (var i = e.length - 1; i >= 0; i--) {
                    var r = e[i];
                    if (!t || -1 !== t.indexOf(r.constructor)) {
                        switch (r.constructor) {
                        case d.default:
                            continue;
                        case s.default:
                            if (r.node && r.node.isConnectedToBones && this.stage.appContext.editingAnimation)
                                continue
                        }
                        return r
                    }
                }
                return null
            }
        }, {
            key: "updateSelection",
            value: function(e) {
                if (e = a.default.filterChildren(e),
                this._TranslateItem = this.findValidItem(e),
                this._TranslateItem) {
                    var t = true;
                    switch (this._TranslateItem.constructor) {
                    case p.default:
                    case y.default:
                        t = false
                    }
                    this._XHandle.stage || (this._XHandle.addToStage(this.stage),
                    this._YHandle.addToStage(this.stage)),
                    t ? this._RotationHandle.addToStage(this.stage) : this._RotationHandle.removeFromStage(),
                    t ? (this._ScaleXHandle.addToStage(this.stage),
                    this._ScaleYHandle.addToStage(this.stage)) : (this._ScaleXHandle.removeFromStage(),
                    this._ScaleYHandle.removeFromStage())
                } else
                    this._XHandle.stage && (this._XHandle.removeFromStage(),
                    this._YHandle.removeFromStage(),
                    this._ScaleXHandle.removeFromStage(),
                    this._ScaleYHandle.removeFromStage(),
                    this._RotationHandle.removeFromStage())
            }
        }, {
            key: "drawPrep",
            value: function(e) {
                var t = o.mat2d.create()
                  , n = t
                  , i = this.stage.transformSpace
                  , r = null
                  , a = this._TranslateItem;
                if (a)
                    switch (a.constructor) {
                    case f.default:
                        if (a.vtxA && a.vtxB) {
                            var d = o.vec2.add(o.vec2.create(), a.vtxA.worldPosition, a.vtxB.worldPosition);
                            o.vec2.scale(d, d, .5);
                            var v = o.mat2d.fromRotation(o.mat2d.create(), o.mat2d.getRotation(a.parent.node.worldTransform));
                            t = n = o.mat2d.mul(v, o.mat2d.fromTranslation(o.mat2d.create(), d), v)
                        }
                        break;
                    case p.default:
                        var g = o.mat2d.fromRotation(o.mat2d.create(), o.mat2d.getRotation(a.parent.node.worldTransform));
                        t = n = o.mat2d.mul(g, a.renderTransform, g);
                        break;
                    case y.default:
                        t = a.renderTransform,
                        n = a.worldRotationTransform;
                        break;
                    case l.default:
                    case u.default:
                    case c.default:
                    case s.default:
                        (r = a.node).isConnectedToBones ? (t = r.getCentroidTransform(),
                        n = r.worldTransform) : t = n = r.worldTransform;
                        break;
                    case h.default:
                        r = a.node,
                        t = a.renderTransform,
                        n = r.worldTransform
                    }
                i == m.default.Parent ? n = r && r.parent ? r.parent.worldTransform : o.mat2d.create() : i == m.default.World && (n = o.mat2d.create()),
                this._XHandle.alignToTransform(t, n),
                this._YHandle.alignToTransform(t, n),
                this._ScaleXHandle.stage && (this._ScaleXHandle.alignToTransform(t, n),
                this._ScaleYHandle.alignToTransform(t, n)),
                this._RotationHandle.stage && this._RotationHandle.alignToTransform(t, n),
                this._TransformSpace[0] = n[0],
                this._TransformSpace[1] = n[1],
                this._TransformSpace[2] = n[2],
                this._TransformSpace[3] = n[3],
                this._TransformSpace[4] = t[4],
                this._TransformSpace[5] = t[5]
            }
        }, {
            key: "startDrag",
            value: function(e, n) {
                return (this._IsScaling = e === this._ScaleYHandle || e === this._ScaleXHandle) ? e == this._ScaleXHandle ? (this._ScaleModulation[0] = 1,
                this._ScaleModulation[1] = 0) : e == this._ScaleYHandle && (this._ScaleModulation[0] = 0,
                this._ScaleModulation[1] = 1) : (this._IsRotating = e === this._RotationHandle) ? this._RotationHandle.lockAngle() : e != this._XHandle && e != this._YHandle || (this._LockToAxis = e),
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "startDrag", this).call(this, e, n)
            }
        }, {
            key: "endDrag",
            value: function() {
                this._IsRotating && (this._RotationHandle.unlockAngle(),
                this._RotationHandle.sliceAngle = 0),
                this._LockToAxis = false,
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "endDrag", this).call(this)
            }
        }, {
            key: "advanceDrag",
            value: function(e, n, i, a) {
                if (this._LockToAxis) {
                    var s = this._LockToAxis.renderTransform
                      , l = o.mat2d.invert(o.mat2d.create(), s);
                    (n = o.vec2.transformMat2(o.vec2.create(), n, l))[0] = 0,
                    o.vec2.transformMat2(n, n, s)
                }
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "advanceDrag", this).call(this, e, n, i, a)
            }
        }, {
            key: "onKeyDown",
            value: function(e) {
                this.snap = e.shiftKey
            }
        }, {
            key: "onKeyUp",
            value: function(e) {
                this.snap = e.shiftKey
            }
        }, {
            key: "disable",
            value: function() {
                this._XHandle.stage && (this._XHandle.removeFromStage(),
                this._YHandle.removeFromStage(),
                this._ScaleXHandle.removeFromStage(),
                this._ScaleYHandle.removeFromStage(),
                this._RotationHandle.removeFromStage()),
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "disable", this).call(this)
            }
        }, {
            key: "transformers",
            get: function() {
                return this._IsScaling ? [P.default] : this._IsRotating ? [k.default] : [b.default, w.default, S.default, O.default]
            }
        }, {
            key: "handle",
            get: function() {
                return this._IsRotating ? this._RotationHandle : this._LockToAxis || this._XHandle
            }
        }, {
            key: "modulation",
            get: function() {
                return this._ScaleModulation
            }
        }, {
            key: "transformSpace",
            get: function() {
                return this._TransformSpace
            }
        }]),
        t
    }(a.default);
    t.default = T
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = n(581);
    var a = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.name = "Event",
            n._KeyStateTrigger = 0,
            n.treeOrderFactor = 1e-9,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "clearKeyStates",
            value: function() {
                (function e(t, n, i) {
                    null === t && (t = Function.prototype);
                    var r = Object.getOwnPropertyDescriptor(t, n);
                    if (void 0 === r) {
                        var o = Object.getPrototypeOf(t);
                        return null === o ? void 0 : e(o, n, i)
                    }
                    if ("value"in r)
                        return r.value;
                    var a = r.get;
                    return void 0 !== a ? a.call(i) : void 0
                }
                )(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "clearKeyStates", this).call(this),
                this.frameTriggerKS = 0
            }
        }, {
            key: "uiHierIconClass",
            get: function() {
                return "HierarchyEventIcon"
            }
        }, {
            key: "uiSelectionIconClass",
            get: function() {
                return "SelectionEventIcon"
            }
        }, {
            key: "typeName",
            get: function() {
                return "Event"
            }
        }, {
            key: "uiIcon",
            get: function() {
                return "icon-event"
            }
        }, {
            key: "frameTrigger",
            get: function() {
                return null
            },
            set: function(e) {}
        }, {
            key: "frameTriggerKS",
            get: function() {
                return this._KeyStateTrigger
            },
            set: function(e) {
                this._KeyStateTrigger != e && (this._KeyStateTrigger = e,
                this.markKeyStateDirty())
            }
        }, {
            key: "keyFrameHandler",
            get: function() {
                return this.kfh || (this.kfh = new s(this)),
                this.kfh
            }
        }]),
        t
    }(((i = o) && i.__esModule ? i : {
        default: i
    }).default);
    t.default = a;
    var s = function() {
        function e(e) {
            this.dispatcher = e
        }
        return e.prototype.setKey = function(e) {
            e.editingAnimation.setKey(this.dispatcher, "frameTrigger"),
            e.captureJournalEntry()
        }
        ,
        Object.defineProperties(e.prototype, {
            state: {
                get: function() {
                    return this.dispatcher.frameTriggerKS
                }
            },
            event: {
                get: function() {
                    return "keyState"
                }
            }
        }),
        e
    }()
}
, , , , , , , , , , , , , , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }, a = n(208), s = (i = a) && i.__esModule ? i : {
        default: i
    }, l = n(2);
    var u = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n._Length = 0,
            n._Skins = null,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "markSkinDeformDirty",
            value: function() {
                if (this._Skins)
                    for (var e = 0; e < this._Skins.length; e++) {
                        this._Skins[e].markDeformDirty()
                    }
            }
        }, {
            key: "onTransform",
            value: function() {
                this.markSkinDeformDirty()
            }
        }, {
            key: "onWorldTransform",
            value: function() {
                this.markSkinDeformDirty()
            }
        }, {
            key: "serializeProperties",
            value: function(e) {
                var n = o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeProperties", this).call(this, e);
                return delete n.skins,
                n
            }
        }, {
            key: "serializeInteractive",
            value: function() {
                var e = o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeInteractive", this).call(this);
                return this._Skins && (e.skins = this._Skins.slice(0)),
                e
            }
        }, {
            key: "uiSelectionIconClass",
            get: function() {
                return "SelectionBoneIcon"
            }
        }, {
            key: "allowDragDrop",
            get: function() {
                return false
            }
        }, {
            key: "length",
            get: function() {
                return this._Length
            },
            set: function(e) {
                this._Length != e && this.dispatch("lengthChanged", {
                    from: e,
                    to: this._Length
                }),
                this._Length !== e && (this._Length = e,
                this.markTransformDirty())
            }
        }, {
            key: "firstBone",
            get: function() {
                var e = this.children
                  , n = true
                  , i = false
                  , r = void 0;
                try {
                    for (var o, a = e[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                        var s = o.value;
                        if (s instanceof t)
                            return s
                    }
                } catch (e) {
                    i = true,
                    r = e
                } finally {
                    try {
                        !n && a.return && a.return()
                    } finally {
                        if (i)
                            throw r
                    }
                }
                return null
            }
        }, {
            key: "tipWorldTranslation",
            get: function() {
                var e = l.mat2d.create();
                return e[4] = this.length,
                l.mat2d.mul(e, this.worldTransform, e),
                l.mat2d.getTranslation(l.vec2.create(), e)
            }
        }, {
            key: "rigLength",
            get: function() {
                return this._Length
            }
        }, {
            key: "skins",
            get: function() {
                return this._Skins || (this._Skins = []),
                this._Skins
            },
            set: function(e) {
                e && e.constructor === Array && (this._Skins = e)
            }
        }]),
        t
    }(s.default);
    t.default = u
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = u(n(314))
      , r = u(n(267))
      , o = u(n(237))
      , a = u(n(398))
      , s = u(n(511))
      , l = u(n(464));
    function u(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var c = function(e) {
        function t(e, n, i, u) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var c = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e, n))
              , d = i.indexOf(n.root.stageItem);
            -1 != d && (console.log("DO NOT DELETE ROOT!"),
            i.splice(d, 1));
            for (var h = [], f = 0; f < u.length; f++) {
                var p = u[f];
                p instanceof s.default ? p.all((function(e) {
                    h.push(e)
                }
                )) : p instanceof l.default && h.push(p)
            }
            n.root.eachChildRecursive((function(e) {
                e.constructor === r.default && -1 != h.indexOf(e.asset) && e.stageItem && i.push(e.stageItem)
            }
            )),
            n.removeAssets(u),
            e.appContext.deselectItems(u);
            for (var y = [], m = [], v = 0; v < i.length; v++) {
                var g = i[v]
                  , _ = g.node
                  , b = true;
                if (_) {
                    switch (_.constructor) {
                    case a.default:
                        continue
                    }
                    for (var w = 0; w < i.length; w++)
                        if (w != v) {
                            var O = i[w];
                            if (g.node.isChildOf(O.node)) {
                                b = false;
                                break
                            }
                        }
                    if (b && g.node.parent) {
                        switch (g.node.parent.remove(g.node),
                        g.node.stageItem.removeFromStage(),
                        g.node.constructor) {
                        case o.default:
                            y.push(g.node);
                            break;
                        case r.default:
                            m.push(g.node)
                        }
                        g.node.hasChildren && g.node.eachChildRecursive((function(e) {
                            e.constructor === o.default && y.push(e),
                            e.stageItem && e.stageItem.removeFromStage()
                        }
                        ))
                    }
                } else
                    g.removeFromStage()
            }
            if (m.length) {
                var S = true
                  , k = false
                  , P = void 0;
                try {
                    for (var E, T = m[Symbol.iterator](); !(S = (E = T.next()).done); S = true) {
                        var C = E.value;
                        if (C.connectedBones && C.connectedBones.length) {
                            var x = C.connectedBones.slice(0)
                              , I = true
                              , D = false
                              , M = void 0;
                            try {
                                for (var A, j = x[Symbol.iterator](); !(I = (A = j.next()).done); I = true) {
                                    var L = A.value;
                                    C.disconnectBone(L.node)
                                }
                            } catch (e) {
                                D = true,
                                M = e
                            } finally {
                                try {
                                    !I && j.return && j.return()
                                } finally {
                                    if (D)
                                        throw M
                                }
                            }
                        }
                    }
                } catch (e) {
                    k = true,
                    P = e
                } finally {
                    try {
                        !S && T.return && T.return()
                    } finally {
                        if (k)
                            throw P
                    }
                }
            }
            if (y.length) {
                var R = [];
                n.root.eachChildRecursive((function(e) {
                    e.constructor === r.default && e.connectedBones.length && R.push(e)
                }
                ));
                for (var F = 0; F < y.length; F++)
                    for (var B = y[F], V = 0; V < R.length; V++) {
                        R[V].disconnectBone(B)
                    }
            }
            return c
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        t
    }(i.default);
    t.default = c
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = a(n(695))
      , o = a(n(396));
    function a(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var s = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this));
            return n._Actor = e,
            n._Id = null,
            n._RefID = "A" + o.default.ID++,
            n._Type = null,
            n._IsMissing = false,
            n._Parent = null,
            n.file = null,
            n._Removed = false,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "onRemovedFromActor",
            value: function() {
                this._Removed = true
            }
        }, {
            key: "onAddedToActor",
            value: function() {
                this._Removed = false
            }
        }, {
            key: "setParent",
            value: function(e) {
                this._Parent = e,
                this.onParentChanged && this.onParentChanged()
            }
        }, {
            key: "fromFile",
            value: function(e, t) {
                t && t()
            }
        }, {
            key: "read",
            value: function(e, t, n) {
                this.setName(t.name),
                this._Id = t.id,
                t.generateNewId && (e.addTempAssetLookup(this._Id, this),
                this._Id = null),
                this._Type = t.type,
                this._IsMissing = false;
                var i = this
                  , r = t.data
                  , o = t.blob
                  , a = false;
                r ? this.fromBase64(r) : o ? (a = true,
                this.file = o,
                this.fromFile(o, n)) : t.getAsync ? (a = true,
                t.getAsync(this, (function(e) {
                    e ? i.fromFile(e, n) : (i._IsMissing = true,
                    i.dispatch("update", i),
                    n && n())
                }
                ))) : this.readRaw ? (a = true,
                this.readRaw(e, t, (function(e) {
                    e || (i._IsMissing = true,
                    i.dispatch("update", i)),
                    n && n()
                }
                ))) : this._IsMissing = true,
                !a && n && n()
            }
        }, {
            key: "serialize",
            value: function() {
                return {
                    name: this.name,
                    id: this._Id,
                    type: this._Type
                }
            }
        }, {
            key: "serializeInteractive",
            value: function() {
                return {
                    name: this.name
                }
            }
        }, {
            key: "serializeHistory",
            value: function() {
                return this.serializeInteractive()
            }
        }, {
            key: "canBeReplacedBy",
            value: function(e) {
                return this.constructor === e.constructor
            }
        }, {
            key: "replaceWith",
            value: function(e, t) {
                var n = this;
                t.root.all((function(t) {
                    t.asset === n && (t.asset = e)
                }
                )),
                t.removeAsset(this)
            }
        }, {
            key: "all",
            value: function(e) {
                return e(this)
            }
        }, {
            key: "parent",
            get: function() {
                return this._Parent
            }
        }, {
            key: "refId",
            get: function() {
                return this._RefID
            }
        }, {
            key: "id",
            get: function() {
                return this._Id
            },
            set: function(e) {
                this._Id != e && (this._Id = e,
                this.dispatch("update", this))
            }
        }, {
            key: "type",
            get: function() {
                return this._Type
            }
        }, {
            key: "isMissing",
            get: function() {
                return this._IsMissing
            },
            set: function(e) {
                this._IsMissing = e,
                this.dispatch("update", this)
            }
        }]),
        t
    }(r.default);
    t.default = s
}
, , , , , , , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = n(314);
    var o = function(e) {
        function t(e, n, i, r) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var o = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e, n));
            return console.log("RENAMING", r),
            i.name = r.substring(0, t.MAX_LENGTH),
            o
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        t
    }(((i = r) && i.__esModule ? i : {
        default: i
    }).default);
    t.default = o,
    o.MAX_LENGTH = 40
}
, , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    });
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }();
    var r = function() {
        function e() {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e)
        }
        return i(e, [{
            key: "canSelect",
            value: function(e) {
                return this.canSelectType(e.constructor) || e.drawAfterSelections
            }
        }, {
            key: "canSelectType",
            value: function(e) {
                return true
            }
        }]),
        e
    }();
    t.default = r
}
, , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }
      , o = c(n(313))
      , a = c(n(397))
      , s = c(n(696))
      , l = c(n(370))
      , u = n(2);
    function c(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var d = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.alwaysMarquee = true,
            n._SuppressDragOperation = false,
            n._IsDrawingContour = true,
            n._SelectedVertex = null,
            n._CheckingInclusion = false,
            n._IsOverMesh = false,
            n._CheckCount = 0,
            n._ScheduledDoAfterInclusion = null,
            n._DragEdgeFrom = null,
            n._IsDeleting = false,
            n._HaveDeleteTarget = false,
            n._HaveAddTarget = false,
            n._ClickDeleted = false,
            n._LastMarkedItems = [],
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "allowDrag",
            value: function() {
                return !this._DragEdgeFrom && !this._HaveDeleteTarget
            }
        }, {
            key: "cancelDrag",
            value: function() {
                if (this._IsDrawingContour)
                    return false;
                var e = null !== this._DragEdgeFrom;
                this._DragEdgeFrom = null;
                var t = this.stage.soloItem;
                if (t) {
                    var n = t.meshEditor;
                    n.hideGhostPoint(),
                    n.hideGhostEdge()
                }
                return e
            }
        }, {
            key: "updateState",
            value: function() {
                var e = this.stage.soloItem
                  , t = !e.meshEditor.isContourClosed;
                if (this._IsDrawingContour != t && (this._IsDrawingContour = t,
                this.alwaysMarquee = this._IsDrawingContour),
                this._IsDeleting && e) {
                    var n = e.meshEditor;
                    n.hideGhostPoint(),
                    n.hideGhostEdge()
                }
            }
        }, {
            key: "cancel",
            value: function() {
                return this.cancelDrag()
            }
        }, {
            key: "validate",
            value: function() {
                var e = this.stage.soloItem;
                return !!e && !!e.meshEditor
            }
        }, {
            key: "enable",
            value: function() {
                var e = this.stage.soloItem;
                return !!e && (!!e.meshEditor && (this.hoverItemChange(this.stage.hoverItem),
                void r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "enable", this).call(this)))
            }
        }, {
            key: "disable",
            value: function() {
                this.hoverItemChange(null),
                this._DragEdgeFrom = null;
                var e = this.stage.soloItem;
                if (e) {
                    var n = e.meshEditor;
                    n && (n.hideGhostPoint(),
                    n.hideGhostEdge())
                }
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "disable", this).call(this),
                this.cancel()
            }
        }, {
            key: "hoverItemChange",
            value: function(e) {
                var t = this.stage.soloItem;
                if (t) {
                    for (var n = t.meshEditor, i = 0; i < this._LastMarkedItems.length; i++)
                        this._LastMarkedItems[i].willDelete = false;
                    if (this._LastMarkedItems.length && this.stage.redraw(),
                    this._LastMarkedItems.length = 0,
                    this._HaveDeleteTarget = false,
                    this._IsDeleting && e) {
                        if (this._LastMarkedItems.push(e),
                        e.constructor === l.default)
                            for (var r = n.getConnectedEdges(e), o = 0; o < r.length; o++) {
                                var a = r[o];
                                a.willDelete = true,
                                this._LastMarkedItems.push(a)
                            }
                        else
                            e.isInternal || (this._LastMarkedItems.push(e.vtxA),
                            e.vtxA.willDelete = true,
                            this._LastMarkedItems.push(e.vtxB),
                            e.vtxB.willDelete = true);
                        e.willDelete = true,
                        this._HaveDeleteTarget = true,
                        this.stage.redraw()
                    }
                }
            }
        }, {
            key: "updateSelection",
            value: function(e) {
                this._SelectedVertex = null;
                for (var t = 0; t < e.length; t++) {
                    var n = e[t];
                    n.constructor === l.default && (this._SelectedVertex = n)
                }
            }
        }, {
            key: "onKeyDown",
            value: function(e) {
                18 !== e.keyCode || this._IsDeleting || (this._IsDeleting = true,
                this.updateState(),
                this.hoverItemChange(this.stage.hoverItem))
            }
        }, {
            key: "onKeyUp",
            value: function(e) {
                18 === e.keyCode && this._IsDeleting && (this._IsDeleting = false,
                this.updateState(),
                this.hoverItemChange(null),
                this._LastMouse && this.mouseMove(this._LastMouse.mouseMove, this._LastMouse.worldMouseMove, this._LastMouse.worldMouse))
            }
        }, {
            key: "advanceDrag",
            value: function(e, n, i, o) {
                this._SuppressDragOperation || r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "advanceDrag", this).call(this, e, n, i, o)
            }
        }, {
            key: "mouseMove",
            value: function(e, t, n) {
                this._LastMouse = {
                    mouseMove: u.vec2.clone(e),
                    worldMouseMove: u.vec2.clone(t),
                    worldMouse: u.vec2.clone(n)
                },
                this.updateState();
                var i = this.stage.soloItem.meshEditor;
                if (this._HaveAddTarget = false,
                !this._IsDeleting) {
                    if (this._IsDrawingContour)
                        this.stage.hoverItem && this.stage.hoverItem.constructor === l.default ? i.hideGhostPoint() : (this.stage.hoverItem && this.stage.hoverItem.constructor === a.default && (n = a.default.pointOnSegment(this.stage.hoverItem.vtxA.worldPosition, this.stage.hoverItem.vtxB.worldPosition, n[0], n[1])),
                        i.updateGhostPoint(n)),
                        this.stage.hoverItem && (this.stage.hoverItem.constructor === a.default || this.stage.hoverItem.constructor === l.default && this.stage.hoverItem !== i.firstContourVertex) ? i.hideGhostEdge() : i.updateGhostEdge(this.stage.hoverItem === i.firstContourVertex ? this.stage.hoverItem : null);
                    else {
                        if (this.stage.hoverItem && this.stage.hoverItem.constructor === l.default)
                            this._CheckingInclusion = false,
                            this._IsOverMesh = true,
                            i.hideGhostPoint(),
                            this._DragEdgeFrom && i.updateGhostEdge(this.stage.hoverItem, this._DragEdgeFrom);
                        else if (this.stage.hoverItem && this.stage.hoverItem.constructor === a.default)
                            n = a.default.pointOnSegment(this.stage.hoverItem.vtxA.worldPosition, this.stage.hoverItem.vtxB.worldPosition, n[0], n[1]),
                            i.updateGhostPoint(n),
                            this._CheckingInclusion = false,
                            this._IsOverMesh = true,
                            this._DragEdgeFrom && i.updateGhostEdge(null, this._DragEdgeFrom);
                        else if (i.contourOnly)
                            i.hideGhostPoint();
                        else {
                            this._CheckingInclusion = true,
                            this._CheckCount++;
                            var r = this;
                            i.isPointOverMesh(i.getLocalPoint(n), (o = this._CheckCount,
                            function(e) {
                                r._CheckingInclusion && o !== r._CheckCount || (r._CheckingInclusion = false,
                                r._IsOverMesh = e,
                                e ? (r._HaveAddTarget = true,
                                i.updateGhostPoint(n),
                                r._DragEdgeFrom && i.updateGhostEdge(null, r._DragEdgeFrom),
                                r._ScheduledDoAfterInclusion && !r._IsDrawingContour && r._ScheduledDoAfterInclusion()) : i.hideGhostPoint(),
                                r._ScheduledDoAfterInclusion = null)
                            }
                            ))
                        }
                        this._DragEdgeFrom || i.hideGhostEdge()
                    }
                    var o;
                    return true
                }
            }
        }, {
            key: "doAfterInclusion",
            value: function(e) {
                this._CheckingInclusion ? this._ScheduledDoAfterInclusion = e : this._IsOverMesh && e()
            }
        }, {
            key: "release",
            value: function(e, n) {
                var i, o, s = this.stage.soloItem.meshEditor;
                if (this._IsDeleting || this._ClickDeleted)
                    ;
                else if (this._IsDrawingContour)
                    !n && this.stage.hoverItem === s.firstContourVertex && s.contourVerticesCount > 0 ? s.ghostEdge && s.ghostEdge.collisionEdge ? s.insertContourPoint(s.ghostEdge.collisionEdge, s.ghostEdge.vtxB.worldPosition) : s.canCloseContour && s.closeContour() : !n && this._SuppressDragOperation && (this.stage.hoverItem && this.stage.hoverItem.constructor === a.default ? (e = a.default.pointOnSegment(this.stage.hoverItem.vtxA.worldPosition, this.stage.hoverItem.vtxB.worldPosition, e[0], e[1]),
                    s.insertContourPoint(this.stage.hoverItem, e)) : s.ghostEdge && s.ghostEdge.collisionEdge ? s.insertContourPoint(s.ghostEdge.collisionEdge, s.ghostEdge.vtxB.worldPosition) : s.appendContourPoint(e));
                else {
                    if (this._DragEdgeFrom && this._DragEdgeFrom != this.stage.hoverItem)
                        if (s.hideGhostPoint(),
                        s.hideGhostEdge(),
                        this.stage.hoverItem && this.stage.hoverItem.constructor === l.default) {
                            var c = this.stage.hoverItem;
                            s.edgeExists(this._DragEdgeFrom, c) || s.addEdge(this._DragEdgeFrom, c)
                        } else if (this.stage.hoverItem && this.stage.hoverItem.constructor === a.default) {
                            var d = this.stage.hoverItem;
                            e = a.default.pointOnSegment(d.vtxA.worldPosition, d.vtxB.worldPosition, e[0], e[1]);
                            var h = s.splitEdge(d, e);
                            this._DragEdgeFrom !== d.vtxA && this._DragEdgeFrom !== d.vtxB && s.addEdge(this._DragEdgeFrom, h)
                        } else
                            this.doAfterInclusion((i = u.vec2.clone(e),
                            o = this._DragEdgeFrom,
                            function() {
                                var e = s.addPoint(i, false, true);
                                s.addEdge(o, e)
                            }
                            ));
                    this._DragEdgeFrom = null
                }
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "release", this).call(this, e, n)
            }
        }, {
            key: "blockMarquee",
            value: function(e) {
                return this._HaveAddTarget
            }
        }, {
            key: "marqueeStarted",
            value: function() {
                this.stage.soloItem.meshEditor.hideGhostPoint()
            }
        }, {
            key: "click",
            value: function(e, t, n) {
                var i, r = this.stage.soloItem.meshEditor;
                if (this._ClickDeleted = false,
                this._IsDeleting)
                    this._ClickDeleted = true,
                    this.stage.hoverItem && r.delete(this.stage.hoverItem);
                else if (this._IsDrawingContour) {
                    if (this.stage.hoverItem && this.stage.hoverItem.constructor === l.default)
                        return void (this._SuppressDragOperation = false);
                    this._SuppressDragOperation = true
                } else if (t) {
                    if (n.shiftKey && (this._DragEdgeFrom = this._SelectedVertex),
                    this.stage.hoverItem && this.stage.hoverItem.constructor === l.default)
                        n.shiftKey ? (this._DragEdgeFrom = this.stage.hoverItem,
                        this.stage.selectItem(this._DragEdgeFrom)) : this.stage.selectItem(this.stage.hoverItem);
                    else if (this.stage.hoverItem && this.stage.hoverItem.constructor === a.default) {
                        e = a.default.pointOnSegment(this.stage.hoverItem.vtxA.worldPosition, this.stage.hoverItem.vtxB.worldPosition, e[0], e[1]);
                        var o = r.splitEdge(this.stage.hoverItem, e);
                        n.shiftKey ? this._DragEdgeFrom = o : r.hideGhostPoint(),
                        this.stage.selectItem(o)
                    }
                    r.contourOnly && (this._DragEdgeFrom = null)
                } else if (!r.contourOnly)
                    if (r.ghostEdge && r.ghostEdge.collisionEdge)
                        ;
                    else {
                        var s = this
                          , c = n.shiftKey;
                        this.doAfterInclusion((i = u.vec2.clone(e),
                        function() {
                            c ? (s._DragEdgeFrom = r.addPoint(i),
                            s.stage.selectItem(s._DragEdgeFrom)) : (s.stage.selectItem(r.addPoint(i)),
                            r.hideGhostPoint())
                        }
                        ))
                    }
            }
        }, {
            key: "transformers",
            get: function() {
                return [s.default]
            }
        }]),
        t
    }(o.default);
    t.default = d
}
, , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = n(262);
    var o = function(e) {
        function t() {
            return function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t),
            function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, "SkinWorker.js"))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        t
    }(((i = r) && i.__esModule ? i : {
        default: i
    }).default);
    t.default = o,
    o.call = function(e, t, n) {
        o.instance || (o.instance = new o),
        o.instance.call(e, t, n)
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }, a = p(n(462)), s = p(n(396)), l = p(n(398)), u = n(2), c = p(n(11)), d = p(n(1)), h = p(n(580)), f = p(n(203));
    function p(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function y(e, t) {
        if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function")
    }
    function m(e, t) {
        if (!e)
            throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    function v(e, t) {
        if ("function" != typeof t && null !== t)
            throw new TypeError("Super expression must either be null or a function, not " + typeof t);
        e.prototype = Object.create(t && t.prototype, {
            constructor: {
                value: e,
                enumerable: false,
                writable: true,
                configurable: true
            }
        }),
        t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
    }
    var g = 4 * (Math.sqrt(2) - 1) / 3 * Math.sqrt(2) * .5;
    function _(e, t, n, i, r, o, a) {
        var s = o
          , l = 3 * (t - e) / s
          , u = 3 * (e - 2 * t + n) / (s *= o)
          , c = (i - e + 3 * (t - n)) / (s *= o);
        e = e,
        t = l + u + c,
        n = 2 * u + 6 * c,
        i = 6 * c;
        for (var d = 0; d <= o; d++)
            r[d][a] = e,
            e += t,
            t += n,
            n += i
    }
    function b(e, t) {
        var n = e[0]
          , i = e[1]
          , r = t[0]
          , o = t[1];
        return Math.abs(n - r) <= .001 * Math.max(1, Math.abs(n), Math.abs(r)) && Math.abs(i - o) <= .001 * Math.max(1, Math.abs(i), Math.abs(o))
    }
    var w, O, S, k, P, E, T = (i = function(e) {
        function t(e) {
            y(this, t);
            var n = m(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.name = "Jelly",
            n.hideInHierarchy = true,
            n._Bones = [],
            n._Pool = [],
            n._Cache = null,
            n._HideJellies = false,
            n._HideBone = false,
            n._EaseIn = .5,
            n._EaseOut = .5,
            n._ScaleIn = 1,
            n._ScaleOut = 1,
            n._InTarget = null,
            n._OutTarget = null,
            n._InPoint = u.vec2.create(),
            n._InDirection = u.vec2.create(),
            n._OutPoint = u.vec2.create(),
            n._OutDirection = u.vec2.create(),
            n
        }
        return v(t, e),
        r(t, [{
            key: "updateDependencies",
            value: function(e) {
                o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "updateDependencies", this).call(this, e);
                var n = this._Parent
                  , i = [];
                if (n) {
                    e.addDependency(this, n),
                    i = i.concat(Array.from(n.allConstraints));
                    var r = n.firstBone;
                    r && (e.addDependency(this, r),
                    i = i.concat(Array.from(r.allConstraints)),
                    !this.outTarget && r.jelly && r.jelly.inTarget && (e.addDependency(this, r.jelly.inTarget),
                    i = i.concat(Array.from(r.jelly.inTarget.allConstraints))));
                    var s = n.parent instanceof a.default && n.parent
                      , l = s && s.jelly;
                    l && l.outTarget && (e.addDependency(this, l.outTarget),
                    i = i.concat(Array.from(l.outTarget.allConstraints)))
                }
                this._InTarget && (e.addDependency(this, this._InTarget),
                i = i.concat(Array.from(this._InTarget.allConstraints))),
                this._OutTarget && (e.addDependency(this, this._OutTarget),
                i = i.concat(Array.from(this._OutTarget.allConstraints))),
                i = new Set(i);
                var u = true
                  , c = false
                  , d = void 0;
                try {
                    for (var h, f = i[Symbol.iterator](); !(u = (h = f.next()).done); u = true) {
                        var p = h.value;
                        e.addDependency(this, p)
                    }
                } catch (e) {
                    c = true,
                    d = e
                } finally {
                    try {
                        !u && f.return && f.return()
                    } finally {
                        if (c)
                            throw d
                    }
                }
                var y = this._Bones;
                if (y) {
                    var m = true
                      , v = false
                      , g = void 0;
                    try {
                        for (var _, b = y[Symbol.iterator](); !(m = (_ = b.next()).done); m = true) {
                            var w = _.value;
                            e.addDependency(w, this),
                            w.updateDependencies(e)
                        }
                    } catch (e) {
                        v = true,
                        g = e
                    } finally {
                        try {
                            !m && b.return && b.return()
                        } finally {
                            if (v)
                                throw g
                        }
                    }
                }
            }
        }, {
            key: "setDefaults",
            value: function() {
                this.segments = 2
            }
        }, {
            key: "updateJellies",
            value: function() {
                var e = this.parent
                  , t = e.length
                  , n = u.vec2.set(u.vec2.create(), t, 0)
                  , i = this._Cache;
                e.dispatch("updateInOut");
                var r = this._Bones;
                if (r && !(i && i.count === r.length && b(i.tip, n) && b(i.out, this._OutPoint) && b(i.in, this._InPoint) && i.sin === this._ScaleIn && i.sout === this._ScaleOut)) {
                    this._Cache = {
                        count: r.length,
                        tip: n,
                        out: u.vec2.clone(this._OutPoint),
                        in: u.vec2.clone(this._InPoint),
                        sin: this._ScaleIn,
                        sout: this._ScaleOut
                    };
                    for (var o = u.vec2.create(), a = this._InPoint, s = this._OutPoint, l = n, c = [], d = 0; d <= 16; d++)
                        c.push(new Float32Array(2));
                    _(o[0], a[0], s[0], l[0], c, 16, 0),
                    _(o[1], a[1], s[1], l[1], c, 16, 1),
                    this._CurvePoints = c,
                    this._GraphicsCurve = null;
                    for (var h = function(e, t) {
                        var n = []
                          , i = e.length
                          , r = new Float32Array(i);
                        r[0] = 0;
                        for (var o = 0; o < i - 1; o++) {
                            var a = e[o]
                              , s = e[o + 1];
                            r[o + 1] = r[o] + u.vec2.distance(a, s)
                        }
                        for (var l = r[i - 1] / t, c = 1, d = 1; d <= t; d++) {
                            for (var h = l * d; c < i - 1 && r[c] < h; )
                                c++;
                            var f = r[c]
                              , p = (f - h) / (f - r[c - 1])
                              , y = 1 - p
                              , m = e[c - 1]
                              , v = e[c];
                            try {
                                n.push([m[0] * p + v[0] * y, m[1] * p + v[1] * y])
                            } catch (t) {
                                console.log("P1", m, v, c, e)
                            }
                        }
                        return n
                    }(c, r.length), f = c[0], p = this._ScaleIn, y = (this._ScaleOut - this._ScaleIn) / (r.length - 1), m = 0; m < h.length; m++) {
                        var v = r[m]
                          , g = h[m];
                        v.translation = f,
                        v.length = u.vec2.distance(g, f),
                        v.scale = u.vec2.set(u.vec2.create(), 1, p),
                        p += y;
                        var w = u.vec2.subtract(u.vec2.create(), g, f);
                        v.rotation = Math.atan2(w[1], w[0]),
                        f = g
                    }
                }
            }
        }, {
            key: "setOutDirection",
            value: function(e) {
                var t = this.parent.length
                  , n = this._EaseOut * t * g
                  , i = u.vec2.normalize(this._OutDirection, e);
                i = u.vec2.scale(u.vec2.create(), i, n);
                var r = this.tipPosition;
                u.vec2.add(this._OutPoint, r, i),
                this.updateJellies()
            }
        }, {
            key: "onParentChanged",
            value: function() {
                if (this.parent instanceof a.default) {
                    var e = true
                      , t = false
                      , n = void 0;
                    try {
                        for (var i, r = this._Bones[Symbol.iterator](); !(e = (i = r.next()).done); e = true) {
                            i.value.setParent(this.parent)
                        }
                    } catch (e) {
                        t = true,
                        n = e
                    } finally {
                        try {
                            !e && r.return && r.return()
                        } finally {
                            if (t)
                                throw n
                        }
                    }
                }
            }
        }, {
            key: "markJellyDirty",
            value: function() {
                var e = this.parent;
                e && (e.markTransformDirty(),
                e.dispatch("jellyChange"))
            }
        }, {
            key: "onTargetRemovedFromStage",
            value: function(e, t) {
                this._InTarget && this._InTarget.stageItem === t && (this.inTarget = null),
                this._OutTarget && this._OutTarget.stageItem === t && (this.outTarget = null)
            }
        }, {
            key: "onDirty",
            value: function() {}
        }, {
            key: "update",
            value: function(e, t) {
                var n = this.parent
                  , i = n.length
                  , r = n.parent instanceof a.default && n.parent
                  , o = r && r.jelly
                  , s = u.mat2d.invert(u.mat2d.create(), n.worldTransform);
                if (s) {
                    if (this._InTarget) {
                        var l = this._InTarget.worldTranslation;
                        u.vec2.transformMat2d(this._InPoint, l, s),
                        u.vec2.normalize(this._InDirection, this._InPoint)
                    } else if (r) {
                        if (r.firstBone === n && o && o.outTarget) {
                            var d = o.outTarget.worldTranslation
                              , h = u.vec2.transformMat2d(u.vec2.create(), d, s);
                            u.vec2.normalize(h, h),
                            u.vec2.negate(this._InDirection, h)
                        } else {
                            var f = u.vec2.set(u.vec2.create(), 1, 0)
                              , p = u.vec2.set(u.vec2.create(), 1, 0);
                            u.vec2.transformMat2(f, f, r.worldTransform),
                            u.vec2.transformMat2(p, p, n.worldTransform);
                            var y = u.vec2.add(u.vec2.create(), f, p)
                              , m = u.vec2.transformMat2(this._InDirection, y, s);
                            u.vec2.normalize(m, m)
                        }
                        u.vec2.scale(this._InPoint, this._InDirection, this._EaseIn * i * g)
                    } else
                        u.vec2.set(this._InDirection, 1, 0),
                        u.vec2.set(this._InPoint, this._EaseIn * i * g, 0);
                    if (this._OutTarget) {
                        var v = this._OutTarget.worldTranslation;
                        u.vec2.transformMat2d(this._OutPoint, v, s);
                        var _ = u.vec2.set(u.vec2.create(), i, 0);
                        u.vec2.subtract(this._OutDirection, this._OutPoint, _),
                        u.vec2.normalize(this._OutDirection, this._OutDirection)
                    } else if (n.firstBone) {
                        var b = n.firstBone
                          , w = b.jelly;
                        if (w && w.inTarget) {
                            var O = w.inTarget.worldTranslation
                              , S = u.vec2.subtract(u.vec2.create(), b.worldTranslation, O)
                              , k = u.vec2.transformMat2(this._OutDirection, S, s);
                            u.vec2.normalize(k, k)
                        } else {
                            var P = u.vec2.set(u.vec2.create(), 1, 0)
                              , E = u.vec2.set(u.vec2.create(), 1, 0);
                            u.vec2.transformMat2(P, P, b.worldTransform),
                            u.vec2.transformMat2(E, E, n.worldTransform);
                            var T = u.vec2.add(u.vec2.create(), P, E);
                            u.vec2.negate(T, T);
                            var C = u.vec2.transformMat2(this._OutDirection, T, s);
                            u.vec2.normalize(C, C)
                        }
                        u.vec2.normalize(this._OutDirection, this._OutDirection);
                        var x = u.vec2.scale(u.vec2.create(), this._OutDirection, this._EaseOut * i * g);
                        u.vec2.set(this._OutPoint, i, 0),
                        u.vec2.add(this._OutPoint, this._OutPoint, x)
                    } else {
                        u.vec2.set(this._OutDirection, -1, 0);
                        var I = u.vec2.scale(u.vec2.create(), this._OutDirection, this._EaseOut * i * g);
                        u.vec2.set(this._OutPoint, i, 0),
                        u.vec2.add(this._OutPoint, this._OutPoint, I)
                    }
                    this.updateJellies()
                } else
                    c.default.warn("Failed to invert transform space", n.worldTransform)
            }
        }, {
            key: "setParent",
            value: function(e) {
                var n = this._Parent;
                o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "setParent", this).call(this, e),
                e !== n && this._Actor.markDependenciesDirty();
                var i = this._Bones;
                if (null === e) {
                    var r = true
                      , a = false
                      , s = void 0;
                    try {
                        for (var l, u = i[Symbol.iterator](); !(r = (l = u.next()).done); r = true) {
                            l.value.all((function(e) {
                                e.stageItem && e.stageItem.removeFromStage()
                            }
                            ))
                        }
                    } catch (e) {
                        a = true,
                        s = e
                    } finally {
                        try {
                            !r && u.return && u.return()
                        } finally {
                            if (a)
                                throw s
                        }
                    }
                } else {
                    if (e.stageItem && e.stageItem.stage) {
                        var c = true
                          , d = false
                          , h = void 0;
                        try {
                            for (var f, p = i[Symbol.iterator](); !(c = (f = p.next()).done); c = true) {
                                f.value.all((function(t) {
                                    t.stageItem && t.stageItem.addToStage(e.stageItem.stage)
                                }
                                ))
                            }
                        } catch (e) {
                            d = true,
                            h = e
                        } finally {
                            try {
                                !c && p.return && p.return()
                            } finally {
                                if (d)
                                    throw h
                            }
                        }
                    }
                }
            }
        }, {
            key: "read",
            value: function(e, n) {
                o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "read", this).call(this, e, n);
                var i = n.jellies;
                if (i) {
                    this._HideJellies = n.hideJellies,
                    this._HideBone = n.hideBone;
                    var r = Number.parseFloat(n.easeIn)
                      , a = Number.parseFloat(n.easeOut);
                    Number.isNaN(r) || (this._EaseIn = r),
                    Number.isNaN(a) || (this._EaseOut = a);
                    var s = Number.parseFloat(n.scaleIn)
                      , u = Number.parseFloat(n.scaleOut);
                    Number.isNaN(s) || (this._ScaleIn = s),
                    Number.isNaN(u) || (this._ScaleOut = u);
                    var c = n.inTarget
                      , d = n.outTarget;
                    if (c || d) {
                        var h = this;
                        e.whenNodesLoaded((function() {
                            c && (h.inTarget = e.getNode(c)),
                            d && (h.outTarget = e.getNode(d))
                        }
                        ))
                    }
                    this._Bones.length = 0;
                    var f = true
                      , p = false
                      , y = void 0;
                    try {
                        for (var m, v = i[Symbol.iterator](); !(f = (m = v.next()).done); f = true) {
                            var g = m.value
                              , _ = e.addNodeType(l.default, null, g, true);
                            _ && (this._Bones.push(_),
                            g.children && e.recurseLoad(g.children, _))
                        }
                    } catch (e) {
                        p = true,
                        y = e
                    } finally {
                        try {
                            !f && v.return && v.return()
                        } finally {
                            if (p)
                                throw y
                        }
                    }
                }
            }
        }, {
            key: "serializeProperties",
            value: function(e) {
                var n = o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeProperties", this).call(this, e);
                n.hideJellies || delete n.hideJellies,
                n.hideBone || delete n.hideBone;
                var i = this._Bones;
                if (i) {
                    var r = []
                      , a = true
                      , s = false
                      , l = void 0;
                    try {
                        for (var u, c = i[Symbol.iterator](); !(a = (u = c.next()).done); a = true) {
                            var d = u.value;
                            r.push(d.serialize(e))
                        }
                    } catch (e) {
                        s = true,
                        l = e
                    } finally {
                        try {
                            !a && c.return && c.return()
                        } finally {
                            if (s)
                                throw l
                        }
                    }
                    n.jellies = r,
                    this._InTarget ? n.inTarget = this._InTarget.refId : delete n.inTarget,
                    this._OutTarget ? n.outTarget = this._OutTarget.refId : delete n.outTarget
                }
                return n
            }
        }, {
            key: "serializeInteractive",
            value: function() {
                var e = o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeInteractive", this).call(this);
                return e.segments = this.segments,
                e.easeIn = this._EaseIn,
                e.easeOut = this._EaseOut,
                e.hideJellies = this._HideJellies,
                e.hideBone = this._HideBone,
                e.scaleIn = this._ScaleIn,
                e.scaleOut = this._ScaleOut,
                e.inTarget = this._InTarget,
                e.outTarget = this._OutTarget,
                e
            }
        }, {
            key: "hideBone",
            get: function() {
                return this._HideBone
            },
            set: function(e) {
                this._HideBone !== e && (this._HideBone = e,
                this.markJellyDirty())
            }
        }, {
            key: "hideJellies",
            get: function() {
                return this._HideJellies
            },
            set: function(e) {
                this._HideJellies !== e && (this._HideJellies = e,
                this.markJellyDirty())
            }
        }, {
            key: "segments",
            get: function() {
                var e = this._Bones;
                return e && e.length || 0
            },
            set: function(e) {
                var t = this
                  , n = this.parent;
                1 === e && (e = 2),
                e > 16 && (e = 16);
                var i = this._Bones;
                e !== i.length && function() {
                    for (var r = n.stageItem && n.stageItem.stage, o = t._Pool, a = i.length; a < e; a++) {
                        var s = o.length ? o.splice(o.length - 1, 1)[0] : t.actor.addNodeType(l.default, null, null, true);
                        s && (s.length = 30,
                        s.translation = u.vec2.set(u.vec2.create(), 50 * a, 0),
                        i.push(s),
                        s.setParent(t.parent),
                        r && s.all((function(e) {
                            e.stageItem && e.stageItem.addToStage(r)
                        }
                        )))
                    }
                    for (; i.length > e; ) {
                        var c = i.splice(i.length - 1, 1)[0];
                        o.push(c),
                        r && c.all((function(e) {
                            e.stageItem && e.stageItem.removeFromStage()
                        }
                        ))
                    }
                    n.dispatch("childrenChanged"),
                    t._Cache = null,
                    t.markJellyDirty(),
                    t._Actor.markDependenciesDirty()
                }()
            }
        }, {
            key: "bones",
            get: function() {
                return this._Bones
            }
        }, {
            key: "tipPosition",
            get: function() {
                var e = this.parent.length;
                return u.vec2.set(u.vec2.create(), e, 0)
            }
        }, {
            key: "easeIn",
            get: function() {
                return this._EaseIn
            },
            set: function(e) {
                e !== this._EaseIn && (this._EaseIn = e,
                this.markJellyDirty())
            }
        }, {
            key: "easeOut",
            get: function() {
                return this._EaseOut
            },
            set: function(e) {
                e !== this._EaseOut && (this._EaseOut = e,
                this.markJellyDirty())
            }
        }, {
            key: "scaleIn",
            get: function() {
                return this._ScaleIn
            },
            set: function(e) {
                e !== this._ScaleIn && (this._ScaleIn = e,
                this.markJellyDirty())
            }
        }, {
            key: "scaleOut",
            get: function() {
                return this._ScaleOut
            },
            set: function(e) {
                e !== this._ScaleOut && (this._ScaleOut = e,
                this.markJellyDirty())
            }
        }, {
            key: "unitControlLength",
            get: function() {
                return this.parent.length * g
            }
        }, {
            key: "inDirection",
            get: function() {
                return this._InDirection
            }
        }, {
            key: "outDirection",
            get: function() {
                return this._OutDirection
            }
        }, {
            key: "inPoint",
            get: function() {
                return this._InPoint
            }
        }, {
            key: "outPoint",
            get: function() {
                return this._OutPoint
            }
        }, {
            key: "inTarget",
            get: function() {
                return this._InTarget
            },
            set: function(e) {
                if (this._InTarget !== e) {
                    if (e) {
                        var t = this._Actor.dependencyGraph;
                        if (t && (t.addDependency(this, e),
                        !t.sort()))
                            throw t.removeDependency(this, e),
                            new h.default(e)
                    }
                    this._Actor.markDependenciesDirty(),
                    this._InTarget && this._InTarget.stageItem.removeEventListener("removedFromStage", this.onTargetRemovedFromStage),
                    this._InTarget = e,
                    this._InTarget && this._InTarget.stageItem.addEventListener("removedFromStage", this.onTargetRemovedFromStage),
                    this.markJellyDirty()
                }
            }
        }, {
            key: "outTarget",
            get: function() {
                return this._OutTarget
            },
            set: function(e) {
                if (this._OutTarget !== e) {
                    if (e) {
                        var t = this._Actor.dependencyGraph;
                        if (t && (t.addDependency(this, e),
                        !t.sort()))
                            throw t.removeDependency(this, e),
                            new h.default(e)
                    }
                    this._Actor.markDependenciesDirty(),
                    this._OutTarget && this._OutTarget.stageItem.removeEventListener("removedFromStage", this.onTargetRemovedFromStage),
                    this._OutTarget = e,
                    this._OutTarget && this._OutTarget.stageItem.addEventListener("removedFromStage", this.onTargetRemovedFromStage),
                    this.markJellyDirty()
                }
            }
        }]),
        t
    }(s.default),
    w = i.prototype,
    O = "onTargetRemovedFromStage",
    S = [d.default],
    k = Object.getOwnPropertyDescriptor(i.prototype, "onTargetRemovedFromStage"),
    P = i.prototype,
    E = {},
    Object.keys(k).forEach((function(e) {
        E[e] = k[e]
    }
    )),
    E.enumerable = !!E.enumerable,
    E.configurable = !!E.configurable,
    ("value"in E || E.initializer) && (E.writable = true),
    E = S.slice().reverse().reduce((function(e, t) {
        return t(w, O, e) || e
    }
    ), E),
    P && void 0 !== E.initializer && (E.value = E.initializer ? E.initializer.call(P) : void 0,
    E.initializer = void 0),
    void 0 === E.initializer && (Object.defineProperty(w, O, E),
    E = null),
    i);
    t.default = T;
    var C = function(e) {
        function t(e) {
            y(this, t);
            var n = m(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.isVisible = false,
            n.isFake = true,
            n
        }
        return v(t, e),
        t
    }(f.default);
    T.StageItem = C
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }, a = n(464);
    var s = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.isCollapsed = true,
            n._Children = [],
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "silentlySetChildren",
            value: function(e) {
                this._Children = e
            }
        }, {
            key: "notifyChildrenChanged",
            value: function(e) {
                e || (this.dispatch("childrenChanged", this),
                this._Actor && this._Actor.notifyAssetChildrenChanged())
            }
        }, {
            key: "add",
            value: function(e, t, n) {
                var i = this._Children
                  , r = i.indexOf(e);
                if (e.parent == this || -1 != r)
                    throw new Error(e + " is already a child of " + this);
                e.parent && e.parent.remove(e),
                e.setParent(this),
                void 0 === n ? i.push(e) : i.splice(n, 0, e),
                this.notifyChildrenChanged(t),
                this.onChildAdded && this.onChildAdded(e)
            }
        }, {
            key: "remove",
            value: function(e, t) {
                var n = this._Children.indexOf(e);
                -1 != n && (e.setParent(null),
                this._Children.splice(n, 1)),
                this.onChildRemoved && this.onChildRemoved(e),
                this.notifyChildrenChanged(t)
            }
        }, {
            key: "eachChild",
            value: function(e) {
                for (var t = 0; t < this._Children.length; t++)
                    e(this._Children[t])
            }
        }, {
            key: "eachChildRecursive",
            value: function(e) {
                for (var t = 0; t < this._Children.length; t++) {
                    var n = this._Children[t];
                    false !== e(n) && (n.eachChildRecursive && n.eachChildRecursive(e))
                }
            }
        }, {
            key: "all",
            value: function(e) {
                if (false !== o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "all", this).call(this, e))
                    for (var n = 0; n < this._Children.length; n++) {
                        var i = this._Children[n];
                        false !== e(i) && (i.eachChildRecursive && i.eachChildRecursive(e))
                    }
            }
        }, {
            key: "read",
            value: function(e, n, i) {
                o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "read", this).call(this, e, n, i);
                var r = n.children;
                if (void 0 !== r && r.length)
                    for (var a = 0; a < r.length; a++) {
                        var s = r[a]
                          , l = this.resolveChildType(e, s.type);
                        if (l) {
                            var u = new l(e,this);
                            u.read(e, s),
                            this.add(u, true),
                            e.addAsset(u)
                        }
                    }
            }
        }, {
            key: "resolveChildType",
            value: function(e, t) {
                return null
            }
        }, {
            key: "serialize",
            value: function() {
                for (var e = o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serialize", this).call(this), n = 0; n < this._Children.length; n++) {
                    var i = this._Children[n].serialize();
                    i && (e.children || (e.children = []),
                    e.children.push(i))
                }
                return e
            }
        }, {
            key: "serializeProperties",
            value: function() {
                var e = o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeProperties", this).call(this);
                return delete e.children,
                e
            }
        }, {
            key: "serializeInteractive",
            value: function() {
                var e = o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeInteractive", this).call(this);
                return e.children = this._Children.slice(0),
                e
            }
        }, {
            key: "children",
            get: function() {
                return this._Children
            },
            set: function(e) {
                this._Children = e,
                this.notifyChildrenChanged()
            }
        }, {
            key: "hierarchyChildren",
            get: function() {
                return this._Children
            }
        }]),
        t
    }(((i = a) && i.__esModule ? i : {
        default: i
    }).default);
    t.default = s
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    });
    t.default = {
        Local: 0,
        Parent: 1,
        World: 2
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = c(n(243))
      , o = c(n(201))
      , a = n(2)
      , s = c(n(267))
      , l = c(n(208))
      , u = c(n(315));
    function c(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function d(e, t) {
        for (var n = 0; n < e.children.length; n++) {
            var i = e.children[n];
            if (t(i.joint))
                break;
            d(i.joint, t)
        }
    }
    var h = function() {
        function e(t, n, i) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e),
            this._CompensateBones = t,
            this._CompensateImages = n,
            this._StageJoints = i,
            this._TransformMatrix = a.mat2d.create(),
            this._TopJoints = i.slice(0);
            for (var r = 0; r < this._TopJoints.length; r++) {
                var o = this._TopJoints[r];
                if (o.node.isConstrained || o.bone && o.bone.isConstrained)
                    this._TopJoints.splice(r, 1),
                    r--;
                else
                    for (var s = o.parentJoint; s; ) {
                        if (s && -1 != this._TopJoints.indexOf(s)) {
                            this._TopJoints.splice(r, 1),
                            r--;
                            break
                        }
                        s = s.parentJoint
                    }
            }
            if (!t)
                for (var l = 0; l < this._TopJoints.length; l++)
                    d(this._TopJoints[l], (function(e) {
                        if (e.node.isConstrained)
                            return true;
                        -1 === i.indexOf(e) && i.push(e)
                    }
                    ))
        }
        return i(e, [{
            key: "retransformBones",
            value: function() {
                for (var e = [], t = this._CompensateImages, n = this._CompensateBones, i = 0; i < this._TopJoints.length; i++) {
                    var o = this._TopJoints[i];
                    if (r.default.alignChain(o, t),
                    t || n)
                        (o.bone && o.node || o.node.parent).eachChildRecursive((function(i) {
                            switch (i.constructor) {
                            case s.default:
                            case l.default:
                                t && -1 == e.indexOf(i) && e.push(i);
                                break;
                            case u.default:
                                n && -1 == e.indexOf(i) && e.push(i)
                            }
                        }
                        ))
                }
                if (e.length)
                    for (var a = 0; a < e.length; a++) {
                        e[a].compensate()
                    }
            }
        }, {
            key: "preTransform",
            value: function() {
                for (var e = 0; e < this._TopJoints.length; e++) {
                    var t = this._TopJoints[e];
                    t.parentJoint && (t = t.parentJoint),
                    r.default.transformChain(t)
                }
            }
        }, {
            key: "advance",
            value: function(e, t) {
                this.skipPreTransform || this.preTransform();
                for (var n = 0; n < this._StageJoints.length; n++) {
                    var i = this._StageJoints[n]
                      , r = i.renderTransform;
                    this._TransformMatrix[4] = r[4] + t[0],
                    this._TransformMatrix[5] = r[5] + t[1],
                    i.renderTransform = this._TransformMatrix
                }
                this.retransformBones()
            }
        }, {
            key: "complete",
            value: function() {}
        }]),
        e
    }();
    t.default = h,
    h.make = function(e, t) {
        for (var n = e.stage.settings, i = n.compensateBones, a = n.compensateImages, s = [], l = 0; l < t.length; l++) {
            var c = t[l];
            if (c.constructor === o.default) {
                if (!c.parentJoint)
                    throw new Error("Parent Joint expected");
                -1 == s.indexOf(c.parentJoint) && s.push(c.parentJoint),
                -1 == s.indexOf(c.joint) && s.push(c.joint)
            } else if (c.constructor === r.default) {
                if (!i && !a && c.node.constructor === u.default)
                    continue;
                -1 == s.indexOf(c) && s.push(c)
            }
        }
        if (0 != s.length)
            return new h(i,a,s)
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.DistanceMode = t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }
      , o = l(n(380))
      , a = n(2)
      , s = l(n(357));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function u(e, t) {
        if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function")
    }
    var c = function(e) {
        function t(e) {
            u(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.name = "Distance Constraint",
            n._Distance = 100,
            n._Mode = h.Closer,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "read",
            value: function(e, n) {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "read", this).call(this, e, n);
                var i = n.distance;
                void 0 !== i && (this._Distance = Number.parseFloat(i));
                var o = n.mode;
                void 0 !== o && (this._Mode = h.fromString(o))
            }
        }, {
            key: "serializeProperties",
            value: function(e) {
                var n = r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeProperties", this).call(this, e);
                return n.mode = this._Mode.toString(),
                n
            }
        }, {
            key: "serializeInteractive",
            value: function() {
                var e = r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeInteractive", this).call(this);
                return e.distance = this._Distance,
                e.mode = this._Mode,
                e
            }
        }, {
            key: "onTargetOptionChanged",
            value: function() {
                this.resetDistance()
            }
        }, {
            key: "resetDistance",
            value: function() {
                var e = this.target;
                if (e) {
                    var t = e.worldTranslation
                      , n = this.parent.worldTranslation;
                    this.distance = a.vec2.distance(t, n)
                }
            }
        }, {
            key: "constrain",
            value: function(e) {
                var t = this._Target;
                if (t) {
                    var n = this.parent
                      , i = t.worldTranslation
                      , r = n.worldTranslation
                      , o = this.strength
                      , s = this.mode
                      , l = this.distance
                      , u = a.vec2.subtract(a.vec2.create(), r, i)
                      , c = a.vec2.length(u);
                    switch (s) {
                    case h.Closer:
                        if (c < l)
                            return true;
                        break;
                    case h.Further:
                        if (c > l)
                            return true
                    }
                    if (c < .001)
                        return true;
                    a.vec2.scale(u, u, 1 / c),
                    a.vec2.scale(u, u, l);
                    var d = n.worldTransform
                      , f = a.vec2.lerp(a.vec2.create(), r, a.vec2.add(a.vec2.create(), i, u), o);
                    return d[4] = f[0],
                    d[5] = f[1],
                    true
                }
            }
        }, {
            key: "distance",
            get: function() {
                return this._Distance
            },
            set: function(e) {
                this._Distance !== e && (this._Distance = e,
                this.markDirty(),
                this.dispatch("changeDistanceConstraint"))
            }
        }, {
            key: "mode",
            get: function() {
                return this._Mode
            },
            set: function(e) {
                this._Mode !== e && (this._Mode = e,
                this.markDirty(),
                this.dispatch("changeDistanceConstraint"))
            }
        }], [{
            key: "constraintName",
            get: function() {
                return "Distance"
            }
        }, {
            key: "targetName",
            get: function() {
                return "Distance To"
            }
        }]),
        t
    }(o.default);
    t.default = c;
    var d = new Map
      , h = t.DistanceMode = function() {
        function e(t, n) {
            u(this, e),
            this._Label = t,
            this._ID = n,
            d.set(t, this)
        }
        return i(e, [{
            key: "toString",
            value: function() {
                return this._Label
            }
        }, {
            key: "id",
            get: function() {
                return this._ID
            }
        }], [{
            key: "fromString",
            value: function(e) {
                return d.get(e) || s.default.World
            }
        }]),
        e
    }();
    h.Closer = new h("closer",0),
    h.Further = new h("further",1),
    h.Exact = new h("exact",2)
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.Decompose = function(e, t) {
        var n = e[0]
          , i = e[1]
          , r = e[2]
          , o = e[3]
          , a = Math.atan2(i, n)
          , s = n * n + i * i
          , l = Math.sqrt(s)
          , u = (n * o - r * i) / l
          , c = Math.atan2(n * r + i * o, s);
        t[0] = e[4],
        t[1] = e[5],
        t[2] = l,
        t[3] = u,
        t[4] = a,
        t[5] = c
    }
    ,
    t.Compose = function(e, t) {
        var n = t[4];
        0 !== n ? i.mat2d.fromRotation(e, n) : i.mat2d.identity(e);
        e[4] = t[0],
        e[5] = t[1],
        i.mat2d.scale(e, e, [t[2], t[3]]);
        var r = t[5];
        0 !== r && (e[2] = e[0] * r + e[2],
        e[3] = e[1] * r + e[3])
    }
    ;
    var i = n(2)
}
, , , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = c(n(0)), a = c(n(1)), s = c(n(4)), l = c(n(20)), u = c(n(471));
    function c(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function d(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var h = (d((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                editing: false
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "commitEdit",
            value: function() {
                var e = new u.default(this.context.nima.stage,this.context.nima.actor,this.props.item,this.inputText.value);
                e.start(),
                e.end(),
                this.context.nima.actor.revise(),
                this.endEdit(false),
                this.forceUpdate()
            }
        }, {
            key: "endEdit",
            value: function() {
                this.setState({
                    editing: false
                }),
                this.inputText && this.inputText.removeEventListener("blur", this.commitEdit),
                clearTimeout(this.editTimeout)
            }
        }, {
            key: "cancelEdit",
            value: function() {
                this.endEdit(true)
            }
        }, {
            key: "startEdit",
            value: function() {
                var e = this.props.item;
                return !e.isNameReadOnly && (this.setState({
                    editing: true,
                    editName: e.name
                }),
                true)
            }
        }, {
            key: "editKeyDown",
            value: function(e) {
                switch (e.keyCode) {
                case 13:
                    this.inputText.blur();
                    break;
                case 27:
                    this.cancelEdit(),
                    this.inputText.blur()
                }
            }
        }, {
            key: "editTextChange",
            value: function(e) {
                this.setState({
                    editName: e.target.value
                })
            }
        }, {
            key: "setInputText",
            value: function(e) {
                var t = this.inputText;
                t && t.removeEventListener("blur", this.commitEdit),
                this.inputText = e,
                e && (e.focus(),
                e.setSelectionRange(0, e.value.length),
                e.addEventListener("blur", this.commitEdit))
            }
        }, {
            key: "render",
            value: function() {
                var e = this.props.item;
                return o.default.createElement("div", {
                    className: l.default.ItemName
                }, this.state.editing ? o.default.createElement("input", {
                    ref: this.setInputText,
                    type: "text",
                    value: this.state.editName,
                    onKeyDown: this.editKeyDown,
                    onChange: this.editTextChange
                }) : e.name)
            }
        }]),
        t
    }(o.default.Component)).prototype, "commitEdit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "commitEdit"), i.prototype),
    d(i.prototype, "endEdit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "endEdit"), i.prototype),
    d(i.prototype, "cancelEdit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "cancelEdit"), i.prototype),
    d(i.prototype, "startEdit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "startEdit"), i.prototype),
    d(i.prototype, "editKeyDown", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "editKeyDown"), i.prototype),
    d(i.prototype, "editTextChange", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "editTextChange"), i.prototype),
    d(i.prototype, "setInputText", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setInputText"), i.prototype),
    i);
    t.default = h,
    h.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = s(n(511))
      , o = s(n(382))
      , a = s(n(604));
    function s(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var l = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n._Bitmap = null,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "resolveChildType",
            value: function(e, t) {
                return t == a.default.dataType ? a.default : null
            }
        }, {
            key: "replaceWith",
            value: function(e, t) {
                for (var n = this._Children, i = 0; i < this._Children.length; i++)
                    this._Children[i];
                var r = e.children
                  , o = [];
                if (t.root.all((function(e) {
                    if (-1 !== n.indexOf(e.asset)) {
                        for (var t = false, i = 0; i < r.length; i++) {
                            var a = r[i];
                            if (a.name == e.asset.name) {
                                e.asset = a,
                                t = true;
                                break
                            }
                        }
                        t || o.push(e.asset)
                    }
                }
                )),
                o.length) {
                    for (var a = this._Children.slice(0), s = 0; s < a.length; s++) {
                        var l = a[s];
                        -1 === o.indexOf(l) && this.remove(l, true)
                    }
                    this.dispatch("childrenChanged", this)
                } else
                    t.removeAsset(this)
            }
        }, {
            key: "uiIcon",
            get: function() {
                return "icon-psd-asset"
            }
        }, {
            key: "uiSelectionIconClass",
            get: function() {
                return "SelectionImageIcon"
            }
        }, {
            key: "uiHierThumbClass",
            get: function() {
                return "psdThumb"
            }
        }, {
            key: "typeName",
            get: function() {
                return "Image Asset"
            }
        }, {
            key: "bitmap",
            get: function() {
                return this._Bitmap
            }
        }]),
        t
    }(r.default);
    t.default = l,
    l.prototype.fromFile = o.default.prototype.fromFile,
    l.prototype.fromBase64 = o.default.prototype.fromBase64,
    l.prototype.readRaw = o.default.prototype.readRaw
}
, function(e, t, n) {
    var i = n(1173);
    "string" == typeof i && (i = [[e.i, i, ""]]);
    var r = {
        insertAt: "top",
        hmr: true,
        transform: void 0
    };
    n(8)(i, r);
    i.locals && (e.exports = i.locals)
}
, , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    });
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }();
    var r = function() {
        function e(t) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e),
            this.node = t
        }
        return i(e, [{
            key: "name",
            get: function() {
                return this.node.name
            }
        }]),
        e
    }();
    t.default = r
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }, a = n(396);
    var s = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n._Children = [],
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "restSiblingIndices",
            value: function() {
                for (var e = 0; e < this._Children.length; e++)
                    this._Children[e].siblingIndex = e
            }
        }, {
            key: "silentlySetChildren",
            value: function(e) {
                this._Children = e,
                this.restSiblingIndices()
            }
        }, {
            key: "notifyChildrenChanged",
            value: function(e) {
                e || (this.dispatch("childrenChanged", this),
                this._Actor && this._Actor.notifyChildrenChanged()),
                this.onChildrenChanged()
            }
        }, {
            key: "onChildrenChanged",
            value: function() {}
        }, {
            key: "add",
            value: function(e, t, n) {
                if (!e.isValidParent(this))
                    return false;
                var i = this._Children
                  , r = i.indexOf(e);
                if (e.parent == this || -1 != r)
                    throw new Error(e + " is already a child of " + this);
                e.parent && e.parent.remove(e),
                e.setParent(this),
                void 0 === n ? (e.siblingIndex = i.length && i[i.length - 1].siblingIndex + 1 || 0,
                i.push(e)) : (i.splice(n, 0, e),
                this.restSiblingIndices()),
                this.notifyChildrenChanged(t),
                this.onChildAdded && this.onChildAdded(e)
            }
        }, {
            key: "remove",
            value: function(e, t) {
                var n = this._Children.indexOf(e);
                -1 != n && (e.setParent(null),
                this._Children.splice(n, 1)),
                this.onChildRemoved && this.onChildRemoved(e),
                this.notifyChildrenChanged(t)
            }
        }, {
            key: "eachChild",
            value: function(e) {
                for (var t = 0; t < this._Children.length; t++)
                    e(this._Children[t])
            }
        }, {
            key: "eachChildRecursive",
            value: function(e) {
                for (var t = 0; t < this._Children.length; t++) {
                    var n = this._Children[t];
                    false !== e(n) && (n.eachChildRecursive && n.eachChildRecursive(e))
                }
            }
        }, {
            key: "all",
            value: function(e) {
                if (false === e(this))
                    return false;
                for (var t = 0; t < this._Children.length; t++) {
                    var n = this._Children[t];
                    false !== e(n) && (n.eachChildRecursive && n.eachChildRecursive(e))
                }
                return true
            }
        }, {
            key: "serializeProperties",
            value: function() {
                var e = o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeProperties", this).call(this);
                return delete e.children,
                e
            }
        }, {
            key: "serializeInteractive",
            value: function() {
                var e = o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeInteractive", this).call(this);
                return e.children = this._Children.slice(0),
                e
            }
        }, {
            key: "serialize",
            value: function(e) {
                for (var n = o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serialize", this).call(this, e), i = 0; i < this._Children.length; i++) {
                    var r = this._Children[i].serialize(e);
                    r && (n.children || (n.children = []),
                    n.children.push(r))
                }
                return n
            }
        }, {
            key: "children",
            get: function() {
                return this._Children
            },
            set: function(e) {
                this._Children = e,
                this.restSiblingIndices(),
                this.notifyChildrenChanged()
            }
        }, {
            key: "hierarchyChildren",
            get: function() {
                return this._Children
            }
        }, {
            key: "firstChild",
            get: function() {
                var e = this._Children;
                return e.length && e[0] || null
            }
        }, {
            key: "lastChild",
            get: function() {
                var e = this._Children;
                return e.length && e[e.length - 1] || null
            }
        }, {
            key: "hasChildren",
            get: function() {
                return true
            }
        }]),
        t
    }(((i = a) && i.__esModule ? i : {
        default: i
    }).default);
    t.default = s
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    });
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }();
    var r = new Map
      , o = function() {
        function e(t) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e),
            this._Label = t,
            r.set(t, this)
        }
        return i(e, [{
            key: "toString",
            value: function() {
                return this._Label
            }
        }], [{
            key: "fromString",
            value: function(t) {
                return r.get(t) || e.Empty
            }
        }]),
        e
    }();
    t.default = o,
    o.Empty = new o("empty"),
    o.Target = new o("target")
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = n(2), a = n(203), s = (i = a) && i.__esModule ? i : {
        default: i
    };
    var l = [1, 161 / 255, 0, 1]
      , u = [1, 1, 1, 1]
      , c = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this));
            return n.drawAfterSelections = true,
            n.isHandle = true,
            n.hitDetectOnMesh = false,
            n.isSelectable = true,
            n._IsMinimalistMode = true === e,
            n._BackgroundOpacity = 1,
            n._VertexBuffer = null,
            n._IndexBuffer = null,
            n._SliceAngle = 0,
            n._CachedSliceAngle = 0,
            n._LockedAngle = null,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "onAddedToStage",
            value: function(e) {
                this.setMesh(this.stageContext.points, 2, this.stageContext.index)
            }
        }, {
            key: "customHitDetect",
            value: function(e, n) {
                var i = Math.sqrt(e * e + n * n);
                return Math.abs(t.outerRadius - i) <= t.proximityThreshold
            }
        }, {
            key: "lockAngle",
            value: function() {
                this._LockedAngle = o.mat2d.getRotation(this.renderTransform)
            }
        }, {
            key: "unlockAngle",
            value: function() {
                this._LockedAngle = null
            }
        }, {
            key: "alignToTransform",
            value: function(e, t) {
                if (this.stage) {
                    var n = o.mat2d.fromRotation(o.mat2d.create(), null === this._LockedAngle ? o.mat2d.getRotation(t) : this._LockedAngle);
                    n[4] = e[4],
                    n[5] = e[5];
                    var i = 1 / this.stage.scale
                      , r = o.mat2d.fromScaling(o.mat2d.create(), [i, i])
                      , a = this.rotationTransform;
                    a && o.mat2d.mul(r, a, r),
                    this.renderTransform = o.mat2d.mul(o.mat2d.create(), n, r)
                }
            }
        }, {
            key: "draw",
            value: function(e, n) {
                var i = this.renderViewTransform
                  , r = this.stageContext;
                if (this._CachedSliceAngle != this._SliceAngle) {
                    this._VertexBuffer || (this._VertexBuffer = e.makeVertexBuffer()),
                    this._IndexBuffer || (this._IndexBuffer = e.makeIndexBuffer()),
                    this._CachedSliceAngle = this._SliceAngle;
                    for (var o = t.innerRadius, a = t.outerRadius, s = [], c = [], d = -1, h = Math.ceil(Math.abs(this._SliceAngle / Math.PI * 180 / 5)), f = this._SliceAngle / h, p = 0, y = 0; y < h + 1; y++) {
                        c.push(Math.cos(p) * o, Math.sin(p) * o, Math.cos(p) * a, Math.sin(p) * a);
                        var m = 2 * y;
                        -1 != d && (s.push(m, m + 1, d),
                        s.push(m + 1, d, d + 1)),
                        d = m,
                        p += f
                    }
                    this._VertexBuffer.update(c),
                    this._IndexBuffer.update(s)
                }
                this._VertexBuffer && e.drawColor(i, this._VertexBuffer, this._IndexBuffer, .7, l),
                this._IsMinimalistMode ? e.drawThickLine(i, r.outerLine, 1, 1, n ? u : l) : (e.drawThickLine(i, r.innerLine, 1, 1, l),
                e.drawThickLine(i, r.outerLine, 1, 1, n ? u : l),
                e.drawThickLine(i, r.directionLine, 1, 1, l))
            }
        }, {
            key: "color",
            get: function() {
                return l
            },
            set: function(e) {
                o.vec4.copy(l, e)
            }
        }, {
            key: "sliceAngle",
            get: function() {
                return this._SliceAngle
            },
            set: function(e) {
                this._SliceAngle = e
            }
        }], [{
            key: "innerRadius",
            get: function() {
                return 5
            }
        }, {
            key: "outerRadius",
            get: function() {
                return 50
            }
        }, {
            key: "proximityThreshold",
            get: function() {
                return 5
            }
        }]),
        t
    }(s.default);
    t.default = c,
    c.initializeStageContext = function(e, t) {
        var n = c.innerRadius
          , i = c.outerRadius
          , r = c.proximityThreshold + c.outerRadius
          , o = [-r, r, r, r, -r, -r, r, -r];
        t.points = o,
        t.index = [0, 1, 2, 1, 3, 2];
        for (var a = [], s = [], l = 20, u = 2 * Math.PI / l, d = 0, h = 0; h < l; h++) {
            var f = Math.cos(d) * n
              , p = Math.sin(d) * n;
            a.push([f, p]),
            d += u
        }
        l = 50,
        u = 2 * Math.PI / l,
        d = 0;
        for (var y = 0; y < l; y++) {
            var m = Math.cos(d) * i
              , v = Math.sin(d) * i;
            s.push([m, v]),
            d += u
        }
        t.innerLine = e.makeThickLine(a, true),
        t.outerLine = e.makeThickLine(s, true);
        var g = [[n, 0], [i, 0]];
        t.directionLine = e.makeThickLine(g, false)
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = n(203), a = (i = o) && i.__esModule ? i : {
        default: i
    }, s = n(2);
    var l = function(e) {
        function t() {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var e = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this));
            return e.drawAfterSelections = true,
            e.isHandle = true,
            e.hitDetectOnMesh = false,
            e.isSelectable = true,
            e._Color = [1, 0, 0, 1],
            e._HoverColor = [1, 1, 0, 1],
            e
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "onAddedToStage",
            value: function(e) {
                this.setMesh(this.stageContext.points, 2, this.stageContext.index)
            }
        }, {
            key: "alignToTransform",
            value: function(e, t) {
                if (this.stage)
                    if (e === t) {
                        var n = s.vec2.create()
                          , i = s.mat2d.decompose(n, e)
                          , r = s.mat2d.fromRotation(s.mat2d.create(), i);
                        r[4] = e[4],
                        r[5] = e[5];
                        var o = 1 / this.stage.scale
                          , a = s.mat2d.fromScaling(s.mat2d.create(), [o * Math.sign(n[0]), o * Math.sign(n[1])])
                          , l = this.rotationTransform;
                        l && s.mat2d.mul(a, l, a),
                        this.renderTransform = s.mat2d.mul(s.mat2d.create(), r, a)
                    } else {
                        var u = s.mat2d.fromRotation(s.mat2d.create(), s.mat2d.getRotation(t));
                        u[4] = e[4],
                        u[5] = e[5];
                        var c = 1 / this.stage.scale
                          , d = s.mat2d.fromScaling(s.mat2d.create(), [c, c])
                          , h = this.rotationTransform;
                        h && s.mat2d.mul(d, h, d),
                        this.renderTransform = s.mat2d.mul(s.mat2d.create(), u, d)
                    }
            }
        }, {
            key: "draw",
            value: function(e, t) {
                var n = this.renderViewTransform
                  , i = this.stageContext;
                e.drawColor(n, i.vertexBuffer, i.indexBuffer, 1, t ? this._HoverColor : this._Color)
            }
        }, {
            key: "color",
            get: function() {
                return this._Color
            },
            set: function(e) {
                s.vec4.copy(this._Color, e)
            }
        }, {
            key: "hoverColor",
            get: function() {
                return this._HoverColor
            },
            set: function(e) {
                s.vec4.copy(this._HoverColor, e)
            }
        }]),
        t
    }(a.default);
    t.default = l,
    l.initializeStageContext = function(e, t) {
        var n = [-4, 30, 4, 30, -4, 38, 4, 38, -.5, 30, .5, 30, -.5, 0, .5, 0]
          , i = [0, 1, 2, 1, 3, 2, 4, 5, 6, 5, 7, 6];
        t.vertexBuffer = e.makeVertexBuffer(n),
        t.indexBuffer = e.makeIndexBuffer(i),
        t.points = n,
        t.index = i
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = n(2)
      , o = d(n(267))
      , a = d(n(237))
      , s = d(n(315))
      , l = d(n(208))
      , u = d(n(243))
      , c = d(n(261));
    function d(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var h = function() {
        function e(t, n, i, a, s, l, u, c) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e),
            this._Tool = t,
            this._Handle = n,
            this._CompensateBones = i,
            this._CompensateImages = a,
            this._ActorNodes = s,
            this._RotationPivot = l,
            this._IsComplex = u,
            this._LastAngle = r.vec2.getAngle(r.vec2.subtract(r.vec2.create(), c, this._RotationPivot)),
            this._StartAngle = this._LastAngle,
            this._AccumulatedAngle = 0;
            for (var d = s.slice(0), h = 0; h < d.length; h++)
                for (var f = d[h]; f.parent; ) {
                    if (-1 != d.indexOf(f.parent)) {
                        d.splice(h, 1),
                        h--;
                        break
                    }
                    f = f.parent
                }
            var p = []
              , y = true
              , m = false
              , v = void 0;
            try {
                for (var g, _ = d[Symbol.iterator](); !(y = (g = _.next()).done); y = true) {
                    var b = g.value
                      , w = {
                        node: b,
                        transform: r.mat2d.clone(b.worldTransform),
                        rotation: b.rotation
                    };
                    b.constructor === o.default && b.isConnectedToBones && (w.bind = b.copyBind()),
                    p.push(w)
                }
            } catch (e) {
                m = true,
                v = e
            } finally {
                try {
                    !y && _.return && _.return()
                } finally {
                    if (m)
                        throw v
                }
            }
            this._TopActorNodes = p
        }
        return i(e, [{
            key: "setRotationDelta",
            value: function(e) {
                var t = r.mat2d.create()
                  , n = r.mat2d.create()
                  , i = r.mat2d.create();
                i[4] = this._RotationPivot[0],
                i[5] = this._RotationPivot[1],
                n[4] = -this._RotationPivot[0],
                n[5] = -this._RotationPivot[1];
                for (var c = r.mat2d.fromRotation(r.mat2d.create(), e), d = this._TopActorNodes, h = this._CompensateImages, f = this._CompensateBones, p = 0; p < d.length; p++) {
                    var y = d[p]
                      , m = y.node;
                    if (this._IsComplex)
                        if (r.mat2d.mul(t, n, y.transform),
                        r.mat2d.mul(t, c, t),
                        r.mat2d.mul(t, i, t),
                        m.hasWorldTransformOverride) {
                            var v = m.worldTransform
                              , g = r.mat2d.clone(v);
                            m.overrideWorldTransform = t,
                            m.constructor === o.default && m.isConnectedToBones && (m.setBind(y.bind),
                            m.compensateConnectedBones(g),
                            m.overrideWorldTransform = g)
                        } else {
                            var _ = r.mat2d.invert(r.mat2d.create(), m.parent.worldTransform);
                            r.mat2d.mul(t, t, _);
                            var b = r.vec2.create();
                            m.rotation = r.mat2d.decompose(b, t),
                            m.scale = b,
                            m.translation = r.mat2d.getTranslation(r.vec2.create(), t)
                        }
                    else
                        m.rotation = y.rotation + e;
                    if (!h || m.constructor !== a.default && m.constructor !== s.default || m.all((function(e) {
                        e.constructor !== a.default && e.constructor !== s.default || u.default.compensateSkinnedImages(e)
                    }
                    )),
                    (h || f) && function() {
                        var e = [];
                        if (m.eachChildRecursive((function(t) {
                            (h && t.constructor === o.default || f && (t.constructor === a.default || t.constructor === l.default)) && -1 == e.indexOf(t) && e.push(t)
                        }
                        )),
                        e.length)
                            for (var t = 0; t < e.length; t++) {
                                e[t].compensate()
                            }
                    }(),
                    m.constructor === a.default && f)
                        for (var w = m.stageItem.joint, O = 0; O < w.children.length; O++) {
                            var S = w.children[O];
                            u.default.alignChain(S.joint)
                        }
                }
            }
        }, {
            key: "onSnapChange",
            value: function(e) {
                this.setAngleFromAccumulation()
            }
        }, {
            key: "setAngleFromAccumulation",
            value: function() {
                var e = this._AccumulatedAngle;
                if (this._Tool.snap) {
                    var t = Math.PI / 4;
                    e = Math.round(e / t) * t
                }
                this._Handle.sliceAngle = e,
                this.setRotationDelta(e)
            }
        }, {
            key: "advance",
            value: function(e, t, n) {
                var i = r.vec2.getAngle(r.vec2.subtract(r.vec2.create(), n, this._RotationPivot))
                  , o = i - this._LastAngle;
                o > Math.PI ? o = 2 * Math.PI - o : o < -Math.PI && (o = 2 * Math.PI + o);
                this._AccumulatedAngle;
                this._AccumulatedAngle += o,
                this._LastAngle = i,
                this.setAngleFromAccumulation()
            }
        }, {
            key: "complete",
            value: function() {}
        }]),
        e
    }();
    t.default = h,
    h.make = function(e, t) {
        for (var n = [], i = 0; i < t.length; i++) {
            var a = t[i];
            if (a.node && (a.constructor !== c.default || !a.node.isConnectedToBones || !e.stage.appContext.editingAnimation))
                if (a.constructor !== u.default || a.isRoot)
                    -1 == n.indexOf(a.node) && n.push(a.node);
                else
                    for (var s = 0; s < a.children.length; s++) {
                        var l = a.children[s];
                        -1 == n.indexOf(l.node) && n.push(l.node)
                    }
        }
        if (0 != n.length) {
            var d = n[0]
              , f = r.mat2d.getTranslation(r.vec2.create(), e.handle.renderTransform)
              , p = false;
            switch (d.constructor) {
            case o.default:
                p = d.isConnectedToBones
            }
            return new h(e,e.handle,e.stage.settings.compensateBones,e.stage.settings.compensateImages,n,f,p,e.stage.worldMouse)
        }
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }
      , o = n(2)
      , a = _(n(1097))
      , s = _(n(313))
      , l = _(n(261))
      , u = _(n(371))
      , c = _(n(383))
      , d = _(n(201))
      , h = _(n(372))
      , f = _(n(243))
      , p = _(n(370))
      , y = _(n(381))
      , m = _(n(512))
      , v = _(n(583))
      , g = _(n(585));
    function _(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var b = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n._Handle = new v.default,
            n._Handle.customSelectionAction = function() {
                return true
            }
            ,
            n._TranslateItem = null,
            n.filterDragSelection = s.default.filterChildren,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "validate",
            value: function() {
                return !this.stage.soloItem
            }
        }, {
            key: "findValidItem",
            value: function(e) {
                for (var t = 0; t < e.length; t++) {
                    var n = e[0];
                    switch (n.constructor) {
                    case l.default:
                        if (n.node && n.node.isConnectedToBones && this.stage.appContext.editingAnimation)
                            continue;
                        break;
                    case p.default:
                    case y.default:
                    case h.default:
                        continue
                    }
                    return n
                }
                return null
            }
        }, {
            key: "updateSelection",
            value: function(e) {
                e = s.default.filterChildren(e),
                this._TranslateItem = this.findValidItem(e),
                this._TranslateItem ? this._Handle.stage || this._Handle.addToStage(this.stage) : this._Handle.stage && this._Handle.removeFromStage()
            }
        }, {
            key: "updateHandle",
            value: function() {
                if (!this._TranslateItem)
                    return false;
                var e = o.mat2d.create()
                  , t = e
                  , n = this.stage.transformSpace
                  , i = null;
                if (this._TranslateItem)
                    switch (this._TranslateItem.constructor) {
                    case u.default:
                    case c.default:
                    case l.default:
                        (i = this._TranslateItem.node).isConnectedToBones ? (e = i.getCentroidTransform(),
                        t = i.worldTransform) : e = t = i.worldTransform;
                        break;
                    case d.default:
                        e = t = (i = this._TranslateItem.actorBone).worldTransform;
                        break;
                    case f.default:
                        i = this._TranslateItem.node,
                        e = this._TranslateItem.renderTransform,
                        t = i.worldTransform
                    }
                return n == m.default.Parent ? t = i && i.parent ? i.parent.worldTransform : o.mat2d.create() : n == m.default.World && (t = o.mat2d.create()),
                this._Handle.alignToTransform(e, t),
                true
            }
        }, {
            key: "drawPrep",
            value: function(e) {
                this.updateHandle()
            }
        }, {
            key: "startDrag",
            value: function(e, n) {
                return this.updateHandle() && (this._Handle.lockAngle(),
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "startDrag", this).call(this, e, n)),
                false
            }
        }, {
            key: "endDrag",
            value: function() {
                this._Handle.unlockAngle(),
                this._Handle.sliceAngle = 0,
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "endDrag", this).call(this)
            }
        }, {
            key: "advanceDrag",
            value: function(e, n, i) {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "advanceDrag", this).call(this, e, n, i)
            }
        }, {
            key: "disable",
            value: function() {
                this._Handle.stage && this._Handle.removeFromStage(),
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "disable", this).call(this)
            }
        }, {
            key: "transformers",
            get: function() {
                return [g.default]
            }
        }, {
            key: "handle",
            get: function() {
                return this._Handle
            }
        }]),
        t
    }(a.default);
    t.default = b
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }
      , o = g(n(313))
      , a = n(2)
      , s = g(n(584))
      , l = g(n(701))
      , u = g(n(261))
      , c = g(n(371))
      , d = g(n(201))
      , h = g(n(372))
      , f = g(n(243))
      , p = g(n(383))
      , y = g(n(512))
      , m = g(n(370))
      , v = g(n(381));
    function g(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var _ = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n._TransformSpace = a.mat2d.create(),
            n._XHandle = new s.default,
            n._XHandle.color = [236 / 255, 62 / 255, 74 / 255, 1],
            n._XHandle.hoverColor = [1, 1, 1, 1],
            n._XHandle.rotationTransform = a.mat2d.fromRotation(a.mat2d.create(), -Math.PI / 2),
            n._YHandle = new s.default,
            n._YHandle.color = [104 / 255, 254 / 255, 217 / 255, 1],
            n._YHandle.hoverColor = [1, 1, 1, 1],
            n._TranslateItem,
            n._Modulation = a.vec2.set(a.vec2.create(), 1, 1),
            n._XHandle.customSelectionAction = function() {
                return true
            }
            ,
            n._YHandle.customSelectionAction = function() {
                return true
            }
            ,
            n.filterDragSelection = o.default.filterChildren,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "validate",
            value: function() {
                return !this.stage.soloItem
            }
        }, {
            key: "findValidItem",
            value: function(e) {
                for (var t = 0; t < e.length; t++) {
                    var n = e[0];
                    switch (n.constructor) {
                    case u.default:
                        if (n.node && n.node.isConnectedToBones && this.stage.appContext.editingAnimation)
                            continue;
                        break;
                    case m.default:
                    case v.default:
                    case h.default:
                        continue
                    }
                    return n
                }
                return null
            }
        }, {
            key: "updateSelection",
            value: function(e) {
                e = o.default.filterChildren(e),
                this._TranslateItem = this.findValidItem(e),
                this._TranslateItem ? this._XHandle.stage || (this._XHandle.addToStage(this.stage),
                this._YHandle.addToStage(this.stage)) : this._XHandle.stage && (this._XHandle.removeFromStage(),
                this._YHandle.removeFromStage())
            }
        }, {
            key: "drawPrep",
            value: function(e) {
                if (this._TranslateItem) {
                    var t = a.mat2d.create()
                      , n = t
                      , i = this.stage.transformSpace
                      , r = null;
                    switch (this._TranslateItem.constructor) {
                    case c.default:
                    case p.default:
                    case u.default:
                        (r = this._TranslateItem.node).isConnectedToBones ? (t = r.getCentroidTransform(),
                        n = r.worldTransform) : t = n = r.worldTransform;
                        break;
                    case d.default:
                        t = n = (r = this._TranslateItem.actorBone).worldTransform;
                        break;
                    case f.default:
                        r = this._TranslateItem.node,
                        t = this._TranslateItem.renderTransform,
                        n = r.worldTransform
                    }
                    i == y.default.Parent ? n = r && r.parent ? r.parent.worldTransform : a.mat2d.create() : i == y.default.World && (n = a.mat2d.create()),
                    this._TransformSpace[0] = n[0],
                    this._TransformSpace[1] = n[1],
                    this._TransformSpace[2] = n[2],
                    this._TransformSpace[3] = n[3],
                    this._TransformSpace[4] = t[4],
                    this._TransformSpace[5] = t[5],
                    this._XHandle.alignToTransform(t, n),
                    this._YHandle.alignToTransform(t, n)
                }
            }
        }, {
            key: "onKeyDown",
            value: function(e) {
                this.snap = e.shiftKey
            }
        }, {
            key: "onKeyUp",
            value: function(e) {
                this.snap = e.shiftKey
            }
        }, {
            key: "startDrag",
            value: function(e, n) {
                return !!this._TranslateItem && (e == this._XHandle ? (this._Modulation[0] = 1,
                this._Modulation[1] = 0) : e == this._YHandle ? (this._Modulation[0] = 0,
                this._Modulation[1] = 1) : (this._Modulation[0] = 1,
                this._Modulation[1] = 1),
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "startDrag", this).call(this, e, n))
            }
        }, {
            key: "endDrag",
            value: function() {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "endDrag", this).call(this)
            }
        }, {
            key: "advanceDrag",
            value: function(e, n, i) {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "advanceDrag", this).call(this, e, n, i)
            }
        }, {
            key: "disable",
            value: function() {
                this._XHandle.stage && (this._XHandle.removeFromStage(),
                this._YHandle.removeFromStage()),
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "disable", this).call(this)
            }
        }, {
            key: "transformers",
            get: function() {
                return [l.default]
            }
        }, {
            key: "modulation",
            get: function() {
                return this._Modulation
            }
        }, {
            key: "transformSpace",
            get: function() {
                return this._TransformSpace
            }
        }]),
        t
    }(o.default);
    t.default = _
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = a(n(313))
      , o = a(n(1098));
    function a(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var s = function(e) {
        function t(e) {
            return function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t),
            function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "validate",
            value: function() {
                return !this.stage.soloItem || !!this.stage.appContext.editingWeights
            }
        }, {
            key: "transformers",
            get: function() {
                return [o.default]
            }
        }]),
        t
    }(r.default);
    t.default = s
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = n(203), a = (i = o) && i.__esModule ? i : {
        default: i
    };
    var s = [1, 0, 0, 1]
      , l = function(e) {
        function t() {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var e = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this));
            return e.isSelectable = false,
            e
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "draw",
            value: function(e, t) {
                var n = this.renderViewTransform
                  , i = this.stageContext;
                e.drawColor(n, i.vertexBuffer, i.indexBuffer, 1, s)
            }
        }]),
        t
    }(a.default);
    t.default = l,
    l.initializeStageContext = function(e, t) {
        var n = [0, 5, 5, 0, 0, -5, -5, 0]
          , i = [0, 1, 2, 2, 3, 0];
        t.vertexBuffer = e.makeVertexBuffer(n),
        t.indexBuffer = e.makeIndexBuffer(i),
        t.points = n,
        t.index = i
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }
      , o = f(n(313))
      , a = f(n(261))
      , s = f(n(243))
      , l = f(n(201))
      , u = f(n(237))
      , c = f(n(315))
      , d = n(2)
      , h = f(n(513));
    function f(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var p = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n._SelectedJoint = null,
            n._SelectedNode = null,
            n._WasImageSelectionDisabled = false,
            n._BaseEnable = n.enable,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "blockMarquee",
            value: function(e) {
                return true
            }
        }, {
            key: "cancel",
            value: function() {}
        }, {
            key: "validate",
            value: function() {
                return !this.stage.soloItem && !this.stage.appContext.editingAnimation
            }
        }, {
            key: "enable",
            value: function() {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "enable", this).call(this);
                var e = this.stage.getLayerOptions(a.default);
                this._WasImageSelectionDisabled = e.disableSelection,
                e.disableSelection = true,
                this.stage.setLayerOptions(a.default, e)
            }
        }, {
            key: "disable",
            value: function() {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "disable", this).call(this),
                this.cancel();
                var e = this.stage.getLayerOptions(a.default);
                e.disableSelection = this._WasImageSelectionDisabled,
                this.stage.setLayerOptions(a.default, e)
            }
        }, {
            key: "updateSelection",
            value: function(e) {
                this._SelectedJoint = null,
                this._SelectedNode = null;
                for (var t = 0; t < e.length; t++) {
                    var n = e[t];
                    n.constructor === s.default ? this._SelectedJoint = n : n.constructor === l.default ? this._SelectedJoint = n.joint : this._SelectedNode = n.node
                }
                null == this._SelectedNode && this.stage.appContext.actor && (this._SelectedNode = this.stage.appContext.actor.root)
            }
        }, {
            key: "click",
            value: function(e, t, n) {
                if (!t) {
                    var i = this.stage.appContext.actor;
                    if (this._CreatedJoint = null,
                    !n.altKey && this._SelectedJoint) {
                        var r = i.addNodeType(u.default, this._SelectedJoint.node, null);
                        if (!r)
                            return void console.error("Unable to make bone.");
                        var o = r.stageItem.joint;
                        r.stageItem.addToStage(this.stage);
                        var a = new h.default(false,false,[o]);
                        a.preTransform(),
                        r.stageItem.joint.renderTransform = d.mat2d.fromTranslation(d.mat2d.create(), e),
                        a.skipPreTransform = true,
                        a.advance([0, 0], [0, 0]),
                        a.skipPreTransform = false,
                        this.addActiveTransformer(a),
                        this._CreatedJoint = o,
                        this.stage.selectItem(this._CreatedJoint)
                    } else {
                        var s = i.addNodeType(c.default, this._SelectedJoint && this._SelectedJoint.node || this._SelectedNode, {});
                        if (!s)
                            return void console.error("Unable to make root bone.");
                        var l = s.stageItem
                          , f = this._SelectedNode.worldTransform
                          , p = d.mat2d.invert(d.mat2d.create(), f);
                        s.translation = d.vec2.transformMat2d(d.vec2.create(), e, p),
                        s.stageItem.addToStage(this.stage);
                        var y = new h.default(false,false,[l]);
                        y.preTransform(),
                        l.renderTransform = d.mat2d.fromTranslation(d.mat2d.create(), e),
                        y.skipPreTransform = true,
                        y.advance([0, 0], [0, 0]),
                        y.skipPreTransform = false,
                        this.addActiveTransformer(y),
                        this.stage.selectItem(s.stageItem)
                    }
                }
            }
        }]),
        t
    }(o.default);
    t.default = p
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }
      , o = d(n(313))
      , a = d(n(261))
      , s = d(n(201))
      , l = d(n(208))
      , u = n(2)
      , c = d(n(446));
    function d(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var h = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n._WasImageSelectionDisabled = false,
            n._WasBoneSelectionDisabled = false,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "enable",
            value: function() {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "enable", this).call(this);
                var e = this.stage.getLayerOptions(a.default);
                this._WasImageSelectionDisabled = e.disableSelection,
                e.disableSelection = true,
                this.stage.setLayerOptions(a.default, e);
                var n = this.stage.getLayerOptions(s.default);
                this._WasBoneSelectionDisabled = n.disableSelection,
                n.disableSelection = true,
                this.stage.setLayerOptions(s.default, n)
            }
        }, {
            key: "validate",
            value: function() {
                return !this.stage.soloItem && !this.stage.appContext.editingAnimation
            }
        }, {
            key: "disable",
            value: function() {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "disable", this).call(this);
                var e = this.stage.getLayerOptions(a.default);
                e.disableSelection = this._WasImageSelectionDisabled,
                this.stage.setLayerOptions(a.default, e);
                var n = this.stage.getLayerOptions(s.default);
                n.disableSelection = this._WasBoneSelectionDisabled,
                this.stage.setLayerOptions(s.default, n)
            }
        }, {
            key: "click",
            value: function(e, t) {
                if (!t) {
                    var n = this.stage.appContext.actor
                      , i = this.stage.selectedItems
                      , r = n.addNodeType(l.default, i && i.length && i[0].node || null, null);
                    if (r) {
                        r.stageItem.addToStage(this.stage);
                        var o = r.parent.worldTransform
                          , a = u.mat2d.invert(u.mat2d.create(), o);
                        r.translation = u.vec2.transformMat2d(u.vec2.create(), e, a);
                        var s = new c.default(false,false,[r]);
                        this.addActiveTransformer(s),
                        this.stage.selectItem(r.stageItem)
                    } else
                        console.error("Unable to make node.")
                }
            }
        }]),
        t
    }(o.default);
    t.default = h
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }
      , o = c(n(313))
      , a = c(n(261))
      , s = c(n(344))
      , l = n(2)
      , u = c(n(446));
    function c(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var d = function(e) {
        function t(e) {
            return function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t),
            function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "enable",
            value: function() {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "enable", this).call(this);
                var e = this.stage.getLayerOptions(a.default);
                this._WasImageSelectionDisabled = e.disableSelection,
                e.disableSelection = true,
                this.stage.setLayerOptions(a.default, e)
            }
        }, {
            key: "validate",
            value: function() {
                return !this.stage.appContext.editingAnimation
            }
        }, {
            key: "disable",
            value: function() {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "disable", this).call(this);
                var e = this.stage.getLayerOptions(a.default);
                e.disableSelection = this._WasImageSelectionDisabled,
                this.stage.setLayerOptions(a.default, e)
            }
        }, {
            key: "click",
            value: function(e, t) {
                if (!t) {
                    var n = this.stage.appContext.actor
                      , i = this.stage.selectedItems
                      , r = n.addNodeType(s.default, i && i.length && i[0].node || null, null);
                    if (r) {
                        r.stageItem.addToStage(this.stage);
                        var o = r.parent.worldTransform
                          , a = l.mat2d.invert(l.mat2d.create(), o);
                        r.translation = l.vec2.transformMat2d(l.vec2.create(), e, a);
                        var c = new u.default(false,false,[r]);
                        this.addActiveTransformer(c),
                        this.stage.selectItem(r.stageItem)
                    } else
                        console.log("Unable to make solo.")
                }
            }
        }]),
        t
    }(o.default);
    t.default = d
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }
      , o = d(n(313))
      , a = d(n(261))
      , s = d(n(201))
      , l = d(n(384))
      , u = n(2)
      , c = d(n(446));
    function d(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var h = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n._WasImageSelectionDisabled = false,
            n._WasBoneSelectionDisabled = false,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "enable",
            value: function() {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "enable", this).call(this);
                var e = this.stage.getLayerOptions(a.default);
                this._WasImageSelectionDisabled = e.disableSelection,
                e.disableSelection = true,
                this.stage.setLayerOptions(a.default, e);
                var n = this.stage.getLayerOptions(s.default);
                this._WasBoneSelectionDisabled = n.disableSelection,
                n.disableSelection = true,
                this.stage.setLayerOptions(s.default, n)
            }
        }, {
            key: "validate",
            value: function() {
                return !this.stage.soloItem && !this.stage.appContext.editingAnimation
            }
        }, {
            key: "disable",
            value: function() {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "disable", this).call(this);
                var e = this.stage.getLayerOptions(a.default);
                e.disableSelection = this._WasImageSelectionDisabled,
                this.stage.setLayerOptions(a.default, e);
                var n = this.stage.getLayerOptions(s.default);
                n.disableSelection = this._WasBoneSelectionDisabled,
                this.stage.setLayerOptions(s.default, n)
            }
        }, {
            key: "click",
            value: function(e, t) {
                if (!t) {
                    var n = this.stage.appContext.actor
                      , i = this.stage.selectedItems
                      , r = n.addNodeType(l.default, i && i.length && i[0].node || null, null);
                    if (r) {
                        r.stageItem.addToStage(this.stage);
                        var o = r.parent.worldTransform
                          , a = u.mat2d.invert(u.mat2d.create(), o);
                        r.translation = u.vec2.transformMat2d(u.vec2.create(), e, a);
                        var s = new c.default(false,false,[r]);
                        this.addActiveTransformer(s),
                        this.stage.selectItem(r.stageItem)
                    } else
                        console.error("Unable to make collider.")
                }
            }
        }]),
        t
    }(o.default);
    t.default = h
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    });
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }();
    var r = function() {
        function e() {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e)
        }
        return i(e, null, [{
            key: "toDisplayValue",
            value: function(e) {
                return "#" + this.toInputValue(e)
            }
        }, {
            key: "toInputValue",
            value: function(e) {
                return ((1 << 24) + (e[0] << 16) + (e[1] << 8) + e[2]).toString(16).slice(1)
            }
        }, {
            key: "fromDisplayValue",
            value: function(e) {
                e = e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i, (function(e, t, n, i) {
                    return t + t + n + n + i + i
                }
                ));
                var t = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);
                if (!t)
                    throw "Invalid input";
                return new Uint8Array([parseInt(t[1], 16), parseInt(t[2], 16), parseInt(t[3], 16)])
            }
        }, {
            key: "fromInputValue",
            value: function(e) {
                return this.fromDisplayValue(e)
            }
        }, {
            key: "defaultValue",
            get: function() {
                return new Uint8Array([255, 255, 255])
            }
        }]),
        e
    }();
    t.default = r
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    });
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }();
    var r = function() {
        function e() {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e)
        }
        return i(e, null, [{
            key: "toDisplayValue",
            value: function(e) {
                return this.toInputValue(e) + "%"
            }
        }, {
            key: "toInputValue",
            value: function(e) {
                return Math.round(100 * e).toFixed()
            }
        }, {
            key: "fromDisplayValue",
            value: function(e) {
                var t = Number.parseFloat(e) / 100;
                if (!t)
                    throw "Invalid input";
                return t
            }
        }, {
            key: "fromInputValue",
            value: function(e) {
                return this.fromDisplayValue(e)
            }
        }, {
            key: "dragScale",
            get: function() {
                return .03
            }
        }, {
            key: "dragMin",
            get: function() {
                return .15
            }
        }, {
            key: "dragMax",
            get: function() {
                return 8
            }
        }, {
            key: "dragFastScale",
            get: function() {
                return .1
            }
        }]),
        e
    }();
    t.default = r
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }
      , o = d(n(380))
      , a = n(2)
      , s = d(n(237))
      , l = d(n(208))
      , u = n(515)
      , c = d(n(11));
    function d(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function h(e, t) {
        if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function")
    }
    var f = function(e) {
        function t(e) {
            h(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.name = "IK Constraint",
            n._InvertDirection = false,
            n._InfluencedBones = [],
            n._Solver = null,
            n._SolverType = y,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "onAdded",
            value: function() {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "onAdded", this).call(this),
                this.parent && this.influenceBone(this.parent),
                this.updatePeerConstrained()
            }
        }, {
            key: "onAddedToActor",
            value: function() {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "onAddedToActor", this).call(this),
                this.updatePeerConstrained()
            }
        }, {
            key: "onRemovedFromActor",
            value: function() {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "onRemovedFromActor", this).call(this),
                this.updatePeerConstrained()
            }
        }, {
            key: "updatePeerConstrained",
            value: function() {
                var e = this.isRemoved
                  , t = this._InfluencedBones;
                if (t) {
                    var n = true
                      , i = false
                      , r = void 0;
                    try {
                        for (var o, a = t[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                            var s = o.value;
                            e ? s.removePeerConstraint(this) : s.addPeerConstraint(this)
                        }
                    } catch (e) {
                        i = true,
                        r = e
                    } finally {
                        try {
                            !n && a.return && a.return()
                        } finally {
                            if (i)
                                throw r
                        }
                    }
                }
            }
        }, {
            key: "updateDependencies",
            value: function(e) {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "updateDependencies", this).call(this, e);
                var n = true
                  , i = false
                  , o = void 0;
                try {
                    for (var a, s = this._InfluencedBones[Symbol.iterator](); !(n = (a = s.next()).done); n = true) {
                        var u = a.value;
                        e.addDependency(this, u)
                    }
                } catch (e) {
                    i = true,
                    o = e
                } finally {
                    try {
                        !n && s.return && s.return()
                    } finally {
                        if (i)
                            throw o
                    }
                }
                if (this._Target && e.addDependency(this, this._Target),
                this.updatePeerConstrained(),
                this._Solver) {
                    var c = this._Solver._FKChain;
                    if (c.length) {
                        var d = c[c.length - 1]
                          , h = true
                          , f = false
                          , p = void 0;
                        try {
                            for (var y, m = c[Symbol.iterator](); !(h = (y = m.next()).done); h = true) {
                                var v = y.value;
                                if (v !== d) {
                                    var g = v.bone.children
                                      , _ = function(t) {
                                        return t instanceof l.default ? c.find((function(e) {
                                            return e.bone === t
                                        }
                                        )) ? "continue" : void e.addDependency(t, d.bone) : "continue"
                                    }
                                      , b = true
                                      , w = false
                                      , O = void 0;
                                    try {
                                        for (var S, k = g[Symbol.iterator](); !(b = (S = k.next()).done); b = true)
                                            _(S.value)
                                    } catch (e) {
                                        w = true,
                                        O = e
                                    } finally {
                                        try {
                                            !b && k.return && k.return()
                                        } finally {
                                            if (w)
                                                throw O
                                        }
                                    }
                                }
                            }
                        } catch (e) {
                            f = true,
                            p = e
                        } finally {
                            try {
                                !h && m.return && m.return()
                            } finally {
                                if (f)
                                    throw p
                            }
                        }
                    }
                }
            }
        }, {
            key: "update",
            value: function() {}
        }, {
            key: "onDirty",
            value: function() {
                this.markDirty()
            }
        }, {
            key: "markDirty",
            value: function() {
                var e = this._Solver;
                if (e && e._FKChain) {
                    var t = true
                      , n = false
                      , i = void 0;
                    try {
                        for (var r, o = e._FKChain[Symbol.iterator](); !(t = (r = o.next()).done); t = true) {
                            r.value.bone.markTransformDirty()
                        }
                    } catch (e) {
                        n = true,
                        i = e
                    } finally {
                        try {
                            !t && o.return && o.return()
                        } finally {
                            if (n)
                                throw i
                        }
                    }
                }
            }
        }, {
            key: "read",
            value: function(e, n) {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "read", this).call(this, e, n);
                var i = n.invertDirection;
                void 0 !== i && (this._InvertDirection = i);
                var o = n.influencedBones;
                if (o) {
                    var a = this;
                    e.whenNodesLoaded((function() {
                        for (var t = 0; t < o.length; t++) {
                            var n = o[t];
                            if (n) {
                                if (n.constructor === String || n.constructor === Number) {
                                    var i = e.getNode(n);
                                    i ? i.constructor === s.default ? (a._InfluencedBones.push(i),
                                    -1 === i.targets.indexOf(a) && i.targets.push(a)) : console.log("NON BONE IN BONE LIST?") : console.log("NO NODE WITH REFID WHILE LOOKING FOR BONE", n)
                                }
                            } else
                                console.warn("Bad bone in bones array?", o)
                        }
                        a._InfluencedBones.sort((function(e, t) {
                            return e.treeDepth - t.treeDepth
                        }
                        )),
                        a.resetSolver()
                    }
                    ))
                }
            }
        }, {
            key: "influenceBone",
            value: function(e, t) {
                if (!e || e.constructor !== s.default)
                    return false;
                if (-1 !== this._InfluencedBones.indexOf(e))
                    return false;
                var n = this._InfluencedBones;
                return n.push(e),
                n.sort((function(e, t) {
                    return e.treeDepth - t.treeDepth
                }
                )),
                this._Actor.markDependenciesDirty(),
                this.resetSolver(),
                -1 === e.targets.indexOf(this) && e.targets.push(this),
                t || this.dispatch("influencedBoneChange"),
                true
            }
        }, {
            key: "resetSolver",
            value: function() {
                this._Solver = new this._SolverType(this,this._InfluencedBones)
            }
        }, {
            key: "removeBoneInfluence",
            value: function(e, t) {
                var n = this._InfluencedBones.indexOf(e);
                if (-1 !== n) {
                    var i = e.targets.indexOf(this);
                    -1 !== i && e.targets.splice(i, 1),
                    this._InfluencedBones.splice(n, 1),
                    this.resetSolver(),
                    t || this.dispatch("influencedBoneChange")
                }
            }
        }, {
            key: "serializeProperties",
            value: function(e) {
                var n = r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeProperties", this).call(this, e);
                if (delete n.influencedBones,
                this._InfluencedBones.length) {
                    for (var i = [], o = 0; o < this._InfluencedBones.length; o++) {
                        var a = this._InfluencedBones[o];
                        i.push(a.refId)
                    }
                    n.influencedBones = i
                }
                return n
            }
        }, {
            key: "serializeInteractive",
            value: function() {
                var e = r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeInteractive", this).call(this);
                return e.invertDirection = this._InvertDirection,
                e.influencedBones = this._InfluencedBones.slice(0),
                e
            }
        }, {
            key: "constrain",
            value: function(e) {
                if (this._Solver && this._Target) {
                    var t = a.mat2d.getTranslation(a.vec2.create(), this._Target.worldTransform);
                    return this._Solver.solve(t, this.strength),
                    true
                }
                return false
            }
        }, {
            key: "solver",
            get: function() {
                return this._Solver
            }
        }, {
            key: "solverType",
            get: function() {
                return this._SolverType
            },
            set: function(e) {
                e != this._SolverType && (this._SolverType = e,
                this.resetSolver())
            }
        }, {
            key: "influencedBones",
            get: function() {
                return this._InfluencedBones
            },
            set: function(e) {
                this._InfluencedBones = e,
                this.dispatch("connectedBonesChanged"),
                this.resetSolver()
            }
        }, {
            key: "invertDirection",
            get: function() {
                return this._InvertDirection
            },
            set: function(e) {
                this._InvertDirection != e && (this._InvertDirection = e,
                this.dispatch("invertDirectionChange", e),
                this.markDirty(),
                this.stageItem && this.stageItem.stage && this.stageItem.stage.redraw())
            }
        }], [{
            key: "constraintName",
            get: function() {
                return "IK"
            }
        }, {
            key: "targetName",
            get: function() {
                return "IK Target"
            }
        }]),
        t
    }(o.default);
    t.default = f;
    var p = 2 * Math.PI
      , y = function() {
        function e(t, n) {
            var i = this;
            if (h(this, e),
            this._Target = t,
            this._Tip = n[n.length - 1],
            this._B1 = n[0],
            this._B1c = this._Tip,
            n.length > 1)
                for (; this._B1c && this._B1c.parent != this._B1; )
                    this._B1c = this._B1c.parent;
            var r = this._Tip
              , o = this._FKChain = [];
            for (this._BoneData = []; r && r != this._B1.parent; )
                o.unshift({
                    bone: r,
                    ikAngle: 0,
                    transformComponents: new Float32Array(6),
                    in: false
                }),
                r = r.parent;
            for (var a = o.length < 3, s = 0; s < o.length; s++) {
                var l = o[s];
                l.idx = s,
                l.in = a
            }
            var u = function(e) {
                var t = i._FKChain.find((function(t) {
                    return t.bone === e
                }
                ));
                if (!t)
                    return console.warn("Bone not in chain?", t, e),
                    "continue";
                i._BoneData.push(t)
            }
              , c = true
              , d = false
              , f = void 0;
            try {
                for (var p, y = n[Symbol.iterator](); !(c = (p = y.next()).done); c = true)
                    u(p.value)
            } catch (e) {
                d = true,
                f = e
            } finally {
                try {
                    !c && y.return && y.return()
                } finally {
                    if (d)
                        throw f
                }
            }
            if (!a)
                for (var m = this._BoneData, v = 0; v < m.length - 1; v++) {
                    var g = m[v];
                    g.in = true,
                    o[g.idx + 1].in = true
                }
        }
        return i(e, [{
            key: "solve1",
            value: function(e, t) {
                var n = e.parentWorldInverse
                  , i = e.bone.worldTranslation
                  , r = a.vec2.copy(a.vec2.create(), t)
                  , o = a.vec2.subtract(a.vec2.create(), r, i)
                  , s = a.vec2.transformMat2(a.vec2.create(), o, n)
                  , l = Math.atan2(s[1], s[0]);
                return m(e, l),
                e.ikAngle = l,
                true
            }
        }, {
            key: "solve2",
            value: function(e, t, n) {
                var i = e.bone
                  , r = t.bone
                  , o = this._FKChain
                  , s = o[e.idx + 1]
                  , l = e.parentWorldInverse
                  , u = i.worldTranslation
                  , c = s.bone.worldTranslation
                  , d = r.tipWorldTranslation
                  , h = a.vec2.copy(a.vec2.create(), n);
                u = a.vec2.transformMat2d(u, u, l),
                c = a.vec2.transformMat2d(c, c, l),
                d = a.vec2.transformMat2d(d, d, l),
                h = a.vec2.transformMat2d(h, h, l);
                var f = a.vec2.subtract(a.vec2.create(), d, c)
                  , p = a.vec2.length(f)
                  , y = a.vec2.subtract(a.vec2.create(), c, u)
                  , v = a.vec2.length(y)
                  , g = a.vec2.subtract(a.vec2.create(), h, u)
                  , _ = a.vec2.length(g)
                  , b = Math.acos(Math.max(-1, Math.min(1, (-p * p + v * v + _ * _) / (2 * v * _))))
                  , w = Math.acos(Math.max(-1, Math.min(1, (p * p + v * v - _ * _) / (2 * p * v))))
                  , O = void 0
                  , S = void 0;
                if (r.parent != i) {
                    var k = o[e.idx + 2].parentWorldInverse;
                    c = s.bone.worldTranslation,
                    d = r.tipWorldTranslation;
                    var P = a.vec2.subtract(a.vec2.create(), d, c)
                      , E = a.vec2.transformMat2(a.vec2.create(), P, k)
                      , T = -Math.atan2(E[1], E[0]);
                    this._Target.invertDirection ? (O = Math.atan2(g[1], g[0]) - b,
                    S = -w + Math.PI + T) : (O = b + Math.atan2(g[1], g[0]),
                    S = w - Math.PI + T)
                } else
                    this._Target.invertDirection ? (O = Math.atan2(g[1], g[0]) - b,
                    S = -w + Math.PI) : (O = b + Math.atan2(g[1], g[0]),
                    S = w - Math.PI);
                if (m(e, O),
                m(s, S),
                s !== t) {
                    var C = t.bone;
                    a.mat2d.mul(C.worldTransform, C.parent.worldTransform, C.transform)
                }
                return e.ikAngle = O,
                s.ikAngle = S,
                true
            }
        }, {
            key: "solve",
            value: function(e, t) {
                var n = this._BoneData;
                if (n.length) {
                    this._Tip;
                    for (var i = this._FKChain, r = 0; r < i.length; r++) {
                        var o = i[r]
                          , s = o.bone.parent.worldTransform
                          , l = a.mat2d.invert(a.mat2d.create(), s);
                        l || (c.default.debug("mat2d.invert failed - " + (s && s[0] + " " + s[1] + " " + s[2] + " " + s[3] + " " + s[4] + s[5])),
                        l = a.mat2d.create());
                        var d = a.mat2d.mul(o.bone.transform, l, o.bone.worldTransform);
                        (0,
                        u.Decompose)(d, o.transformComponents),
                        o.parentWorldInverse = l
                    }
                    if (1 === n.length)
                        this.solve1(n[0], e);
                    else if (2 == n.length)
                        this.solve2(n[0], n[1], e);
                    else
                        for (var h = n[n.length - 1], f = 0; f < n.length - 1; f++) {
                            var y = n[f];
                            this.solve2(y, h, e);
                            for (var v = y.idx + 1; v < i.length - 1; v++) {
                                var g = i[v]
                                  , _ = g.bone.parent.worldTransform;
                                g.parentWorldInverse = a.mat2d.invert(a.mat2d.create(), _)
                            }
                        }
                    var b = t;
                    if (1 != b) {
                        var w = true
                          , O = false
                          , S = void 0;
                        try {
                            for (var k, P = i[Symbol.iterator](); !(w = (k = P.next()).done); w = true) {
                                var E = k.value;
                                if (E.in) {
                                    var T = E.transformComponents[4] % p
                                      , C = E.ikAngle % p - T;
                                    C > Math.PI ? C -= p : C < -Math.PI && (C += p),
                                    m(E, T + C * b)
                                } else {
                                    var x = E.bone;
                                    E.ikAngle = E.transformComponents[4] % p,
                                    a.mat2d.mul(x.worldTransform, x.parent.worldTransform, x.transform)
                                }
                            }
                        } catch (e) {
                            O = true,
                            S = e
                        } finally {
                            try {
                                !w && P.return && P.return()
                            } finally {
                                if (O)
                                    throw S
                            }
                        }
                    }
                }
            }
        }, {
            key: "getChain",
            value: function() {
                return this._FKChain
            }
        }, {
            key: "getWorld",
            value: function() {
                if (!this._B1)
                    return a.mat2d.create();
                var e = a.mat2d.clone(this._B1.parent.worldTransform);
                if (this._B1.parent.length) {
                    var t = a.mat2d.fromTranslation(a.mat2d.create(), [this._B1.parent.length, 0]);
                    a.mat2d.mul(e, e, t)
                }
                return e
            }
        }]),
        e
    }();
    function m(e, t) {
        var n = e.bone.parent.worldTransform
          , i = e.bone.transform
          , r = e.transformComponents;
        0 === t ? a.mat2d.identity(i) : a.mat2d.fromRotation(i, t),
        i[4] = r[0],
        i[5] = r[1];
        var o = r[2]
          , s = r[3];
        i[0] *= o,
        i[1] *= o,
        i[2] *= s,
        i[3] *= s;
        var l = r[5];
        0 !== l && (i[2] = i[0] * l + i[2],
        i[3] = i[1] * l + i[3]),
        a.mat2d.mul(e.bone.worldTransform, n, i)
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }
      , o = c(n(380))
      , a = n(2)
      , s = c(n(357))
      , l = n(515)
      , u = c(n(1101));
    function c(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var d = 2 * Math.PI
      , h = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.name = "Rotation Constraint",
            n._Copy = true,
            n._EnableMin = false,
            n._EnableMax = false,
            n._Offset = false,
            n._Min = -d,
            n._Max = d,
            n._Scale = 1,
            n._SourceSpace = s.default.World,
            n._DestSpace = s.default.World,
            n._MinMaxSpace = s.default.World,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "markDirty",
            value: function() {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "markDirty", this).call(this),
                this.dispatch("changeConstraint")
            }
        }, {
            key: "read",
            value: function(e, n) {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "read", this).call(this, e, n);
                var i = n.sourceSpace;
                void 0 !== i && (this._SourceSpace = s.default.fromString(i)),
                void 0 !== (i = n.destSpace) && (this._DestSpace = s.default.fromString(i)),
                void 0 !== (i = n.minMaxSpace) && (this._MinMaxSpace = s.default.fromString(i));
                var o = n.copy;
                void 0 !== o && (this._Copy = !!o),
                void 0 !== (o = n.enableMin) && (this._EnableMin = !!o),
                void 0 !== (o = n.enableMax) && (this._EnableMax = !!o),
                void 0 !== (o = n.offset) && (this._Offset = !!o),
                void 0 !== (o = n.min) && (this._Min = Number.parseFloat(o)),
                void 0 !== (o = n.max) && (this._Max = Number.parseFloat(o)),
                void 0 !== (o = n.scale) && (this._Scale = Number.parseFloat(o))
            }
        }, {
            key: "serializeProperties",
            value: function(e) {
                var n = r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeProperties", this).call(this, e);
                return n.sourceSpace = this._SourceSpace.toString(),
                n.destSpace = this._DestSpace.toString(),
                n.minMaxSpace = this._MinMaxSpace.toString(),
                n
            }
        }, {
            key: "serializeInteractive",
            value: function() {
                var e = r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeInteractive", this).call(this);
                return e.sourceSpace = this._SourceSpace,
                e.destSpace = this._DestSpace,
                e.minMaxSpace = this._MinMaxSpace,
                e.copy = this._Copy,
                e.enableMin = this._EnableMin,
                e.enableMax = this._EnableMax,
                e.offset = this._Offset,
                e.min = this._Min,
                e.max = this._Max,
                e.scale = this._Scale,
                e
            }
        }, {
            key: "constrain",
            value: function(e) {
                var t = this._Target
                  , n = this.parent
                  , i = n.parent
                  , r = this.strength
                  , o = this._SourceSpace
                  , u = this._DestSpace
                  , c = this._MinMaxSpace
                  , h = new Float32Array(6)
                  , f = new Float32Array(6)
                  , p = n.worldTransform
                  , y = a.mat2d.create();
                if ((0,
                l.Decompose)(p, h),
                t) {
                    if (a.mat2d.copy(y, t.worldTransform),
                    o === s.default.Local) {
                        var m = t.parent;
                        if (m) {
                            var v = a.mat2d.invert(a.mat2d.create(), m.worldTransform);
                            v && (y = a.mat2d.mul(v, v, y))
                        }
                    }
                    (0,
                    l.Decompose)(y, f),
                    this._Copy ? (f[4] *= this._Scale,
                    this._Offset && (f[4] += n.rotation)) : f[4] = u === s.default.Local ? 0 : h[4],
                    u === s.default.Local && i && ((0,
                    l.Compose)(y, f),
                    a.mat2d.mul(y, i.worldTransform, y),
                    (0,
                    l.Decompose)(y, f))
                } else
                    a.mat2d.copy(y, p),
                    f[0] = h[0],
                    f[1] = h[1],
                    f[2] = h[2],
                    f[3] = h[3],
                    f[4] = h[4],
                    f[5] = h[5];
                var g = !(c !== s.default.Local || !i);
                if (g) {
                    (0,
                    l.Compose)(y, f);
                    var _ = a.mat2d.invert(a.mat2d.create(), i.worldTransform);
                    _ ? (a.mat2d.mul(y, _, y),
                    (0,
                    l.Decompose)(y, f)) : g = false
                }
                this._EnableMax && f[4] > this._Max && (f[4] = this._Max),
                this._EnableMin && f[4] < this._Min && (f[4] = this._Min),
                g && ((0,
                l.Compose)(y, f),
                a.mat2d.mul(y, i.worldTransform, y),
                (0,
                l.Decompose)(y, f));
                var b = h[4] % d
                  , w = f[4] % d - b;
                return w > Math.PI ? w -= d : w < -Math.PI && (w += d),
                f[4] = b + w * r,
                f[0] = h[0],
                f[1] = h[1],
                f[2] = h[2],
                f[3] = h[3],
                f[5] = h[5],
                (0,
                l.Compose)(n.worldTransform, f),
                true
            }
        }, {
            key: "sourceSpace",
            get: function() {
                return this._SourceSpace
            },
            set: function(e) {
                this._SourceSpace !== e && (this._SourceSpace = e,
                this.markDirty())
            }
        }, {
            key: "destSpace",
            get: function() {
                return this._DestSpace
            },
            set: function(e) {
                this._DestSpace !== e && (this._DestSpace = e,
                this.markDirty())
            }
        }, {
            key: "minMaxSpace",
            get: function() {
                return this._MinMaxSpace
            },
            set: function(e) {
                this._MinMaxSpace !== e && (this._MinMaxSpace = e,
                this.markDirty())
            }
        }, {
            key: "copy",
            get: function() {
                return this._Copy
            },
            set: function(e) {
                this._Copy !== e && (this._Copy = e,
                this.markDirty())
            }
        }, {
            key: "enableMin",
            get: function() {
                return this._EnableMin
            },
            set: function(e) {
                this._EnableMin !== e && (this._EnableMin = e,
                this.markDirty())
            }
        }, {
            key: "enableMax",
            get: function() {
                return this._EnableMax
            },
            set: function(e) {
                this._EnableMax !== e && (this._EnableMax = e,
                this.markDirty())
            }
        }, {
            key: "offset",
            get: function() {
                return this._Offset
            },
            set: function(e) {
                this._Offset !== e && (this._Offset = e,
                this.markDirty())
            }
        }, {
            key: "min",
            get: function() {
                return this._Min
            },
            set: function(e) {
                this._Min !== e && (this._Min = e,
                this.markDirty())
            }
        }, {
            key: "max",
            get: function() {
                return this._Max
            },
            set: function(e) {
                this._Max !== e && (this._Max = e,
                this.markDirty())
            }
        }, {
            key: "scale",
            get: function() {
                return this._Scale
            },
            set: function(e) {
                this._Scale !== e && (this._Scale = e,
                this.markDirty())
            }
        }], [{
            key: "converter",
            get: function() {
                return u.default
            }
        }, {
            key: "constraintName",
            get: function() {
                return "Rotation"
            }
        }, {
            key: "targetName",
            get: function() {
                return "Rotation Source"
            }
        }]),
        t
    }(o.default);
    t.default = h
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }
      , o = u(n(380))
      , a = n(2)
      , s = u(n(357))
      , l = n(515);
    function u(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var c = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.name = "Scale Constraint",
            n._CopyX = true,
            n._CopyY = true,
            n._EnableMinX = false,
            n._EnableMinY = false,
            n._EnableMaxX = false,
            n._EnableMaxY = false,
            n._Offset = false,
            n._Min = a.vec2.set(a.vec2.create(), -1, -1),
            n._Max = a.vec2.set(a.vec2.create(), 1, 1),
            n._Scale = a.vec2.set(a.vec2.create(), 1, 1),
            n._SourceSpace = s.default.World,
            n._DestSpace = s.default.World,
            n._MinMaxSpace = s.default.World,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "markDirty",
            value: function() {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "markDirty", this).call(this),
                this.dispatch("changeConstraint")
            }
        }, {
            key: "read",
            value: function(e, n) {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "read", this).call(this, e, n);
                var i = n.sourceSpace;
                void 0 !== i && (this._SourceSpace = s.default.fromString(i)),
                void 0 !== (i = n.destSpace) && (this._DestSpace = s.default.fromString(i)),
                void 0 !== (i = n.minMaxSpace) && (this._MinMaxSpace = s.default.fromString(i));
                var o = n.copyX;
                void 0 !== o && (this._CopyX = !!o),
                void 0 !== (o = n.copyY) && (this._CopyY = !!o),
                void 0 !== (o = n.enableMinX) && (this._EnableMinX = !!o),
                void 0 !== (o = n.enableMinY) && (this._EnableMinY = !!o),
                void 0 !== (o = n.enableMaxX) && (this._EnableMaxX = !!o),
                void 0 !== (o = n.enableMaxY) && (this._EnableMaxY = !!o),
                void 0 !== (o = n.offset) && (this._Offset = !!o),
                void 0 !== (o = n.minX) && (this._Min[0] = Number.parseFloat(o)),
                void 0 !== (o = n.minY) && (this._Min[1] = Number.parseFloat(o)),
                void 0 !== (o = n.maxX) && (this._Max[0] = Number.parseFloat(o)),
                void 0 !== (o = n.maxY) && (this._Max[1] = Number.parseFloat(o)),
                void 0 !== (o = n.scaleX) && (this._Scale[0] = Number.parseFloat(o)),
                void 0 !== (o = n.scaleY) && (this._Scale[1] = Number.parseFloat(o))
            }
        }, {
            key: "serializeProperties",
            value: function(e) {
                var n = r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeProperties", this).call(this, e);
                return n.sourceSpace = this._SourceSpace.toString(),
                n.destSpace = this._DestSpace.toString(),
                n.minMaxSpace = this._MinMaxSpace.toString(),
                n
            }
        }, {
            key: "serializeInteractive",
            value: function() {
                var e = r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeInteractive", this).call(this);
                return e.sourceSpace = this._SourceSpace,
                e.destSpace = this._DestSpace,
                e.minMaxSpace = this._MinMaxSpace,
                e.copyX = this._CopyX,
                e.copyY = this._CopyY,
                e.enableMinX = this._EnableMinX,
                e.enableMinY = this._EnableMinY,
                e.enableMaxX = this._EnableMaxX,
                e.enableMaxY = this._EnableMaxY,
                e.offset = this._Offset,
                e.minX = this._Min[0],
                e.minY = this._Min[1],
                e.maxX = this._Max[0],
                e.maxY = this._Max[1],
                e.scaleX = this._Scale[0],
                e.scaleY = this._Scale[1],
                e
            }
        }, {
            key: "constrain",
            value: function(e) {
                var t = this._Target
                  , n = this.parent
                  , i = n.parent
                  , r = this.strength
                  , o = this._SourceSpace
                  , u = this._DestSpace
                  , c = this._MinMaxSpace
                  , d = new Float32Array(6)
                  , h = new Float32Array(6)
                  , f = n.worldTransform
                  , p = a.mat2d.create();
                if ((0,
                l.Decompose)(f, d),
                t) {
                    if (a.mat2d.copy(p, t.worldTransform),
                    o === s.default.Local) {
                        var y = t.parent;
                        if (y) {
                            var m = a.mat2d.invert(a.mat2d.create(), y.worldTransform);
                            p = a.mat2d.mul(m, m, p)
                        }
                    }
                    (0,
                    l.Decompose)(p, h),
                    this._CopyX ? (h[2] *= this._Scale[0],
                    this._Offset && (h[2] *= n.scale[0])) : h[2] = u === s.default.Local ? 1 : d[2],
                    this._CopyY ? (h[3] *= this._Scale[1],
                    this._Offset && (h[3] *= n.scale[1])) : h[3] = u === s.default.Local ? 0 : d[3],
                    u === s.default.Local && i && ((0,
                    l.Compose)(p, h),
                    a.mat2d.mul(p, i.worldTransform, p),
                    (0,
                    l.Decompose)(p, h))
                } else
                    a.mat2d.copy(p, f),
                    h[0] = d[0],
                    h[1] = d[1],
                    h[2] = d[2],
                    h[3] = d[3],
                    h[4] = d[4],
                    h[5] = d[5];
                var v = !(c !== s.default.Local || !i);
                if (v) {
                    (0,
                    l.Compose)(p, h);
                    var g = a.mat2d.invert(a.mat2d.create(), i.worldTransform);
                    a.mat2d.mul(p, g, p),
                    (0,
                    l.Decompose)(p, h)
                }
                this._EnableMaxX && h[2] > this._Max[0] && (h[2] = this._Max[0]),
                this._EnableMinX && h[2] < this._Min[0] && (h[2] = this._Min[0]),
                this._EnableMaxY && h[3] > this._Max[1] && (h[3] = this._Max[1]),
                this._EnableMinY && h[3] < this._Min[1] && (h[3] = this._Min[1]),
                v && ((0,
                l.Compose)(p, h),
                a.mat2d.mul(p, i.worldTransform, p),
                (0,
                l.Decompose)(p, h));
                var _ = 1 - r;
                return h[4] = d[4],
                h[0] = d[0],
                h[1] = d[1],
                h[2] = d[2] * _ + h[2] * r,
                h[3] = d[3] * _ + h[3] * r,
                h[5] = d[5],
                (0,
                l.Compose)(n.worldTransform, h),
                true
            }
        }, {
            key: "sourceSpace",
            get: function() {
                return this._SourceSpace
            },
            set: function(e) {
                this._SourceSpace !== e && (this._SourceSpace = e,
                this.markDirty())
            }
        }, {
            key: "destSpace",
            get: function() {
                return this._DestSpace
            },
            set: function(e) {
                this._DestSpace !== e && (this._DestSpace = e,
                this.markDirty())
            }
        }, {
            key: "minMaxSpace",
            get: function() {
                return this._MinMaxSpace
            },
            set: function(e) {
                this._MinMaxSpace !== e && (this._MinMaxSpace = e,
                this.markDirty())
            }
        }, {
            key: "copyX",
            get: function() {
                return this._CopyX
            },
            set: function(e) {
                this._CopyX !== e && (this._CopyX = e,
                this.markDirty())
            }
        }, {
            key: "copyY",
            get: function() {
                return this._CopyY
            },
            set: function(e) {
                this._CopyY !== e && (this._CopyY = e,
                this.markDirty())
            }
        }, {
            key: "enableMinX",
            get: function() {
                return this._EnableMinX
            },
            set: function(e) {
                this._EnableMinX !== e && (this._EnableMinX = e,
                this.markDirty())
            }
        }, {
            key: "enableMinY",
            get: function() {
                return this._EnableMinY
            },
            set: function(e) {
                this._EnableMinY !== e && (this._EnableMinY = e,
                this.markDirty())
            }
        }, {
            key: "enableMaxX",
            get: function() {
                return this._EnableMaxX
            },
            set: function(e) {
                this._EnableMaxX !== e && (this._EnableMaxX = e,
                this.markDirty())
            }
        }, {
            key: "enableMaxY",
            get: function() {
                return this._EnableMaxY
            },
            set: function(e) {
                this._EnableMaxY !== e && (this._EnableMaxY = e,
                this.markDirty())
            }
        }, {
            key: "offset",
            get: function() {
                return this._Offset
            },
            set: function(e) {
                this._Offset !== e && (this._Offset = e,
                this.markDirty())
            }
        }, {
            key: "minX",
            get: function() {
                return this._Min[0]
            },
            set: function(e) {
                this._Min[0] !== e && (this._Min[0] = e,
                this.markDirty())
            }
        }, {
            key: "minY",
            get: function() {
                return this._Min[1]
            },
            set: function(e) {
                this._Min[1] !== e && (this._Min[1] = e,
                this.markDirty())
            }
        }, {
            key: "maxX",
            get: function() {
                return this._Max[0]
            },
            set: function(e) {
                this._Max[0] !== e && (this._Max[0] = e,
                this.markDirty())
            }
        }, {
            key: "maxY",
            get: function() {
                return this._Max[1]
            },
            set: function(e) {
                this._Max[1] !== e && (this._Max[1] = e,
                this.markDirty())
            }
        }, {
            key: "scaleX",
            get: function() {
                return this._Scale[0]
            },
            set: function(e) {
                this._Scale[0] !== e && (this._Scale[0] = e,
                this.markDirty())
            }
        }, {
            key: "scaleY",
            get: function() {
                return this._Scale[1]
            },
            set: function(e) {
                this._Scale[1] !== e && (this._Scale[1] = e,
                this.markDirty())
            }
        }], [{
            key: "constraintName",
            get: function() {
                return "Scale"
            }
        }, {
            key: "targetName",
            get: function() {
                return "Scale Source"
            }
        }]),
        t
    }(o.default);
    t.default = c
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }
      , o = u(n(380))
      , a = n(2)
      , s = n(515)
      , l = u(n(357));
    function u(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var c = 2 * Math.PI
      , d = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.name = "Transform Constraint",
            n._SourceSpace = l.default.World,
            n._DestSpace = l.default.World,
            n._ComponentsA = new Float32Array(6),
            n._ComponentsB = new Float32Array(6),
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "read",
            value: function(e, n) {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "read", this).call(this, e, n);
                var i = n.sourceSpace;
                void 0 !== i && (this._SourceSpace = l.default.fromString(i)),
                void 0 !== (i = n.destSpace) && (this._DestSpace = l.default.fromString(i))
            }
        }, {
            key: "serializeProperties",
            value: function(e) {
                var n = r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeProperties", this).call(this, e);
                return n.sourceSpace = this._SourceSpace.toString(),
                n.destSpace = this._DestSpace.toString(),
                n
            }
        }, {
            key: "serializeInteractive",
            value: function() {
                var e = r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeInteractive", this).call(this);
                return e.sourceSpace = this._SourceSpace,
                e.destSpace = this._DestSpace,
                e
            }
        }, {
            key: "constrain",
            value: function(e) {
                var t = this._Target;
                if (t) {
                    var n = this.parent
                      , i = this._ComponentsA
                      , r = this._ComponentsB
                      , o = this.strength
                      , u = this._SourceSpace
                      , d = this._DestSpace
                      , h = n.worldTransform
                      , f = a.mat2d.clone(t.worldTransform);
                    if (u === l.default.Local) {
                        var p = t.parent;
                        if (p) {
                            var y = a.mat2d.invert(a.mat2d.create(), p.worldTransform);
                            y && (f = a.mat2d.mul(y, y, f))
                        }
                    }
                    if (d === l.default.Local) {
                        var m = n.parent;
                        m && a.mat2d.mul(f, m.worldTransform, f)
                    }
                    (0,
                    s.Decompose)(h, i),
                    (0,
                    s.Decompose)(f, r);
                    var v = i[4] % c
                      , g = r[4] % c - v;
                    g > Math.PI ? g -= c : g < -Math.PI && (g += c);
                    var _ = 1 - o;
                    return r[4] = v + g * o,
                    r[0] = i[0] * _ + r[0] * o,
                    r[1] = i[1] * _ + r[1] * o,
                    r[2] = i[2] * _ + r[2] * o,
                    r[3] = i[3] * _ + r[3] * o,
                    r[5] = i[5] * _ + r[5] * o,
                    (0,
                    s.Compose)(n.worldTransform, r),
                    true
                }
            }
        }, {
            key: "sourceSpace",
            get: function() {
                return this._SourceSpace
            },
            set: function(e) {
                this._SourceSpace !== e && (this._SourceSpace = e,
                this.markDirty(),
                this.dispatch("changeTransformConstraint"))
            }
        }, {
            key: "destSpace",
            get: function() {
                return this._DestSpace
            },
            set: function(e) {
                this._DestSpace !== e && (this._DestSpace = e,
                this.markDirty(),
                this.dispatch("changeTransformConstraint"))
            }
        }], [{
            key: "constraintName",
            get: function() {
                return "Transform"
            }
        }, {
            key: "targetName",
            get: function() {
                return "Transform Source"
            }
        }]),
        t
    }(o.default);
    t.default = d
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }
      , o = l(n(380))
      , a = n(2)
      , s = l(n(357));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var u = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.name = "Translation Constraint",
            n._CopyX = true,
            n._CopyY = true,
            n._EnableMinX = false,
            n._EnableMinY = false,
            n._EnableMaxX = false,
            n._EnableMaxY = false,
            n._Offset = false,
            n._Min = a.vec2.set(a.vec2.create(), -100, -100),
            n._Max = a.vec2.set(a.vec2.create(), 100, 100),
            n._Scale = a.vec2.set(a.vec2.create(), 1, 1),
            n._SourceSpace = s.default.World,
            n._DestSpace = s.default.World,
            n._MinMaxSpace = s.default.World,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "markDirty",
            value: function() {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "markDirty", this).call(this),
                this.dispatch("changeConstraint")
            }
        }, {
            key: "read",
            value: function(e, n) {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "read", this).call(this, e, n);
                var i = n.sourceSpace;
                void 0 !== i && (this._SourceSpace = s.default.fromString(i)),
                void 0 !== (i = n.destSpace) && (this._DestSpace = s.default.fromString(i)),
                void 0 !== (i = n.minMaxSpace) && (this._MinMaxSpace = s.default.fromString(i));
                var o = n.copyX;
                void 0 !== o && (this._CopyX = !!o),
                void 0 !== (o = n.copyY) && (this._CopyY = !!o),
                void 0 !== (o = n.enableMinX) && (this._EnableMinX = !!o),
                void 0 !== (o = n.enableMinY) && (this._EnableMinY = !!o),
                void 0 !== (o = n.enableMaxX) && (this._EnableMaxX = !!o),
                void 0 !== (o = n.enableMaxY) && (this._EnableMaxY = !!o),
                void 0 !== (o = n.offset) && (this._Offset = !!o),
                void 0 !== (o = n.minX) && (this._Min[0] = Number.parseFloat(o)),
                void 0 !== (o = n.minY) && (this._Min[1] = Number.parseFloat(o)),
                void 0 !== (o = n.maxX) && (this._Max[0] = Number.parseFloat(o)),
                void 0 !== (o = n.maxY) && (this._Max[1] = Number.parseFloat(o)),
                void 0 !== (o = n.scaleX) && (this._Scale[0] = Number.parseFloat(o)),
                void 0 !== (o = n.scaleY) && (this._Scale[1] = Number.parseFloat(o))
            }
        }, {
            key: "serializeProperties",
            value: function(e) {
                var n = r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeProperties", this).call(this, e);
                return n.sourceSpace = this._SourceSpace.toString(),
                n.destSpace = this._DestSpace.toString(),
                n.minMaxSpace = this._MinMaxSpace.toString(),
                n
            }
        }, {
            key: "serializeInteractive",
            value: function() {
                var e = r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeInteractive", this).call(this);
                return e.sourceSpace = this._SourceSpace,
                e.destSpace = this._DestSpace,
                e.minMaxSpace = this._MinMaxSpace,
                e.copyX = this._CopyX,
                e.copyY = this._CopyY,
                e.enableMinX = this._EnableMinX,
                e.enableMinY = this._EnableMinY,
                e.enableMaxX = this._EnableMaxX,
                e.enableMaxY = this._EnableMaxY,
                e.offset = this._Offset,
                e.minX = this._Min[0],
                e.minY = this._Min[1],
                e.maxX = this._Max[0],
                e.maxY = this._Max[1],
                e.scaleX = this._Scale[0],
                e.scaleY = this._Scale[1],
                e
            }
        }, {
            key: "constrain",
            value: function(e) {
                var t = this._Target
                  , n = this.parent
                  , i = n.parent
                  , r = this.strength
                  , o = this._SourceSpace
                  , l = this._DestSpace
                  , u = this._MinMaxSpace
                  , c = n.worldTransform
                  , d = a.mat2d.getTranslation(a.vec2.create(), c)
                  , h = a.vec2.create();
                if (t) {
                    var f = a.mat2d.clone(t.worldTransform);
                    if (o === s.default.Local) {
                        var p = t.parent;
                        if (p) {
                            var y = a.mat2d.invert(a.mat2d.create(), p.worldTransform);
                            y && (f = a.mat2d.mul(y, y, f))
                        }
                    }
                    a.mat2d.getTranslation(h, f),
                    this._CopyX ? (h[0] *= this._Scale[0],
                    this._Offset && (h[0] += n.translation[0])) : h[0] = l === s.default.Local ? 0 : d[0],
                    this._CopyY ? (h[1] *= this._Scale[1],
                    this._Offset && (h[1] += n.translation[1])) : h[1] = l === s.default.Local ? 0 : d[1],
                    l === s.default.Local && i && a.vec2.transformMat2d(h, h, i.worldTransform)
                } else
                    a.vec2.copy(h, d);
                var m = !(u !== s.default.Local || !i);
                if (m) {
                    var v = a.mat2d.invert(a.mat2d.create(), i.worldTransform);
                    a.vec2.transformMat2d(h, h, v)
                }
                this._EnableMaxX && h[0] > this._Max[0] && (h[0] = this._Max[0]),
                this._EnableMinX && h[0] < this._Min[0] && (h[0] = this._Min[0]),
                this._EnableMaxY && h[1] > this._Max[1] && (h[1] = this._Max[1]),
                this._EnableMinY && h[1] < this._Min[1] && (h[1] = this._Min[1]),
                m && a.vec2.transformMat2d(h, h, i.worldTransform);
                var g = 1 - r;
                return c[4] = d[0] * g + h[0] * r,
                c[5] = d[1] * g + h[1] * r,
                true
            }
        }, {
            key: "sourceSpace",
            get: function() {
                return this._SourceSpace
            },
            set: function(e) {
                this._SourceSpace !== e && (this._SourceSpace = e,
                this.markDirty())
            }
        }, {
            key: "destSpace",
            get: function() {
                return this._DestSpace
            },
            set: function(e) {
                this._DestSpace !== e && (this._DestSpace = e,
                this.markDirty())
            }
        }, {
            key: "minMaxSpace",
            get: function() {
                return this._MinMaxSpace
            },
            set: function(e) {
                this._MinMaxSpace !== e && (this._MinMaxSpace = e,
                this.markDirty())
            }
        }, {
            key: "copyX",
            get: function() {
                return this._CopyX
            },
            set: function(e) {
                this._CopyX !== e && (this._CopyX = e,
                this.markDirty())
            }
        }, {
            key: "copyY",
            get: function() {
                return this._CopyY
            },
            set: function(e) {
                this._CopyY !== e && (this._CopyY = e,
                this.markDirty())
            }
        }, {
            key: "enableMinX",
            get: function() {
                return this._EnableMinX
            },
            set: function(e) {
                this._EnableMinX !== e && (this._EnableMinX = e,
                this.markDirty())
            }
        }, {
            key: "enableMinY",
            get: function() {
                return this._EnableMinY
            },
            set: function(e) {
                this._EnableMinY !== e && (this._EnableMinY = e,
                this.markDirty())
            }
        }, {
            key: "enableMaxX",
            get: function() {
                return this._EnableMaxX
            },
            set: function(e) {
                this._EnableMaxX !== e && (this._EnableMaxX = e,
                this.markDirty())
            }
        }, {
            key: "enableMaxY",
            get: function() {
                return this._EnableMaxY
            },
            set: function(e) {
                this._EnableMaxY !== e && (this._EnableMaxY = e,
                this.markDirty())
            }
        }, {
            key: "offset",
            get: function() {
                return this._Offset
            },
            set: function(e) {
                this._Offset !== e && (this._Offset = e,
                this.markDirty())
            }
        }, {
            key: "minX",
            get: function() {
                return this._Min[0]
            },
            set: function(e) {
                this._Min[0] !== e && (this._Min[0] = e,
                this.markDirty())
            }
        }, {
            key: "minY",
            get: function() {
                return this._Min[1]
            },
            set: function(e) {
                this._Min[1] !== e && (this._Min[1] = e,
                this.markDirty())
            }
        }, {
            key: "maxX",
            get: function() {
                return this._Max[0]
            },
            set: function(e) {
                this._Max[0] !== e && (this._Max[0] = e,
                this.markDirty())
            }
        }, {
            key: "maxY",
            get: function() {
                return this._Max[1]
            },
            set: function(e) {
                this._Max[1] !== e && (this._Max[1] = e,
                this.markDirty())
            }
        }, {
            key: "scaleX",
            get: function() {
                return this._Scale[0]
            },
            set: function(e) {
                this._Scale[0] !== e && (this._Scale[0] = e,
                this.markDirty())
            }
        }, {
            key: "scaleY",
            get: function() {
                return this._Scale[1]
            },
            set: function(e) {
                this._Scale[1] !== e && (this._Scale[1] = e,
                this.markDirty())
            }
        }], [{
            key: "constraintName",
            get: function() {
                return "Translation"
            }
        }, {
            key: "targetName",
            get: function() {
                return "Translation Source"
            }
        }]),
        t
    }(o.default);
    t.default = u
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = a(n(1104))
      , o = a(n(1105));
    function a(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var s = function() {
        function e(t, n, i, r, o) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e),
            this._Group = t,
            this._Animation = n,
            this._List = i,
            this._Time = r,
            this._Type = i.forceHold ? e.Type.Hold : e.Type.Linear,
            this._Value = o,
            this._Dirty = true,
            this._InFactor = 0,
            this._InValue = o,
            this._OutFactor = 0,
            this._OutValue = o,
            this._Bezier = null,
            this.refId = e.ID++
        }
        return i(e, [{
            key: "remove",
            value: function() {
                this._List.remove(this),
                this._Animation.onKeyFrameDeleted(this)
            }
        }, {
            key: "constrainToIn",
            value: function(t, n) {
                if (this.nxt && this.prv)
                    switch (this._Type) {
                    case e.Type.Mirrored:
                        this.outValue = this._Value + (this._Value - this._InValue);
                        var i = this._Time + (this._Time - this.inTime);
                        this.outTime = i,
                        this.outTime != i && (this.inTime = this._Time + (this._Time - this.outTime));
                        break;
                    case e.Type.Asymmetric:
                        var r = this.graphValue
                          , o = (this.inTime - this._Time) / t
                          , a = (this.inGraphValue - r) / n
                          , s = Math.sqrt(o * o + a * a);
                        o /= s,
                        a /= s;
                        var l = (this.outTime - this._Time) / t
                          , u = (this.outGraphValue - r) / n
                          , c = Math.sqrt(l * l + u * u);
                        this.outTime = this._Time - o * c * t,
                        this.outGraphValue = r - a * c * n
                    }
            }
        }, {
            key: "constrainToOut",
            value: function(t, n) {
                if (this.nxt && this.prv)
                    switch (this._Type) {
                    case e.Type.Mirrored:
                        this.inValue = this._Value + (this._Value - this._OutValue);
                        var i = this._Time + (this._Time - this.outTime);
                        this.inTime = i,
                        this.inTime != i && (this.outTime = this._Time + (this._Time - this.inTime));
                        break;
                    case e.Type.Asymmetric:
                        var r = this.graphValue
                          , o = (this.outTime - this._Time) / t
                          , a = (this.outGraphValue - r) / n
                          , s = Math.sqrt(o * o + a * a);
                        o /= s,
                        a /= s;
                        var l = (this.inTime - this._Time) / t
                          , u = (this.inGraphValue - r) / n
                          , c = Math.sqrt(l * l + u * u);
                        this.inTime = this._Time - o * c * t,
                        this.inGraphValue = r - a * c * n
                    }
            }
        }, {
            key: "setFullFrameTime",
            value: function(e, t, n) {
                var i = this._Animation;
                this._List.canGraph || (t = false,
                n = false);
                var r = Math.round(e * i.fps) / i.fps;
                if (this._Time != r) {
                    var o = this._Time
                      , a = this.inTime
                      , s = this.outTime
                      , l = t && this.prv && this.prv.outTime
                      , u = n && this.nxt && this.nxt.inTime;
                    if (this.time = r,
                    t) {
                        var c = o - a;
                        if (0 !== c) {
                            var d = (this._InValue - this._Value) / c;
                            this.inValue = d * (r - this.inTime) + this._Value
                        }
                        var h = this.prv;
                        if (0 !== (c = l - h._Time)) {
                            var f = (h._OutValue - h._Value) / c;
                            h.outValue = f * (h.outTime - h._Time) + h._Value
                        }
                    }
                    if (n) {
                        var p = s - o;
                        if (0 !== p) {
                            var y = (this._OutValue - this._Value) / p;
                            this.outValue = y * (this.outTime - r) + this._Value
                        }
                        var m = this.nxt;
                        if (0 !== (p = m._Time - u)) {
                            var v = (m._InValue - m._Value) / p;
                            m.inValue = v * (m._Time - m.inTime) + m._Value
                        }
                    }
                }
            }
        }, {
            key: "updateInterpolationCurve",
            value: function() {
                var t = this.nxt
                  , n = this._Type
                  , i = e.Type;
                !t || n === i.Linear && t._Type === i.Linear || n === i.Hold ? delete this._Curve : this._Curve = new r.default([this._Time, this._Value],[this.outTime, this._OutValue],[t.inTime, t._InValue],[t._Time, t._Value])
            }
        }, {
            key: "interpolate",
            value: function(e) {
                this._Dirty && (this.updateInterpolationCurve(),
                this._Dirty = false);
                var t = this.nxt;
                if (0 === this._Type)
                    return this._Value;
                if (!this._Curve) {
                    var n = (e - this._Time) / (t._Time - this._Time);
                    return this._Value * (1 - n) + t._Value * n
                }
                var i = this._Curve.get(e);
                return Number.isNaN(i) && console.log(this._Time, e, t._Time),
                i
            }
        }, {
            key: "row",
            get: function() {
                return this._List
            }
        }, {
            key: "time",
            get: function() {
                return this._Time
            },
            set: function(e) {
                this._Time != e && (this._Animation.onKeyFramePropChanged(this, "Time", this._Time, e, true),
                this._Time = e,
                this._Dirty = true,
                this.prv && (this.prv._Dirty = true))
            }
        }, {
            key: "value",
            get: function() {
                return (0,
                o.default)(this._Value)
            },
            set: function(t) {
                if (null !== t && (this._Value != t || null != t && t.constructor === Object)) {
                    if (!t || t.constructor !== Object && t.constructor !== Float32Array)
                        if (this._Type === e.Type.Linear)
                            this.inValue = t,
                            this.outValue = t;
                        else {
                            var n = t - this._Value;
                            this.inValue += n,
                            this.outValue += n
                        }
                    else
                        ;this._Animation.onKeyFramePropChanged(this, "Value", this._Value, t),
                    this._Value = t,
                    this._Dirty = true,
                    this.prv && (this.prv._Dirty = true)
                }
            }
        }, {
            key: "graphValueBounds",
            get: function() {
                if (this._Dirty && (this.updateInterpolationCurve(),
                this._Dirty = false),
                this._Curve) {
                    var e = this._Curve.getBounds();
                    return [this._List.getGraphValue(e[0]), this._List.getGraphValue(e[1])]
                }
                var t = this._List.getGraphValue(this._Value);
                return [t, t]
            }
        }, {
            key: "graphValue",
            get: function() {
                return this._List.getGraphValue(this._Value)
            },
            set: function(e) {
                this.value = this._List.setGraphValue(e)
            }
        }, {
            key: "type",
            get: function() {
                return this._Type
            },
            set: function(t) {
                if (this._List.forceHold && t !== e.Type.Hold && (console.warn("Attempted to set a hold only keyframe to a non hold interpolation"),
                t = e.Type.Hold),
                this._Type != t) {
                    switch (t) {
                    case e.Type.Hold:
                        this._Type === e.Type.Linear && (this.inFactor = .1,
                        this.inValue = this._Value);
                        break;
                    case e.Type.Linear:
                        this.inFactor = 0,
                        this.inValue = this._Value,
                        this.outFactor = 0,
                        this.outValue = this._Value;
                        break;
                    case e.Type.Disconnected:
                        this._Type !== e.Type.Linear && this._Type !== e.Type.Hold || (this.inFactor = .1,
                        this.inValue = this._Value,
                        this.outFactor = .1,
                        this.outValue = this._Value);
                        break;
                    case e.Type.Mirrored:
                    case e.Type.Asymmetric:
                        this._Type !== e.Type.Linear && this._Type !== e.Type.Hold || (this.inFactor = .1,
                        this.inValue = this._Value,
                        this.outFactor = .1,
                        this.outValue = this._Value)
                    }
                    this._Animation.onKeyFramePropChanged(this, "Type", this._Type, t),
                    this._Type = t,
                    this._Dirty = true,
                    this.prv && (this.prv._Dirty = true)
                }
            }
        }, {
            key: "inFactor",
            get: function() {
                return this._InFactor
            },
            set: function(e) {
                this._InFactor != e && (this._Animation.onKeyFramePropChanged(this, "InFactor", this._InFactor, e),
                this._InFactor = e,
                this._Dirty = true,
                this.prv && (this.prv._Dirty = true))
            }
        }, {
            key: "clampedInFactor",
            get: function() {
                return Math.max(u, Math.min(l, this._InFactor))
            }
        }, {
            key: "clampedOutFactor",
            get: function() {
                return Math.max(u, Math.min(l, this._OutFactor))
            }
        }, {
            key: "inTime",
            get: function() {
                return this.prv ? this._Time - (this._Time - this.prv._Time) * Math.max(u, Math.min(l, this._InFactor)) : this._Time
            },
            set: function(e) {
                this.prv && (this.inFactor = Math.max(0, Math.min(1, (e - this._Time) / -(this._Time - this.prv._Time))))
            }
        }, {
            key: "outTime",
            get: function() {
                return this.nxt ? this._Time + (this.nxt._Time - this._Time) * Math.max(u, Math.min(l, this._OutFactor)) : this._Time
            },
            set: function(e) {
                this.nxt && (this.outFactor = Math.max(0, Math.min(1, (e - this._Time) / (this.nxt._Time - this._Time))))
            }
        }, {
            key: "inGraphValue",
            get: function() {
                return this._List.getGraphValue(this._InValue)
            },
            set: function(e) {
                this.inValue = this._List.setGraphValue(e)
            }
        }, {
            key: "inValue",
            get: function() {
                return this._InValue
            },
            set: function(e) {
                if (this._InValue != e) {
                    if (isNaN(e)) {
                        var t = new Error;
                        console.log(t.stack)
                    }
                    this._Animation.onKeyFramePropChanged(this, "InValue", this._InValue, e),
                    this._Animation.onKeyFramePropChanged(this, "InFactor", this._InFactor, this._InFactor),
                    this._InValue = e,
                    this._Dirty = true,
                    this.prv && (this.prv._Dirty = true)
                }
            }
        }, {
            key: "outFactor",
            get: function() {
                return this._OutFactor
            },
            set: function(e) {
                this._OutFactor != e && (this._Animation.onKeyFramePropChanged(this, "OutFactor", this._OutFactor, e),
                this._OutFactor = e,
                this._Dirty = true,
                this.prv && (this.prv._Dirty = true))
            }
        }, {
            key: "outGraphValue",
            get: function() {
                return this._List.getGraphValue(this._OutValue)
            },
            set: function(e) {
                this.outValue = this._List.setGraphValue(e)
            }
        }, {
            key: "outValue",
            get: function() {
                return this._OutValue
            },
            set: function(e) {
                if (this._OutValue != e) {
                    if (isNaN(e)) {
                        var t = new Error;
                        console.log(t.stack)
                    }
                    this._Animation.onKeyFramePropChanged(this, "OutValue", this._OutValue, e),
                    this._Animation.onKeyFramePropChanged(this, "OutFactor", this._OutFactor, this._OutFactor),
                    this._OutValue = e,
                    this._Dirty = true,
                    this.prv && (this.prv._Dirty = true)
                }
            }
        }, {
            key: "hasHandles",
            get: function() {
                var t = this._Type
                  , n = e.Type;
                return t === n.Mirrored || t === n.Asymmetric || t === n.Disconnected || t === n.Hold && this.prv && (this.prv._Type === n.Mirrored || this.prv._Type === n.Asymmetric || this.prv._Type === n.Disconnected)
            }
        }]),
        e
    }();
    t.default = s,
    s.ID = 0,
    s.Type = {
        Hold: 0,
        Linear: 1,
        Mirrored: 2,
        Asymmetric: 3,
        Disconnected: 4,
        Progression: 5
    };
    var l = .99999
      , u = 1 - l
}
, function(e, t, n) {
    var i = n(1122);
    "string" == typeof i && (i = [[e.i, i, ""]]);
    var r = {
        insertAt: "top",
        hmr: true,
        transform: void 0
    };
    n(8)(i, r);
    i.locals && (e.exports = i.locals)
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = n(716), a = (i = o) && i.__esModule ? i : {
        default: i
    };
    var s = new Map
      , l = function() {
        function e(t) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e),
            e._Idx++,
            e._Stack.push(this),
            this._Idx = e._Idx,
            this._Priority = 1,
            this.set(t)
        }
        return r(e, [{
            key: "set",
            value: function(t, n) {
                this._Type = t,
                this._Priority = n || 1,
                e._Stack = a.default.sortBy(e._Stack, (function(e) {
                    return e._Idx
                }
                )),
                e._Stack = a.default.sortBy(e._Stack, (function(e) {
                    return e._Priority
                }
                )),
                e.updateCursor()
            }
        }, {
            key: "remove",
            value: function() {
                var t = e._Stack.indexOf(this);
                -1 !== t && e._Stack.splice(t, 1),
                e.updateCursor()
            }
        }], [{
            key: "updateCursor",
            value: function() {
                for (var t = e._Stack.length - 1; t >= 0; t--) {
                    var n = e._Stack[t];
                    return void (document.body.style.cursor = n._Type)
                }
                document.body.style.cursor = ""
            }
        }, {
            key: "set",
            value: function(t, n, i) {
                var r = s.get(t);
                r || (r = new e,
                s.set(t, r)),
                r.set(n, i)
            }
        }, {
            key: "remove",
            value: function(e) {
                var t = s.get(e);
                t && (t.remove(),
                s.delete(e))
            }
        }]),
        e
    }();
    t.default = l,
    l._Stack = [],
    l._Idx = 0
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }, a = n(382), s = (i = a) && i.__esModule ? i : {
        default: i
    };
    var l = function(e) {
        function t(e, n) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var i = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return i._LayeredAsset = n,
            i._Left = 0,
            i._Top = 0,
            i._Width = 0,
            i._Height = 0,
            i
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "read",
            value: function(e, n, i) {
                o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "read", this).call(this, e, n, i),
                this._Width = n.width,
                this._Height = n.height,
                this._Left = n.left,
                this._Top = n.top
            }
        }, {
            key: "serialize",
            value: function() {
                var e = o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serialize", this).call(this);
                return e.width = this._Width,
                e.height = this._Height,
                e.left = this._Left,
                e.top = this._Top,
                e
            }
        }, {
            key: "serializeInteractive",
            value: function() {
                var e = o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "serializeInteractive", this).call(this);
                return e.width = this._Width,
                e.height = this._Height,
                e.left = this._Left,
                e.top = this._Top,
                e
            }
        }, {
            key: "canBeReplacedBy",
            value: function(e) {
                switch (e.constructor) {
                case s.default:
                case t:
                    return true
                }
                return false
            }
        }, {
            key: "left",
            get: function() {
                return this._Left
            }
        }, {
            key: "top",
            get: function() {
                return this._Top
            }
        }], [{
            key: "dataType",
            get: function() {
                return "image/layer"
            }
        }]),
        t
    }(s.default);
    t.default = l
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = u(n(0)), a = u(n(4)), s = u(n(1)), l = u(n(603));
    function u(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function c(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var d = (c((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                active: false,
                hover: false
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "setResizeGrabber",
            value: function(e) {
                this.resizeGrabber = e
            }
        }, {
            key: "click",
            value: function(e) {
                this.props.onMouseDown && this.props.onMouseDown(e),
                l.default.set(this, this.props.isHorizontal ? "ns-resize" : "ew-resize"),
                this.setState({
                    active: true
                }),
                window.addEventListener("mouseup", this.release, true),
                this.context.nima.isDragging = true
            }
        }, {
            key: "release",
            value: function() {
                this.setState({
                    active: false
                }),
                window.removeEventListener("mouseup", this.release, true),
                this.context.nima.isDragging = false,
                l.default.remove(this)
            }
        }, {
            key: "enter",
            value: function() {
                var e = this;
                clearTimeout(this.timeout),
                l.default.set(this, this.props.isHorizontal ? "ns-resize" : "ew-resize"),
                this.timeout = setTimeout((function() {
                    e.setState({
                        hover: true
                    })
                }
                ), 300)
            }
        }, {
            key: "leave",
            value: function() {
                clearTimeout(this.timeout),
                l.default.remove(this),
                this.setState({
                    hover: false
                })
            }
        }, {
            key: "setLeft",
            value: function(e) {
                this.resizeGrabber.style.left = e + "px"
            }
        }, {
            key: "setBottom",
            value: function(e) {
                this.resizeGrabber.style.bottom = e + "px"
            }
        }, {
            key: "hide",
            value: function(e) {
                this.resizeGrabber.style.display = e ? "none" : null
            }
        }, {
            key: "render",
            value: function() {
                return o.default.createElement("div", {
                    ref: this.setResizeGrabber,
                    className: "resizeGrabber" + (this.props.isHorizontal ? " horizontalResizeGrabber" : "") + (this.state.active || this.state.hover ? " resizeGrabberActive" : "") + (this.props.addClass ? " " + this.props.addClass : ""),
                    onMouseDown: this.click,
                    onMouseEnter: this.enter,
                    onMouseLeave: this.leave
                })
            }
        }]),
        t
    }(o.default.Component)).prototype, "setResizeGrabber", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setResizeGrabber"), i.prototype),
    c(i.prototype, "click", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "click"), i.prototype),
    c(i.prototype, "release", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "release"), i.prototype),
    c(i.prototype, "enter", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "enter"), i.prototype),
    c(i.prototype, "leave", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "leave"), i.prototype),
    i);
    t.default = d,
    d.contextTypes = {
        nima: a.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = n(313);
    var a = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n._LastToolType = null,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "enable",
            value: function() {
                this._LastToolType = this.stage.toolType,
                function e(t, n, i) {
                    null === t && (t = Function.prototype);
                    var r = Object.getOwnPropertyDescriptor(t, n);
                    if (void 0 === r) {
                        var o = Object.getPrototypeOf(t);
                        return null === o ? void 0 : e(o, n, i)
                    }
                    if ("value"in r)
                        return r.value;
                    var a = r.get;
                    return void 0 !== a ? a.call(i) : void 0
                }(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "enable", this).call(this)
            }
        }, {
            key: "close",
            value: function() {
                this.stage.tool instanceof t && (this.stage.toolType = this._LastToolType)
            }
        }]),
        t
    }(((i = o) && i.__esModule ? i : {
        default: i
    }).default);
    t.default = a
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = c(n(0)), a = c(n(1)), s = c(n(4)), l = c(n(471)), u = c(n(3));
    function c(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function d(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var h = (d((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {},
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "itemUpdate",
            value: function() {
                this.forceUpdate()
            }
        }, {
            key: "setItem",
            value: function(e) {
                this.item !== e && (this.item && (this.item.removeEventListener("update", this.itemUpdate),
                this.item.removeEventListener("keyState", this.itemUpdate)),
                this.item = e,
                e && (e.addEventListener("update", this.itemUpdate),
                e.addEventListener("keyState", this.itemUpdate)))
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.item != this.props.item && this.setItem(e.item)
            }
        }, {
            key: "componentWillMount",
            value: function() {
                this.setItem(this.props.item)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setItem(null)
            }
        }, {
            key: "commitEdit",
            value: function() {
                var e = this.context
                  , t = this.inputText;
                if (t) {
                    var n = e.nima
                      , i = new l.default(n.stage,n.actor,this.props.item,t.value);
                    i.start(),
                    i.end(),
                    this.endEdit(false)
                }
            }
        }, {
            key: "endEdit",
            value: function(e) {
                this.setState({
                    editing: false
                }),
                this.inputText && this.inputText.removeEventListener("blur", this.commitEdit),
                clearTimeout(this.editTimeout)
            }
        }, {
            key: "cancelEdit",
            value: function() {
                this.endEdit(true)
            }
        }, {
            key: "startEdit",
            value: function() {
                this.setState({
                    editing: true,
                    editName: this.props.item.name
                });
                var e = this;
                clearTimeout(this.editTimeout),
                this.editTimeout = setTimeout((function() {
                    e.inputText.focus(),
                    e.inputText.setSelectionRange(0, e.inputText.value.length),
                    e.inputText.addEventListener("blur", e.commitEdit)
                }
                ), 0)
            }
        }, {
            key: "editKeyDown",
            value: function(e) {
                switch (e.keyCode) {
                case 13:
                    this.inputText.blur();
                    break;
                case 27:
                    this.cancelEdit(),
                    this.inputText.blur()
                }
            }
        }, {
            key: "editTextChange",
            value: function(e) {
                this.setState({
                    editName: e.target.value
                })
            }
        }, {
            key: "select",
            value: function() {
                this.item && this.context.nima.stage.selectItem(this.item.stageItem)
            }
        }, {
            key: "textMouseDown",
            value: function(e) {
                e.stopPropagation(),
                clearTimeout(this.selectTimeout);
                var t = Date.now();
                this.lastMouseDown && t - this.lastMouseDown < 200 ? this.startEdit() : this.selectTimeout = setTimeout(this.select, 230),
                this.lastMouseDown = t
            }
        }, {
            key: "deleteItem",
            value: function(e) {
                e.stopPropagation(),
                this.props.onDelete && this.props.onDelete(this.props.item)
            }
        }, {
            key: "setKey",
            value: function(e) {
                e.stopPropagation(),
                this.props.setKey && this.props.setKey(this.props.item)
            }
        }, {
            key: "setInputText",
            value: function(e) {
                this.inputText = e
            }
        }, {
            key: "render",
            value: function() {
                var e, t = this.props.isAnimating, n = this.props.item;
                switch (this.keyState) {
                case 0:
                    e = "SelectionPanelKey";
                    break;
                case 1:
                    e = "SelectionPanelKeyChanged";
                    break;
                case 2:
                    e = "SelectionPanelKeyed"
                }
                return o.default.createElement("div", {
                    className: t ? "MeshBoneRow MeshBoneRowAnim" : "MeshBoneRow",
                    onClick: this.select
                }, o.default.createElement("svg", {
                    className: "TimelineIcon TimelineEventIcon"
                }, o.default.createElement("use", {
                    xlinkHref: u.default.make("/images/symbol-defs.svg#" + n.uiIcon)
                })), this.state.editing ? o.default.createElement("input", {
                    type: "text",
                    ref: this.setInputText,
                    value: this.state.editName,
                    onKeyDown: this.editKeyDown,
                    onChange: this.editTextChange
                }) : o.default.createElement("div", {
                    className: "MeshBone",
                    onClick: this.textMouseDown
                }, n.name), o.default.createElement("svg", {
                    className: "DeleteRow",
                    style: {
                        display: t ? "none" : null
                    },
                    onClick: this.deleteItem
                }, o.default.createElement("use", {
                    xlinkHref: u.default.make("/images/symbol-defs.svg#icon-delete")
                })), this.props.setKey ? o.default.createElement("div", {
                    className: e,
                    style: {
                        display: t ? null : "none"
                    },
                    onClick: this.setKey
                }, o.default.createElement("div", null)) : null)
            }
        }, {
            key: "keyState",
            get: function() {
                return 0
            }
        }]),
        t
    }(o.default.Component)).prototype, "itemUpdate", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "itemUpdate"), i.prototype),
    d(i.prototype, "commitEdit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "commitEdit"), i.prototype),
    d(i.prototype, "endEdit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "endEdit"), i.prototype),
    d(i.prototype, "cancelEdit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "cancelEdit"), i.prototype),
    d(i.prototype, "startEdit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "startEdit"), i.prototype),
    d(i.prototype, "editKeyDown", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "editKeyDown"), i.prototype),
    d(i.prototype, "editTextChange", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "editTextChange"), i.prototype),
    d(i.prototype, "select", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "select"), i.prototype),
    d(i.prototype, "textMouseDown", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "textMouseDown"), i.prototype),
    d(i.prototype, "deleteItem", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "deleteItem"), i.prototype),
    d(i.prototype, "setKey", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setKey"), i.prototype),
    d(i.prototype, "setInputText", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setInputText"), i.prototype),
    i);
    t.default = h,
    h.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = l(n(203)), a = l(n(1)), s = n(2);
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var u, c, d, h, f, p, y = [1, 1, 1, .3], m = [198 / 255, 198 / 255, 198 / 255, .1], v = (i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n._ActorImage = e,
            n.isSelectable = false,
            n.hitDetectOnMesh = false,
            n._Mesh = null,
            n._UseImageWorld = false,
            n.updateTransform(),
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "customHitDetect",
            value: function(e, t) {
                return true
            }
        }, {
            key: "updateTransform",
            value: function() {
                this.renderTransform = this._UseImageWorld ? this._ActorImage.worldTransform : s.mat2d.create()
            }
        }, {
            key: "onAddedStage",
            value: function(e) {
                this._ActorImage.addEventListener("worldTransform", this.updateTransform)
            }
        }, {
            key: "onRemovedFromStage",
            value: function(e) {
                this._ActorImage.removeEventListener("worldTransform", this.updateTransform)
            }
        }, {
            key: "setMesh",
            value: function(e, t, n, i) {
                this._Mesh = this.stage.graphics.makeWireframe(e, t, 2, n, 0),
                this.stage.redraw(),
                this._UseImageWorld = i,
                this.updateTransform()
            }
        }, {
            key: "draw",
            value: function(e, t) {
                var n = this._Mesh;
                n && e.drawWireframe(this.renderViewTransform, n, 1, y, m)
            }
        }, {
            key: "drawSelection",
            value: function(e, t) {}
        }]),
        t
    }(o.default),
    u = i.prototype,
    c = "updateTransform",
    d = [a.default],
    h = Object.getOwnPropertyDescriptor(i.prototype, "updateTransform"),
    f = i.prototype,
    p = {},
    Object.keys(h).forEach((function(e) {
        p[e] = h[e]
    }
    )),
    p.enumerable = !!p.enumerable,
    p.configurable = !!p.configurable,
    ("value"in p || p.initializer) && (p.writable = true),
    p = d.slice().reverse().reduce((function(e, t) {
        return t(u, c, e) || e
    }
    ), p),
    f && void 0 !== p.initializer && (p.value = p.initializer ? p.initializer.call(f) : void 0,
    p.initializer = void 0),
    void 0 === p.initializer && (Object.defineProperty(u, c, p),
    p = null),
    i);
    t.default = v
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = n(203), a = (i = o) && i.__esModule ? i : {
        default: i
    }, s = n(2);
    var l = [1, 91 / 255, 91 / 255, 1]
      , u = [351 / 255, 60 / 255, 100 / 255, 1]
      , c = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.isVisible = false,
            n.isFake = true,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "updateHighlights",
            value: function(e) {
                var t = this.node;
                e.highlight(this);
                var n = t.influencedBones;
                if (n) {
                    var i = true
                      , r = false
                      , o = void 0;
                    try {
                        for (var a, s = n[Symbol.iterator](); !(i = (a = s.next()).done); i = true) {
                            var l = a.value;
                            e.highlight(l.stageItem)
                        }
                    } catch (e) {
                        r = true,
                        o = e
                    } finally {
                        try {
                            !i && s.return && s.return()
                        } finally {
                            if (r)
                                throw o
                        }
                    }
                }
            }
        }, {
            key: "draw",
            value: function(e, t, n) {
                var i = this.node;
                if (i && i.isEnabled && 1 !== i.strength) {
                    var r = i.solver;
                    if (r) {
                        for (var o = r._FKChain, a = [], c = [], d = null, f = null, p = 0; p < o.length; p++) {
                            var y = o[p]
                              , m = y.transformComponents[4]
                              , v = y.ikAngle;
                            f = h(f, y, m),
                            a.push(s.mat2d.getTranslation(s.vec2.create(), f)),
                            d = h(d, y, v),
                            c.push(s.mat2d.getTranslation(s.vec2.create(), d)),
                            p === o.length - 1 && (s.mat2d.mul(f, f, s.mat2d.fromTranslation(s.mat2d.create(), [y.bone.length, 0])),
                            a.push(s.mat2d.getTranslation(s.vec2.create(), f)),
                            s.mat2d.mul(d, d, s.mat2d.fromTranslation(s.mat2d.create(), [y.bone.length, 0])),
                            c.push(s.mat2d.getTranslation(s.vec2.create(), d)))
                        }
                        e.drawThickLine(this.stage.viewTransform, e.makeThickLine(a, false), .5 / this.stage.scale * this.stage.screenScale, .5, u),
                        e.drawThickLine(this.stage.viewTransform, e.makeThickLine(c, false), .5 / this.stage.scale * this.stage.screenScale, .5, l)
                    }
                }
            }
        }, {
            key: "highlight",
            get: function() {
                return this.isVisible
            },
            set: function(e) {
                this.isVisible = e
            }
        }]),
        t
    }(a.default);
    t.default = c;
    var d = s.mat2d.create();
    function h(e, t, n, i) {
        var r = e || t.bone.parent.worldTransform
          , o = t.transformComponents;
        0 === n ? s.mat2d.identity(d) : s.mat2d.fromRotation(d, n),
        d[4] = o[0],
        d[5] = o[1],
        void 0 !== i && (d[4] += i);
        var a = o[2]
          , l = o[3];
        d[0] *= a,
        d[1] *= a,
        d[2] *= l,
        d[3] *= l;
        var u = o[5];
        return 0 !== u && (d[2] = d[0] * u + d[2],
        d[3] = d[1] * u + d[3]),
        null === e && (e = s.mat2d.clone(d)),
        s.mat2d.mul(e, r, d),
        e
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = n(203), a = (i = o) && i.__esModule ? i : {
        default: i
    };
    var s = [1, 91 / 255, 91 / 255, 1]
      , l = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.isVisible = false,
            n.isFake = true,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "updateHighlights",
            value: function(e) {
                this.node;
                e.highlight(this)
            }
        }, {
            key: "draw",
            value: function(e, t, n) {
                var i = this.node;
                if (i && i.isEnabled) {
                    if (this.radius !== i.distance) {
                        this.radius = i.distance;
                        var r = i.distance;
                        this.radius = r;
                        for (var o = Math.ceil(Math.min(100, Math.max(20, 2 * Math.PI * r / 10))), a = 2 * Math.PI / o, l = 0, u = [], c = 0; c < o; c++) {
                            var d = Math.cos(l) * r
                              , h = Math.sin(l) * r;
                            u.push([d, h]),
                            l += a
                        }
                        this.line = e.makeThickLine(u, true)
                    }
                    this.renderTransform = i.target ? i.target.worldTransform : i.parent.worldTransform,
                    e.drawThickLine(this.renderViewTransform, this.line, .5 / this.stage.scale * this.stage.screenScale, 1, s)
                }
            }
        }, {
            key: "highlight",
            get: function() {
                return this.isVisible
            },
            set: function(e) {
                this.isVisible = e,
                function e(t, n, i, r) {
                    var o = Object.getOwnPropertyDescriptor(t, n);
                    if (void 0 === o) {
                        var a = Object.getPrototypeOf(t);
                        null !== a && e(a, n, i, r)
                    } else if ("value"in o && o.writable)
                        o.value = i;
                    else {
                        var s = o.set;
                        void 0 !== s && s.call(r, i)
                    }
                    return i
                }(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "highlight", e, this)
            }
        }]),
        t
    }(a.default);
    t.default = l
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = s(n(203))
      , o = s(n(357))
      , a = n(2);
    function s(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var l = [1, 91 / 255, 91 / 255, 1]
      , u = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.isVisible = false,
            n.isFake = true,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "updateHighlights",
            value: function(e) {
                this.node;
                e.highlight(this)
            }
        }, {
            key: "draw",
            value: function(e, t, n) {
                var i = this.node;
                if (i && i.isEnabled && (i.enableMinX || i.enableMaxX || i.enableMinY || i.enableMinY)) {
                    var r = 340282.3
                      , s = i.enableMinX ? i.minX : -r
                      , u = i.enableMinY ? i.minY : -r
                      , c = i.enableMaxX ? i.maxX : r
                      , d = i.enableMaxY ? i.maxY : r
                      , h = [[s, u], [s, d], [c, d], [c, u]]
                      , f = e.makeThickLine(h, true)
                      , p = i.parent;
                    p && (p = p.parent),
                    this.renderTransform = i.minMaxSpace === o.default.Local && p ? p.worldTransform : a.mat2d.create(),
                    e.drawThickLine(this.renderViewTransform, f, .5 / this.stage.scale * this.stage.screenScale, 1, l)
                }
            }
        }, {
            key: "highlight",
            get: function() {
                return this.isVisible
            },
            set: function(e) {
                this.isVisible = e,
                function e(t, n, i, r) {
                    var o = Object.getOwnPropertyDescriptor(t, n);
                    if (void 0 === o) {
                        var a = Object.getPrototypeOf(t);
                        null !== a && e(a, n, i, r)
                    } else if ("value"in o && o.writable)
                        o.value = i;
                    else {
                        var s = o.set;
                        void 0 !== s && s.call(r, i)
                    }
                    return i
                }(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "highlight", e, this)
            }
        }]),
        t
    }(r.default);
    t.default = u
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }
      , o = c(n(313))
      , a = c(n(201))
      , s = c(n(726))
      , l = c(n(9))
      , u = c(n(410));
    function c(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var d = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n._Brush = new s.default,
            n._SuppressDragOperation = false,
            n._WasBoneSelectionDisabled = false,
            n._SelectedBoneIndex = 0,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "marqueeStarted",
            value: function() {
                this._Brush.marqueeStarted()
            }
        }, {
            key: "blockMarquee",
            value: function(e) {
                return !l.default.isMultiSelect(e) && !e.shiftKey && !e.altKey && this._Brush.hasSelection
            }
        }, {
            key: "setSelectedVertexWeight",
            value: function(e, t) {
                var n = this.stage.appContext.editingWeights;
                n && n.setWeight(t, e, this._Brush.selectedVertices)
            }
        }, {
            key: "cancel",
            value: function() {}
        }, {
            key: "validate",
            value: function() {
                return !!this.stage.appContext.editingWeights
            }
        }, {
            key: "enable",
            value: function() {
                this._PaintWeightTool = this.stage.findTool(u.default),
                this._Brush.addToStage(this.stage),
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "enable", this).call(this);
                var e = this.stage.getLayerOptions(a.default);
                this._WasBoneSelectionDisabled = e.disableSelection,
                e.disableSelection = true,
                this.stage.setLayerOptions(a.default, e);
                var n = this.stage.appContext.editingWeights;
                n && (this._SelectedBoneIndex %= n.node.connectedBones.length)
            }
        }, {
            key: "disable",
            value: function() {
                this._Brush.removeFromStage(this.stage),
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "disable", this).call(this),
                this.cancel();
                var e = this.stage.getLayerOptions(a.default);
                e.disableSelection = this._WasBoneSelectionDisabled,
                this.stage.setLayerOptions(a.default, e)
            }
        }, {
            key: "updateSelection",
            value: function(e, t) {
                t && (this._Brush.marquee(t),
                this.dispatch("selectionChanged"))
            }
        }, {
            key: "clearSelections",
            value: function() {
                this._Brush.clearSelections(),
                self.stage.redraw(),
                this.dispatch("selectionChanged")
            }
        }, {
            key: "advanceDrag",
            value: function(e, n, i, o) {
                var a = this.stage.appContext.editingWeights;
                if (!this.stage.isDraggingMarquee && a) {
                    if (this._Brush.hasSelection) {
                        var s = n[1] / 200
                          , l = this._Brush.selectedVertices;
                        new Array(l.length).fill(1);
                        var u = this._Brush.selectedVertices
                          , c = this._PaintWeightTool._SelectedBoneIndex
                          , d = true
                          , h = false
                          , f = void 0;
                        try {
                            for (var p, y = u[Symbol.iterator](); !(d = (p = y.next()).done); d = true) {
                                var m = p.value
                                  , v = a.getWeight(c, m);
                                a.setWeight(c, v + s, [m], true)
                            }
                        } catch (e) {
                            h = true,
                            f = e
                        } finally {
                            try {
                                !d && y.return && y.return()
                            } finally {
                                if (h)
                                    throw f
                            }
                        }
                        a.commitSetWeight()
                    }
                    r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "advanceDrag", this).call(this, e, n, i, o)
                }
            }
        }, {
            key: "mouseMove",
            value: function(e, t, n) {
                if (!this.stage.isDraggingMarquee)
                    return this._Brush.position = n,
                    true
            }
        }, {
            key: "release",
            value: function(e, n, i) {
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "release", this).call(this, e, n),
                n || (this._Brush.selectHover(i),
                this.dispatch("selectionChanged"))
            }
        }, {
            key: "click",
            value: function(e, t, n) {}
        }, {
            key: "doesCustomSelection",
            get: function() {
                return true
            }
        }, {
            key: "selectedWeights",
            get: function() {
                return this._Brush.selectedWeights
            }
        }, {
            key: "brush",
            get: function() {
                return this._Brush
            }
        }]),
        t
    }(o.default);
    t.default = d
}
, , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(),
    o = U(n(0)),
    a = U(n(23)),
    s = U(n(4)),
    l = U(n(691)), // Bowser - browser detection lib
    u = U(n(692)),
    c = U(n(417)),
    d = U(n(1111)),
    h = U(n(1)),
    f = U(n(1112)),
    p = U(n(1113)),
    y = U(n(1114)),
    m = U(n(470)),
    v = U(n(1115)),
    g = U(n(605)),
    _ = U(n(348)),
    b = U(n(472)),
    w = U(n(1163)),
    O = U(n(1164)),
    S = U(n(1178)),
    k = U(n(1188)),
    P = U(n(1194)),
    E = U(n(1195)),
    T = U(n(1196)),
    C = U(n(1201)),
    x = U(n(1204)),
    I = U(n(1208)),
    D = U(n(1209)),
    M = U(n(728)),
    A = U(n(447)),
    j = U(n(201)),
    L = U(n(243)),
    R = U(n(13)),
    F = U(n(551)),
    B = U(n(730)),
    V = U(n(165)),
    N = U(n(15)),
    z = U(n(702)),
    W = U(n(11)),
    H = U(n(1226));
    function U(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function K(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }

    var G = (
        K(
            (
                i = function(e) {

                    function t(e) {
                        !function(e, t) {
                            if (!(e instanceof t))
                                throw new TypeError("Cannot call a class as a function")
                        }(this, t);

                        var n = function(e, t) {
                            if (!e)
                                throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                            return !t || "object" != typeof t && "function" != typeof t ? e : t
                        }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));

                        window.editor = n;
                        var isBrowserUnsupported = true !== l.default.chrome && true !== l.default.firefox && true !== l.default.safari && true !== l.default.opera;
                        return n.listeningForMenuClose = false,
                        n.state = {
                            animationIsResizing: false,
                            contextMenus: [],
                            error: null,
                            exportOpen: false,
                            meshMode: false,
                            settingsOpen: false,
                            showBrowserWarning: isBrowserUnsupported,
                            showCrashError: false,
                            showExportToEngine: false,
                            showGuides: false,
                            siteMenuOpen: false,
                            isFilesModalOpen: false,
                            isFilesModalClosing: false,
                            isPropertiesModalOpen: false,
                            isPropertiesModalClosing: false
                        },
                        n
                    }

                    return function(e, t) {
                        if ("function" != typeof t && null !== t)
                            throw new TypeError("Super expression must either be null or a function, not " + typeof t);
                            
                        e.prototype = Object.create(t && t.prototype, {
                            constructor: {
                                value: e,
                                enumerable: false,
                                writable: true,
                                configurable: true
                            }
                        }),
                        t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
                    }(t, e),
                    r(
                        t,
                        [
                            {
                                key: "componentWillMount",
                                value: function() {
                                    this.ddid = 0,
                                    this.dropDownPopups = [],
                                    this.isMeshMode = false;
                                    try {
                                        var e = document.createElement("canvas");
                                        e.style.display = "none",
                                        e.className = "Stage",
                                        document.body.insertBefore(e, document.body.firstChild),
                                        this.nima = new D.default(e,this,this.props.user,this.props.preferences,this.props.buildNumber,this.props.file)
                                    } catch (e) {
                                        if (console.log("Nima boot error", e),
                                        e && e.constructor === M.default)
                                            return void (this.state.error = H.default.WebGLDisabled);
                                        var t = e && e.constructor && e.constructor.toString && e.constructor.toString() || "unknown";
                                        return W.default.warn("Nima failed to instance due to an unhandled error. Error constructor " + t),
                                        void (this.state.error = H.default.Unknown)
                                    }
                                    this.shortcuts = new u.default(this.nima),
                                    this.keyMap = new c.default(this.shortcuts.onAction,this.shortcuts.onActionReleased);
                                    var n = this;
                                    this.tooltip = {
                                        enter: function(e) {
                                            n.tooltipRef && n.tooltipRef.showFor(e)
                                        },
                                        leave: function(e) {
                                            n.tooltipRef && n.tooltipRef.hideFor(e)
                                        },
                                        click: function(e) {
                                            n.tooltipRef && n.tooltipRef.hideImmediatelyFor(e)
                                        }
                                    },
                                    true === l.default.mac ? this.keyMap.parse(d.default.OSX) : this.keyMap.parse(d.default.Windows),
                                    this.nima.stage.toolType = A.default;
                                    var i = this._Preferences = this.nima.getPreference("editor") || {};
                                    this._PreferencesTimeout = null,
                                    this.filePanelWidth = i.filePanelWidth || 300,
                                    this.selectionPanelWidth = i.selectionPanelWidth || 200,
                                    this.animationPanelHeight = i.animationPanelHeight || 260,
                                    window.location.hash && 0 === window.location.hash.indexOf("#files") && this.showFilesModal(window.location.hash && window.location.hash.toString())
                                }
                            }, {
                                key: "closeModal",
                                value: function() {
                                    var e = this.state
                                    , t = e.exportOpen
                                    , n = e.showExportToEngine
                                    , i = e.isFilesModalOpen
                                    , r = e.isPropertiesModalOpen;
                                    e.isShortcutsModalOpen;
                                    t ? this.leaveExportShot() : n ? this.toggleShowExportToEngine() : i ? this.closeFilesModal() : r && this.closePropertiesModal()
                                }
                            }, {
                                key: "toggleShortcutsModal",
                                value: function() {}
                            }, {
                                key: "showFilesModal",
                                value: function(e, t) {
                                    clearTimeout(this.closeFilesTimeout),
                                    this.setState({
                                        siteMenuOpen: false,
                                        chooseLocation: t || null,
                                        isFilesModalOpen: true,
                                        isFilesModalClosing: false,
                                        filesModalPath: e && e.constructor === String ? e : null
                                    })
                                }
                            }, {
                                key: "closeFilesModal",
                                value: function() {
                                    this.state.chooseLocation && this.state.chooseLocation(null),
                                    this.setState({
                                        isFilesModalOpen: false,
                                        isFilesModalClosing: true
                                    });
                                    var e = this;
                                    clearTimeout(this.closeFilesTimeout),
                                    this.closeFilesTimeout = setTimeout((function() {
                                        e.setState({
                                            isFilesModalClosing: false
                                        })
                                    }
                                    ), 300)
                                }
                            }, {
                                key: "showPropertiesModal",
                                value: function() {
                                    clearTimeout(this.closePropertiesTimeout),
                                    this.setState({
                                        isPropertiesModalOpen: true,
                                        isPropertiesModalClosing: false
                                    })
                                }
                            }, {
                                key: "closePropertiesModal",
                                value: function() {
                                    this.setState({
                                        isPropertiesModalOpen: false,
                                        isPropertiesModalClosing: true
                                    });
                                    var e = this;
                                    clearTimeout(this.closePropertiesTimeout),
                                    this.closePropertiesTimeout = setTimeout((function() {
                                        e.setState({
                                            isPropertiesModalClosing: false
                                        })
                                    }
                                    ), 300);
                                    var t = this.props.file;
                                    this.nima._ExpiredAlert && (t.isPublic || V.default.isPaid) && (this.nima._ExpiredAlert.hide(),
                                    this.nima._ExpiredAlert = null)
                                }
                            }, {
                                key: "setFilePanel",
                                value: function(e) {
                                    this.filePanel = e
                                }
                            }, {
                                key: "setFilePanelResizer",
                                value: function(e) {
                                    this.filePanelResizer = e
                                }
                            }, {
                                key: "componentDidMount",
                                value: function() {
                                    if (this.nima && (this.nima.addEventListener("ready", this.nimaReady),
                                    this.nima.addEventListener("keyDown", this.keyMap.onKeyDown),
                                    this.nima.addEventListener("keyUp", this.keyMap.onKeyUp),
                                    this.nima.addEventListener("fileRenamed", this.onFileRenamed),
                                    this.nima.stage.addEventListener("selectionChanged", this.debounceUpdateSelectionPanelItem),
                                    this.nima.addEventListener("selectionChanged", this.debounceUpdateSelectionPanelItem),
                                    this.nima.addEventListener("fileLoaded", this.fileLoaded),
                                    this.nima.addEventListener("editingAnimationChanged", this.editingAnimationChanged)),
                                    !this.state.error) {
                                        window.addEventListener("resize", this.windowResize),
                                        this.visibleStageResize(),
                                        this.filePanel.setAnimationMode(this.isAnimationOpen ? this.state.animation : null),
                                        this.resizePanels();
                                        var e = this.props
                                        , t = e.file;
                                        e.user.isPaid || t.isPublic ? t.showProperties && this.showPropertiesModal() : this.showPropertiesModal()
                                    }
                                }
                            }, {
                                key: "componentWillUnmount",
                                value: function() {
                                    window.removeEventListener("resize", this.windowResize),
                                    this.nima && (this.nima.removeEventListener("ready", this.nimaReady),
                                    this.nima.removeEventListener("keyDown", this.keyMap.onKeyDown),
                                    this.nima.removeEventListener("keyUp", this.keyMap.onKeyUp),
                                    this.nima.removeEventListener("fileRenamed", this.onFileRenamed),
                                    this.nima.stage.removeEventListener("selectionChanged", this.debounceUpdateSelectionPanelItem),
                                    this.nima.removeEventListener("selectionChanged", this.debounceUpdateSelectionPanelItem),
                                    this.nima.removeEventListener("fileLoaded", this.fileLoaded),
                                    this.nima.removeEventListener("editingAnimationChanged", this.editingAnimationChanged),
                                    this.nima.cleanup(),
                                    this.nima = null)
                                }
                            }, {
                                key: "savePreference",
                                value: function(e, t) {
                                    var n = this.nima
                                    , i = this._Preferences;
                                    i[e] = t,
                                    clearTimeout(this._PreferencesTimeout),
                                    this._PreferencesTimeout = setTimeout((function() {
                                        n.setCharacterPreference("editor", i)
                                    }
                                    ), 750)
                                }
                            }, {
                                key: "getStateForLog",
                                value: function() {
                                    return {
                                        exportOpen: this.state.exportOpen,
                                        animationIsResizing: this.state.animationIsResizing,
                                        settingsOpen: this.state.settingsOpen,
                                        siteMenuOpen: this.state.siteMenuOpen,
                                        isAnimationOpen: this.isAnimationOpen || false,
                                        isMeshMode: this.isMeshMode || false,
                                        stageRect: this.stageRect
                                    }
                                }
                            }, {
                                key: "setContextMenuItemData",
                                value: function(e) {
                                    this.contextMenuItemData = e
                                }
                            }, {
                                key: "clearContextMenuItemData",
                                value: function(e) {
                                    this.contextMenuItemData === e && (this.contextMenuItemData = null)
                                }
                            }, {
                                key: "removeContextMenus",
                                value: function(e) {
                                    e && (e.stopPropagation(),
                                    e.preventDefault());
                                    var t = false;
                                    return this.contextMenuItemData && (this.contextMenuItemData.select ? this.contextMenuItemData.select(this.contextMenuItemData) : t = true),
                                    t || (this.setState({
                                        contextMenus: []
                                    }),
                                    this.listenForContextMenuClose(false)),
                                    false
                                }
                            }, {
                                key: "listenForContextMenuClose",
                                value: function(e) {
                                    if (e) {
                                        if (this.listeningForMenuClose)
                                            return;
                                        return window.addEventListener("click", this.removeContextMenus, true),
                                        void (this.listeningForMenuClose = true)
                                    }
                                    this.listeningForMenuClose && (window.removeEventListener("click", this.removeContextMenus, true),
                                    this.listeningForMenuClose = false)
                                }
                            }, {
                                key: "onContextMenuAdded",
                                value: function() {
                                    this.state.contextMenus.length && this.listenForContextMenuClose(true)
                                }
                            }, {
                                key: "showContextMenu",
                                value: function(e) {
                                    var t = this;
                                    this.setState((function(e) {
                                        return t.contextMenuItemData = null,
                                        (0,
                                        R.default)(t.onContextMenuAdded),
                                        {
                                            contextMenus: []
                                        }
                                    }
                                    )),
                                    this.addContextMenu(e)
                                }
                            }, {
                                key: "addContextMenu",
                                value: function(e) {
                                    e && e.items && e.items.length && this.setState((function(t) {
                                        return t.contextMenus.push(e),
                                        {
                                            contextMenus: t.contextMenus
                                        }
                                    }
                                    ))
                                }
                            }, {
                                key: "removeContextMenu",
                                value: function(e) {
                                    var t = this.state.contextMenus
                                    , n = t.indexOf(e);
                                    -1 != n && (t.splice(n, 1),
                                    this.setState({
                                        contextMenus: t
                                    }))
                                }
                            }, {
                                key: "addDropDownPopup",
                                value: function(e) {
                                    e.id = this.ddid++,
                                    this.dropDownPopups.push(e);
                                    var t = o.default.createElement(I.default, {
                                        data: e,
                                        onHide: this.removeDropDownPopup,
                                        onHiding: this.hidingDropDownPopup
                                    })
                                    , n = document.createElement("div");
                                    return this.dropDownPopupsDiv.appendChild(n),
                                    e.component = a.default.render(t, n),
                                    e.container = n,
                                    e
                                }
                            }, {
                                key: "setVerticalRuler",
                                value: function(e) {
                                    this.verticalRuler = e
                                }
                            }, {
                                key: "setHorizontalRuler",
                                value: function(e) {
                                    this.horizontalRuler = e
                                }
                            }, {
                                key: "setStagePanel",
                                value: function(e) {
                                    this.stagePanel = e
                                }
                            }, {
                                key: "setTooltip",
                                value: function(e) {
                                    this.tooltipRef = e
                                }
                            }, {
                                key: "setExportShot",
                                value: function(e) {
                                    this.exportShot = e
                                }
                            }, {
                                key: "setExportEngineModal",
                                value: function(e) {
                                    this.exportEngineModal = e
                                }
                            }, {
                                key: "setExportImageSeqModal",
                                value: function(e) {
                                    this.exportImageSeqModal = e
                                }
                            }, {
                                key: "setSettingsPanel",
                                value: function(e) {
                                    this.settingsPanel = e
                                }
                            }, {
                                key: "setAnimationPanel",
                                value: function(e) {
                                    this.animationPanel = e
                                }
                            }, {
                                key: "setMenu",
                                value: function(e) {
                                    this.menu = e
                                }
                            }, {
                                key: "setAlertContainer",
                                value: function(e) {
                                    this.alertContainer = e
                                }
                            }, {
                                key: "setSelectionResizer",
                                value: function(e) {
                                    this.selectionResizer = e
                                }
                            }, {
                                key: "setSelectionPanel",
                                value: function(e) {
                                    this.selectionPanel = e
                                }
                            }, {
                                key: "setToolbar",
                                value: function(e) {
                                    this.toolbar = e
                                }
                            }, {
                                key: "hidingDropDownPopup",
                                value: function(e) {
                                    e.onClosed && e.onClosed()
                                }
                            }, {
                                key: "removeDropDownPopup",
                                value: function(e) {
                                    var t = this.dropDownPopups
                                    , n = t.indexOf(e);
                                    -1 != n && (t.splice(n, 1),
                                    a.default.unmountComponentAtNode(e.container),
                                    e.container.parentNode.removeChild(e.container))
                                }
                            }, {
                                key: "windowResize",
                                value: function() {
                                    this.visibleStageResize()
                                }
                            }, {
                                key: "fileLoaded",
                                value: function(e) {
                                    this.setState({
                                        actor: e
                                    });
                                    var t = this.workspace || this._Preferences.workspace;
                                    t && this.switchWorkspace(t)
                                }
                            }, {
                                key: "onHierarchyPanelsResized",
                                value: function(e) {
                                    this._Preferences.grabberY !== e && this.savePreference("grabberY", e)
                                }
                            }, {
                                key: "resizePanels",
                                value: function() {
                                    this.updateFilePanelSize(this.filePanelWidth),
                                    this.updateSelectionPanelSize(this.filePanelWidth + this.selectionPanelWidth),
                                    this.animationPanel.setHeight(this.animationPanelHeight)
                                }
                            }, {
                                key: "toggleWorkspace",
                                value: function() {
                                    this.nima.stage.soloItem || this.switchWorkspace("AnimateButton" === this.workspace ? "SetupButton" : "AnimateButton")
                                }
                            }, {
                                key: "updateStageRect",
                                value: function(e) {
                                    var t = this.stagePanel.getBoundingClientRect();
                                    this.stagePanelRect = t;
                                    var n = {
                                        left: this.stagePanelRect.left,
                                        width: this.stagePanelRect.width + (this.isMeshMode ? this.filePanelWidth : 0),
                                        height: this.stagePanelRect.height,
                                        bottom: this.stagePanelRect.bottom
                                    };
                                    this.stageRect && this.stageRect.left == n.left && this.stageRect.width == n.width && this.stageRect.height == n.height && this.stageRect.bottom == n.bottom || (this.stageRect = n,
                                    e || this.nima.dispatch("stageRectChanged", this.stageRect))
                                }
                            }, {
                                key: "visibleStageResize",
                                value: function() {
                                    this.updateStageRect(false)
                                }
                            }, {
                                key: "nimaReady",
                                value: function() {
                                    this.nima.loadFile()
                                }
                            }, {
                                key: "onFileRenamed",
                                value: function(e) {
                                    var t = this.props.file;
                                    t.name = e.name,
                                    t.slug = e.slug,
                                    t.previewPage = e.previewPage,
                                    history.replaceState("", "", "/a/" + this.props.user.username + "/files/" + t.product + "/" + e.slug)
                                }
                            }, {
                                key: "updateSelectionPanel",
                                value: function() {
                                    this.selectionPanel && this.selectionPanel.forceUpdate()
                                }
                            }, {
                                key: "debounceUpdateSelectionPanelItem",
                                value: function() {
                                    (0,
                                    R.default)(this.updateSelectionPanelItem)
                                }
                            }, {
                                key: "updateSelectionPanelItem",
                                value: function() {
                                    var e = this.selectionPanel;
                                    if (e) {
                                        var t = null;
                                        if (this.holdSelection)
                                            t = this.holdSelection;
                                        else {
                                            this.nima.selectedItems.length && (t = this.nima.selectedItems);
                                            var n = this.nima.stage.getFilteredSelectedItems();
                                            n.length && (t = t ? t.concat(n) : n)
                                        }
                                        e.setSelectedItem(t)
                                    }
                                }
                            }, {
                                key: "holdSelectedItem",
                                value: function(e) {
                                    this.holdSelection = e,
                                    this.updateSelectionPanelItem()
                                }
                            }, {
                                key: "clearHoldSelectedItem",
                                value: function(e) {
                                    this.holdSelection == e && (this.holdSelection = null,
                                    this.updateSelectionPanelItem())
                                }
                            }, {
                                key: "getChildContext",
                                value: function() {
                                    return {
                                        nima: this.nima,
                                        tooltip: this.tooltip,
                                        keyMap: this.keyMap,
                                        contextMenu: this.contextMenu,
                                        editor: this
                                    }
                                }
                            }, {
                                key: "hoverShowInHierarchy",
                                value: function() {
                                    this.filePanel.bringHoverIntoView()
                                }
                            }, {
                                key: "switchWorkspace",
                                value: function(e) {
                                    if (this.workspace = e,
                                    this.state.actor) {
                                        this.filePanel && this.filePanel.workspaceToggle.toggleChanged(e),
                                        this.isAnimationOpen = false;
                                        var t = null;
                                        "AnimateButton" == e ? (this.isAnimationOpen = true,
                                        (t = this.lastEditingAnimation) && -1 === this.nima.actor.animations.indexOf(t) && (t = null),
                                        null == t && (t = this.nima.animations.length ? this.nima.animations[0] : this.nima.actor.createAnimation()),
                                        this.nima.editingAnimation = t) : this.nima.editingAnimation = null,
                                        this.animationPanel.setIsOpen(this.isAnimationOpen),
                                        this.filePanel.setAnimationMode(this.isAnimationOpen ? t : null),
                                        this.selectionPanel.setAnimationMode(this.isAnimationOpen ? t : null),
                                        this.toolbar.setAnimationMode(this.isAnimationOpen ? t : null),
                                        this.selectionResizer.setBottom(this.isAnimationOpen ? this.animationPanelHeight : 0),
                                        this.stagePanel.style.bottom = this.isAnimationOpen ? this.animationPanelHeight + "px" : 0,
                                        this._Preferences.workspace !== e && this.savePreference("workspace", e);
                                        var n = this
                                        , i = true;
                                        if (this.state.showGuides) {
                                            window.requestAnimationFrame((function e() {
                                                n.visibleStageResize(),
                                                i && window.requestAnimationFrame(e)
                                            }
                                            )),
                                            this.visibleStageResize()
                                        }
                                        setTimeout((function() {
                                            i = false,
                                            n.visibleStageResize()
                                        }
                                        ), 400)
                                    }
                                }
                            }, {
                                key: "editingAnimationChanged",
                                value: function() {
                                    this.nima.editingAnimation ? "AnimateButton" !== this.workspace && this.switchWorkspace("AnimateButton") : "AnimateButton" === this.workspace && this.switchWorkspace("SetupButton"),
                                    this.nima.editingAnimation && (this.lastEditingAnimation = this.nima.editingAnimation),
                                    this.animationPanel.setAnimation(this.nima.editingAnimation),
                                    this.filePanel.setEditingAnimation(this.nima.editingAnimation)
                                }
                            }, {
                                key: "selectAnimation",
                                value: function(e) {
                                    this.nima.editingAnimation != e && (this.nima.editingAnimation = e)
                                }
                            }, {
                                key: "deleteAnimation",
                                value: function(e) {
                                    this.nima.actor.removeAnimation(e),
                                    0 == this.nima.actor.animations.length ? (this.filePanel.forceSetupWorkspace(),
                                    this.nima.editingAnimation = null) : this.nima.editingAnimation == e && (e = this.nima.actor.animations[0],
                                    this.nima.editingAnimation = e)
                                }
                            }, {
                                key: "startResizeSelection",
                                value: function(e) {
                                    window.addEventListener("mousemove", this.resizeSelection, true),
                                    window.addEventListener("mouseup", this.endResizeSelection, true)
                                }
                            }, {
                                key: "resizeSelection",
                                value: function(e) {
                                    this.updateSelectionPanelSize(e.clientX)
                                }
                            }, {
                                key: "updateSelectionPanelSize",
                                value: function(e) {
                                    var t = a.default.findDOMNode(this.selectionPanel).getBoundingClientRect()
                                    , n = a.default.findDOMNode(this.toolbar).getBoundingClientRect();
                                    this.selectionPanelWidth = Math.max(200, Math.min(n.left - t.left, e - t.left)),
                                    this.selectionPanel.setWidth(this.selectionPanelWidth),
                                    this.filePanel.setSelectionPanelWidth(this.selectionPanelWidth),
                                    this.stagePanel.style.left = this.filePanelWidth + this.selectionPanelWidth + "px",
                                    this.selectionResizer.setLeft(this.filePanelWidth + this.selectionPanelWidth),
                                    this.state.showGuides && this.visibleStageResize()
                                }
                            }, {
                                key: "endResizeSelection",
                                value: function(e) {
                                    window.removeEventListener("mousemove", this.resizeSelection, true),
                                    window.removeEventListener("mouseup", this.endResizeSelection, true),
                                    this.visibleStageResize(),
                                    this.savePreference("selectionPanelWidth", this.selectionPanelWidth)
                                }
                            }, {
                                key: "startResizeAnimation",
                                value: function(e) {
                                    window.addEventListener("mousemove", this.resizeAnimation, true),
                                    window.addEventListener("mouseup", this.endResizeAnimation, true),
                                    this.setState({
                                        animationIsResizing: true
                                    })
                                }
                            }, {
                                key: "resizeAnimation",
                                value: function(e) {
                                    this.animationPanelHeight = Math.max(260, Math.min(window.innerHeight, window.innerHeight - e.clientY)),
                                    this.updateAnimationPanelSize()
                                }
                            }, {
                                key: "updateAnimationPanelSize",
                                value: function() {
                                    if (this.animationPanel.setHeight(this.animationPanelHeight),
                                    this.selectionPanel.setBottom(this.animationPanelHeight),
                                    this.selectionResizer.setBottom(this.animationPanelHeight),
                                    this.stagePanel.style.bottom = this.animationPanelHeight + "px",
                                    this.state.showGuides)
                                        this.stagePanel.style.transition = "none",
                                        this.visibleStageResize();
                                    else {
                                        var e = this;
                                        clearTimeout(this.vsr),
                                        this.vsr = setTimeout((function() {
                                            e.visibleStageResize()
                                        }
                                        ), 100)
                                    }
                                }
                            }, {
                                key: "endResizeAnimation",
                                value: function(e) {
                                    this.stagePanel.style.transition = "",
                                    window.removeEventListener("mousemove", this.resizeAnimation, true),
                                    window.removeEventListener("mouseup", this.endResizeAnimation, true),
                                    this.setState({
                                        animationIsResizing: false
                                    }),
                                    this.visibleStageResize(),
                                    this.savePreference("animationPanelHeight", this.animationPanelHeight)
                                }
                            }, {
                                key: "startResizeFilePanel",
                                value: function(e) {
                                    window.addEventListener("mousemove", this.resizeFilePanel, true),
                                    window.addEventListener("mouseup", this.endResizeFilePanel, true)
                                }
                            }, {
                                key: "resizeFilePanel",
                                value: function(e) {
                                    this.updateFilePanelSize(e.clientX)
                                }
                            }, {
                                key: "updateFilePanelSize",
                                value: function(e) {
                                    var t = a.default.findDOMNode(this.toolbar).getBoundingClientRect();
                                    this.filePanelWidth = Math.max(300, Math.min(t.left - this.selectionPanelWidth, e)),
                                    this.filePanel.setWidth(this.filePanelWidth),
                                    this.selectionPanel.setLeft(this.filePanelWidth),
                                    this.selectionPanel.setFilePanelWidth(this.filePanelWidth),
                                    this.animationPanel.setLeft(this.filePanelWidth),
                                    this.filePanelResizer.setLeft(this.filePanelWidth),
                                    this.selectionResizer.setLeft(this.filePanelWidth + this.selectionPanelWidth),
                                    this.stagePanel.style.left = this.filePanelWidth + this.selectionPanelWidth + "px"
                                }
                            }, {
                                key: "endResizeFilePanel",
                                value: function(e) {
                                    window.removeEventListener("mousemove", this.resizeFilePanel, true),
                                    window.removeEventListener("mouseup", this.endResizeFilePanel, true),
                                    this.visibleStageResize(),
                                    this.animationPanel.resize(),
                                    this.savePreference("filePanelWidth", this.filePanelWidth)
                                }
                            }, {
                                key: "getAccurateStageRect",
                                value: function() {
                                    return this.state.exportOpen ? this.exportShot.getStageRect() : this.stageRect
                                }
                            }, {
                                key: "getStageRect",
                                value: function() {
                                    return this.state.exportOpen ? this.exportShot.getStageRect() : this.stageRect
                                }
                            }, {
                                key: "find",
                                value: function() {
                                    this.filePanel.find()
                                }
                            }, {
                                key: "zoomFit",
                                value: function() {
                                    this.exportScreen && this.exportScreen.zoomFit ? this.exportScreen.zoomFit() : this.nima.stage.zoomFit(1)
                                }
                            }, {
                                key: "incSelectionFilter",
                                value: function(e) {
                                    this.toolbar.incSelectionFilter(e)
                                }
                            }, {
                                key: "meshMode",
                                value: function(e) {
                                    if (this.isMeshMode = e,
                                    this.filePanel.setMeshMode(e),
                                    this.toolbar.setMeshMode(e),
                                    e)
                                        this.stagePanel.style.transition = "left 0.4s cubic-bezier(0.8, 0, 0, 1)",
                                        this.stagePanel.style.left = this.selectionPanelWidth + "px",
                                        this.filePanelResizer.hide(true),
                                        this.selectionResizer.hide(true),
                                        this.stagePanelRect && (this.stageRect = {
                                            left: this.stagePanelRect.left - this.filePanelWidth,
                                            width: this.stagePanelRect.width + this.filePanelWidth,
                                            height: this.stagePanelRect.height,
                                            bottom: this.stagePanelRect.bottom
                                        },
                                        this.nima.dispatch("stageRectChanged", this.stageRect));
                                    else {
                                        this.stagePanel.style.left = this.filePanelWidth + this.selectionPanelWidth + "px";
                                        var t = this;
                                        setTimeout((function() {
                                            t.visibleStageResize(),
                                            t.stagePanel.style.transition = null,
                                            t.filePanelResizer.hide(false),
                                            t.selectionResizer.hide(false)
                                        }
                                        ), 400)
                                    }
                                }
                            }, {
                                key: "weightsMode",
                                value: function(e) {
                                    if (this.isMeshMode = e,
                                    this.filePanel.setMeshMode(e),
                                    this.toolbar.setWeightsMode(e),
                                    e)
                                        this.stagePanel.style.transition = "left 0.4s cubic-bezier(0.8, 0, 0, 1)",
                                        this.stagePanel.style.left = this.selectionPanelWidth + "px",
                                        this.filePanelResizer.hide(true),
                                        this.selectionResizer.hide(true),
                                        this.stagePanelRect && (this.stageRect = {
                                            left: this.stagePanelRect.left - this.filePanelWidth,
                                            width: this.stagePanelRect.width + this.filePanelWidth,
                                            height: this.stagePanelRect.height,
                                            bottom: this.stagePanelRect.bottom
                                        },
                                        this.nima.dispatch("stageRectChanged", this.stageRect));
                                    else {
                                        this.stagePanel.style.left = this.filePanelWidth + this.selectionPanelWidth + "px";
                                        var t = this;
                                        setTimeout((function() {
                                            t.visibleStageResize(),
                                            t.stagePanel.style.transition = null,
                                            t.filePanelResizer.hide(false),
                                            t.selectionResizer.hide(false)
                                        }
                                        ), 400)
                                    }
                                }
                            }, {
                                key: "settingsToggled",
                                value: function() {
                                    this.setState({
                                        settingsOpen: !this.state.settingsOpen
                                    }),
                                    this.state.settingsOpen ? this.stagePanel.style.marginRight = null : this.stagePanel.style.marginRight = "220px",
                                    this.animationPanel.resizeFor(.4);
                                    var e = this;
                                    if (this.state.showGuides) {
                                        window.requestAnimationFrame((function t() {
                                            e.visibleStageResize(),
                                            window.requestAnimationFrame(t)
                                        }
                                        )),
                                        this.visibleStageResize()
                                    }
                                    setTimeout((function() {
                                        e.visibleStageResize()
                                    }
                                    ), 400)
                                }
                            }, {
                                key: "showExportMenu",
                                value: function(e, t) {
                                    this.nima.showContextMenu({
                                        x: t.clientX,
                                        y: t.clientY,
                                        items: [{
                                            name: "Export to Engine",
                                            select: this.toggleShowExportToEngine
                                        }, {
                                            name: "Image Sequence",
                                            select: this.toggleShowExportImageSequence
                                        }, {
                                            type: "Divider"
                                        }, {
                                            name: "Download File",
                                            select: this.toggleShowShareProject
                                        }]
                                    })
                                }
                            }, {
                                key: "toggleShowExportShot",
                                value: function() {
                                    var e = this.nima.actor;
                                    e && e.animations && e.animations.length ? (this.state.showExportToEngine || (this.exporter = z.default),
                                    this.toggleShowExport()) : this.nima.alert({
                                        title: "No Animations",
                                        message: "You need at least one animation to export a shot."
                                    })
                                }
                            }, {
                                key: "gotoExportShot",
                                value: function() {
                                    this.nima.setCancelCallback(this.leaveExportShot),
                                    this.wasEditingAnimation = this.nima.editingAnimation,
                                    this.nima.editingAnimation = null,
                                    this.filePanel.translatePanelOut(true),
                                    this.selectionPanel.translatePanelOut(true),
                                    this.toolbar.translatePanelOut(true, this.state.settingsOpen),
                                    this.filePanelResizer.hide(true),
                                    this.selectionResizer.hide(true),
                                    this.settingsPanel.translatePanelOut(true, this.state.settingsOpen),
                                    this.animationPanel.setIsOpen(false),
                                    this.animationPanel.setExport(true),
                                    this.selectionPanel.setAnimationMode(false);
                                    var e = this.nima.stage.settings;
                                    this.wasShowingGridAxisBeforeExport = e.showGridAxis,
                                    this.wasShowingGridSubdivisionsBeforeExport = e.showGridSubdivisions,
                                    e.showGridAxis = false,
                                    e.showGridSubdivisions = false;
                                    var t = this.nima.stage.getLayerOptions(j.default)
                                    , n = this.nima.stage.getLayerOptions(L.default);
                                    this.wasBoneDrawingDisabledBeforeExport = t.disableDraw,
                                    t.disableDraw = true,
                                    n.disableDraw = true,
                                    this.nima.stage.isDragDisabled = true,
                                    this.nima.stage.redraw(),
                                    this.exportShot.updateValues(),
                                    this.setState({
                                        exportOpen: true,
                                        isShowingExport: true
                                    }),
                                    this.nima.isExporting = true,
                                    clearTimeout(this.exportTimeout)
                                }
                            }, {
                                key: "showCrash",
                                value: function() {
                                    this.setState({
                                        showCrashError: true
                                    })
                                }
                            }, {
                                key: "leaveExportShot",
                                value: function() {
                                    this.nima.clearCancelCallback(this.leaveExportShot),
                                    this.nima.editingAnimation = this.wasEditingAnimation,
                                    this.filePanel.translatePanelOut(false),
                                    this.selectionPanel.translatePanelOut(false),
                                    this.toolbar.translatePanelOut(false, this.state.settingsOpen),
                                    this.filePanelResizer.hide(false),
                                    this.selectionResizer.hide(false),
                                    this.settingsPanel.translatePanelOut(false, this.state.settingsOpen),
                                    this.animationPanel.setIsOpen(this.isAnimationOpen),
                                    this.animationPanel.setExport(false),
                                    this.selectionPanel.setAnimationMode(this.isAnimationOpen ? this.nima.editingAnimation : null),
                                    this.exportShot.exitExport(),
                                    this.nima.stage.isDragDisabled = this.wasSelectionDisabledBeforeExport;
                                    var e = this.nima.stage.getLayerOptions(j.default)
                                    , t = this.nima.stage.getLayerOptions(L.default);
                                    e.disableDraw = this.wasBoneDrawingDisabledBeforeExport,
                                    t.disableDraw = this.wasBoneDrawingDisabledBeforeExport;
                                    var n = this.nima.stage.settings;
                                    n.showGridAxis = this.wasShowingGridAxisBeforeExport,
                                    n.showGridSubdivisions = this.wasShowingGridSubdivisionsBeforeExport,
                                    this.setState({
                                        exportOpen: false
                                    }),
                                    this.nima.stage.redraw(),
                                    this.nima.isExporting = false,
                                    clearTimeout(this.exportTimeout);
                                    var i = this;
                                    this.exportTimeout = setTimeout((function() {
                                        i.setState({
                                            isShowingExport: false
                                        })
                                    }
                                    ), 400)
                                }
                            }, {
                                key: "prepareShotPreview",
                                value: function() {
                                    document.getElementById("canvas").style.transform = "translate3D(0, -144px, 0)"
                                }
                            }, {
                                key: "exitShotPreview",
                                value: function() {
                                    this.nima.style.transform = null
                                }
                            }, {
                                key: "toggleSiteMenu",
                                value: function() {
                                    this.setState({
                                        siteMenuOpen: !this.state.siteMenuOpen
                                    })
                                }
                            }, {
                                key: "logoClick",
                                value: function() {
                                    this.state.siteMenuOpen ? window.location = "/" : this.setState({
                                        siteMenuOpen: !this.state.siteMenuOpen
                                    })
                                }
                            }, {
                                key: "loadMenu",
                                value: function() {
                                    this.menu.getMenuData()
                                }
                            }, {
                                key: "setDropdownPopupsDiv",
                                value: function(e) {
                                    this.dropDownPopupsDiv = e
                                }
                            }, {
                                key: "drawRulers",
                                value: function() {
                                    this.verticalRuler && this.verticalRuler.drawTicks(),
                                    this.horizontalRuler && this.horizontalRuler.drawTicks()
                                }
                            }, {
                                key: "serializeGuides",
                                value: function() {
                                    var e = {};
                                    return this.verticalRuler && (e.vertical = this.verticalRuler.serialize()),
                                    this.horizontalRuler && (e.horizontal = this.horizontalRuler.serialize()),
                                    e.vertical || e.horizontal ? e : null
                                }
                            }, {
                                key: "preferencesUpdated",
                                value: function() {
                                    this.setState({
                                        showGuides: this.nima.getPreference("showGuides")
                                    }),
                                    this.settingsPanel.updatePreferences()
                                }
                            }, {
                                key: "resetGuides",
                                value: function() {
                                    this.verticalRuler && this.verticalRuler.reset(),
                                    this.horizontalRuler && this.horizontalRuler.reset()
                                }
                            }, {
                                key: "deserializeGuides",
                                value: function(e) {
                                    this.verticalRuler && this.verticalRuler.deserialize(e.vertical),
                                    e && e.horizontal && this.horizontalRuler && this.horizontalRuler.deserialize(e.horizontal)
                                }
                            }, {
                                key: "getGuides",
                                value: function() {
                                    if (!this.state.showGuides || this.state.isShowingExport)
                                        return null;
                                    var e = [];
                                    return this.verticalRuler && (e = e.concat(this.verticalRuler.guides)),
                                    this.horizontalRuler && (e = e.concat(this.horizontalRuler.guides)),
                                    e
                                }
                            }, {
                                key: "toggleShowExportImageSequence",
                                value: function() {
                                    this.state.showExportToEngine || (this.exporter = C.default),
                                    this.toggleShowExport()
                                }
                            }, {
                                key: "toggleShowShareProject",
                                value: function() {
                                    this.state.showExportToEngine || (this.exporter = E.default),
                                    this.toggleShowExport()
                                }
                            }, {
                                key: "toggleShowExportToEngine",
                                value: function() {
                                    this.state.showExportToEngine || (this.exporter = T.default),
                                    this.toggleShowExport()
                                }
                            }, {
                                key: "toggleShowExport",
                                value: function() {
                                    var e = !this.state.showExportToEngine;
                                    if (e)
                                        switch (this.setState({
                                            showExportToEngine: e
                                        }),
                                        this.exporter) {
                                        case T.default:
                                            N.default.event("file", "export", "nima");
                                            break;
                                        case E.default:
                                            N.default.event("file", "export-project", "nima");
                                            break;
                                        case C.default:
                                            N.default.event("file", "export-image-seq", "nima")
                                        }
                                    else {
                                        var t = this;
                                        this.exportDisplayTimeout = setTimeout((function() {
                                            t.setState({
                                                showExportToEngine: e
                                            })
                                        }
                                        ), 400)
                                    }
                                }
                            }, {
                                key: "showAlert",
                                value: function(e) {
                                    this.alertContainer.add(e)
                                }
                            }, {
                                key: "continueUsingUnoptimizedBrowser",
                                value: function() {
                                    this.setState({
                                        showBrowserWarning: false
                                    })
                                }
                            }, {
                                key: "setExportScreen",
                                value: function(e) {
                                    this.exportScreen = e
                                }
                            }, {
                                key: "render",
                                value: function() {
                                    if (this.state.error)
                                        return o.default.createElement(y.default, {
                                            error: this.state.error
                                        });
                                    for (var e = [], t = 0; t < this.state.contextMenus.length; t++) {
                                        var n = this.state.contextMenus[t];
                                        e.push(o.default.createElement(x.default, {
                                            key: "cx" + t,
                                            data: n,
                                            onHide: this.removeContextMenu
                                        }))
                                    }
                                    var i = null;
                                    if (this.state.showExportToEngine)
                                        switch (this.exporter) {
                                        case E.default:
                                            i = o.default.createElement(E.default, {
                                                ref: this.setExportScreen,
                                                onExportComplete: this.toggleShowExport
                                            });
                                            break;
                                        case T.default:
                                            i = o.default.createElement(T.default, {
                                                ref: this.setExportScreen,
                                                onExportComplete: this.toggleShowExport
                                            });
                                            break;
                                        case C.default:
                                            i = o.default.createElement(C.default, {
                                                ref: this.setExportScreen,
                                                onExportComplete: this.toggleShowExport
                                            });
                                            break;
                                        case z.default:
                                            i = o.default.createElement(z.default, {
                                                ref: this.setExportScreen,
                                                username: this.props.user.username,
                                                verified: this.props.isVerified,
                                                name: this.props.user.name,
                                                avatar: this.props.user.avatar,
                                                onExportComplete: this.toggleShowExport
                                            })
                                        }
                                    var r = this.props.file;
                                    return o.default.createElement("div", {
                                        className: "UIPanels"
                                    }, this.state.isFilesModalOpen || this.state.isFilesModalClosing ? o.default.createElement(F.default, {
                                        key: "files",
                                        defaultFilename: r.title,
                                        onChooseLocation: this.state.chooseLocation,
                                        path: this.state.filesModalPath,
                                        isOpen: this.state.isFilesModalOpen,
                                        isClosing: this.state.isFilesModalClosing,
                                        onClose: this.closeFilesModal
                                    }) : null, this.state.isPropertiesModalOpen || this.state.isPropertiesModalClosing ? o.default.createElement(B.default, {
                                        isOpen: this.state.isPropertiesModalOpen,
                                        isClosing: this.state.isPropertiesModalClosing,
                                        onClose: this.closePropertiesModal,
                                        file: r
                                    }) : null, this.state.showCrashError ? o.default.createElement(f.default, null) : null, this.state.showBrowserWarning ? o.default.createElement(p.default, {
                                        onContinueAnyway: this.continueUsingUnoptimizedBrowser
                                    }) : null, o.default.createElement(m.default, {
                                        ref: this.setMenu,
                                        onClose: this.toggleSiteMenu,
                                        onShowFilesModal: this.showFilesModal,
                                        onLogoClick: this.logoClick,
                                        file: r,
                                        siteMenuOpen: this.state.siteMenuOpen,
                                        username: this.props.user.username,
                                        name: this.props.user.name,
                                        avatar: this.props.user.avatar
                                    }), o.default.createElement(v.default, {
                                        ref: this.setFilePanel,
                                        onShowPropertiesModal: this.showPropertiesModal,
                                        onLogoHover: this.loadMenu,
                                        onLogoClick: this.logoClick,
                                        siteMenuOpen: this.state.siteMenuOpen,
                                        file: r,
                                        profileName: this.props.user.name,
                                        onSwitchedToggle: this.switchWorkspace,
                                        width: this.filePanelWidth,
                                        selectionPanelWidth: this.selectionPanelWidth,
                                        onHierarchyPanelsResized: this.onHierarchyPanelsResized
                                    }), o.default.createElement(g.default, {
                                        ref: this.setFilePanelResizer,
                                        onMouseDown: this.startResizeFilePanel,
                                        addClass: "HierarchyResizer"
                                    }), o.default.createElement(g.default, {
                                        ref: this.setSelectionResizer,
                                        onMouseDown: this.startResizeSelection,
                                        addClass: "SelectionResizer"
                                    }), o.default.createElement(_.default, {
                                        ref: this.setSelectionPanel,
                                        filePanelWidth: this.filePanelWidth,
                                        width: this.selectionPanelWidth,
                                        animationPanelHeight: this.animationPanelHeight,
                                        animationIsResizing: this.state.animationIsResizing,
                                        onMeshMode: this.meshMode,
                                        onWeightsMode: this.weightsMode
                                    }), o.default.createElement("div", {
                                        ref: this.setStagePanel,
                                        className: "StagePanel"
                                    }, o.default.createElement(b.default, {
                                        ref: this.setAlertContainer,
                                        showGuides: this.state.showGuides,
                                        showModal: this.hasModalOpen
                                    }), o.default.createElement(w.default, {
                                        ref: this.setVerticalRuler,
                                        isVertical: false,
                                        isVisible: !this.state.isShowingExport && !this.state.showExportToEngine && this.state.showGuides
                                    }), o.default.createElement(w.default, {
                                        ref: this.setHorizontalRuler,
                                        isVertical: true,
                                        isVisible: !this.state.isShowingExport && !this.state.showExportToEngine && this.state.showGuides
                                    })), o.default.createElement(O.default, {
                                        ref: this.setAnimationPanel,
                                        onClickResizeGrabber: this.startResizeAnimation,
                                        height: this.animationPanelHeight,
                                        actor: this.state.actor,
                                        onAnimationSelected: this.selectAnimation,
                                        onDeleteAnimation: this.deleteAnimation,
                                        settingsOpen: this.state.settingsOpen,
                                        filePanelWidth: this.filePanelWidth
                                    }), o.default.createElement(S.default, {
                                        ref: this.setToolbar,
                                        onSettingsToggled: this.settingsToggled,
                                        onGotoExport: this.showExportMenu,
                                        settingsOpen: this.state.settingsOpen
                                    }), o.default.createElement(k.default, {
                                        ref: this.setSettingsPanel,
                                        onSettingsToggled: this.settingsToggled,
                                        isOpen: this.state.settingsOpen
                                    }), i, o.default.createElement(P.default, {
                                        ref: this.setTooltip
                                    }), e, o.default.createElement("div", {
                                        ref: this.setDropdownPopupsDiv
                                    }))
                                }
                            }, {
                                key: "hasModalOpen",
                                get: function() {
                                    return this.state.exportOpen || this.state.showExportToEngine || this.state.isFilesModalOpen || this.state.isPropertiesModalOpen
                                }
                            }
                        ]
                    ), t
                }(o.default.Component)
            ).prototype, "closeModal", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "closeModal"), i.prototype),
        K(i.prototype, "toggleShortcutsModal", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleShortcutsModal"), i.prototype),
        K(i.prototype, "showFilesModal", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "showFilesModal"), i.prototype),
        K(i.prototype, "closeFilesModal", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "closeFilesModal"), i.prototype),
        K(i.prototype, "showPropertiesModal", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "showPropertiesModal"), i.prototype),
        K(i.prototype, "closePropertiesModal", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "closePropertiesModal"), i.prototype),
        K(i.prototype, "setFilePanel", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "setFilePanel"), i.prototype),
        K(i.prototype, "setFilePanelResizer", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "setFilePanelResizer"), i.prototype),
        K(i.prototype, "removeContextMenus", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "removeContextMenus"), i.prototype),
        K(i.prototype, "onContextMenuAdded", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "onContextMenuAdded"), i.prototype),
        K(i.prototype, "removeContextMenu", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "removeContextMenu"), i.prototype),
        K(i.prototype, "addDropDownPopup", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "addDropDownPopup"), i.prototype),
        K(i.prototype, "setVerticalRuler", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "setVerticalRuler"), i.prototype),
        K(i.prototype, "setHorizontalRuler", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "setHorizontalRuler"), i.prototype),
        K(i.prototype, "setStagePanel", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "setStagePanel"), i.prototype),
        K(i.prototype, "setTooltip", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "setTooltip"), i.prototype),
        K(i.prototype, "setExportShot", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "setExportShot"), i.prototype),
        K(i.prototype, "setExportEngineModal", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "setExportEngineModal"), i.prototype),
        K(i.prototype, "setExportImageSeqModal", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "setExportImageSeqModal"), i.prototype),
        K(i.prototype, "setSettingsPanel", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "setSettingsPanel"), i.prototype),
        K(i.prototype, "setAnimationPanel", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "setAnimationPanel"), i.prototype),
        K(i.prototype, "setMenu", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "setMenu"), i.prototype),
        K(i.prototype, "setAlertContainer", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "setAlertContainer"), i.prototype),
        K(i.prototype, "setSelectionResizer", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "setSelectionResizer"), i.prototype),
        K(i.prototype, "setSelectionPanel", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "setSelectionPanel"), i.prototype),
        K(i.prototype, "setToolbar", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "setToolbar"), i.prototype),
        K(i.prototype, "hidingDropDownPopup", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "hidingDropDownPopup"), i.prototype),
        K(i.prototype, "removeDropDownPopup", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "removeDropDownPopup"), i.prototype),
        K(i.prototype, "windowResize", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "windowResize"), i.prototype),
        K(i.prototype, "fileLoaded", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "fileLoaded"), i.prototype),
        K(i.prototype, "onHierarchyPanelsResized", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "onHierarchyPanelsResized"), i.prototype),
        K(i.prototype, "resizePanels", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "resizePanels"), i.prototype),
        K(i.prototype, "nimaReady", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "nimaReady"), i.prototype),
        K(i.prototype, "onFileRenamed", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "onFileRenamed"), i.prototype),
        K(i.prototype, "debounceUpdateSelectionPanelItem", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "debounceUpdateSelectionPanelItem"), i.prototype),
        K(i.prototype, "updateSelectionPanelItem", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "updateSelectionPanelItem"), i.prototype),
        K(i.prototype, "switchWorkspace", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "switchWorkspace"), i.prototype),
        K(i.prototype, "editingAnimationChanged", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "editingAnimationChanged"), i.prototype),
        K(i.prototype, "selectAnimation", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "selectAnimation"), i.prototype),
        K(i.prototype, "deleteAnimation", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "deleteAnimation"), i.prototype),
        K(i.prototype, "startResizeSelection", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "startResizeSelection"), i.prototype),
        K(i.prototype, "resizeSelection", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "resizeSelection"), i.prototype),
        K(i.prototype, "updateSelectionPanelSize", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "updateSelectionPanelSize"), i.prototype),
        K(i.prototype, "endResizeSelection", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "endResizeSelection"), i.prototype),
        K(i.prototype, "startResizeAnimation", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "startResizeAnimation"), i.prototype),
        K(i.prototype, "resizeAnimation", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "resizeAnimation"), i.prototype),
        K(i.prototype, "updateAnimationPanelSize", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "updateAnimationPanelSize"), i.prototype),
        K(i.prototype, "endResizeAnimation", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "endResizeAnimation"), i.prototype),
        K(i.prototype, "startResizeFilePanel", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "startResizeFilePanel"), i.prototype),
        K(i.prototype, "resizeFilePanel", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "resizeFilePanel"), i.prototype),
        K(i.prototype, "updateFilePanelSize", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "updateFilePanelSize"), i.prototype),
        K(i.prototype, "endResizeFilePanel", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "endResizeFilePanel"), i.prototype),
        K(i.prototype, "meshMode", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "meshMode"), i.prototype),
        K(i.prototype, "weightsMode", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "weightsMode"), i.prototype),
        K(i.prototype, "settingsToggled", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "settingsToggled"), i.prototype),
        K(i.prototype, "showExportMenu", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "showExportMenu"), i.prototype),
        K(i.prototype, "toggleShowExportShot", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleShowExportShot"), i.prototype),
        K(i.prototype, "gotoExportShot", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "gotoExportShot"), i.prototype),
        K(i.prototype, "leaveExportShot", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "leaveExportShot"), i.prototype),
        K(i.prototype, "prepareShotPreview", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "prepareShotPreview"), i.prototype),
        K(i.prototype, "exitShotPreview", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "exitShotPreview"), i.prototype),
        K(i.prototype, "toggleSiteMenu", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleSiteMenu"), i.prototype),
        K(i.prototype, "logoClick", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "logoClick"), i.prototype),
        K(i.prototype, "loadMenu", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "loadMenu"), i.prototype),
        K(i.prototype, "setDropdownPopupsDiv", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "setDropdownPopupsDiv"), i.prototype),
        K(i.prototype, "toggleShowExportImageSequence", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleShowExportImageSequence"), i.prototype),
        K(i.prototype, "toggleShowShareProject", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleShowShareProject"), i.prototype),
        K(i.prototype, "toggleShowExportToEngine", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleShowExportToEngine"), i.prototype),
        K(i.prototype, "toggleShowExport", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleShowExport"), i.prototype),
        K(i.prototype, "continueUsingUnoptimizedBrowser", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "continueUsingUnoptimizedBrowser"), i.prototype),
        K(i.prototype, "setExportScreen", [h.default], Object.getOwnPropertyDescriptor(i.prototype, "setExportScreen"), i.prototype),
        i
    );

    t.default = G,
    G.childContextTypes = {
        nima: s.default.object,
        tooltip: s.default.object,
        keyMap: s.default.object,
        contextMenu: s.default.object,
        editor: s.default.object
    }
}
, , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = v(n(1094))
      , o = v(n(507))
      , a = v(n(697))
      , s = v(n(410))
      , l = v(n(447))
      , u = v(n(586))
      , c = v(n(587))
      , d = v(n(588))
      , h = v(n(590))
      , f = v(n(591))
      , p = v(n(592))
      , y = v(n(593))
      , m = v(n(702));
    function v(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var g = function() {
        function e(t) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e),
            this.app = t,
            this.togglePlayPressTime = Date.now(),
            this.onAction = this.onAction.bind(this),
            this.onActionReleased = this.onActionReleased.bind(this)
        }
        return i(e, [{
            key: "onAction",
            value: function(e, t) {
                if (t)
                    switch (e) {
                    case _.PreviousItem:
                    case _.NextItem:
                    case _.BrushSizeUp:
                    case _.BrushSizeDown:
                    case _.BrushFeatherUp:
                    case _.BrushFeatherDown:
                    case _.BrushStrengthUp:
                    case _.BrushStrengthDown:
                    case _.NudgeRight:
                    case _.NudgeLeft:
                    case _.NudgeUp:
                    case _.NudgeDown:
                    case _.BumpRight:
                    case _.BumpLeft:
                    case _.BumpUp:
                    case _.BumpDown:
                        break;
                    default:
                        return
                    }
                switch (e) {
                case _.PickParent:
                    this.app.pickParent();
                    break;
                case _.BringForward:
                    this.app.incrementSelectionDrawOrder(1);
                    break;
                case _.SendBackward:
                    this.app.incrementSelectionDrawOrder(-1);
                    break;
                case _.SendToFront:
                    this.app.bumpSelectionDrawOrder(1);
                    break;
                case _.SendToBack:
                    this.app.bumpSelectionDrawOrder(-1);
                    break;
                case _.HoverShowInHierarchy:
                    this.app.editor.hoverShowInHierarchy();
                    break;
                case _.SwitchMode:
                    this.app.editor.toggleWorkspace();
                    break;
                case _.KeySelected:
                    this.app.keySelected(true, true, true, true);
                    break;
                case _.KeySelectedTranslation:
                    this.app.keySelected(true, false, false, false);
                    break;
                case _.KeySelectedRotation:
                    this.app.keySelected(false, true, false, false);
                    break;
                case _.KeySelectedScale:
                    this.app.keySelected(false, false, true, false);
                    break;
                case _.KeySelectedLength:
                    this.app.keySelected(false, false, false, true);
                    break;
                case _.NudgeLeft:
                    this.app.translateSelection([-1, 0]);
                    break;
                case _.NudgeRight:
                    this.app.translateSelection([1, 0]);
                    break;
                case _.NudgeUp:
                    this.app.translateSelection([0, 1]);
                    break;
                case _.NudgeDown:
                    this.app.translateSelection([0, -1]);
                    break;
                case _.BumpLeft:
                    this.app.translateSelection([-10, 0]);
                    break;
                case _.BumpRight:
                    this.app.translateSelection([10, 0]);
                    break;
                case _.BumpUp:
                    this.app.translateSelection([0, 10]);
                    break;
                case _.BumpDown:
                    this.app.translateSelection([0, -10]);
                    break;
                case _.NextSelectionFilter:
                    this.app.incSelectionFilter(1);
                    break;
                case _.PreviousSelectionFilter:
                    this.app.incSelectionFilter(-1);
                    break;
                case _.ToggleRulers:
                    this.app.setProjectPreference("showGuides", !this.app.getPreference("showGuides"));
                    break;
                case _.ResetRulers:
                    this.app.resetGuides();
                    break;
                case _.Item1:
                    this.app.selectIndexItem(0);
                    break;
                case _.Item2:
                    this.app.selectIndexItem(1);
                    break;
                case _.Item3:
                    this.app.selectIndexItem(2);
                    break;
                case _.Item4:
                    this.app.selectIndexItem(3);
                    break;
                case _.Item5:
                    this.app.selectIndexItem(4);
                    break;
                case _.Item6:
                    this.app.selectIndexItem(5);
                    break;
                case _.Item7:
                    this.app.selectIndexItem(6);
                    break;
                case _.Item8:
                    this.app.selectIndexItem(7);
                    break;
                case _.Item9:
                    this.app.selectIndexItem(8);
                    break;
                case _.Item10:
                    this.app.selectIndexItem(9);
                    break;
                case _.NextItem:
                    this.app.selectIndexItemNext();
                    break;
                case _.PreviousItem:
                    this.app.selectIndexItemPrevious();
                    break;
                case _.BrushSizeUp:
                    this.app.incBrushSize(t ? 10 : 1);
                    break;
                case _.BrushSizeDown:
                    this.app.incBrushSize(t ? -10 : -1);
                    break;
                case _.BrushFeatherUp:
                    this.app.incBrushFeather(t ? 10 : 1);
                    break;
                case _.BrushFeatherDown:
                    this.app.incBrushFeather(t ? -10 : -1);
                    break;
                case _.BrushStrengthUp:
                    this.app.incBrushStrength(.1);
                    break;
                case _.BrushStrengthDown:
                    this.app.incBrushStrength(-.1);
                    break;
                case _.TogglePlay:
                    this.togglePlayPressTime = Date.now();
                    break;
                case _.Copy:
                    this.app.copy();
                    break;
                case _.Paste:
                    this.app.paste();
                    break;
                case _.Cut:
                    this.app.cut();
                    break;
                case _.Delete:
                    this.app.delete();
                    break;
                case _.Cancel:
                    this.app.cancel();
                    break;
                case _.Undo:
                    this.app.undo();
                    break;
                case _.Deselect:
                    this.app.deselect();
                    break;
                case _.Redo:
                    this.app.redo();
                    break;
                case _.Find:
                    this.app.find();
                    break;
                case _.DrawMeshTool:
                    this.app.stage.toolType = o.default;
                    break;
                case _.SelectChildrenTool:
                    this.app.stage.toolType === a.default ? this.app.stage.tool.close() : this.app.stage.toolType = a.default;
                    break;
                case _.PaintWeightTool:
                    this.app.stage.toolType = s.default;
                    break;
                case _.TranslateTool:
                    this.app.stage.toolType = l.default;
                    break;
                case _.RotateTool:
                    this.app.stage.toolType = u.default;
                    break;
                case _.ScaleTool:
                    this.app.stage.toolType = c.default;
                    break;
                case _.IKTool:
                    this.app.stage.toolType = d.default;
                    break;
                case _.BoneTool:
                    this.app.stage.toolType = h.default;
                    break;
                case _.NodeTool:
                    this.app.stage.toolType = f.default;
                    break;
                case _.SoloTool:
                    this.app.stage.toolType = p.default;
                    break;
                case _.ColliderTool:
                    this.app.stage.toolType = y.default;
                    break;
                case _.ZoomFit:
                    this.app.zoomFit();
                    break;
                case _.Group:
                    this.app.group();
                    break;
                case _.GroupSolo:
                    this.app.groupSolo();
                    break;
                case _.SelectAll:
                    this.app.selectAll();
                    break;
                case _.ZoomIn:
                    var n = this.app.stage.zoom
                      , i = (0,
                    r.default)(n);
                    i <= n && (i *= 2),
                    this.app.stage.zoom = i;
                    break;
                case _.ZoomOut:
                    var m = this.app.stage.zoom
                      , v = (0,
                    r.default)(m);
                    v >= m && (v /= 2),
                    this.app.stage.zoom = v;
                    break;
                case _.Zoom100:
                    this.app.stage.zoom = 1;
                    break;
                case _.Pan:
                    this.app.startPan();
                    break;
                case _.TimelineStart:
                    this.app.editingAnimation && (this.app.editingAnimation.position = 0,
                    this.app.editingAnimation.showPlayhead());
                    break;
                case _.TimelineEnd:
                    this.app.editingAnimation && (this.app.editingAnimation.position = this.app.editingAnimation.duration,
                    this.app.editingAnimation.showPlayhead());
                    break;
                case _.NextFrame:
                    this.app.editingAnimation && this.app.editingAnimation.moveFrames(1);
                    break;
                case _.NextKeyFrame:
                    this.app.editingAnimation && this.app.editingAnimation.moveKeyFrames(true);
                    break;
                case _.PreviousFrame:
                    this.app.editingAnimation && this.app.editingAnimation.moveFrames(-1);
                    break;
                case _.PreviousKeyFrame:
                    this.app.editingAnimation && this.app.editingAnimation.moveKeyFrames(false);
                    break;
                case _.Next10Frames:
                    this.app.editingAnimation && this.app.editingAnimation.moveFrames(10);
                    break;
                case _.Previous10Frames:
                    this.app.editingAnimation && this.app.editingAnimation.moveFrames(-10);
                    break;
                case _.ForceRevision:
                    this.app.forceRevision();
                    break;
                case _.ToggleShortcutsModal:
                    this.app.editor.toggleShortcutsModal();
                    break;
                case _.Duplicate:
                    this.app.duplicate()
                }
            }
        }, {
            key: "onActionReleased",
            value: function(e) {
                switch (e) {
                case _.TogglePlay:
                    this.app.editor.state.showExportToEngine && this.app.editor.exporter === m.default ? this.app.editor.exportScreen.togglePause() : this.app.editingAnimation && Date.now() - this.togglePlayPressTime < 200 && (this.app.editingAnimation.isPlaying = !this.app.editingAnimation.isPlaying);
                    break;
                case _.Pan:
                    this.app.stage.isPanning = false
                }
            }
        }]),
        e
    }();
    t.default = g;
    var _ = {
        BoneTool: "bone-tool",
        Cancel: "cancel",
        ColliderTool: "collider-tool",
        Copy: "copy",
        Cut: "cut",
        Delete: "delete",
        Deselect: "deselect",
        DrawMeshTool: "draw-mesh-tool",
        Duplicate: "duplicate",
        Find: "find",
        ForceRevision: "force-revision",
        Group: "group",
        GroupSolo: "group-solo",
        IKTool: "ik-tool",
        Next10Frames: "next-10-frames",
        NextFrame: "next-frame",
        NextKeyFrame: "next-key-frame",
        NodeTool: "node-tool",
        PaintWeightTool: "paint-weight-tool",
        Pan: "pan",
        Paste: "paste",
        Previous10Frames: "prev-10-frames",
        PreviousFrame: "prev-frame",
        PreviousKeyFrame: "previous-key-frame",
        Redo: "redo",
        RotateTool: "rotate-tool",
        ScaleTool: "scale-tool",
        SelectAll: "select-all",
        SelectChildrenTool: "select-children-tool",
        ToggleShortcutsModal: "show-shortcuts-modal",
        SoloTool: "solo-tool",
        TimelineEnd: "timeline-end",
        TimelineStart: "timeline-start",
        TogglePlay: "toggle-play",
        TranslateTool: "translate-tool",
        Undo: "undo",
        Zoom100: "zoom-100",
        ZoomFit: "zoom-fit",
        ZoomIn: "zoom-in",
        ZoomOut: "zoom-out",
        BrushFeatherDown: "brush-feather-down",
        BrushFeatherUp: "brush-feather-up",
        BrushSizeDown: "brush-size-down",
        BrushSizeUp: "brush-size-up",
        BrushStrengthDown: "brush-strength-down",
        BrushStrengthUp: "brush-strength-up",
        Item1: "item1",
        Item10: "item10",
        Item2: "item2",
        Item3: "item3",
        Item4: "item4",
        Item5: "item5",
        Item6: "item6",
        Item7: "item7",
        Item8: "item8",
        Item9: "item9",
        KeySelected: "key-selected",
        KeySelectedLength: "key-selected-length",
        KeySelectedRotation: "key-selected-rotation",
        KeySelectedScale: "key-selected-scale",
        KeySelectedTranslation: "key-selected-translation",
        NextItem: "next-item",
        PreviousItem: "prev-item",
        BumpDown: "bump-down",
        BumpLeft: "bump-left",
        BumpRight: "bump-right",
        BumpUp: "bump-up",
        NudgeDown: "nudge-down",
        NudgeLeft: "nudge-left",
        NudgeRight: "nudge-right",
        NudgeUp: "nudge-up",
        ResetRulers: "reset-rulers",
        ToggleRulers: "toggle-rulers",
        AllSelectionFilter: "all-selection-filter",
        BoneSelectionFilter: "bone-selection-filter",
        ImageSelectionFilter: "image-selection-filter",
        NextSelectionFilter: "next-selection-filter",
        PreviousSelectionFilter: "previous-selection-filter",
        VertexSelectionFilter: "vertex-selection-filter",
        HoverShowInHierarchy: "hover-show-in-hierarchy",
        SwitchMode: "switch-mode",
        BringForward: "bring-forward",
        SendBackward: "send-backward",
        SendToBack: "send-to-back",
        SendToFront: "send-to-front",
        PickParent: "pick-parent"
    };
    g.Actions = _
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = n(2);
    var o = function() {
        function e() {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e),
            this._Min = r.vec2.create(),
            this._Max = r.vec2.create(),
            this._Area = 0,
            this._Width = 0,
            this._Height = 0
        }
        return i(e, [{
            key: "set",
            value: function(e, t) {
                return r.vec2.copy(this._Min, e),
                r.vec2.copy(this._Max, t),
                this._Area = (this._Width = this._Max[0] - this._Min[0]) * (this._Height = this._Max[1] - this._Min[1]),
                this
            }
        }, {
            key: "contains",
            value: function(e) {
                return this._Min[0] <= e.min[0] && this._Min[1] <= e.min[1] && this._Max[0] >= e.max[0] && this._Max[1] >= e.max[1]
            }
        }, {
            key: "combineFrom",
            value: function(e, t) {
                return this._Min[0] = Math.min(e.min[0], t.min[0]),
                this._Min[1] = Math.min(e.min[1], t.min[1]),
                this._Max[0] = Math.max(e.max[0], t.max[0]),
                this._Max[1] = Math.max(e.max[1], t.max[1]),
                this._Area = (this._Width = this._Max[0] - this._Min[0]) * (this._Height = this._Max[1] - this._Min[1]),
                this
            }
        }, {
            key: "combine",
            value: function(e) {
                return this._Min[0] = Math.min(this._Min[0], e.min[0]),
                this._Min[1] = Math.min(this._Min[1], e.min[1]),
                this._Max[0] = Math.max(this._Max[0], e.max[0]),
                this._Max[1] = Math.max(this._Max[1], e.max[1]),
                this._Area = (this._Width = this._Max[0] - this._Min[0]) * (this._Height = this._Max[1] - this._Min[1]),
                this
            }
        }, {
            key: "isPointInside",
            value: function(e, t) {
                return e >= this._Min[0] && e <= this._Max[0] && t >= this._Min[1] && t <= this._Max[1]
            }
        }, {
            key: "overlaps",
            value: function(e) {
                var t = r.vec2.subtract(r.vec2.create(), e.min, this._Max)
                  , n = r.vec2.subtract(r.vec2.create(), this._Min, e.max);
                return !(t[0] > 0 || t[1] > 0) && !(n[0] > 0 || n[1] > 0)
            }
        }, {
            key: "expandHeight",
            value: function(e) {
                this._Min[1] -= e,
                this._Max[1] += e
            }
        }, {
            key: "expandWidth",
            value: function(e) {
                this._Min[0] -= e,
                this._Max[0] += e
            }
        }, {
            key: "min",
            get: function() {
                return this._Min
            }
        }, {
            key: "max",
            get: function() {
                return this._Max
            }
        }, {
            key: "area",
            get: function() {
                return this._Area
            }
        }, {
            key: "boxWidth",
            get: function() {
                return this._Width
            }
        }, {
            key: "boxHeight",
            get: function() {
                return this._Height
            }
        }, {
            key: "center",
            get: function() {
                return r.vec2.scale(r.vec2.create(), r.vec2.add(r.vec2.create(), this._Min, this._Max), .5)
            }
        }, {
            key: "extents",
            get: function() {
                return r.vec2.scale(r.vec2.create(), r.vec2.subtract(r.vec2.create(), this._Max, this._Min), .5)
            }
        }]),
        e
    }();
    t.default = o
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    });
    t.default = function e(t, n) {
        !function(e, t) {
            if (!(e instanceof t))
                throw new TypeError("Cannot call a class as a function")
        }(this, e),
        this.id = t,
        n && n.constructor === Object ? this.data = n : this.data = new Float32Array(n || [])
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = n(12);
    var a = function(e) {
        function t() {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var e = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this));
            return e._Name = null,
            e._IsSelected = false,
            e
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "setName",
            value: function(e, t) {
                this._Name = e,
                t || (this.dispatch("update", this),
                this.dispatch("nameChanged", e))
            }
        }, {
            key: "name",
            get: function() {
                return this._Name
            },
            set: function(e) {
                this.setName(e)
            }
        }, {
            key: "isSelected",
            get: function() {
                return this._IsSelected
            },
            set: function(e) {
                this._IsSelected != e && (this._IsSelected = e,
                this.dispatch("selectedChange", e))
            }
        }]),
        t
    }(((i = o) && i.__esModule ? i : {
        default: i
    }).default);
    t.default = a
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = l(n(397))
      , o = l(n(370))
      , a = n(2)
      , s = l(n(446));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function u(e, t) {
        if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function")
    }
    var c = function() {
        function e(t, n, i) {
            u(this, e),
            this._Stage = t,
            this._MeshEditor = n,
            this._Vertices = i,
            this._AccumMove = a.vec2.create()
        }
        return i(e, [{
            key: "advance",
            value: function(e, t, n, i) {
                e = a.vec2.add(a.vec2.create(), this._MeshEditor.getLocalMove(t), this._AccumMove);
                for (var r = a.vec2.create(), o = 0, s = 0, l = 0; l < this._Vertices.length; l++) {
                    var u = this._Vertices[l];
                    a.vec2.add(r, u.position, e);
                    var c = this._MeshEditor.constrainLocal(r)
                      , d = c[0] - r[0]
                      , h = c[1] - r[1];
                    Math.abs(d) > Math.abs(o) && (o = d),
                    Math.abs(h) > Math.abs(s) && (s = h)
                }
                for (var f = new Array(this._Vertices.length), p = a.vec2.set(a.vec2.create(), e[0] + o, e[1] + s), y = 0; y < this._Vertices.length; y++) {
                    var m = this._Vertices[y];
                    f[y] = a.vec2.clone(m.position),
                    m.position = a.vec2.add(r, m.position, p)
                }
                if (this._MeshEditor.doesAnyEdgeIntersect()) {
                    for (var v = 0; v < this._Vertices.length; v++) {
                        this._Vertices[v].position = f[v]
                    }
                    return this._AccumMove[0] = e[0],
                    void (this._AccumMove[1] = e[1])
                }
                this._AccumMove[0] = -o,
                this._AccumMove[1] = -s,
                this._MeshEditor.markMeshDirty()
            }
        }, {
            key: "complete",
            value: function() {}
        }]),
        e
    }();
    t.default = c;
    var d = function() {
        function e(t, n) {
            u(this, e),
            this._Stage = t,
            this._Vertices = n
        }
        return i(e, [{
            key: "advance",
            value: function(e, t, n, i) {
                for (var r = a.vec2.create(), o = 0; o < this._Vertices.length; o++) {
                    var s = this._Vertices[o];
                    s.deformWorld = a.vec2.add(r, s.worldPosition, t)
                }
            }
        }, {
            key: "complete",
            value: function() {}
        }]),
        e
    }();
    c.make = function(e, t) {
        for (var n = [], i = [], a = 0; a < t.length; a++) {
            var l = t[a];
            switch (l.constructor) {
            case r.default:
                var u = l.vtxA;
                if (u.isDeformer) {
                    -1 === i.indexOf(u) && i.push(u),
                    u = l.vtxB,
                    -1 === i.indexOf(u) && i.push(u);
                    continue
                }
                -1 === n.indexOf(u) && n.push(u),
                u = l.vtxB,
                -1 === n.indexOf(u) && n.push(u);
                break;
            case o.default:
                if (l.isDeformer) {
                    i.push(l);
                    continue
                }
                n.push(l)
            }
        }
        return 0 != n.length ? new c(e.stage,e.stage.soloItem.meshEditor,n) : 0 != i.length ? (e.suppressTransformer(s.default),
        new d(e.stage,i)) : void 0
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }
      , o = c(n(313))
      , a = c(n(243))
      , s = c(n(201))
      , l = c(n(698))
      , u = c(n(184));
    function c(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var d = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n._Parent = null,
            n._Alert = null,
            n._LastToolType = null,
            n._SelectedChildren = [],
            n._MadeNotSectable = [],
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "makeSelectableAgain",
            value: function() {
                for (var e = 0; e < this._MadeNotSectable.length; e++)
                    this._MadeNotSectable[e].isSelectable = true;
                this._MadeNotSectable.length = 0
            }
        }, {
            key: "cancel",
            value: function() {
                this._Parent && this.makeSelectableAgain(),
                this._SelectedChildren.length ? (this._SelectedChildren.length = 0,
                this.stage.clearSelections()) : (this.stage.clearSelections(),
                this.stage.toolType = this._LastToolType)
            }
        }, {
            key: "updateSelection",
            value: function(e) {
                this._SelectedChildren.length = 0;
                for (var t = 0; t < e.length; t++) {
                    var n = e[t];
                    switch (n.constructor) {
                    case s.default:
                    case a.default:
                        continue
                    }
                    n.node && n.node !== this._Parent.node && this._SelectedChildren.push(n.node)
                }
                var i = this._SelectedChildren.length > 0;
                this._Alert.enableButton(1, i),
                this._Alert.accentButton(1, i)
            }
        }, {
            key: "close",
            value: function() {
                this.stage.toolType = this._LastToolType
            }
        }, {
            key: "enable",
            value: function() {
                this._LastToolType = this.stage.toolType,
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "enable", this).call(this),
                this.stage.clearSelections();
                for (var e = this.stage.stageItems, n = 0; n < e.length; n++) {
                    var i = e[n];
                    i.node && i.node != this._Parent.node && i.constructor !== a.default || (e.splice(n, 1),
                    n--)
                }
                var o = this;
                this._Alert = this.stage.appContext.alert({
                    title: "Pick Children",
                    message: "Pick the children for " + this._Parent.node.name + ".",
                    type: u.default.Types.State,
                    buttons: [{
                        label: "CANCEL",
                        action: function(e, t) {
                            o.cancel(),
                            o.stage.toolType = o._LastToolType
                        }
                    }, {
                        label: "DONE",
                        isDisabled: true,
                        action: function(e, t) {
                            o.close()
                        }
                    }]
                })
            }
        }, {
            key: "validate",
            value: function() {
                if (this.stage.appContext.editingAnimation)
                    return false;
                var e = this.stage.selectedItems;
                if (!e.length || !e[0].node || !e[0].node.isNode)
                    return false;
                var t = this.stage.stageItems;
                this._Parent = e[0];
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i !== this._Parent && i.constructor !== a.default || -1 !== this._MadeNotSectable.indexOf(i) || !i.isSelectable || (this._MadeNotSectable.push(i),
                    i.isSelectable = false)
                }
                if (this._Parent.node && this._Parent.node.stageItem) {
                    var r = this._Parent.node.stageItem;
                    -1 === this._MadeNotSectable.indexOf(r) && r.isSelectable && (this._MadeNotSectable.push(r),
                    r.isSelectable = false)
                }
                return true
            }
        }, {
            key: "disable",
            value: function() {
                if (this._Alert.hide(),
                r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "disable", this).call(this),
                this._Parent) {
                    if (this.makeSelectableAgain(),
                    this._SelectedChildren.length) {
                        "Bone" === this._Parent.node.name && (this._Parent.node.name = (this._SelectedChildren[0].name || "Item") + " Bone");
                        var e = new l.default(this.stage,this.stage.appContext.actor,this._SelectedChildren,this._Parent.node);
                        e.silent = false,
                        e.start(),
                        e.end(),
                        this._SelectedChildren.length = 0
                    }
                    this.stage.selectItem(this._Parent)
                }
            }
        }, {
            key: "click",
            value: function(e) {}
        }]),
        t
    }(o.default);
    t.default = d
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = a(n(314))
      , r = a(n(237))
      , o = a(n(315));
    function a(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var s = function(e) {
        function t(e, n, i, a) {
            if (function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t),
            null === a)
                throw new Error("Parent should never be null.");
            var s = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e, n))
              , l = true
              , u = false
              , c = void 0;
            try {
                for (var d, h = i[Symbol.iterator](); !(l = (d = h.next()).done); l = true) {
                    var f = d.value;
                    if (f.isValidParent(a) && (f.parent !== a && f !== a)) {
                        if (a.isChildOf(f))
                            if (a.constructor === r.default) {
                                for (var p = a.parent; p && p.constructor !== o.default; )
                                    p = p.parent;
                                p && p.constructor === o.default && (f.parent.add(p),
                                p.compensate())
                            } else
                                f.parent.add(a),
                                a.compensate();
                        a.add(f),
                        f.isNode && f.compensate()
                    }
                }
            } catch (e) {
                u = true,
                c = e
            } finally {
                try {
                    !l && h.return && h.return()
                } finally {
                    if (u)
                        throw c
                }
            }
            return s
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        t
    }(i.default);
    t.default = s
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = d(n(203)), a = n(2), s = d(n(1)), l = d(n(444)), u = d(n(509)), c = d(n(3));
    function d(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var h, f, p, y, m, v, g = [1, 1, 1, .8], _ = [1, 1, 1, .2], b = [1, 1, 1, 1], w = (i = function(e) {
        function t() {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var e = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, null));
            return e.drawAfterSelections = true,
            e.isHandle = true,
            e.hitDetectOnMesh = false,
            e.isSelectable = false,
            e._VertexBuffer = null,
            e._IndexBuffer = null,
            e._IsInEditingPosition = false,
            e._ResetEditingPosition = false,
            e._Feather = 50,
            e._Strength = 1,
            e._Size = 100,
            e._Recalculate = true,
            e._InnerRadius = e._Size - e._Feather,
            e._InnerLine,
            e._OuterLine,
            e._ShadowTexture,
            e._InnerShadowVB,
            e._InnerShadowIB,
            e._Mode = t.Mode.Add,
            e._Influence = null,
            e._IsWaitingForVerts = false,
            e
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "customHitDetect",
            value: function(e, t) {
                return false
            }
        }, {
            key: "makeBrush",
            value: function(e) {
                var t = this._InnerRadius
                  , n = this._Size
                  , i = []
                  , r = []
                  , o = []
                  , a = [];
                if (t > 0) {
                    for (var s = Math.round(10 * Math.sqrt(t)), u = 2 * Math.PI / s, c = 0, d = 2 * s, h = 0, f = 0; f < s; f++) {
                        var p = Math.cos(c)
                          , y = Math.sin(c)
                          , m = p * t
                          , v = y * t;
                        i.push([m, v]);
                        var g = Math.max(0, t - 5)
                          , _ = t + 5;
                        r.push(p * g, y * g, .0625, 0),
                        r.push(p * _, y * _, 1, 0),
                        o.push(h, h + 1, (h + 3) % d),
                        o.push(h, (h + 3) % d, (h + 2) % d),
                        h += 2,
                        c += u
                    }
                    i.length ? (this._InnerLine = e.makeThickLine(i, true),
                    this._InnerShadowVB ? (this._InnerShadowVB.update(r),
                    this._InnerShadowIB.update(o)) : (this._InnerShadowVB = e.makeVertexBuffer(r),
                    this._InnerShadowIB = e.makeIndexBuffer(o))) : this._InnerLine = null
                } else
                    this._InnerLine = null;
                if (t !== n) {
                    for (var b = Math.round(10 * Math.sqrt(n)), w = 2 * Math.PI / b, O = 0, S = 0; S < b; S++) {
                        var k = Math.cos(O) * n
                          , P = Math.sin(O) * n;
                        a.push([k, P]),
                        O += w
                    }
                    a.length ? this._OuterLine = e.makeThickLine(a, true) : this._OuterLine = null
                } else
                    this._OuterLine = null;
                if (!this._ShadowTexture) {
                    for (var E = new Uint8Array(64), T = 0, C = 0; C < 16; C++)
                        E[T++] = 0,
                        E[T++] = 0,
                        E[T++] = 0,
                        E[T++] = Math.round(255 * Math.pow(1 - Math.abs(1 - C / 8), 3) * .3);
                    this._ShadowTexture = e.loadBitmapTexture({
                        width: 16,
                        height: 1,
                        bytes: E,
                        channels: 4
                    }, l.default.ClampToEdge)
                }
            }
        }, {
            key: "draw",
            value: function(e, t) {
                this._Recalculate && (this.makeBrush(e),
                this._Recalculate = false);
                var n = this.renderViewTransform;
                if (this._IsInEditingPosition) {
                    var i = this.stage;
                    if (this._ResetEditingPosition && i.isMouseOver)
                        this._IsInEditingPosition = false,
                        this._ResetEditingPosition = false;
                    else {
                        var r = a.mat2d.clone(i.viewTransform)
                          , s = a.mat2d.invert(r, r)
                          , l = i.getVisibleStageArea()
                          , u = a.vec2.transformMat2d(a.vec2.create(), [l.left + this._Size * i.scale, l.height - this._Size * i.scale], s);
                        n = a.mat2d.mul(o.default._RenderViewTransform, i.viewTransform, a.mat2d.fromTranslation(a.mat2d.create(), u))
                    }
                }
                if (this._InnerLine && (e.drawTextured(n, this._InnerShadowVB, this._InnerShadowIB, Math.min(1, Math.max(.25, 1 / this.stage.scale)), b, this._ShadowTexture),
                e.drawThickLine(n, this._InnerLine, 1 / this.stage.scale, 1, g)),
                this._OuterLine && e.drawThickLine(n, this._OuterLine, 1 / this.stage.scale, 1, _),
                this._Influence) {
                    e.enableNormalBlending();
                    var c = this.stage.appContext.editingWeights;
                    if (c)
                        for (var d = a.mat2d.create(), h = this.stage, f = h.viewTransform, p = 1 / h.scale, y = a.mat2d.fromScaling(a.mat2d.create(), [p, p]), m = this.stageContext, v = c.verts, w = c.showDeformed ? null : c.node.worldTransform, O = this._Influence.index, S = this._Influence.weights, k = m.vertexTargetImage, P = a.vec2.create(), E = 0; E < O.length; E++) {
                            var T = 4 * O[E]
                              , C = v[T]
                              , x = v[T + 1] - 2 * p;
                            w ? a.vec2.transformMat2d(P, [C, x], w) : (P[0] = C,
                            P[1] = x);
                            var I = a.mat2d.fromTranslation(d, P);
                            a.mat2d.mul(I, I, y);
                            var D = a.mat2d.mul(d, f, I);
                            e.drawTextured(D, m.vertexBuffer, m.indexBuffer, Math.min(1, .9 * S[E] + .1), b, k, true)
                        }
                }
            }
        }, {
            key: "updateWeightedVertices",
            value: function() {
                if (!this._IsWaitingForVerts)
                    if (this.stage) {
                        var e = this.position;
                        if (this.stage.appContext.editingWeights) {
                            var t = this;
                            this._IsWaitingForVerts = true,
                            u.default.call("fbv", [e[0], e[1], this._InnerRadius, this._Size], (function(e) {
                                t._IsWaitingForVerts = false,
                                t._Influence = e,
                                t.stage && t.stage.redraw()
                            }
                            ))
                        }
                    } else {
                        var n = new Error;
                        console.log("TRYING TO PAINT WHERE WE SHOULDN'T", n.stack)
                    }
            }
        }, {
            key: "influence",
            get: function() {
                return this._Influence
            }
        }, {
            key: "position",
            get: function() {
                return a.mat2d.getTranslation(a.vec2.create(), this.renderTransform)
            },
            set: function(e) {
                this._IsWaitingForVerts || (this.renderTransform = a.mat2d.fromTranslation(a.mat2d.create(), e),
                this.updateWeightedVertices())
            }
        }, {
            key: "mode",
            get: function() {
                return this._Mode
            },
            set: function(e) {
                this._Mode != e && (this._Mode = e)
            }
        }, {
            key: "size",
            get: function() {
                return this._Size
            },
            set: function(e) {
                this._Size != e && (this._Size = Math.max(0, e),
                this._InnerRadius = Math.max(0, Math.min(this._Size, this._Size - this._Feather)),
                this._Recalculate = true,
                this.stage && this.stage.redraw())
            }
        }, {
            key: "isInEditingPosition",
            get: function() {
                return this._IsInEditingPosition
            },
            set: function(e) {
                this._IsInEditingPosition != e && (e ? (this._ResetEditingPosition = false,
                this._IsInEditingPosition = e) : this._ResetEditingPosition = true,
                this.stage && this.stage.redraw())
            }
        }, {
            key: "feather",
            get: function() {
                return this._Feather
            },
            set: function(e) {
                this._Feather != e && (this._Feather = Math.max(0, Math.min(this._Size, e)),
                this._InnerRadius = Math.max(0, Math.min(this._Size, this._Size - this._Feather)),
                this._Recalculate = true,
                this.stage && this.stage.redraw())
            }
        }, {
            key: "strength",
            get: function() {
                return this._Strength
            },
            set: function(e) {
                e = Math.min(1, Math.max(0, e)),
                this._Strength != e && (this._Strength = e)
            }
        }]),
        t
    }(o.default),
    h = i.prototype,
    f = "updateWeightedVertices",
    p = [s.default],
    y = Object.getOwnPropertyDescriptor(i.prototype, "updateWeightedVertices"),
    m = i.prototype,
    v = {},
    Object.keys(y).forEach((function(e) {
        v[e] = y[e]
    }
    )),
    v.enumerable = !!v.enumerable,
    v.configurable = !!v.configurable,
    ("value"in v || v.initializer) && (v.writable = true),
    v = p.slice().reverse().reduce((function(e, t) {
        return t(h, f, e) || e
    }
    ), v),
    m && void 0 !== v.initializer && (v.value = v.initializer ? v.initializer.call(m) : void 0,
    v.initializer = void 0),
    void 0 === v.initializer && (Object.defineProperty(h, f, v),
    v = null),
    i);
    t.default = w,
    w.initializeStageContext = function(e, t) {
        t.vertexTargetImage = e.loadTexture(c.default.make("/images/vertex_paint_target.png"), l.default.MultiplyAlpha);
        var n = [-8.5, -8.5, 0, 1, 8.5, -8.5, 1, 1, 8.5, 8.5, 1, 0, -8.5, 8.5, 0, 0]
          , i = [-8.5, -8.5, 8.5, -8.5, 8.5, 8.5, -8.5, 8.5]
          , r = [0, 1, 2, 2, 3, 0];
        t.vertexBuffer = e.makeVertexBuffer(n),
        t.cVertexBuffer = e.makeVertexBuffer(i),
        t.indexBuffer = e.makeIndexBuffer(r),
        t.points = n,
        t.index = r
    }
    ,
    w.Mode = {
        Add: 0,
        Subtract: 1
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = n(203), a = (i = o) && i.__esModule ? i : {
        default: i
    }, s = n(2);
    var l = function(e) {
        function t() {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var e = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this));
            return e.drawAfterSelections = true,
            e.isHandle = true,
            e.hitDetectOnMesh = false,
            e.isSelectable = true,
            e._Color = [1, 0, 0, 1],
            e._HoverColor = [1, 1, 0, 1],
            e
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "onAddedToStage",
            value: function(e) {
                this.setMesh(this.stageContext.points, 2, this.stageContext.index)
            }
        }, {
            key: "alignToTransform",
            value: function(e, t) {
                if (this.stage)
                    if (e === t) {
                        var n = s.vec2.create()
                          , i = s.mat2d.decompose(n, e)
                          , r = s.mat2d.fromRotation(s.mat2d.create(), i);
                        r[4] = e[4],
                        r[5] = e[5];
                        var o = 1 / this.stage.scale
                          , a = s.mat2d.fromScaling(s.mat2d.create(), [o * Math.sign(n[0]), o * Math.sign(n[1])])
                          , l = this.rotationTransform;
                        l && s.mat2d.mul(a, l, a),
                        this.renderTransform = s.mat2d.mul(s.mat2d.create(), r, a)
                    } else {
                        var u = s.mat2d.fromRotation(s.mat2d.create(), s.mat2d.getRotation(t));
                        u[4] = e[4],
                        u[5] = e[5];
                        var c = 1 / this.stage.scale
                          , d = s.mat2d.fromScaling(s.mat2d.create(), [c, c])
                          , h = this.rotationTransform;
                        h && s.mat2d.mul(d, h, d),
                        this.renderTransform = s.mat2d.mul(s.mat2d.create(), u, d)
                    }
            }
        }, {
            key: "draw",
            value: function(e, t) {
                var n = this.renderViewTransform
                  , i = this.stageContext;
                e.drawColor(n, i.vertexBuffer, i.indexBuffer, 1, t ? this._HoverColor : this._Color)
            }
        }, {
            key: "color",
            get: function() {
                return this._Color
            },
            set: function(e) {
                s.vec4.copy(this._Color, e)
            }
        }, {
            key: "hoverColor",
            get: function() {
                return this._HoverColor
            },
            set: function(e) {
                s.vec4.copy(this._HoverColor, e)
            }
        }]),
        t
    }(a.default);
    t.default = l,
    l.initializeStageContext = function(e, t) {
        var n = [-5, 100, 5, 100, 0, 107, -.6, 100, .6, 100, -.6, 0, .6, 0]
          , i = [0, 1, 2, 3, 4, 5, 4, 6, 5];
        t.vertexBuffer = e.makeVertexBuffer(n),
        t.indexBuffer = e.makeIndexBuffer(i),
        t.points = n,
        t.index = i
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = n(2)
      , o = h(n(267))
      , a = h(n(237))
      , s = h(n(208))
      , l = h(n(315))
      , u = h(n(243))
      , c = h(n(261))
      , d = h(n(11));
    function h(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var f = function() {
        function e(t, n, i, r, o) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e),
            this._Modulation = t,
            this._CompensateBones = n,
            this._CompensateImages = i,
            this._ActorNodes = r,
            this._TransformSpace = o;
            for (var a = r.slice(0), s = 0; s < a.length; s++)
                for (var l = a[s]; l.parent; ) {
                    if (-1 != a.indexOf(l.parent)) {
                        a.splice(s, 1),
                        s--;
                        break
                    }
                    l = l.parent
                }
            this._TopActorNodes = a
        }
        return i(e, [{
            key: "advance",
            value: function(e, t) {
                var n = .001 * (t[0] + t[1])
                  , i = void 0
                  , c = void 0
                  , h = void 0
                  , f = void 0
                  , p = this;
                if (this._TransformSpace) {
                    if (i = r.mat2d.create(),
                    !(c = r.mat2d.invert(r.mat2d.create(), this._TransformSpace)))
                        return void d.default.warn("Failed to invert transform space", this._TransformSpace);
                    if (h = r.mat2d.copy(r.mat2d.create(), this._TransformSpace),
                    1 === this._Modulation[0] && 1 === this._Modulation[1])
                        f = r.mat2d.fromScaling(r.mat2d.create(), [1 + n * this._Modulation[0], 1 + n * this._Modulation[1]]);
                    else {
                        var y = r.vec2.transformMat2(r.vec2.create(), t, c);
                        f = r.mat2d.fromScaling(r.mat2d.create(), [1 + .001 * y[0] * this._Modulation[0], 1 + .001 * y[1] * this._Modulation[1]])
                    }
                }
                for (var m = 0; m < this._TopActorNodes.length; m++) {
                    var v = this._TopActorNodes[m]
                      , g = void 0;
                    if (v.constructor === o.default && v.isConnectedToBones && (g = r.mat2d.clone(v.worldTransform)),
                    this._TransformSpace)
                        if (r.mat2d.mul(i, c, v.worldTransform),
                        r.mat2d.mul(i, f, i),
                        r.mat2d.mul(i, h, i),
                        v.hasWorldTransformOverride)
                            v.overrideWorldTransform = i;
                        else {
                            var _ = r.mat2d.invert(r.mat2d.create(), v.parent.worldTransform);
                            r.mat2d.mul(i, _, i);
                            var b = r.vec2.create();
                            v.rotation = r.mat2d.decompose(b, i),
                            v.scale = b,
                            v.translation = r.mat2d.getTranslation(r.vec2.create(), i)
                        }
                    else
                        v.scale = r.vec2.add(r.vec2.create(), v.scale, [n * this._Modulation[0], n * this._Modulation[1]]);
                    if (v.constructor === o.default && v.isConnectedToBones && (v.compensateConnectedBones(g),
                    v.overrideWorldTransform = g),
                    !this._CompensateImages || v.constructor !== a.default && v.constructor !== l.default || v.all((function(e) {
                        e.constructor !== a.default && e.constructor !== l.default || u.default.compensateSkinnedImages(e)
                    }
                    )),
                    v.constructor === a.default && this._CompensateBones)
                        for (var w = v.stageItem.joint, O = 0; O < w.children.length; O++) {
                            var S = w.children[O];
                            u.default.alignChain(S.joint)
                        }
                    (this._CompensateImages || this._CompensateBones) && function() {
                        var e = [];
                        if (v.eachChildRecursive((function(t) {
                            (p._CompensateImages && t.constructor === o.default || p._CompensateBones && (t.constructor === a.default || t.constructor === s.default)) && -1 == e.indexOf(t) && e.push(t)
                        }
                        )),
                        e.length)
                            for (var t = 0; t < e.length; t++) {
                                e[t].compensate()
                            }
                    }()
                }
            }
        }, {
            key: "complete",
            value: function() {}
        }]),
        e
    }();
    t.default = f,
    f.make = function(e, t) {
        for (var n = [], i = 0; i < t.length; i++) {
            var r = t[i];
            if (r.node && (r.constructor !== c.default || !r.node.isConnectedToBones || !e.stage.appContext.editingAnimation))
                if (r.constructor === u.default)
                    for (var o = 0; o < r.children.length; o++) {
                        var a = r.children[o];
                        -1 == n.indexOf(a.node) && n.push(a.node)
                    }
                else
                    -1 == n.indexOf(r.node) && n.push(r.node)
        }
        if (0 != n.length)
            return new f(e.snap ? [1, 1] : e.modulation,e.stage.settings.compensateBones,e.stage.settings.compensateImages,n,e.transformSpace)
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = E(n(0)), a = E(n(1)), s = E(n(4)), l = E(n(171)), u = E(n(1099)), c = E(n(310)), d = E(n(347)), h = E(n(465)), f = E(n(197)), p = E(n(595)), y = E(n(594)), m = n(393), v = E(n(703)), g = n(2), _ = n(469), b = E(n(1110)), w = E(n(359)), O = E(n(184)), S = E(n(316)), k = E(n(342)), P = E(n(3));
    function E(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function T(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var C = (0,
    _.SortableElement)((function(e) {
        var t = e.value
          , n = e.selectedAnimation
          , i = e.checkedAnimations
          , r = e.firstAnimation
          , a = e.toggleExportAnimation
          , s = e.selectAnimation
          , l = e.isSorting;
        return o.default.createElement(u.default, {
            data: t,
            isSelectable: true,
            value: i.has(t),
            label: t.name,
            isSelected: t === n,
            onSelected: s,
            onValueChange: a,
            isCover: !l && t === r
        })
    }
    ))
      , x = (0,
    _.SortableContainer)((function(e) {
        var t = e.items
          , n = e.checkedAnimations
          , i = e.firstAnimation
          , r = e.selectedAnimation
          , a = e.selectAnimation
          , s = e.toggleExportAnimation
          , l = e.isSorting;
        return o.default.createElement("ul", null, t.map((function(e, t) {
            return o.default.createElement(C, {
                key: t,
                index: t,
                value: e,
                checkedAnimations: n,
                firstAnimation: i,
                selectedAnimation: r,
                toggleExportAnimation: s,
                selectAnimation: a,
                isSorting: l
            })
        }
        )))
    }
    ))
      , I = (T((i = function(e) {
        function t(e, n) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var i = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e))
              , r = i._Preferences = n.nima.getPreference("modal") || {};
            return i.state = {
                allowFork: r.allowfork || false,
                animationPosition: 0,
                animations: [],
                backgroundColor: r.bgclr ? new Uint8Array(r.bgclr) : new Uint8Array([102, 102, 102]),
                canPublish: false,
                coverPosition: r.cover || 0,
                exportAnimations: new Set,
                isLoading: true,
                isModalClosing: false,
                isModalOpen: false,
                isPaused: true,
                isPublishing: false,
                isSorting: false,
                licenseOptions: [],
                selectedAnimation: null,
                selectedLicenseIndex: r.license || 0,
                shareSource: r.sharesource || false,
                showGuides: false,
                showPanTip: false,
                title: r.title || "",
                zoom: r.zoom || 1
            },
            i._ActorData = null,
            i._RuntimeGraphics = null,
            i._RuntimeGraphicsExtension = null,
            i._RuntimeActor = null,
            i._ActorInstance = null,
            i._ActorAnimation = null,
            i._ViewTransform = g.mat2d.create(),
            i._RuntimeAnimationIndex = -1,
            i._RuntimeAnimation = null,
            i._AnimationTime = 0,
            i._LastAdvanceTime = Date.now(),
            i._ViewOffsetX = 0,
            i._ViewOffsetY = 0,
            i._ViewScale = 1,
            i._TargetViewOffsetX = 0,
            i._TargetViewOffsetY = 0,
            i._TargetViewScale = 1,
            i._ScreenScale = 1,
            i._LastMouseX = 0,
            i._LastMouseY = 0,
            i._ShowGuides = false,
            i._OverrideAnimationPosition = null,
            i._ForceRender = false,
            i._IsRendering = false,
            i._RenderCapture = [],
            i._LastBackgroundColor = new Uint8Array([0, 0, 0]),
            i._PreferencesTimeout = null,
            i
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "componentWillMount",
            value: function() {
                var e = []
                  , t = true
                  , n = false
                  , i = void 0;
                try {
                    for (var r, o = k.default.all[Symbol.iterator](); !(t = (r = o.next()).done); t = true) {
                        var a = r.value;
                        "CC BY" !== a[0] ? e.push({
                            label: a[1].label,
                            hoverTitle: a[1].title,
                            hoverDesc: a[1].description,
                            hoverIcon: a[1].iconsString,
                            value: true,
                            active: false
                        }) : e.push({
                            label: a[1].label,
                            hoverTitle: a[1].title,
                            hoverDesc: a[1].description,
                            hoverIcon: a[1].iconsString,
                            value: false,
                            active: true
                        })
                    }
                } catch (e) {
                    n = true,
                    i = e
                } finally {
                    try {
                        !t && o.return && o.return()
                    } finally {
                        if (n)
                            throw i
                    }
                }
                this.setState({
                    licenseOptions: e
                })
            }
        }, {
            key: "componentDidMount",
            value: function() {
                this.openModal(),
                this.context.nima.setCancelCallback(this.closeModal)
            }
        }, {
            key: "componentDidUpdate",
            value: function() {
                this.updateCanPublish()
            }
        }, {
            key: "updateCanPublish",
            value: function() {
                var e = this.props.verified && this.state.exportAnimations.size > 0 && null !== this._RuntimeActor && this.state.title.length > 2 && !this.body.wasEmpty;
                this.state.canPublish !== e && this.setState({
                    canPublish: e
                })
            }
        }, {
            key: "onBodyPopulated",
            value: function(e) {
                this.updateCanPublish();
                var t = this.body.serialize();
                this.savePreference("body", t)
            }
        }, {
            key: "hideGuides",
            value: function() {
                this.showGuides(false, false)
            }
        }, {
            key: "scheduleHideGuides",
            value: function(e) {
                clearTimeout(this._GuidesTimeout),
                this._GuidesTimeout = setTimeout(this.hideGuides, e || 1e3)
            }
        }, {
            key: "showGuides",
            value: function(e, t) {
                clearTimeout(this._GuidesTimeout),
                t && this.scheduleHideGuides(),
                this._ShowGuides !== e && (this.setState({
                    showGuides: e
                }),
                this._ShowGuides = e)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                window.removeEventListener("focus", this.startRenderLoop),
                window.removeEventListener("mousemove", this.pan, true),
                window.removeEventListener("mouseup", this.stopPan, true),
                window.removeEventListener("mousemove", this.dragCover, true),
                window.removeEventListener("mouseup", this.stopDragCover, true),
                window.removeEventListener("mousemove", this.dragPlayhead, true),
                window.removeEventListener("mouseup", this.stopDragPlayhead, true),
                this._ActorData = null,
                this.context.nima.clearCancelCallback(this.closeModal),
                this.disposeRuntime(),
                clearTimeout(this.loadTimeout)
            }
        }, {
            key: "savePreference",
            value: function(e, t) {
                var n = this.context.nima
                  , i = this._Preferences;
                i[e] = t,
                clearTimeout(this._PreferencesTimeout),
                this._PreferencesTimeout = setTimeout((function() {
                    n.setCharacterPreference("modal", i)
                }
                ), 750)
            }
        }, {
            key: "clearPreferences",
            value: function() {
                this.context.nima.setCharacterPreference("modal", {})
            }
        }, {
            key: "disposeRuntime",
            value: function() {
                this._ActorInstance && (this._ActorInstance.dispose(this._RuntimeGraphics),
                this._ActorInstance = null),
                this._RuntimeActor && (this._RuntimeActor.dispose(this._RuntimeGraphics),
                this._RuntimeActor = null),
                this._RuntimeGraphics && (this._RuntimeGraphics.dispose(),
                this._RuntimeGraphics = null),
                this.RuntimeGraphicsExtension && (this._RuntimeGraphicsExtension.dispose(),
                this._RuntimeGraphicsExtension = null)
            }
        }, {
            key: "initRuntime",
            value: function() {
                if (this.disposeRuntime(),
                this.canvas && this._ActorData) {
                    this._RuntimeGraphicsExtension = new b.default(this.canvas),
                    this._RuntimeGraphics = new m.Graphics(this._RuntimeGraphicsExtension.gl);
                    var e = new m.ActorLoader
                      , t = this;
                    e.load(this._ActorData, (function(e) {
                        if (t._RuntimeGraphics)
                            if (e) {
                                t._RuntimeActor = e,
                                t._RuntimeActor.initialize(t._RuntimeGraphics),
                                t._ActorInstance = t._RuntimeActor.makeInstance(),
                                t._ActorInstance.initialize(t._RuntimeGraphics),
                                t._ActorInstance.advance(1);
                                var n = t._ActorInstance.computeAABB()
                                  , i = n[2] - n[0] || 540
                                  , r = n[3] - n[1] || 303
                                  , o = n[0] + .5 * i
                                  , a = n[1] + .5 * r;
                                t._RuntimeGraphics.setSize(540, 303);
                                var s = Math.min(540 / i, 303 / r)
                                  , l = t._Preferences;
                                t._TargetViewScale = l.zoom || s,
                                t._TargetViewOffsetX = l.offsetx || -o * s + 270,
                                t._TargetViewOffsetY = l.offsety || -a * s + 151.5,
                                t._ViewOffsetX = t._TargetViewOffsetX,
                                t._ViewOffsetY = t._TargetViewOffsetY,
                                t._ViewScale = 2 * s,
                                t.setState({
                                    isLoading: false,
                                    isPaused: false,
                                    showPanTip: true,
                                    zoom: t._TargetViewScale
                                }),
                                t.startRenderLoop()
                            } else
                                console.log("FAILED TO LOAD RUNTIME ACTOR")
                    }
                    ))
                }
            }
        }, {
            key: "startRenderLoop",
            value: function() {
                this._IsRendering || (this._LastAdvanceTime = Date.now(),
                window.removeEventListener("focus", this.startRenderLoop),
                window.addEventListener("focus", this.startRenderLoop),
                window.requestAnimationFrame(this.advance),
                this._IsRendering = true)
            }
        }, {
            key: "togglePause",
            value: function() {
                this.state.isPaused ? (this.setState({
                    isPaused: false
                }),
                this.startRenderLoop()) : this.setState({
                    isPaused: true
                })
            }
        }, {
            key: "advance",
            value: function() {
                var e = this._RuntimeGraphics;
                if (document.hasFocus() && e && this._ActorInstance) {
                    var t = Date.now()
                      , n = (t - this._LastAdvanceTime) / 1e3;
                    this._LastAdvanceTime = t;
                    var i = this._TargetViewScale - this._ViewScale
                      , r = this._TargetViewOffsetX - this._ViewOffsetX
                      , o = this._TargetViewOffsetY - this._ViewOffsetY
                      , a = Math.min(1, 15 * n)
                      , s = false;
                    Math.abs(i) > 1e-5 && (s = true,
                    i *= a),
                    Math.abs(r) > .01 && (s = true,
                    r *= a),
                    Math.abs(o) > .01 && (s = true,
                    o *= a);
                    var l = this.context.nima.actor.animations
                      , u = l.indexOf(this.state.selectedAnimation)
                      , c = this.state.backgroundColor
                      , d = this.state.isPaused;
                    if (!g.vec3.exactEquals(this._LastBackgroundColor, c) || 0 !== this._RenderCapture.length || !d || s || this._ForceRender || u !== this._RuntimeAnimationIndex) {
                        g.vec3.copy(this._LastBackgroundColor, c);
                        var h = void 0
                          , f = this._RenderCapture.length && this._RenderCapture.splice(0, 1)[0]
                          , p = this._OverrideAnimationPosition;
                        if (f ? (this._RuntimeGraphicsExtension.bindOffscreenFrameBuffer(e, f.width, f.height),
                        h = f.viewTransform,
                        u = l.indexOf(f.animation),
                        this._OverrideAnimationPosition = f.animationPosition) : (this._ViewOffsetX += r,
                        this._ViewOffsetY += o,
                        this._ViewScale += i,
                        (h = this._ViewTransform)[0] = this._ViewScale,
                        h[3] = this._ViewScale,
                        h[4] = this._ViewOffsetX,
                        h[5] = this._ViewOffsetY),
                        u !== this._RuntimeAnimationIndex && (this._ActorInstance && this._ActorInstance.dispose(e),
                        this._ActorInstance = this._RuntimeActor.makeInstance(),
                        this._ActorInstance.initialize(e),
                        u < this._ActorInstance._Animations.length && (this._RuntimeAnimationIndex = u,
                        this._RuntimeAnimation = this._ActorInstance._Animations[u],
                        this._AnimationTime = 0)),
                        this._ShowGuides && (n *= .15),
                        this._RuntimeAnimation) {
                            var y = void 0;
                            null !== this._OverrideAnimationPosition ? y = this._OverrideAnimationPosition * this._RuntimeAnimation._Duration : (d ? y = this._AnimationTime : (this._AnimationTime += n,
                            y = this._AnimationTime = this._AnimationTime % this._RuntimeAnimation._Duration),
                            this.setState({
                                animationPosition: y / this._RuntimeAnimation._Duration
                            })),
                            this._RuntimeAnimation.apply(y, this._ActorInstance, 1)
                        }
                        if (this._ActorInstance && this._ActorInstance.advance(n),
                        e.clear([c[0] / 255, c[1] / 255, c[2] / 255, 1]),
                        e.setView(h),
                        this._ActorInstance && this._ActorInstance.draw(e),
                        f) {
                            var m = this._RuntimeGraphicsExtension.unbindOffscreenFrameBuffer();
                            this._OverrideAnimationPosition = p,
                            f.complete(f, m),
                            this.advance()
                        } else
                            window.requestAnimationFrame(this.advance)
                    } else
                        this._IsRendering = false
                } else
                    this._IsRendering = false
            }
        }, {
            key: "loadActor",
            value: function() {
                var e = this.context.nima.actor;
                if (e.isLoadingBitmaps)
                    e.isMissingBitmaps ? this.context.nima.alert({
                        title: "Missing Images",
                        message: "You cannot export a shot with missing images."
                    }) : this.loadTimeout = setTimeout(this.loadActor, 1e3);
                else {
                    var t = e.animations
                      , n = new v.default({
                        writerFormat: "Binary",
                        animations: t,
                        atlasPadding: 2,
                        atlasPowerOfTwo: true,
                        atlasSquare: false,
                        cropAnimationsToWorkArea: true,
                        cropImages: true,
                        isZipExport: false,
                        maxAtlasHeight: 2048,
                        maxAtlasWidth: 2048,
                        maxImageHeight: 1024,
                        maxImageWidth: 1024
                    })
                      , i = this;
                    n.export(e, (function(e) {
                        i._ActorData = e,
                        i.initRuntime()
                    }
                    ))
                }
            }
        }, {
            key: "openModal",
            value: function() {
                var e = this._Preferences
                  , t = this.context.nima.actor
                  , n = t.animations.slice(0)
                  , i = t.animations.reduce((function(e, t) {
                    return e.set(t.refId, t),
                    e
                }
                ), new Map)
                  , r = new Set;
                if (e.animations) {
                    var o = true
                      , a = false
                      , s = void 0;
                    try {
                        for (var l, u = e.animations[Symbol.iterator](); !(o = (l = u.next()).done); o = true) {
                            var c = l.value
                              , d = i.get(c.id);
                            d && (c.isUnchecked || r.add(d))
                        }
                    } catch (e) {
                        a = true,
                        s = e
                    } finally {
                        try {
                            !o && u.return && u.return()
                        } finally {
                            if (a)
                                throw s
                        }
                    }
                } else {
                    var h = []
                      , f = true
                      , p = false
                      , y = void 0;
                    try {
                        for (var m, v = n[Symbol.iterator](); !(f = (m = v.next()).done); f = true) {
                            var g = m.value;
                            h.push({
                                id: g.refId
                            }),
                            r.add(g)
                        }
                    } catch (e) {
                        p = true,
                        y = e
                    } finally {
                        try {
                            !f && v.return && v.return()
                        } finally {
                            if (p)
                                throw y
                        }
                    }
                    this.savePreference("animations", h)
                }
                this.setState({
                    animations: n,
                    exportAnimations: r,
                    isLoading: true,
                    isModalOpen: true,
                    isModalClosing: false,
                    selectedAnimation: i[e.selectedAnimation] || n[0]
                });
                var _ = this;
                setTimeout((function() {
                    _.loadActor()
                }
                ), 500)
            }
        }, {
            key: "closeModal",
            value: function() {
                this.setState({
                    isModalOpen: false,
                    isModalClosing: true
                }),
                this.props.onExportComplete()
            }
        }, {
            key: "selectAnimation",
            value: function(e) {
                this.startRenderLoop(),
                this.setState({
                    selectedAnimation: e
                }),
                this.savePreference("selectedAnimation", e.refId)
            }
        }, {
            key: "toggleExportAnimation",
            value: function(e, t) {
                var n = new Set(this.state.exportAnimations);
                e ? n.add(t) : n.delete(t);
                var i = this.state.animations.map((function(e) {
                    return {
                        id: e.refId,
                        isUnchecked: !n.has(e)
                    }
                }
                ));
                this.savePreference("animations", i),
                this.setState({
                    exportAnimations: n
                })
            }
        }, {
            key: "toggleShareSource",
            value: function(e) {
                var t = {
                    shareSource: e
                };
                e || (t.allowFork = false),
                this.savePreference("sharesource", e),
                this.setState(t)
            }
        }, {
            key: "toggleAllowFork",
            value: function(e) {
                var t = {
                    allowFork: e
                };
                e && (t.shareSource = true,
                this.savePreference("sharesource", true)),
                this.savePreference("allowfork", e),
                this.setState(t)
            }
        }, {
            key: "changeBgColor",
            value: function(e) {
                this.startRenderLoop(),
                this.setState({
                    backgroundColor: e
                }),
                this.savePreference("bgclr", Array.prototype.slice.call(e))
            }
        }, {
            key: "setCanvas",
            value: function(e) {
                this.canvas = e,
                e && (e.width = 540,
                e.height = 303,
                this.initRuntime())
            }
        }, {
            key: "mouseWheel",
            value: function(e) {
                if (this.canvas) {
                    var t = -e.deltaY / 1e3 * 2;
                    e.ctrlKey && (t /= 15);
                    var n = this.canvas.getBoundingClientRect();
                    return this.zoomTo((e.clientX - n.left) * this._ScreenScale, this._RuntimeGraphics.viewportHeight - (e.clientY - n.top) * this._ScreenScale, this._TargetViewScale + t),
                    this.showGuides(true, true),
                    this.startRenderLoop(),
                    true
                }
            }
        }, {
            key: "zoomTo",
            value: function(e, t, n) {
                n = Math.min(8, Math.max(.1, n));
                var i = this._TargetViewScale;
                this._TargetViewScale = n;
                var r = this._TargetViewScale / i
                  , o = e - this._TargetViewOffsetX
                  , a = t - this._TargetViewOffsetY
                  , s = o * r
                  , l = a * r;
                this._TargetViewOffsetX += o - s,
                this._TargetViewOffsetY += a - l,
                this.savePreference("zoom", this._TargetViewScale),
                this.setState({
                    zoom: this._TargetViewScale
                })
            }
        }, {
            key: "startPan",
            value: function(e) {
                this.state.isLoading || (e.preventDefault(),
                e.stopPropagation(),
                this.setState({
                    showPanTip: false
                }),
                window.addEventListener("mousemove", this.pan, true),
                window.addEventListener("mouseup", this.stopPan, true),
                this.showGuides(true),
                this._LastMouseX = e.clientX,
                this._LastMouseY = e.clientY,
                this._ForceRender = true,
                this.startRenderLoop())
            }
        }, {
            key: "pan",
            value: function(e) {
                e.preventDefault(),
                e.stopPropagation();
                var t = e.clientX - this._LastMouseX
                  , n = e.clientY - this._LastMouseY;
                this._LastMouseX = e.clientX,
                this._LastMouseY = e.clientY,
                this._TargetViewOffsetX += t * this._ScreenScale,
                this._TargetViewOffsetY -= n * this._ScreenScale,
                this.savePreference("offsetx", this._TargetViewOffsetX),
                this.savePreference("offsety", this._TargetViewOffsetY)
            }
        }, {
            key: "stopPan",
            value: function(e) {
                this.setState({
                    showPanTip: false
                }),
                this.scheduleHideGuides(500),
                this._ForceRender = false,
                window.removeEventListener("mousemove", this.pan, true),
                window.removeEventListener("mouseup", this.stopPan, true)
            }
        }, {
            key: "onSortStart",
            value: function() {
                this.setState({
                    isSorting: true
                })
            }
        }, {
            key: "onSortEnd",
            value: function(e) {
                var t = e.oldIndex
                  , n = e.newIndex
                  , i = (0,
                _.arrayMove)(this.state.animations, t, n);
                this.setState({
                    animations: i,
                    isSorting: false
                });
                var r, o = this._Preferences.animations;
                r = (0,
                _.arrayMove)(o, t, n),
                this.savePreference("animations", r)
            }
        }, {
            key: "zoomFit",
            value: function() {
                if (this._ActorInstance) {
                    var e = this._ActorInstance.computeAABB()
                      , t = e[2] - e[0]
                      , n = e[3] - e[1]
                      , i = e[0] + .5 * t
                      , r = e[1] + .5 * n
                      , o = Math.min(540 / t, 303 / n);
                    this._TargetViewScale = o,
                    this._TargetViewOffsetX = -i * o + 270,
                    this._TargetViewOffsetY = -r * o + 151.5,
                    this.setState({
                        zoom: this._TargetViewScale
                    }),
                    this.startRenderLoop()
                }
            }
        }, {
            key: "setZoom",
            value: function(e) {
                this.zoomTo(270, 151.5, e)
            }
        }, {
            key: "startDragCover",
            value: function(e) {
                e.preventDefault(),
                e.stopPropagation(),
                this._ForceRender = true,
                this.startRenderLoop(),
                this._OverrideAnimationPosition = this.state.coverPosition,
                window.addEventListener("mousemove", this.dragCover, true),
                window.addEventListener("mouseup", this.stopDragCover, true)
            }
        }, {
            key: "dragCover",
            value: function(e) {
                e.preventDefault(),
                e.stopPropagation();
                var t = this.track.getBoundingClientRect();
                this._OverrideAnimationPosition = Math.min(1, Math.max(0, (e.clientX - t.left) / t.width)),
                this.setState({
                    coverPosition: this._OverrideAnimationPosition
                }),
                this.savePreference("cover", this._OverrideAnimationPosition)
            }
        }, {
            key: "stopDragCover",
            value: function(e) {
                this._RuntimeAnimation && (this._AnimationTime = this._OverrideAnimationPosition * this._RuntimeAnimation._Duration),
                this._ForceRender = false,
                this._OverrideAnimationPosition = null,
                window.removeEventListener("mousemove", this.dragCover, true),
                window.removeEventListener("mouseup", this.stopDragCover, true)
            }
        }, {
            key: "startDragPlayhead",
            value: function(e) {
                e.preventDefault(),
                e.stopPropagation();
                var t = this.track.getBoundingClientRect()
                  , n = Math.min(1, Math.max(0, (e.clientX - t.left) / t.width));
                this._RuntimeAnimation && (this._AnimationTime = n * this._RuntimeAnimation._Duration),
                this._ForceRender = true,
                this.startRenderLoop(),
                window.addEventListener("mousemove", this.dragPlayhead, true),
                window.addEventListener("mouseup", this.stopDragPlayhead, true)
            }
        }, {
            key: "dragPlayhead",
            value: function(e) {
                e.preventDefault(),
                e.stopPropagation();
                var t = this.track.getBoundingClientRect()
                  , n = Math.min(1, Math.max(0, (e.clientX - t.left) / t.width));
                this._RuntimeAnimation && (this._AnimationTime = n * this._RuntimeAnimation._Duration)
            }
        }, {
            key: "stopDragPlayhead",
            value: function(e) {
                this._OverrideAnimationPosition = null,
                this._ForceRender = false,
                window.removeEventListener("mousemove", this.dragPlayhead, true),
                window.removeEventListener("mouseup", this.stopDragPlayhead, true)
            }
        }, {
            key: "setTrack",
            value: function(e) {
                this.track = e
            }
        }, {
            key: "inputTitle",
            value: function(e) {
                var t = e.target.value;
                this.setState({
                    title: t
                });
                this.savePreference("title", t)
            }
        }, {
            key: "captureFrame",
            value: function(e, t, n, i, r, o) {
                this._RenderCapture.push({
                    width: e,
                    height: t,
                    viewTransform: n,
                    animation: i,
                    animationPosition: r,
                    complete: o
                })
            }
        }, {
            key: "getCover",
            value: function(e) {
                var t = this.state
                  , n = t.animations
                  , i = t.exportAnimations
                  , r = t.coverPosition
                  , o = n.find((function(e) {
                    return i.has(e)
                }
                ))
                  , a = g.mat2d.create();
                a[0] = 2 * this._TargetViewScale,
                a[3] = 2 * this._TargetViewScale,
                a[4] = 2 * this._TargetViewOffsetX,
                a[5] = 2 * this._TargetViewOffsetY,
                this.captureFrame(1080, 606, a, o, r, (function(t, n) {
                    var i = t.width
                      , r = t.height
                      , o = document.createElement("canvas");
                    o.width = i,
                    o.height = r;
                    for (var a = o.getContext("2d"), s = new Uint8ClampedArray(n.length), l = 0; l < r; l++)
                        for (var u = 0; u < i; u++)
                            for (var c = 4 * (l * i + u), d = 4 * ((r - l - 1) * i + u), h = 0; h < 4; h++)
                                s[d + h] = n[c + h];
                    var f = new ImageData(s,i,r);
                    a.putImageData(f, 0, 0),
                    o.toBlob((function(t) {
                        var n, i = new FileReader;
                        i.onload = function() {
                            n = this.result,
                            e && e(new Uint8Array(n))
                        }
                        ,
                        i.readAsArrayBuffer(t)
                    }
                    ))
                }
                ))
            }
        }, {
            key: "saveShotRevision",
            value: function(e) {
                var t = this.context.nima;
                t.revisionManager.systemSave("Published Shot", (function() {}
                ), (function(t) {
                    e(t)
                }
                ), [].concat(function(e) {
                    if (Array.isArray(e)) {
                        for (var t = 0, n = Array(e.length); t < e.length; t++)
                            n[t] = e[t];
                        return n
                    }
                    return Array.from(e)
                }(this.state.exportAnimations))) || t.alert({
                    type: O.default.Types.Default,
                    title: "Error",
                    message: "An error occurred while attempting to save your data for publication.",
                    buttons: []
                })
            }
        }, {
            key: "publish",
            value: function() {
                var e = this
                  , t = this.context.nima
                  , n = []
                  , i = this.state.exportAnimations
                  , r = true
                  , o = false
                  , a = void 0;
                try {
                    for (var s, l = this.state.animations[Symbol.iterator](); !(r = (s = l.next()).done); r = true) {
                        var u = s.value;
                        i.has(u) && n.push(u)
                    }
                } catch (e) {
                    o = true,
                    a = e
                } finally {
                    try {
                        !r && l.return && l.return()
                    } finally {
                        if (o)
                            throw a
                    }
                }
                var c = t.actor;
                this.setState({
                    isPublishing: true
                }),
                this.saveShotRevision((function(i) {
                    e.getCover((function(r) {
                        var o = e._TargetViewScale
                          , a = e._ViewTransform;
                        new v.default({
                            animations: n,
                            atlasPadding: 2,
                            atlasPowerOfTwo: true,
                            atlasSquare: false,
                            cropImages: true,
                            cropAnimationsToWorkArea: true,
                            isZipExport: false,
                            maxAtlasHeight: 2048,
                            maxAtlasWidth: 2048,
                            maxImageHeight: 1024,
                            maxImageWidth: 1024,
                            view: {
                                center: [(a[4] - 270) / -o, (a[5] - 151.5) / -o],
                                size: [540 / o, 303 / o]
                            },
                            wantWriter: true
                        }).export(c, (function(n) {
                            var o = n.toArrayBuffer()
                              , a = {
                                title: e.state.title,
                                body: e.body.serialize(),
                                shareSource: e.state.shareSource,
                                allowFork: e.state.allowFork,
                                revisionKey: i,
                                public: {
                                    background: Array.prototype.slice.call(e.state.backgroundColor),
                                    license: e.state.allowFork ? e.state.licenseOptions[e.state.selectedLicenseIndex].label : void 0
                                }
                            }
                              , s = JSON.stringify(a)
                              , l = new w.default;
                            l.writeString(s),
                            l.writeUint32(o.length),
                            l.write(o),
                            l.writeUint32(r.length),
                            l.write(r);
                            var u = l.toBlob("application/octet-binary")
                              , c = new XMLHttpRequest;
                            c.open("POST", "/api/editor/shot", true),
                            c.onload = function() {
                                200 == this.status ? (e.closeModal(),
                                e.clearPreferences(),
                                setTimeout((function() {
                                    t.alert({
                                        type: O.default.Types.Avatar,
                                        avatar: t.user.avatar,
                                        title: "Posted",
                                        message: "Your shot has been posted!",
                                        buttons: null
                                    })
                                }
                                ), 800)) : (t.alert({
                                    title: "Error",
                                    message: "An error occurred while submitting your shot, please try again."
                                }),
                                e.setState({
                                    isPublishing: false
                                }))
                            }
                            ,
                            c.onerror = function() {
                                t.alert({
                                    title: "Error",
                                    message: "A network error occurred while submitting your shot, please try again."
                                }),
                                e.setState({
                                    isPublishing: false
                                })
                            }
                            ,
                            c.send(u)
                        }
                        ))
                    }
                    ))
                }
                ))
            }
        }, {
            key: "setBody",
            value: function(e) {
                this.body = e;
                var t = this._Preferences;
                e && t.body && this.body.deserialize(t.body)
            }
        }, {
            key: "selectLicense",
            value: function(e) {
                this.setState({
                    selectedLicenseIndex: e
                }),
                this.savePreference("license", e)
            }
        }, {
            key: "render",
            value: function() {
                var e = this.state
                  , t = e.selectedAnimation
                  , n = e.animations
                  , i = e.backgroundColor
                  , r = e.shareSource
                  , a = e.allowFork
                  , s = e.zoom
                  , u = e.exportAnimations
                  , m = e.isSorting
                  , v = e.coverPosition
                  , g = e.animationPosition
                  , _ = e.isLoading
                  , b = n.find((function(e) {
                    return u.has(e)
                }
                ));
                return o.default.createElement(l.default, {
                    addClass: "ExportShotModal",
                    isOpen: this.state.isModalOpen,
                    isClosing: this.state.isModalClosing,
                    onClose: this.closeModal
                }, o.default.createElement("div", {
                    className: "ExportShotOptionsCol"
                }, o.default.createElement("div", {
                    className: "ModalHeader"
                }, o.default.createElement("svg", {
                    className: "ModalIcon ExportShotModalIcon"
                }, o.default.createElement("use", {
                    xlinkHref: P.default.make("/images/symbol-defs.svg#icon-shots")
                })), o.default.createElement("div", {
                    className: "ModalHeadline"
                }, "Share a Shot"), o.default.createElement("div", {
                    className: "ModalSubHeadline"
                }, "Publish your file to showcase a rich preview of your work.")), o.default.createElement("div", {
                    className: "ModalContent"
                }, o.default.createElement("div", {
                    className: "ModalGroupProperty"
                }, o.default.createElement("div", {
                    className: "ModalGroupPropertyTitle"
                }, "Share Source"), o.default.createElement(c.default, {
                    addClass: "ContrastToggle",
                    isOn: r,
                    onToggle: this.toggleShareSource
                })), o.default.createElement("div", {
                    className: "ModalGroupProperty"
                }, o.default.createElement("div", {
                    className: "ModalGroupPropertyTitle"
                }, "Allow Fork"), o.default.createElement(c.default, {
                    addClass: "ContrastToggle",
                    isOn: a,
                    onToggle: this.toggleAllowFork
                })), o.default.createElement("div", {
                    className: "ModalGroupProperty ModalGroupLicense",
                    style: {
                        height: this.state.allowFork ? "39px" : "0"
                    }
                }, o.default.createElement("div", {
                    className: "ModalGroupPropertyTitle",
                    style: {
                        width: "100px",
                        flex: "initial"
                    }
                }, "Artwork License"), o.default.createElement(S.default, {
                    addClass: "DropdownAutoWidth",
                    options: this.state.licenseOptions,
                    selectedIndex: this.state.selectedLicenseIndex,
                    onSelectionChanged: this.selectLicense,
                    disabled: null
                })), o.default.createElement("div", {
                    className: "ModalGroupProperty"
                }, o.default.createElement("div", {
                    className: "ModalGroupPropertyTitle"
                }, "Background Color"), o.default.createElement(d.default, {
                    value: i,
                    converter: y.default,
                    isAnimating: false,
                    onValueChanged: this.changeBgColor,
                    onValueCommit: null,
                    disabled: false,
                    addClass: "ContrastInput"
                })), o.default.createElement("div", {
                    className: "ModalGroupProperty"
                }, o.default.createElement("div", {
                    className: "ModalGroupPropertyTitle"
                }, "Zoom"), o.default.createElement(d.default, {
                    value: s,
                    converter: p.default,
                    onValueChanged: this.setZoom,
                    addClass: "ContrastInput"
                })))), o.default.createElement("div", {
                    className: "ExportShotPreviewCol"
                }, o.default.createElement("div", {
                    className: "ExportShotContainer",
                    onMouseDown: this.startPan,
                    onWheel: this.mouseWheel
                }, o.default.createElement("canvas", {
                    ref: this.setCanvas
                }), o.default.createElement("div", {
                    className: "ExportShotCanvasOverlay"
                }, o.default.createElement("div", {
                    className: "ExportShotGuides",
                    style: {
                        opacity: this.state.showGuides ? 1 : 0
                    }
                }, o.default.createElement("div", {
                    className: "ExportShotThirdLeftGuide"
                }), o.default.createElement("div", {
                    className: "ExportShotThirdRightGuide"
                }), o.default.createElement("div", {
                    className: "ExportShotThirdTopGuide"
                }), o.default.createElement("div", {
                    className: "ExportShotThirdBottomGuide"
                })), this.state.showPanTip || _ ? o.default.createElement("div", {
                    className: "ExportShotCanvasTip"
                }, _ ? "Loading..." : "Pan/Zoom to Setup Your Shot") : null)), o.default.createElement("div", {
                    className: "ExportShotPlaybackControls"
                }, o.default.createElement("svg", {
                    onClick: this.togglePause,
                    className: "PlayButton"
                }, o.default.createElement("use", {
                    xlinkHref: P.default.make("/images/symbol-defs.svg#icon-" + (this.state.isPaused ? "play" : "pause"))
                })), o.default.createElement("div", {
                    className: "ExportShotPlaybackTransport"
                }, o.default.createElement("div", {
                    className: "ExportShotPlaybackTrack",
                    ref: this.setTrack
                }), o.default.createElement("div", {
                    className: "ExportShotPlaybackScrubber",
                    style: {
                        left: 100 * g + "%"
                    },
                    onMouseDown: this.startDragPlayhead
                }), t !== b || _ ? null : o.default.createElement("div", {
                    className: "ExportShotCoverScrubber",
                    onMouseDown: this.startDragCover,
                    style: {
                        left: 100 * v + "%"
                    }
                }, o.default.createElement("div", {
                    className: "ShotCoverBadge"
                }, "COVER")))), o.default.createElement("div", {
                    className: "ExportShotUserProfile"
                }, o.default.createElement("div", {
                    className: this.props.avatar ? "CommentAvatar" : "CommentAvatarEmpty",
                    style: {
                        background: this.props.avatar ? "url('" + this.props.avatar + "')" : null,
                        backgroundSize: this.props.avatar ? "cover" : null
                    }
                }, this.props.avatar ? null : o.default.createElement("svg", null, o.default.createElement("use", {
                    xlinkHref: P.default.make("/images/symbol-defs.svg#icon-avatar")
                }))), this.props.name || this.props.username), o.default.createElement("input", {
                    type: "text",
                    className: "ExportShotTitle",
                    placeholder: "Title",
                    value: this.state.title,
                    onChange: this.inputTitle
                }), o.default.createElement(h.default, {
                    onInputChanged: this.onBodyPopulated,
                    ref: this.setBody,
                    onSubmit: null,
                    defaultText: "Say something...",
                    isEditable: true
                }), o.default.createElement(f.default, {
                    disabled: !this.state.canPublish || this.state.isPublishing,
                    label: this.props.verified ? "PUBLISH SHOT" : "VERIFY YOUR EMAIL",
                    onPress: this.publish,
                    accentBtn: true
                })), o.default.createElement("div", {
                    className: "ExportShotAnimationsCol"
                }, o.default.createElement("div", {
                    className: "ModalGroupTitle"
                }, "Animations"), o.default.createElement("div", {
                    className: "ModalGroupSubTitle"
                }, "Drag and drop to sort. The top-most animation will be used as a cover image for your shot."), o.default.createElement("div", {
                    className: "ExportShotAnimationsList"
                }, o.default.createElement(x, {
                    lockAxis: "y",
                    helperClass: "ExportShotAnimationGhost",
                    distance: 10,
                    items: n,
                    selectedAnimation: t,
                    checkedAnimations: u,
                    firstAnimation: b,
                    toggleExportAnimation: this.toggleExportAnimation,
                    selectAnimation: this.selectAnimation,
                    onSortStart: this.onSortStart,
                    onSortEnd: this.onSortEnd,
                    isSorting: m
                }))))
            }
        }]),
        t
    }(o.default.Component)).prototype, "onBodyPopulated", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onBodyPopulated"), i.prototype),
    T(i.prototype, "hideGuides", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "hideGuides"), i.prototype),
    T(i.prototype, "startRenderLoop", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "startRenderLoop"), i.prototype),
    T(i.prototype, "togglePause", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "togglePause"), i.prototype),
    T(i.prototype, "advance", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "advance"), i.prototype),
    T(i.prototype, "loadActor", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "loadActor"), i.prototype),
    T(i.prototype, "openModal", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "openModal"), i.prototype),
    T(i.prototype, "closeModal", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "closeModal"), i.prototype),
    T(i.prototype, "selectAnimation", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "selectAnimation"), i.prototype),
    T(i.prototype, "toggleExportAnimation", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleExportAnimation"), i.prototype),
    T(i.prototype, "toggleShareSource", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleShareSource"), i.prototype),
    T(i.prototype, "toggleAllowFork", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleAllowFork"), i.prototype),
    T(i.prototype, "changeBgColor", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeBgColor"), i.prototype),
    T(i.prototype, "setCanvas", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setCanvas"), i.prototype),
    T(i.prototype, "mouseWheel", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseWheel"), i.prototype),
    T(i.prototype, "startPan", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "startPan"), i.prototype),
    T(i.prototype, "pan", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "pan"), i.prototype),
    T(i.prototype, "stopPan", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "stopPan"), i.prototype),
    T(i.prototype, "onSortStart", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onSortStart"), i.prototype),
    T(i.prototype, "onSortEnd", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onSortEnd"), i.prototype),
    T(i.prototype, "setZoom", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setZoom"), i.prototype),
    T(i.prototype, "startDragCover", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "startDragCover"), i.prototype),
    T(i.prototype, "dragCover", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "dragCover"), i.prototype),
    T(i.prototype, "stopDragCover", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "stopDragCover"), i.prototype),
    T(i.prototype, "startDragPlayhead", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "startDragPlayhead"), i.prototype),
    T(i.prototype, "dragPlayhead", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "dragPlayhead"), i.prototype),
    T(i.prototype, "stopDragPlayhead", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "stopDragPlayhead"), i.prototype),
    T(i.prototype, "setTrack", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setTrack"), i.prototype),
    T(i.prototype, "inputTitle", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "inputTitle"), i.prototype),
    T(i.prototype, "publish", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "publish"), i.prototype),
    T(i.prototype, "setBody", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setBody"), i.prototype),
    T(i.prototype, "selectLicense", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "selectLicense"), i.prototype),
    i);
    t.default = I,
    I.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = t.WRITER_FORMATS = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = j(n(237))
      , o = j(n(384))
      , a = j(n(396))
      , s = j(n(514))
      , l = j(n(448))
      , u = j(n(596))
      , c = j(n(267))
      , d = j(n(398))
      , h = j(n(208))
      , f = j(n(344))
      , p = j(n(315))
      , y = j(n(597))
      , m = j(n(598))
      , v = j(n(599))
      , g = j(n(600))
      , _ = j(n(358))
      , b = j(n(466))
      , w = j(n(467))
      , O = j(n(359))
      , S = j(n(369))
      , k = j(n(399))
      , P = j(n(445))
      , E = j(n(468))
      , T = j(n(385))
      , C = j(n(510))
      , x = j(n(601))
      , I = j(n(712))
      , D = j(n(9))
      , M = n(2)
      , A = j(n(400));
    function j(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function L(e, t) {
        return {
            id: e,
            key: t
        }
    }
    var R = {
        Nodes: L(1, "nodes"),
        ActorNode: L(2, "node"),
        ActorBone: L(3, "bone"),
        ActorRootBone: L(4, "rootBone"),
        ActorImage: L(5, "image"),
        View: L(6, "view"),
        Animation: L(7, "animation"),
        Animations: L(8, "animations"),
        Atlases: L(9, "atlases"),
        Atlas: L(10, "atlas"),
        ActorEvent: L(12, "event"),
        CustomIntProperty: L(13, "customInt"),
        CustomFloatProperty: L(14, "customFloat"),
        CustomStringProperty: L(15, "customString"),
        CustomBooleanProperty: L(16, "customBool"),
        ColliderRectangle: L(17, "rectangleCollider"),
        ColliderTriangle: L(18, "triangleCollider"),
        ColliderCircle: L(19, "circleCollider"),
        ColliderPolygon: L(20, "polygonCollider"),
        ColliderLine: L(21, "lineCollider"),
        ActorImageSequence: L(22, "imageSequence"),
        ActorNodeSolo: L(23, "solo"),
        JellyComponent: L(28, "jelly"),
        ActorJellyBone: L(29, "jellyBone"),
        ActorIKConstraint: L(30, "ikConstraint"),
        ActorDistanceConstraint: L(31, "distanceConstraint"),
        ActorTranslationConstraint: L(32, "translationConstraint"),
        ActorRotationConstraint: L(33, "rotationConstraint"),
        ActorScaleConstraint: L(34, "scaleConstraint"),
        ActorTransformConstraint: L(35, "transformConstraint")
    }
      , F = t.WRITER_FORMATS = {
        JSON: "JSON",
        BINARY: "Binary"
    }
      , B = {
        JSON: {
            writer: T.default,
            block: E.default
        },
        Binary: {
            writer: O.default,
            block: w.default
        }
    };
    function V(e, t, n, i) {
        t.writeString(n.name, "name");
        var r = 0;
        n.parent && (r = i.get(n.parent)),
        t.writeId(r, "parent")
    }
    function N(e, t, n, i) {
        V(0, t, n, i),
        t.writeFloat32Array(n.rigTranslation, "translation"),
        t.writeFloat32(n.rigRotation, "rotation"),
        t.writeFloat32Array(n.rigScale, "scale"),
        t.writeFloat32(n.rigOpacity, "opacity"),
        t.writeBool(n.isCollapsedVisibility, "isCollapsed")
    }
    function z(e, t, n, i) {
        var r = new e.block(R.ActorNodeSolo);
        N(0, r, n, i),
        r.writeUint32(n.rigActiveChildIndex, "activeChild"),
        t.writeBlock(r)
    }
    function W(e, t, n, i) {
        var r = new e.block(R.ActorJellyBone);
        V(0, r, n, i),
        r.writeFloat32(n.rigOpacity, "opacity"),
        r.writeBool(n.isCollapsedVisibility, "isCollapsed"),
        t.writeBlock(r)
    }
    function H(e, t, n, i) {
        !function(e, t, n, i) {
            V(0, t, n, i),
            t.writeFloat32(n.rigStrength, "strength"),
            t.writeBool(n.isEnabled, "isEnabled")
        }(0, t, n, i);
        var r = n.target ? i.get(n.target) : void 0;
        t.writeId(r, "target")
    }
    function U(e, t, n, i) {
        var r = new e.block(R.ActorIKConstraint);
        H(0, r, n, i),
        r.writeBool(n.invertDirection, "isInverted");
        var o = n.influencedBones;
        r.openArray("bones"),
        r.writeUint8length(o.length);
        for (var a = 0; a < o.length; a++) {
            var s = o[a];
            r.writeId(i.get(s))
        }
        r.closeArray(),
        t.writeBlock(r)
    }
    function K(e, t, n, i) {
        var r = new e.block(R.ActorDistanceConstraint);
        H(0, r, n, i),
        r.writeFloat32(n.distance, "distance"),
        r.writeUint8(n.mode.id, "modeId"),
        t.writeBlock(r)
    }
    function G(e, t, n, i) {
        H(0, t, n, i),
        n.copyX ? (t.writeBool(true, "copyX"),
        t.writeFloat32(n.scaleX, "scaleX")) : t.writeBool(false, "copyX"),
        n.enableMinX ? (t.writeBool(true, "enableMinX"),
        t.writeFloat32(n.minX, "minX")) : t.writeBool(false, "enableMinX"),
        n.enableMaxX ? (t.writeBool(true, "enableMaxX"),
        t.writeFloat32(n.maxX, "maxX")) : t.writeBool(false, "enableMaxX"),
        n.copyY ? (t.writeBool(true, "copyY"),
        t.writeFloat32(n.scaleY, "scaleY")) : t.writeBool(false, "copyY"),
        n.enableMinY ? (t.writeBool(true, "enableMinY"),
        t.writeFloat32(n.minY, "minY")) : t.writeBool(false, "enableMinY"),
        n.enableMaxY ? (t.writeBool(true, "enableMaxY"),
        t.writeFloat32(n.maxY, "maxY")) : t.writeBool(false, "enableMaxY"),
        t.writeBool(n.offset, "offset"),
        t.writeUint8(n.sourceSpace.id, "sourceSpaceId"),
        t.writeUint8(n.destSpace.id, "destSpaceId"),
        t.writeUint8(n.minMaxSpace.id, "minMaxSpaceId")
    }
    function X(e, t, n, i) {
        var r = new e.block(R.ActorTranslationConstraint);
        G(0, r, n, i),
        t.writeBlock(r)
    }
    function J(e, t, n, i) {
        var r = new e.block(R.ActorScaleConstraint);
        G(0, r, n, i),
        t.writeBlock(r)
    }
    function Y(e, t, n, i) {
        var r = new e.block(R.ActorRotationConstraint);
        H(0, r, n, i),
        n.copy ? (r.writeBool(true, "copy"),
        r.writeFloat32(n.scale, "scale")) : r.writeBool(false, "copy"),
        n.enableMin ? (r.writeBool(true, "enableMin"),
        r.writeFloat32(n.min, "min")) : r.writeBool(false, "enableMin"),
        n.enableMax ? (r.writeBool(true, "enableMax"),
        r.writeFloat32(n.max, "max")) : r.writeBool(false, "enableMax"),
        r.writeBool(n.offset, "offset"),
        r.writeUint8(n.sourceSpace.id, "sourceSpaceId"),
        r.writeUint8(n.destSpace.id, "destSpaceId"),
        r.writeUint8(n.minMaxSpace.id, "minMaxSpaceId"),
        t.writeBlock(r)
    }
    function q(e, t, n, i) {
        var r = new e.block(R.ActorTransformConstraint);
        H(0, r, n, i),
        r.writeUint8(n.sourceSpace.id, "sourceSpaceId"),
        r.writeUint8(n.destSpace.id, "destSpaceId"),
        t.writeBlock(r)
    }
    function Q(e, t, n, i) {
        var r = new e.block(R.JellyComponent);
        V(0, r, n, i),
        r.writeFloat32(n.easeIn, "easeIn"),
        r.writeFloat32(n.easeOut, "easeOut"),
        r.writeFloat32(n.scaleIn, "scaleIn"),
        r.writeFloat32(n.scaleOut, "scaleOut");
        var o = n.inTarget
          , a = n.outTarget;
        r.writeId(i.get(o), "inTarget"),
        r.writeId(i.get(a), "outTarget"),
        t.writeBlock(r)
    }
    function Z(e, t, n, i) {
        var r = new e.block(R.ActorBone);
        N(0, r, n, i),
        r.writeFloat32(n.rigLength, "length"),
        t.writeBlock(r)
    }
    function $(e, t, n, i) {
        var r = new e.block(R.ActorRootBone);
        N(0, r, n, i),
        t.writeBlock(r)
    }
    function ee(e, t, n, i) {
        var r = new e.block(R.ActorNode);
        N(0, r, n, i),
        t.writeBlock(r)
    }
    function te(e, t, n, i) {
        var r = new e.block(n.isSequence ? R.ActorImageSequence : R.ActorImage);
        N(0, r, n, i);
        var o = n.isVisible && n.asset && (n.isSequence && n.asset.children.length > 0 || n.bitmap);
        if (r.writeBool(o, "isVisible"),
        o) {
            var a = function(e, t, n, i, r, o, a, s) {
                for (var l = e.minU, u = e.minV, d = e.maxU - e.minU, h = e.maxV - e.minV, f = c.width, p = c.height, y = e.x / f, m = e.y / p, v = e.width / f, g = e.height / p, _ = 0; _ < t; _++) {
                    var b = (n[i] - l) / d
                      , w = (n[i + 1] - u) / h;
                    if (e.rotated) {
                        var O = b;
                        b = w,
                        w = O
                    }
                    o[a] = y + b * v,
                    o[a + 1] = m + w * g,
                    a += s,
                    i += r
                }
            };
            r.writeUint8(n.blendMode, "blendMode"),
            r.writeUint16(n.rigDrawOrder, "drawOrder");
            var s = n.asset;
            n.isSequence && (s = s.children[0]);
            var l = e.assetLookup[s.refId]
              , u = e.assetData[l].packing
              , c = e.atlases[u.atlas];
            r.writeUint8(u.atlas, "atlas");
            var d = n.meshData
              , h = n.weightData
              , f = n.connectedBones
              , p = void 0
              , y = void 0;
            if (d)
                p = new Float32Array(d.verts),
                y = d.tris;
            else {
                var m = n.width / 2
                  , v = n.height / 2;
                p = new Float32Array([-m, -v, 0, 1, m, -v, 1, 1, m, v, 1, 0, -m, v, 0, 0]),
                y = new Uint16Array([0, 1, 2, 2, 3, 0])
            }
            !(!d || !d.deform) && d.deform.verts.length === p.length && (p = new Float32Array(d.deform.verts));
            var g = p.length / 4
              , _ = null;
            if (n.isSequence) {
                var b = 2
                  , w = 0;
                _ = new Float32Array(2 * g);
                for (var O = 0; O < g; O++)
                    _[w++] = p[b],
                    _[w++] = p[b + 1],
                    b += 4
            }
            if (a(u, g, p, 2, 4, p, 2, 4),
            h && h.length / 8 == g && f.length) {
                for (var S = new Float32Array(12 * g), k = 0, P = 0, E = 0, T = 0; T < g; T++)
                    S[k++] = p[P++],
                    S[k++] = p[P++],
                    S[k++] = p[P++],
                    S[k++] = p[P++],
                    S[k++] = h[E++],
                    S[k++] = h[E++],
                    S[k++] = h[E++],
                    S[k++] = h[E++],
                    S[k++] = h[E++],
                    S[k++] = h[E++],
                    S[k++] = h[E++],
                    S[k++] = h[E++];
                p = S,
                r.openArray("bones"),
                r.writeUint8length(f.length);
                for (var C = 0; C < f.length; C++) {
                    var x = f[C];
                    r.openObject("bone"),
                    r.writeId(i.get(x.node), "component"),
                    r.writeFloat32Array(x.bind, "bind"),
                    r.closeObject()
                }
                r.closeArray(),
                r.writeFloat32Array(n.worldTransform || M.mat2d.create(), "worldTransform")
            } else
                r.openArray("bones"),
                r.writeUint8length(0),
                r.closeArray();
            if (r.writeUint32(g, "numVertices"),
            r.writeFloat32Array(p, "vertices"),
            r.writeUint32(y.length / 3, "numTriangles"),
            r.writeUint16Array(y, "triangles"),
            n.isSequence) {
                var I = n.asset.children;
                r.openArray("frames"),
                r.writeUint16length(I.length, "length");
                for (var D = 1; D < I.length; D++) {
                    var A = I[D]
                      , j = e.assetLookup[A.refId]
                      , L = e.assetData[j].packing;
                    r.openObject("frame"),
                    r.writeUint8(L.atlas, "atlas");
                    var F = new Float32Array(2 * g);
                    a(L, g, _, 0, 2, F, 0, 2),
                    r.writeFloat32Array(F, "uv"),
                    r.closeObject()
                }
                r.closeArray()
            }
        }
        t.writeBlock(r)
    }
    function ne(e, t, n, i) {
        var r = 0
          , o = n.keyedNodes
          , s = new e.block(R.Animation)
          , l = n.duration
          , u = 0
          , c = l;
        if (e.options.cropAnimationsToWorkArea && n.isWorkAreaActive)
            l = n.workAreaEnd - n.workAreaStart,
            u = n.workAreaStart,
            c = n.workAreaEnd;
        else if (e.options.maxKeyFrameTimeIsDuration) {
            for (var d = 0, h = 0; h < o.length; h++)
                for (var f = o[h].propsList, p = 0; p < f.length; p++)
                    for (var y = f[p].keyFrames, m = 0; m < y.length; m++) {
                        var v = y[m].time;
                        v >= u && v <= c && v > d && (d = v - u)
                    }
            l = d - u
        }
        s.writeString(n.name, "name"),
        s.writeUint8(n.fps, "fps"),
        s.writeFloat32(l, "duration"),
        s.writeBool(n.loop, "isLooping"),
        s.openArray("keyed"),
        s.writeUint16length(o.length);
        for (var g = 0; g < o.length; g++) {
            var b = o[g]
              , w = b.node === _.default.OrderObject ? 0 : i.get(b.node);
            if (void 0 !== w) {
                s.openObject("component"),
                s.writeId(w, "component");
                var O = b.propsList;
                s.writeUint16length(O.length);
                for (var S = 0; S < O.length; S++) {
                    var k = O[S]
                      , P = I.default.Properties[k.property]
                      , E = new e.block(P)
                      , T = k.keyFrames;
                    E.openArray("frames"),
                    E.writeUint16length(T.length);
                    for (var C = 0; C < T.length; C++) {
                        var D = T[C]
                          , M = D.time - u;
                        E.openObject("frame"),
                        E.writeFloat64(M, "time");
                        var A = void 0;
                        switch (P) {
                        case I.default.Properties.frameBooleanValue:
                        case I.default.Properties.frameStringValue:
                        case I.default.Properties.frameTrigger:
                        case I.default.Properties.frameDrawOrder:
                        case I.default.Properties.frameIsCollisionEnabled:
                        case I.default.Properties.frameActiveChild:
                            A = false;
                            break;
                        default:
                            A = true
                        }
                        if (A)
                            switch (E.writeUint8(D._Type, "type"),
                            D._Type) {
                            case x.default.Type.Asymmetric:
                            case x.default.Type.Mirrored:
                            case x.default.Type.Disconnected:
                                E.writeFloat64(D.clampedInFactor, "inFactor"),
                                E.writeFloat32(D._InValue, "inValue"),
                                E.writeFloat64(D.clampedOutFactor, "outFactor"),
                                E.writeFloat32(D._OutValue, "outValue");
                                break;
                            case x.default.Type.Hold:
                                E.writeFloat64(D.clampedInFactor, "inFactor"),
                                E.writeFloat32(D._InValue, "inValue");
                                break;
                            case x.default.Type.Progression:
                            }
                        if (M > r && (r = M),
                        P === I.default.Properties.frameTrigger)
                            ;
                        else if (P === I.default.Properties.frameStringValue)
                            E.writeString(D.value, "value");
                        else if (P === I.default.Properties.frameBooleanValue || P === I.default.Properties.frameIsCollisionEnabled)
                            E.writeBool(D.value, "value");
                        else if (P === I.default.Properties.frameIntValue)
                            E.writeInt32(D.value, "value");
                        else if (P === I.default.Properties.frameDrawOrder) {
                            var j = D.value;
                            E.openArray("drawOrder");
                            var L = [];
                            for (var F in j) {
                                var B = j[F]
                                  , V = i.get(B.obj);
                                void 0 !== V && L.push({
                                    nodeIndex: V,
                                    value: B.v
                                })
                            }
                            E.writeUint16length(L.length);
                            var N = true
                              , z = false
                              , W = void 0;
                            try {
                                for (var H, U = L[Symbol.iterator](); !(N = (H = U.next()).done); N = true) {
                                    var K = H.value;
                                    E.openObject("order"),
                                    E.writeId(K.nodeIndex, "component"),
                                    E.writeUint16(K.value, "order"),
                                    E.closeObject()
                                }
                            } catch (e) {
                                z = true,
                                W = e
                            } finally {
                                try {
                                    !N && U.return && U.return()
                                } finally {
                                    if (z)
                                        throw W
                                }
                            }
                            E.closeArray()
                        } else if (P === I.default.Properties.frameVertices)
                            E.writeFloat32Array(D.value, "value");
                        else if (P === I.default.Properties.frameActiveChild)
                            if (void 0 !== D.value && D.value.parent) {
                                if (D.value instanceof a.default) {
                                    var G = D.value.parent.children.indexOf(D.value);
                                    -1 === G && console.warn("NOT A SOLO CHILD??", D),
                                    E.writeFloat32(G + 1, "value")
                                }
                            } else
                                E.writeFloat32(0, "value");
                        else
                            E.writeFloat32(D.value, "value");
                        E.closeObject()
                    }
                    E.closeArray(),
                    s.writeBlock(E)
                }
                s.closeObject()
            }
        }
        s.closeArray(),
        s.writeFloat32(e.options.animationStart || 0, "animationStart"),
        s.writeFloat32(e.options.animationEnd || r, "animationEnd"),
        t.writeBlock(s)
    }
    function ie(e, t, n, i) {
        var r = new e.block(R.ActorEvent);
        V(0, r, n, i),
        t.writeBlock(r)
    }
    function re(e, t, n, i) {
        var r = void 0;
        switch (n.propertyType) {
        case k.default.Type.Integer:
            r = R.CustomIntProperty;
            break;
        case k.default.Type.Float:
            r = R.CustomFloatProperty;
            break;
        case k.default.Type.String:
            r = R.CustomStringProperty;
            break;
        case k.default.Type.Boolean:
            r = R.CustomBooleanProperty
        }
        var o = new e.block(r);
        switch (V(0, o, n, i),
        n.propertyType) {
        case k.default.Type.Integer:
            o.writeInt32(n.rigIntValue, "int");
            break;
        case k.default.Type.Float:
            o.writeFloat32(n.rigFloatValue, "float");
            break;
        case k.default.Type.String:
            o.writeString(n.rigStringValue, "string");
            break;
        case k.default.Type.Boolean:
            o.writeBool(n.rigBooleanValue, "bool")
        }
        t.writeBlock(o)
    }
    function oe(e, t, n, i) {
        var r = void 0;
        switch (n.shape) {
        case o.default.Shape.Rectangle:
            r = R.ColliderRectangle;
            break;
        case o.default.Shape.Triangle:
            r = R.ColliderTriangle;
            break;
        case o.default.Shape.Circle:
            r = R.ColliderCircle;
            break;
        case o.default.Shape.Polygon:
            r = R.ColliderPolygon;
            break;
        case o.default.Shape.Line:
            r = R.ColliderLine
        }
        var a = new e.block(r);
        switch (N(0, a, n, i),
        a.writeBool(n.rigIsCollisionEnabled, "isCollisionEnabled"),
        n.shape) {
        case o.default.Shape.Rectangle:
        case o.default.Shape.Triangle:
            a.writeFloat32(n.width, "width"),
            a.writeFloat32(n.height, "height");
            break;
        case o.default.Shape.Circle:
            a.writeFloat32(n.radius, "radius");
            break;
        case o.default.Shape.Polygon:
            a.writeUint32(n.meshData.editor.cc, "cc");
            var s = n.meshData.editor.c;
            (function(e) {
                for (var t = e.length / 2, n = 0, i = e.length, r = 0, o = 0; o < t; o++) {
                    var a = e[n]
                      , s = e[n + 1];
                    r += (e[(n + 2) % i] - a) * (e[(n + 3) % i] + s),
                    n += 2
                }
                return r > 0
            }
            )(s) && (s = function(e) {
                for (var t = new Float32Array(e.length), n = e.length / 2, i = 0, r = e.length - 2, o = 0; o < n; o++)
                    t[r] = e[i],
                    t[r + 1] = e[i + 1],
                    i += 2,
                    r -= 2;
                return t
            }(s)),
            a.writeFloat32Array(s, "contour");
            break;
        case o.default.Shape.Line:
            a.writeUint32(n.lineData.length / 2, "lineDataLength"),
            a.writeFloat32Array(n.lineData, "lineData")
        }
        t.writeBlock(a)
    }
    var ae = function() {
        function e(t) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e),
            this.options = t
        }
        return i(e, [{
            key: "addExportAsset",
            value: function(e, t) {
                var n = null
                  , i = this.assetLookup[e.refId];
                void 0 === i ? (this.assetLookup[e.refId] = this.assetData.length,
                n = {
                    asset: e,
                    bitmap: e.bitmap,
                    meshes: []
                },
                this.assetData.push(n)) : n = this.assetData[i],
                t.meshData && n.meshes.push(t.meshData)
            }
        }, {
            key: "export",
            value: function(e, t) {
                var n = []
                  , i = new Map
                  , a = [];
                this.assetLookup = {},
                this.assetData = a;
                var _ = this
                  , w = this.options;
                e.root.eachChildRecursive((function(e) {
                    switch (e.constructor) {
                    case c.default:
                        if (i.set(e, n.length),
                        n.push(e),
                        e.isVisible && e.asset)
                            if (e.asset instanceof P.default)
                                for (var t = 0; t < e.asset.children.length; t++) {
                                    var a = e.asset.children[t];
                                    _.addExportAsset(a, e)
                                }
                            else
                                e.bitmap && _.addExportAsset(e.asset, e);
                        break;
                    case o.default:
                    case k.default:
                    case l.default:
                    case C.default:
                    case d.default:
                    case r.default:
                    case p.default:
                    case h.default:
                    case f.default:
                    case u.default:
                    case s.default:
                    case g.default:
                    case m.default:
                    case y.default:
                    case v.default:
                        i.set(e, n.length),
                        n.push(e)
                    }
                }
                ));
                for (var O = [], E = 0; E < a.length; E++) {
                    var T = a[E]
                      , x = {
                        bytes: T.bitmap.bytes,
                        width: T.bitmap.width,
                        height: T.bitmap.height,
                        channels: T.bitmap.channels
                    }
                      , I = 1
                      , M = 1
                      , j = 0
                      , L = 0;
                    if (O.push(x),
                    w.cropImages)
                        for (var F = 0; F < T.meshes.length; F++)
                            for (var B = T.meshes[F].verts, V = B.length / 4, N = 0, H = 0; H < V; H++) {
                                var G = B[N + 2]
                                  , ae = B[N + 3];
                                N += 4,
                                G < I && (I = G),
                                G > j && (j = G),
                                ae < M && (M = ae),
                                ae > L && (L = ae)
                            }
                    x.minU = 1 !== I ? I : 0,
                    x.minV = 1 !== M ? M : 0,
                    x.maxU = 0 !== j ? j : 1,
                    x.maxV = 0 !== L ? L : 1
                }
                (new b.default).makeAtlas(O, {
                    multiplyAlpha: w.multiplyAlpha,
                    atlasPadding: w.atlasPadding,
                    atlasPowerOfTwo: w.atlasPowerOfTwo,
                    atlasSquare: w.atlasSquare,
                    maxAtlasWidth: w.maxAtlasWidth,
                    maxAtlasHeight: w.maxAtlasHeight,
                    maxImageWidth: w.maxImageWidth,
                    maxImageHeight: w.maxImageHeight
                }, (function(b) {
                    if (b) {
                        _.atlases = b.atlases;
                        for (var O = 0; O < b.bitmaps.length; O++) {
                            var P = b.bitmaps[O];
                            a[O].packing = P
                        }
                        var E = new _.stream;
                        E.sign("NIMA"),
                        E.writeUint32(16, "version");
                        var T = new _.block(R.Nodes,true);
                        T.writeUint16length(n.length);
                        for (var x = 0; x < n.length; x++) {
                            var I = n[x];
                            switch (I.constructor) {
                            case u.default:
                                U(_, T, I, i);
                                break;
                            case s.default:
                                K(_, T, I, i);
                                break;
                            case g.default:
                                X(_, T, I, i);
                                break;
                            case m.default:
                                J(_, T, I, i);
                                break;
                            case y.default:
                                Y(_, T, I, i);
                                break;
                            case v.default:
                                q(_, T, I, i);
                                break;
                            case C.default:
                                Q(_, T, I, i);
                                break;
                            case d.default:
                                W(_, T, I, i);
                                break;
                            case r.default:
                                Z(_, T, I, i);
                                break;
                            case p.default:
                                $(_, T, I, i);
                                break;
                            case c.default:
                                te(_, T, I, i);
                                break;
                            case h.default:
                                ee(_, T, I, i);
                                break;
                            case l.default:
                                ie(_, T, I, i);
                                break;
                            case k.default:
                                re(_, T, I, i);
                                break;
                            case o.default:
                                oe(_, T, I, i);
                                break;
                            case f.default:
                                z(_, T, I, i)
                            }
                        }
                        if (E.writeBlock(T),
                        w.view) {
                            var M = [0, 0]
                              , j = [1e3, 1e3]
                              , L = w.view;
                            L && (M = L.center,
                            j = L.size);
                            var F = new _.block(R.View);
                            F.writeFloat32(M[0], "x"),
                            F.writeFloat32(M[1], "y"),
                            F.writeFloat32(j[0], "width"),
                            F.writeFloat32(j[1], "height"),
                            E.writeBlock(F)
                        }
                        var B = e.orderedAnimations;
                        if (B) {
                            var V = new _.block(R.Animations,true);
                            V.writeUint16length(B.length);
                            var N = true
                              , H = false
                              , G = void 0;
                            try {
                                for (var ae, se = B[Symbol.iterator](); !(N = (ae = se.next()).done); N = true) {
                                    var le = ae.value;
                                    ne(_, V, le, i)
                                }
                            } catch (e) {
                                H = true,
                                G = e
                            } finally {
                                try {
                                    !N && se.return && se.return()
                                } finally {
                                    if (H)
                                        throw G
                                }
                            }
                            E.writeBlock(V)
                        }
                        var ue = w.isZipExport
                          , ce = b.atlases
                          , de = []
                          , he = 0;
                        if (ce.length)
                            for (var fe = 0; fe < ce.length; fe++) {
                                he++,
                                de.push(null);
                                var pe = ce[fe];
                                S.default.toCompressedBuffer(pe, "image/png", function(e) {
                                    return function(t) {
                                        ye(e, t)
                                    }
                                }(fe), "image/png", 1)
                            }
                        else
                            ye(-1)
                    } else
                        t(null);
                    function ye(e, n) {
                        if (e >= 0 && (de[e] = n,
                        he--),
                        0 === he)
                            if (ue) {
                                var i = ce.length;
                                if (i > 0) {
                                    var r = new _.block(R.Atlases);
                                    r.writeBool(true, "isOOB"),
                                    r.openArray("data"),
                                    r.writeUint16length(ce.length);
                                    var o = E;
                                    if (1 === i) {
                                        var a = w.characterName + ".png";
                                        r.writeString(a)
                                    } else if (i > 1)
                                        for (var s = 0; s < i; s++) {
                                            var l = w.characterName + s + ".png";
                                            r.writeString(l)
                                        }
                                    r.closeArray(),
                                    o.writeBlock(r)
                                }
                                var u = D.default.isNode ? E.toArrayBuffer() : E.toBlob();
                                A.default.createWriter(D.default.isNode ? new A.default.Uint8ArrayWriter : new A.default.BlobWriter, (function(e) {
                                    e.add(w.characterName + (w.extension || ".nima"), D.default.isNode ? new A.default.Uint8ArrayReader(u) : new A.default.BlobReader(u), (function() {
                                        var n = ce.length;
                                        if (n) {
                                            var i = 0;
                                            e.add(1 === n ? w.characterName + ".png" : w.characterName + "0.png", D.default.isNode ? new A.default.Uint8ArrayReader(de[0]) : new A.default.BlobReader(new Blob([de[0]],{
                                                type: "image/png"
                                            })), (function r() {
                                                ++i == n ? e.close((function(e) {
                                                    t(e)
                                                }
                                                )) : e.add(w.characterName + i + ".png", D.default.isNode ? new A.default.Uint8ArrayReader(de[i]) : new A.default.BlobReader(new Blob([de[i]],{
                                                    type: "image/png"
                                                })), r)
                                            }
                                            ))
                                        } else
                                            e.close((function(e) {
                                                t(e)
                                            }
                                            ))
                                    }
                                    ), (function(e, t) {}
                                    ))
                                }
                                ), (function(e) {}
                                ))
                            } else {
                                if (ce.length) {
                                    var c = new _.block(R.Atlases);
                                    c.writeBool(false, "isOOB"),
                                    c.openArray("data"),
                                    c.writeUint16length(ce.length);
                                    for (var d = 0; d < de.length; d++) {
                                        var h = de[d];
                                        c.writeUint32length(h.length),
                                        c.writeRaw(h)
                                    }
                                    c.closeArray(),
                                    E.writeBlock(c)
                                }
                                w.wantWriter ? t(E) : t(D.default.isNode ? E.toArrayBuffer() : E.toBlob("application/octet-stream"))
                            }
                    }
                }
                ))
            }
        }, {
            key: "block",
            get: function() {
                var e = this.options.writerFormat in B ? this.options.writerFormat : F.JSON;
                return B[e].block
            }
        }, {
            key: "stream",
            get: function() {
                var e = this.options.writerFormat in B ? this.options.writerFormat : F.JSON;
                return B[e].writer
            }
        }]),
        e
    }();
    t.default = ae
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = m(n(1)), a = m(n(12)), s = m(n(399)), l = m(n(13)), u = m(n(705)), c = m(n(707)), d = m(n(708)), h = m(n(709)), f = m(n(710)), p = m(n(1102)), y = m(n(711));
    function m(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function v(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var g = (v((i = function(e) {
        function t(e, n) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var i = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this));
            return i._Node = e,
            i._Animation = n,
            i._IsExpanded = false,
            i._HasHover = false,
            i._IsSelected = false,
            i._KeyFrameGroups = [],
            i._BaseGroup = null,
            i._RowCount = 0,
            i._PropertyGroups = [],
            i
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "clear",
            value: function() {
                for (var e = 0; e < this._KeyFrameGroups.length; e++) {
                    this._KeyFrameGroups[e].removeEventListener("update", this.updateGroup)
                }
                this._KeyFrameGroups.length = 0,
                this._BaseGroup = null,
                (0,
                l.default)(this.updateGroup)
            }
        }, {
            key: "addGroup",
            value: function(e) {
                null === this._BaseGroup && (this._BaseGroup = e),
                this._KeyFrameGroups.push(e),
                e.addEventListener("update", this.updateGroup),
                (0,
                l.default)(this.updateGroup)
            }
        }, {
            key: "translateX",
            value: function(e, t) {
                var n = this._Node;
                if (n.stageItem) {
                    var i = n.stageItem.stage
                      , r = n.actor
                      , o = new u.default(i,r,n.stageItem,e);
                    o.silent = t,
                    o.start(),
                    o.end()
                }
            }
        }, {
            key: "translateY",
            value: function(e, t) {
                var n = this._Node;
                if (n.stageItem) {
                    var i = n.stageItem.stage
                      , r = n.actor
                      , o = new c.default(i,r,n.stageItem,e);
                    o.silent = t,
                    o.start(),
                    o.end()
                }
            }
        }, {
            key: "setRotationRef",
            value: function(e) {
                this.rotationRef = e
            }
        }, {
            key: "rotate",
            value: function(e, t) {
                var n = this._Node;
                if (n.stageItem) {
                    var i = n.stageItem.stage
                      , r = n.actor
                      , o = (e - this.rotationRef.propertyValue) / 180 * Math.PI
                      , a = new d.default(i,r,n.stageItem,o);
                    a.silent = t,
                    a.start(),
                    a.end()
                }
            }
        }, {
            key: "scaleX",
            value: function(e, t) {
                var n = this._Node;
                n.stageItem && (n.scale = [e, n.scale[1]],
                t || n.stageItem.stage.appContext.captureJournalEntry())
            }
        }, {
            key: "scaleY",
            value: function(e, t) {
                var n = this._Node;
                n.stageItem && (n.scale = [n.scale[0], e],
                t || n.stageItem.stage.appContext.captureJournalEntry())
            }
        }, {
            key: "changeCollisionEnabled",
            value: function(e, t, n) {
                var i = this._Node;
                i.stageItem && (i.isCollisionEnabled = 1 === e,
                t || i.stageItem.stage.appContext.captureJournalEntry())
            }
        }, {
            key: "changeIntValue",
            value: function(e, t, n) {
                var i = this._Node;
                i.stageItem && (n.node.intValue = e,
                t || i.stageItem.stage.appContext.captureJournalEntry())
            }
        }, {
            key: "changeFloatValue",
            value: function(e, t, n) {
                var i = this._Node;
                i.stageItem && (n.node.floatValue = e,
                t || i.stageItem.stage.appContext.captureJournalEntry())
            }
        }, {
            key: "changeStringValue",
            value: function(e, t, n) {
                var i = this._Node;
                i.stageItem && (n.node.stringValue = e,
                t || i.stageItem.stage.appContext.captureJournalEntry())
            }
        }, {
            key: "changeBooleanValue",
            value: function(e, t, n) {
                var i = this._Node;
                i.stageItem && (n.node.booleanValue = 1 === e,
                t || i.stageItem.stage.appContext.captureJournalEntry())
            }
        }, {
            key: "changeActiveChild",
            value: function(e, t, n) {
                var i = this._Node;
                i.stageItem && (n.node.activeChildIndex = e - 1,
                t || i.stageItem.stage.appContext.captureJournalEntry())
            }
        }, {
            key: "elongate",
            value: function(e, t) {
                var n = this._Node;
                if (n.stageItem) {
                    var i = n.stageItem.stage
                      , r = n.actor
                      , o = new h.default(i,r,[n.stageItem],e);
                    o.silent = t,
                    o.start(),
                    o.end()
                }
            }
        }, {
            key: "changeOpacity",
            value: function(e, t) {
                var n = this._Node;
                if (n.stageItem) {
                    var i = n.stageItem.stage
                      , r = n.actor
                      , o = new f.default(i,r,n.stageItem,e);
                    o.silent = t,
                    o.start(),
                    o.end()
                }
            }
        }, {
            key: "changeSequence",
            value: function(e, t) {
                var n = this._Node;
                if (n.stageItem) {
                    var i = n.stageItem.stage
                      , r = n.actor
                      , o = new y.default(i,r,n.stageItem,e);
                    o.silent = t,
                    o.start(),
                    o.end()
                }
            }
        }, {
            key: "changeStrength",
            value: function(e, t) {
                var n = this._Node;
                n.stageItem && (n.strength = e,
                t || n.stageItem.stage.appContext.captureJournalEntry())
            }
        }, {
            key: "changeDrawOrder",
            value: function(e, t) {
                var n = this._Node;
                if (n.stageItem) {
                    var i = n.stageItem.stage
                      , r = n.actor
                      , o = new p.default(i,r,n.stageItem,e);
                    o.silent = t,
                    o.start(),
                    o.end()
                }
            }
        }, {
            key: "updateGroup",
            value: function() {
                for (var e = this._KeyFrameGroups, t = [], n = 1, i = 0; i < e.length; i++) {
                    var r = e[i]
                      , o = r.props;
                    if (o.framePosX || o.framePosY) {
                        var a = {
                            label: "Translation",
                            props: []
                        };
                        t.push(a),
                        o.framePosX && (a.props.push({
                            label: "X",
                            event: "animatePosX",
                            key: "framePosX",
                            onValueChanged: this.translateX,
                            frameList: o.framePosX
                        }),
                        n++),
                        o.framePosY && (a.props.push({
                            label: "Y",
                            event: "animatePosY",
                            key: "framePosY",
                            onValueChanged: this.translateY,
                            frameList: o.framePosY
                        }),
                        n++)
                    }
                    if (o.frameRotation) {
                        var l = {
                            label: "Rotation",
                            props: [{
                                label: "",
                                event: "animateRotation",
                                key: "frameRotation",
                                isAngle: true,
                                ref: this.setRotationRef,
                                onValueChanged: this.rotate,
                                frameList: o.frameRotation
                            }]
                        };
                        t.push(l),
                        n++
                    }
                    if (o.frameScaleX || o.frameScaleY) {
                        var u = {
                            label: "Scale",
                            props: []
                        };
                        t.push(u),
                        o.frameScaleX && (u.props.push({
                            label: "X",
                            event: "animateScaleX",
                            key: "frameScaleX",
                            onValueChanged: this.scaleX,
                            frameList: o.frameScaleX
                        }),
                        n++),
                        o.frameScaleY && (u.props.push({
                            label: "Y",
                            event: "animateScaleY",
                            key: "frameScaleY",
                            onValueChanged: this.scaleY,
                            frameList: o.frameScaleY
                        }),
                        n++)
                    }
                    if (o.frameOpacity) {
                        var c = {
                            label: "Opacity",
                            props: [{
                                label: "",
                                event: "animateOpacity",
                                key: "frameOpacity",
                                onValueChanged: this.changeOpacity,
                                frameList: o.frameOpacity
                            }]
                        };
                        t.push(c),
                        n++
                    }
                    if (o.frameSequence) {
                        var d = {
                            label: "Frame",
                            props: [{
                                label: "",
                                event: "animateSequence",
                                key: "frameSequence",
                                onValueChanged: this.changeSequence,
                                frameList: o.frameSequence
                            }]
                        };
                        t.push(d),
                        n++
                    }
                    if (o.frameStrength) {
                        var h = {
                            label: "Strength",
                            props: [{
                                label: "",
                                event: "animateStrength",
                                key: "frameStrength",
                                onValueChanged: this.changeStrength,
                                frameList: o.frameStrength
                            }]
                        };
                        t.push(h),
                        n++
                    }
                    if (o.frameLength) {
                        var f = {
                            label: "Length",
                            props: [{
                                label: "",
                                event: "animateLength",
                                key: "frameLength",
                                onValueChanged: this.elongate,
                                frameList: o.frameLength
                            }]
                        };
                        t.push(f),
                        n++
                    }
                    if (o.frameIsCollisionEnabled) {
                        var p = {
                            label: "Enabled",
                            props: [{
                                node: r.node,
                                label: "",
                                event: "animateCollisionEnabled",
                                key: "frameIsCollisionEnabled",
                                onValueChanged: this.changeCollisionEnabled,
                                frameList: o.frameIsCollisionEnabled,
                                isText: true,
                                enumerationIndex: function(e) {
                                    return e.node.isCollisionEnabled ? 1 : 0
                                },
                                enumeration: ["False", "True"]
                            }]
                        };
                        t.push(p),
                        n++
                    }
                    if (o.frameIntValue && r.node.propertyType === s.default.Type.Integer) {
                        var y = {
                            label: r.node.name,
                            props: [{
                                node: r.node,
                                label: "",
                                event: "animateIntValue",
                                key: "frameIntValue",
                                decimals: 0,
                                onValueChanged: this.changeIntValue,
                                frameList: o.frameIntValue
                            }]
                        };
                        t.push(y),
                        n++
                    }
                    if (o.frameFloatValue && r.node.propertyType === s.default.Type.Float) {
                        var m = {
                            label: r.node.name,
                            props: [{
                                node: r.node,
                                label: "",
                                event: "animateFloatValue",
                                key: "frameFloatValue",
                                onValueChanged: this.changeFloatValue,
                                frameList: o.frameFloatValue
                            }]
                        };
                        t.push(m),
                        n++
                    }
                    if (o.frameStringValue && r.node.propertyType === s.default.Type.String) {
                        var v = {
                            label: r.node.name,
                            props: [{
                                node: r.node,
                                label: "",
                                event: "animateStringValue",
                                key: "frameStringValue",
                                isText: true,
                                onValueChanged: this.changeStringValue,
                                frameList: o.frameStringValue
                            }]
                        };
                        t.push(v),
                        n++
                    }
                    if (o.frameBooleanValue && r.node.propertyType === s.default.Type.Boolean) {
                        var g = {
                            label: r.node.name,
                            props: [{
                                node: r.node,
                                label: "",
                                event: "animateBooleanValue",
                                key: "frameBooleanValue",
                                isText: true,
                                onValueChanged: this.changeBooleanValue,
                                frameList: o.frameBooleanValue,
                                enumerationIndex: function(e) {
                                    return e.node.booleanValue ? 1 : 0
                                },
                                enumeration: ["False", "True"]
                            }]
                        };
                        t.push(g),
                        n++
                    }
                    if (o.frameActiveChild) {
                        var _ = {
                            label: "Active Child",
                            props: [{
                                node: r.node,
                                label: "",
                                event: "animateActiveChild",
                                key: "frameActiveChild",
                                isText: true,
                                onValueChanged: this.changeActiveChild,
                                frameList: o.frameActiveChild,
                                enumerationIndex: function(e) {
                                    return e.node.activeChildIndex + 1
                                },
                                get enumeration() {
                                    var e = this.node
                                      , t = [{
                                        label: "None"
                                    }]
                                      , n = true
                                      , i = false
                                      , r = void 0;
                                    try {
                                        for (var o, a = e.children[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                                            var s = o.value;
                                            t.push({
                                                label: s.name,
                                                child: s
                                            })
                                        }
                                    } catch (e) {
                                        i = true,
                                        r = e
                                    } finally {
                                        try {
                                            !n && a.return && a.return()
                                        } finally {
                                            if (i)
                                                throw r
                                        }
                                    }
                                    return t
                                }
                            }]
                        };
                        t.push(_),
                        n++
                    }
                    if (o.frameDrawOrder) {
                        var b = {
                            label: "Draw Order",
                            props: [{
                                label: "",
                                event: "animateDrawOrder",
                                key: "frameDrawOrder",
                                onValueChanged: this.changeDrawOrder,
                                frameList: o.frameDrawOrder
                            }]
                        };
                        t.push(b),
                        n++
                    }
                    if (o.frameVertices) {
                        var w = {
                            label: "Vertex Deform",
                            props: [{
                                label: "",
                                event: "animateVertexDeform",
                                key: "frameVertices",
                                onValueChanged: null,
                                frameList: o.frameVertices
                            }]
                        };
                        t.push(w),
                        n++
                    }
                    if (o.frameTrigger) {
                        var O = {
                            label: "Trigger",
                            props: [{
                                label: "",
                                key: "frameTrigger",
                                frameList: o.frameTrigger
                            }]
                        };
                        t.push(O),
                        n++
                    }
                }
                this._RowCount = n,
                this._PropertyGroups = t,
                this.dispatch("update"),
                this._Animation.dispatchUpdateEditableRows()
            }
        }, {
            key: "rowCount",
            get: function() {
                return this._RowCount
            }
        }, {
            key: "propertyGroups",
            get: function() {
                return this._PropertyGroups
            }
        }, {
            key: "node",
            get: function() {
                return this._Node
            }
        }, {
            key: "animation",
            get: function() {
                return this._Animation
            }
        }, {
            key: "baseKeyFrameGroup",
            get: function() {
                return this._BaseGroup
            }
        }, {
            key: "keyFrameGroups",
            get: function() {
                return this._KeyFrameGroups
            }
        }, {
            key: "hasHover",
            get: function() {
                return this._HasHover
            },
            set: function(e) {
                this._HasHover != e && (this._HasHover = e,
                this.dispatch("hover"),
                this._Animation.dispatch("update"))
            }
        }, {
            key: "isSelected",
            get: function() {
                return this._IsSelected
            },
            set: function(e) {
                this._IsSelected != e && (this._IsSelected = e,
                this.dispatch("selected", this._IsSelected),
                this._Animation.dispatch("update"))
            }
        }, {
            key: "isExpanded",
            get: function() {
                return this._IsExpanded
            },
            set: function(e) {
                this._IsExpanded != e && (this._IsExpanded = e,
                this.dispatch("expand", e),
                this._Animation.dispatch("expand", this))
            }
        }]),
        t
    }(a.default)).prototype, "translateX", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "translateX"), i.prototype),
    v(i.prototype, "translateY", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "translateY"), i.prototype),
    v(i.prototype, "setRotationRef", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "setRotationRef"), i.prototype),
    v(i.prototype, "rotate", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "rotate"), i.prototype),
    v(i.prototype, "scaleX", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "scaleX"), i.prototype),
    v(i.prototype, "scaleY", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "scaleY"), i.prototype),
    v(i.prototype, "changeCollisionEnabled", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "changeCollisionEnabled"), i.prototype),
    v(i.prototype, "changeIntValue", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "changeIntValue"), i.prototype),
    v(i.prototype, "changeFloatValue", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "changeFloatValue"), i.prototype),
    v(i.prototype, "changeStringValue", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "changeStringValue"), i.prototype),
    v(i.prototype, "changeBooleanValue", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "changeBooleanValue"), i.prototype),
    v(i.prototype, "changeActiveChild", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "changeActiveChild"), i.prototype),
    v(i.prototype, "elongate", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "elongate"), i.prototype),
    v(i.prototype, "changeOpacity", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "changeOpacity"), i.prototype),
    v(i.prototype, "changeSequence", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "changeSequence"), i.prototype),
    v(i.prototype, "changeStrength", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "changeStrength"), i.prototype),
    v(i.prototype, "changeDrawOrder", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "changeDrawOrder"), i.prototype),
    v(i.prototype, "updateGroup", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "updateGroup"), i.prototype),
    i);
    t.default = g
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = o(n(314))
      , r = o(n(706));
    function o(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var a = function(e) {
        function t(e, n, i, o) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var a = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e, n));
            a._StageItem = i;
            var s = void 0;
            return (s = a._StageItem.node) && (s.translation = [o, s.translation[1]],
            (0,
            r.default)(a._Stage.settings.compensateBones, a._Stage.settings.compensateImages, s)),
            a
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        t
    }(i.default);
    t.default = a
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = function(e, t, n) {
        if (t || e) {
            var a = [];
            if (n.eachChild((function(n) {
                (t && (n.constructor === i.default || n.constructor === o.default) || e && n.constructor === r.default) && -1 == a.indexOf(n) && a.push(n)
            }
            )),
            a.length)
                for (var s = 0; s < a.length; s++) {
                    a[s].compensate()
                }
        }
    }
    ;
    var i = a(n(267))
      , r = a(n(237))
      , o = a(n(208));
    function a(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = o(n(314))
      , r = o(n(706));
    function o(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var a = function(e) {
        function t(e, n, i, o) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var a = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e, n));
            a._StageItem = i;
            var s = void 0;
            return (s = a._StageItem.node) && (s.translation = [s.translation[0], o],
            (0,
            r.default)(a._Stage.settings.compensateBones, a._Stage.settings.compensateImages, s)),
            a
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        t
    }(i.default);
    t.default = a
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = o(n(314))
      , r = o(n(585));
    function o(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var a = function(e) {
        function t(e, n, i, o) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var a = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e, n));
            (a._StageItem = i,
            a._StageItem && a._StageItem.node) && new r.default(null,null,a._Stage.settings.compensateBones,a._Stage.settings.compensateImages,[a._StageItem.node],a._StageItem.node.worldTranslation,false,[0, 0]).setRotationDelta(o);
            return a
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        t
    }(i.default);
    t.default = a
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = a(n(314))
      , r = n(2)
      , o = a(n(513));
    function a(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var s = function(e) {
        function t(e, n, i, a) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            for (var s = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e, n)), l = 0; l < i.length; l++) {
                var u = i[l]
                  , c = new o.default(e.settings.compensateBones,e.settings.compensateImages,[u.joint])
                  , d = r.mat2d.getTranslation(r.vec2.create(), u.parentJoint.renderTransform)
                  , h = r.mat2d.getTranslation(r.vec2.create(), u.joint.renderTransform)
                  , f = r.vec2.subtract(r.vec2.create(), h, d)
                  , p = a - r.vec2.length(f);
                0 === r.vec2.length(f) && (f = [1, 0]);
                var y = r.vec2.normalize(r.vec2.create(), f)
                  , m = r.vec2.scale(y, y, p);
                c.advance(null, m)
            }
            return s
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        t
    }(i.default);
    t.default = s
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = n(314);
    var o = function(e) {
        function t(e, n, i, r) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var o = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e, n));
            return i.node.opacity = r,
            o
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        t
    }(((i = r) && i.__esModule ? i : {
        default: i
    }).default);
    t.default = o
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = n(314);
    var o = function(e) {
        function t(e, n, i, r) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var o = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e, n));
            return i.node.sequence = r,
            o
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        t
    }(((i = r) && i.__esModule ? i : {
        default: i
    }).default);
    t.default = o
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = a(n(12))
      , o = a(n(1103));
    function a(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var s = function(e) {
        function t(e, n) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var i = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this));
            return i._Node = e,
            i._Animation = n,
            i._EmptyProperties = {},
            i._Properties = {},
            i._PropertiesList = [],
            i
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "triggerEvents",
            value: function(e, t) {
                for (var n = 0; n < this._PropertiesList.length; n++) {
                    var i = this._PropertiesList[n];
                    if (i.findTriggeredFrames) {
                        var r = i.findTriggeredFrames(e, t);
                        r && r.length && this._Animation.dispatch("triggerEvent", this._Node)
                    }
                }
            }
        }, {
            key: "interpolate",
            value: function(e) {
                for (var t = 0; t < this._PropertiesList.length; t++) {
                    var n = this._PropertiesList[t];
                    n.interpolate && n.interpolate(e)
                }
            }
        }, {
            key: "removeProperty",
            value: function(e) {
                var t = this._Properties[e];
                if (t) {
                    delete this._Properties[e];
                    var n = this._PropertiesList.indexOf(t);
                    -1 != n && (this._PropertiesList.splice(n, 1),
                    0 == this._PropertiesList.length && this._Animation.hideKeyedNode(this)),
                    this.dispatch("update", this._Properties)
                }
            }
        }, {
            key: "getKeyFrames",
            value: function(e) {
                var t = this._Properties[e];
                return t || (t = this._EmptyProperties[e]) && (delete this._EmptyProperties[e],
                this._Properties[e] = t,
                this._PropertiesList.push(t),
                this.dispatch("update", this._Properties)),
                t || (this._Properties[e] = t = new o.default(this,this._Animation,e),
                this._PropertiesList.push(t),
                1 == this._PropertiesList.length && this._Animation.showKeyedNode(this),
                this.dispatch("update", this._Properties),
                this._Animation.dispatch("update")),
                t
            }
        }, {
            key: "serialize",
            value: function() {
                for (var e = {}, t = 0; t < this._PropertiesList.length; t++) {
                    var n = this._PropertiesList[t];
                    e[n.property] = n.serialize()
                }
                return e
            }
        }, {
            key: "deserialize",
            value: function(e, t) {
                for (var n in t) {
                    var i, r = t[n];
                    if ("frameActiveChildIndex" === n) {
                        n = "frameActiveChild";
                        var a = this._Node.children;
                        if (a.length) {
                            var s = true
                              , l = false
                              , u = void 0;
                            try {
                                for (var c, d = r[Symbol.iterator](); !(s = (c = d.next()).done); s = true) {
                                    var h = c.value
                                      , f = a[h.v - 1];
                                    h.v = f ? f.refId : -1
                                }
                            } catch (e) {
                                l = true,
                                u = e
                            } finally {
                                try {
                                    !s && d.return && d.return()
                                } finally {
                                    if (l)
                                        throw u
                                }
                            }
                        }
                    }
                    this._Properties[n] = i = new o.default(this,this._Animation,n),
                    this._PropertiesList.push(i),
                    i.deserialize(e, r)
                }
            }
        }, {
            key: "hideProperty",
            value: function(e) {
                "frameDrawOrder" === e.property ? this._Animation.orderKeyState = 0 : this._Node[e.property + "KS"] = 0,
                this._EmptyProperties[e.property] = e;
                var n = this._PropertiesList.indexOf(e);
                if (-1 != n) {
                    this._PropertiesList.splice(n, 1),
                    delete this._Properties[e.property],
                    0 == this._PropertiesList.length && this._Animation.hideKeyedNode(this);
                    var i = t.RigPropertyLookup[e.property];
                    i && (this._Node[e.property] = this._Node[i]),
                    this.dispatch("update", this._Properties)
                }
            }
        }, {
            key: "showProperty",
            value: function(e) {
                delete this._EmptyProperties[e.property],
                -1 == this._PropertiesList.indexOf(e) && (this._PropertiesList.push(e),
                this._Properties[e.property] = e,
                1 == this._PropertiesList.length && this._Animation.showKeyedNode(this),
                this.dispatch("update", this._Properties))
            }
        }, {
            key: "props",
            get: function() {
                return this._Properties
            }
        }, {
            key: "propsList",
            get: function() {
                return this._PropertiesList
            }
        }, {
            key: "node",
            get: function() {
                return this._Node
            }
        }, {
            key: "animation",
            get: function() {
                return this._Animation
            }
        }]),
        t
    }(r.default);
    function l(e, t) {
        return {
            id: e,
            key: t
        }
    }
    t.default = s,
    s.Properties = {
        unknown: l(0, "unknown"),
        framePosX: l(1, "posX"),
        framePosY: l(2, "posY"),
        frameScaleX: l(3, "scaleX"),
        frameScaleY: l(4, "scaleY"),
        frameRotation: l(5, "rotation"),
        frameOpacity: l(6, "opacity"),
        frameDrawOrder: l(7, "drawOrder"),
        frameLength: l(8, "length"),
        frameVertices: l(9, "vertices"),
        frameStrength: l(10, "strength"),
        frameTrigger: l(11, "trigger"),
        frameIntValue: l(12, "intValue"),
        frameFloatValue: l(13, "floatValue"),
        frameStringValue: l(14, "stringValue"),
        frameBooleanValue: l(15, "boolValue"),
        frameIsCollisionEnabled: l(16, "isCollisionEnabled"),
        frameSequence: l(17, "sequence"),
        frameActiveChild: l(18, "activeChild")
    },
    s.RigPropertyLookup = {
        framePosX: "rigPosX",
        framePosY: "rigPosY",
        frameScaleX: "rigScaleX",
        frameScaleY: "rigScaleY",
        frameRotation: "rigRotation",
        frameOpacity: "rigOpacity",
        frameDrawOrder: "rigDrawOrder",
        frameLength: "rigLength",
        frameVertices: "rigVertices",
        frameStrength: "rigStrength",
        frameIntValue: "rigIntValue",
        frameFloatValue: "rigFloatValue",
        frameStringValue: "rigStringValue",
        frameBooleanValue: "rigBooleanValue",
        frameIsCollisionEnabled: "rigIsCollisionEnabled",
        frameSequence: "rigSequence",
        frameActiveChild: "rigActiveChild"
    },
    s.ExportPropertyLookup = {
        Unknown: 0,
        PosX: 1,
        PosY: 2,
        ScaleX: 3,
        ScaleY: 4,
        Rotation: 5,
        Opacity: 6,
        DrawOrder: 7,
        Length: 8,
        VertexDeform: 9,
        ConstraintStrength: 10,
        Trigger: 11,
        IntProperty: 12,
        FloatProperty: 13,
        StringProperty: 14,
        BooleanProperty: 15,
        IsCollisionEnabled: 16,
        Sequence: 17,
        ActiveChildIndex: 18
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = function(e, t) {
        for (var n = void 0, i = void 0, r = 1, o = e.length; r < o; r++) {
            for (i = e[r],
            n = r - 1; n >= 0 && t(i, e[n]) < 0; )
                e[n + 1] = e[n],
                n--;
            e[n + 1] = i
        }
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = s(n(12)), a = s(n(1));
    function s(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function l(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var u = (l((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this));
            return n.name = "Animations",
            n.isNameReadOnly = true,
            n._UpdateTimeout = null,
            e.addEventListener("animationListChanged", n.onUpdateRequired),
            n._Actor = e,
            n._AnimationList = [],
            n.update(),
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "sort",
            value: function(e) {
                var n = this._Actor.animations.slice(0);
                switch (e) {
                case t.SortOrder.Created:
                    break;
                case t.SortOrder.Alphabetical:
                    n.sort((function(e, t) {
                        return e.name.localeCompare(t.name)
                    }
                    ))
                }
                for (var i = 0; i < n.length; i++)
                    n[i].order = i
            }
        }, {
            key: "update",
            value: function() {
                var e = this._Actor.orderedAnimations;
                this._AnimationList = e,
                this.dispatch("update"),
                this.dispatch("childrenChanged")
            }
        }, {
            key: "onUpdateRequired",
            value: function() {
                clearTimeout(this._UpdateTimeout),
                this._UpdateTimeout = setTimeout(this.update, 0)
            }
        }, {
            key: "cleanup",
            value: function() {
                this._Actor.removeEventListener("animationListChanged", this.onUpdateRequired)
            }
        }, {
            key: "uiHierIconClass",
            get: function() {
                return "HierarchyAnimIcon"
            }
        }, {
            key: "uiIcon",
            get: function() {
                return "icon-animations"
            }
        }, {
            key: "sortOrder",
            get: function() {
                return this._SortOrder
            },
            set: function(e) {
                this._SortOrder != e && (this._SortOrder = e,
                this.update())
            }
        }, {
            key: "hierarchyChildren",
            get: function() {
                return this._AnimationList
            }
        }]),
        t
    }(o.default)).prototype, "update", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "update"), i.prototype),
    l(i.prototype, "onUpdateRequired", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onUpdateRequired"), i.prototype),
    i);
    t.default = u,
    u.SortOrder = {
        Created: 0,
        Alphabetical: 1
    }
}
, function(e, t, n) {
    var i = n(1121);
    "string" == typeof i && (i = [[e.i, i, ""]]);
    var r = {
        insertAt: "top",
        hmr: true,
        transform: void 0
    };
    n(8)(i, r);
    i.locals && (e.exports = i.locals)
}
, , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = n(511), a = (i = o) && i.__esModule ? i : {
        default: i
    };
    var s = 1
      , l = function(e) {
        function t(e) {
            return function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t),
            function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "assignID",
            value: function() {
                return this.id = "folder-" + s++,
                this.id
            }
        }, {
            key: "read",
            value: function(e, n, i) {
                (function e(t, n, i) {
                    null === t && (t = Function.prototype);
                    var r = Object.getOwnPropertyDescriptor(t, n);
                    if (void 0 === r) {
                        var o = Object.getPrototypeOf(t);
                        return null === o ? void 0 : e(o, n, i)
                    }
                    if ("value"in r)
                        return r.value;
                    var a = r.get;
                    return void 0 !== a ? a.call(i) : void 0
                }
                )(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "read", this).call(this, e, n, i);
                var r = this.id;
                if (r || (r = this.assignID()),
                r) {
                    var o = r.split("-");
                    if (o.length > 1) {
                        var a = Number.parseInt(o[1]);
                        a > s && (s = a + 1)
                    }
                }
            }
        }, {
            key: "resolveChildType",
            value: function(e, t) {
                var n = e.constructor.registeredAssets[t];
                return n ? n.ctr : null
            }
        }, {
            key: "uiIcon",
            get: function() {
                return "icon-folder"
            }
        }]),
        t
    }(a.default);
    t.default = l
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = l(n(0)), a = l(n(1133)), s = l(n(1));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function u(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var c = (u((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                value: 0
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "updateValue",
            value: function(e, t) {
                var n = this.props.minValue || 0;
                e = n + e * ((this.props.maxValue || 1) - n),
                this.setState({
                    value: e
                }),
                !t && this.props.onValueChanged && this.props.onValueChanged(e)
            }
        }, {
            key: "setValue",
            value: function(e, t) {
                var n = this.props.minValue || 0
                  , i = (e - n) / ((this.props.maxValue || 1) - n);
                this.refs.slider.setValue(i, t),
                t && this.updateValue(i, true)
            }
        }, {
            key: "componentDidMount",
            value: function() {
                void 0 !== this.props.value && null !== this.props.value && this.setValue(this.props.value, true)
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                void 0 !== e.value && e.value != this.props.value && this.setValue(e.value, true)
            }
        }, {
            key: "valueChangeComplete",
            value: function() {
                this.props.onValueChangeComplete && this.props.onValueChangeComplete()
            }
        }, {
            key: "render",
            value: function() {
                var e = Math.round(this.state.value * (this.props.displayScale || 1));
                return o.default.createElement("div", null, o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitleSlider"
                }, this.props.label), o.default.createElement("div", {
                    className: "SelectionPanelSliderValue"
                }, e)), o.default.createElement(a.default, {
                    ref: "slider",
                    onValueChanged: this.updateValue,
                    onValueChangeComplete: this.valueChangeComplete
                }))
            }
        }]),
        t
    }(o.default.Component)).prototype, "updateValue", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "updateValue"), i.prototype),
    u(i.prototype, "valueChangeComplete", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "valueChangeComplete"), i.prototype),
    i);
    t.default = c
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = c(n(0)), a = c(n(1)), s = c(n(4)), l = c(n(471)), u = c(n(3));
    function c(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function d(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var h = (d((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {},
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "nodeUpdate",
            value: function() {
                this.forceUpdate()
            }
        }, {
            key: "setNode",
            value: function(e) {
                this.node !== e && (this.node && this.node.removeEventListener("update", this.nodeUpdate),
                this.node = e,
                e && e.addEventListener("update", this.nodeUpdate))
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.bone != this.props.bone && this.setNode(e.bone)
            }
        }, {
            key: "componentDidMount",
            value: function() {
                this.setNode(this.props.node)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setNode(null),
                clearTimeout(this.selectTimeout)
            }
        }, {
            key: "commitEdit",
            value: function() {
                if (this.props.node) {
                    var e = new l.default(this.context.nima.stage,this.context.nima.actor,this.props.node,this.inputText.value);
                    e.start(),
                    e.end(),
                    this.endEdit(false)
                }
            }
        }, {
            key: "endEdit",
            value: function(e) {
                this.setState({
                    editing: false
                }),
                this.inputText && this.inputText.removeEventListener("blur", this.commitEdit),
                clearTimeout(this.editTimeout)
            }
        }, {
            key: "cancelEdit",
            value: function() {
                this.endEdit(true)
            }
        }, {
            key: "startEdit",
            value: function() {
                this.setState({
                    editing: true,
                    editName: this.props.node.name
                });
                var e = this;
                clearTimeout(this.editTimeout),
                this.editTimeout = setTimeout((function() {
                    e.inputText.focus(),
                    e.inputText.setSelectionRange(0, e.inputText.value.length),
                    e.inputText.addEventListener("blur", e.commitEdit)
                }
                ), 0)
            }
        }, {
            key: "editKeyDown",
            value: function(e) {
                switch (e.keyCode) {
                case 13:
                    this.inputText.blur();
                    break;
                case 27:
                    this.cancelEdit(),
                    this.inputText.blur()
                }
            }
        }, {
            key: "editTextChange",
            value: function(e) {
                this.setState({
                    editName: e.target.value
                })
            }
        }, {
            key: "select",
            value: function() {
                this.node && this.context.nima.stage.selectItem(this.node.stageItem)
            }
        }, {
            key: "textMouseDown",
            value: function(e) {
                e.stopPropagation(),
                clearTimeout(this.selectTimeout);
                var t = Date.now();
                this.lastMouseDown && t - this.lastMouseDown < 200 ? this.startEdit() : this.selectTimeout = setTimeout(this.select, 230),
                this.lastMouseDown = t
            }
        }, {
            key: "mouseEnter",
            value: function() {
                this.props.node && this.props.node.stageItem && this.props.node.stageItem.stage && (this.context.nima.stage.hoverItem = this.props.node.stageItem)
            }
        }, {
            key: "mouseLeave",
            value: function() {
                this.props.node && this.props.node.stageItem && this.props.node.stageItem.stage && this.context.nima.stage.hoverItem === this.props.node.stageItem && (this.context.nima.stage.hoverItem = null)
            }
        }, {
            key: "setInputText",
            value: function(e) {
                this.inputText = e
            }
        }, {
            key: "suppressEvent",
            value: function(e) {
                e.stopPropagation()
            }
        }, {
            key: "render",
            value: function() {
                var e = this.props
                  , t = e.node
                  , n = e.onRemove;
                return o.default.createElement("div", {
                    className: "MeshBoneRow",
                    onMouseEnter: this.mouseEnter,
                    onMouseLeave: this.mouseLeave,
                    onMouseDown: this.select
                }, o.default.createElement("svg", {
                    className: "TimelineIcon TimelineBoneIcon"
                }, o.default.createElement("use", {
                    xlinkHref: u.default.make("/images/symbol-defs.svg#" + t.uiIcon)
                })), this.state.editing ? o.default.createElement("input", {
                    ref: this.setInputText,
                    type: "text",
                    value: this.state.editName,
                    onKeyDown: this.editKeyDown,
                    onChange: this.editTextChange
                }) : o.default.createElement("div", {
                    className: "MeshBone",
                    onMouseDown: this.textMouseDown
                }, t.name), n ? o.default.createElement("svg", {
                    className: "DeleteRow",
                    onMouseDown: this.suppressEvent,
                    onClick: n
                }, o.default.createElement("use", {
                    xlinkHref: u.default.make("/images/symbol-defs.svg#icon-delete")
                })) : null)
            }
        }]),
        t
    }(o.default.Component)).prototype, "nodeUpdate", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "nodeUpdate"), i.prototype),
    d(i.prototype, "commitEdit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "commitEdit"), i.prototype),
    d(i.prototype, "endEdit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "endEdit"), i.prototype),
    d(i.prototype, "cancelEdit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "cancelEdit"), i.prototype),
    d(i.prototype, "startEdit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "startEdit"), i.prototype),
    d(i.prototype, "editKeyDown", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "editKeyDown"), i.prototype),
    d(i.prototype, "editTextChange", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "editTextChange"), i.prototype),
    d(i.prototype, "select", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "select"), i.prototype),
    d(i.prototype, "textMouseDown", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "textMouseDown"), i.prototype),
    d(i.prototype, "mouseEnter", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseEnter"), i.prototype),
    d(i.prototype, "mouseLeave", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseLeave"), i.prototype),
    d(i.prototype, "setInputText", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setInputText"), i.prototype),
    d(i.prototype, "suppressEvent", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "suppressEvent"), i.prototype),
    i);
    t.default = h,
    h.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = c(n(0)), a = c(n(1)), s = c(n(4)), l = c(n(471)), u = c(n(3));
    function c(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function d(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var h = (d((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {},
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "boneUpdate",
            value: function() {
                this.forceUpdate()
            }
        }, {
            key: "setBone",
            value: function(e) {
                this.bone !== e && (this.bone && this.bone.removeEventListener("update", this.boneUpdate),
                this.bone = e,
                e && e.addEventListener("update", this.boneUpdate))
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.bone != this.props.bone && this.setBone(e.bone)
            }
        }, {
            key: "componentDidMount",
            value: function() {
                this.setBone(this.props.bone)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setBone(null)
            }
        }, {
            key: "disconnect",
            value: function() {
                this.props.bone.stageItem.isConnected = false,
                this.props.image ? this.props.image.disconnectBone(this.props.bone) : this.props.disconnect && this.props.disconnect(this.props.bone),
                this.context.nima.stage.updateHighlights(),
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "commitEdit",
            value: function() {
                var e = new l.default(this.context.nima.stage,this.context.nima.actor,this.props.bone,this.inputText.value);
                e.start(),
                e.end(),
                this.endEdit(false)
            }
        }, {
            key: "endEdit",
            value: function(e) {
                this.setState({
                    editing: false
                }),
                this.inputText && this.inputText.removeEventListener("blur", this.commitEdit),
                clearTimeout(this.editTimeout)
            }
        }, {
            key: "cancelEdit",
            value: function() {
                this.endEdit(true)
            }
        }, {
            key: "startEdit",
            value: function() {
                this.setState({
                    editing: true,
                    editName: this.props.bone.name
                });
                var e = this;
                clearTimeout(this.editTimeout),
                this.editTimeout = setTimeout((function() {
                    e.inputText.focus(),
                    e.inputText.setSelectionRange(0, e.inputText.value.length),
                    e.inputText.addEventListener("blur", e.commitEdit)
                }
                ), 0)
            }
        }, {
            key: "editKeyDown",
            value: function(e) {
                switch (e.keyCode) {
                case 13:
                    this.inputText.blur();
                    break;
                case 27:
                    this.cancelEdit(),
                    this.inputText.blur()
                }
            }
        }, {
            key: "editTextChange",
            value: function(e) {
                this.setState({
                    editName: e.target.value
                })
            }
        }, {
            key: "textMouseDown",
            value: function(e) {
                var t = Date.now();
                this.lastMouseDown && t - this.lastMouseDown < 200 && this.startEdit(),
                this.lastMouseDown = t
            }
        }, {
            key: "mouseEnter",
            value: function() {
                this.props.bone && this.props.bone.stageItem && this.props.bone.stageItem.stage && (this.context.nima.stage.hoverItem = this.props.bone.stageItem)
            }
        }, {
            key: "mouseLeave",
            value: function() {
                this.props.bone && this.props.bone.stageItem && this.props.bone.stageItem.stage && this.context.nima.stage.hoverItem === this.props.bone.stageItem && (this.context.nima.stage.hoverItem = null)
            }
        }, {
            key: "setInputText",
            value: function(e) {
                this.inputText = e
            }
        }, {
            key: "render",
            value: function() {
                var e = this.props.allowDisconnect;
                return o.default.createElement("div", {
                    className: "MeshBoneRow",
                    onMouseEnter: this.mouseEnter,
                    onMouseLeave: this.mouseLeave
                }, o.default.createElement("svg", {
                    className: "TimelineIcon TimelineBoneIcon"
                }, o.default.createElement("use", {
                    xlinkHref: u.default.make("/images/symbol-defs.svg#icon-bone")
                })), this.state.editing ? o.default.createElement("input", {
                    ref: this.setInputText,
                    type: "text",
                    value: this.state.editName,
                    onKeyDown: this.editKeyDown,
                    onChange: this.editTextChange
                }) : o.default.createElement("div", {
                    className: "MeshBone",
                    onMouseDown: this.textMouseDown
                }, this.props.bone.name), e ? o.default.createElement("svg", {
                    className: "DeleteRow",
                    onClick: this.disconnect
                }, o.default.createElement("use", {
                    xlinkHref: u.default.make("/images/symbol-defs.svg#icon-delete")
                })) : null)
            }
        }]),
        t
    }(o.default.Component)).prototype, "boneUpdate", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "boneUpdate"), i.prototype),
    d(i.prototype, "disconnect", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "disconnect"), i.prototype),
    d(i.prototype, "commitEdit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "commitEdit"), i.prototype),
    d(i.prototype, "endEdit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "endEdit"), i.prototype),
    d(i.prototype, "cancelEdit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "cancelEdit"), i.prototype),
    d(i.prototype, "startEdit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "startEdit"), i.prototype),
    d(i.prototype, "editKeyDown", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "editKeyDown"), i.prototype),
    d(i.prototype, "editTextChange", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "editTextChange"), i.prototype),
    d(i.prototype, "textMouseDown", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "textMouseDown"), i.prototype),
    d(i.prototype, "mouseEnter", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseEnter"), i.prototype),
    d(i.prototype, "mouseLeave", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseLeave"), i.prototype),
    d(i.prototype, "setInputText", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setInputText"), i.prototype),
    i);
    t.default = h,
    h.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = s(n(0))
      , o = s(n(1150))
      , a = s(n(347));
    function s(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var l = function(e) {
        function t(e) {
            return function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t),
            function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "render",
            value: function() {
                var e = this.props
                  , t = e.disabled
                  , n = e.value
                  , i = e.onValueChanged
                  , s = e.dragScale
                  , l = e.onValueCommit
                  , u = e.isOn
                  , c = e.onToggle
                  , d = e.converter;
                return r.default.createElement("div", {
                    className: "SelectionPanelCheckProperty"
                }, r.default.createElement(o.default, {
                    value: u,
                    onValueChange: c
                }), r.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle",
                    style: {
                        opacity: u ? null : ".45"
                    }
                }, this.props.label), r.default.createElement(a.default, {
                    disabled: t || !u,
                    value: n,
                    converter: d,
                    onValueChanged: i,
                    dragScale: s,
                    onValueCommit: l
                }))
            }
        }]),
        t
    }(r.default.Component);
    t.default = l
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = n(203);
    var o = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.isVisible = false,
            n.isFake = true,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        t
    }(((i = r) && i.__esModule ? i : {
        default: i
    }).default);
    t.default = o
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = n(203);
    var o = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.isVisible = false,
            n.isFake = true,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        t
    }(((i = r) && i.__esModule ? i : {
        default: i
    }).default);
    t.default = o
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = r(n(203));
    r(n(357)),
    n(2);
    function r(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var o = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.isVisible = false,
            n.isFake = true,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        t
    }(i.default);
    t.default = o
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = r(n(203));
    r(n(357)),
    n(2);
    function r(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var o = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.isVisible = false,
            n.isFake = true,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        t
    }(i.default);
    t.default = o
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = c(n(203))
      , o = n(2)
      , a = (c(n(1)),
    c(n(444)))
      , s = c(n(9))
      , l = c(n(201))
      , u = c(n(3));
    function c(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var d = [1, 1, 1, 1]
      , h = [198 / 255, 198 / 255, 198 / 255, 1]
      , f = [0, 139 / 255, 1, 1]
      , p = function(e) {
        function t() {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var e = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, null));
            return e.drawAfterSelections = true,
            e.isHandle = true,
            e.hitDetectOnMesh = false,
            e.isSelectable = false,
            e._HoverIndex = -1,
            e._SelectedIndices = new Set,
            e
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "customHitDetect",
            value: function(e, t) {
                return false
            }
        }, {
            key: "draw",
            value: function(e, t) {
                var n = this._PieBuffer;
                n || (this._PieBuffer = n = e.makeVertexBuffer());
                var i = this.stage.appContext.editingWeights;
                if (i) {
                    var r = []
                      , a = 0
                      , s = this._SelectedIndices;
                    e.enableNormalBlending();
                    for (var u = o.mat2d.create(), c = this.stage, p = c.viewTransform, y = 1 / c.scale, m = o.mat2d.fromScaling(o.mat2d.create(), [y, y]), v = this.stageContext, g = i.verts, _ = i.showDeformed ? null : i.node.worldTransform, b = i.node.weightData, w = v.vertexTargetImage, O = o.vec2.create(), S = g.length / 4, k = 0, P = 0; P < S; P++) {
                        var E = g[k]
                          , T = g[k + 1] - 2 * y;
                        k += 4,
                        _ ? o.vec2.transformMat2d(O, [E, T], _) : (O[0] = E,
                        O[1] = T);
                        var C = o.mat2d.fromTranslation(u, O);
                        o.mat2d.mul(C, C, m);
                        var x = o.mat2d.mul(u, p, C)
                          , I = s.has(P);
                        if (I) {
                            for (var D = 8 * P, M = 0, A = 0; A < 4; A++)
                                if (!(window.blk && A < window.blk)) {
                                    var j = b[D + A]
                                      , L = b[D + A + 4];
                                    if (L > 0) {
                                        var R = l.default.Colors[j - 1]
                                          , F = 360 * L;
                                        r.push(O[0], O[1] + 2 * y),
                                        r.push(.75 * R[0], .75 * R[1], .75 * R[2], .75 * R[3]),
                                        r.push(180 - F / 2 + M),
                                        r.push(15),
                                        r.push(360 - F),
                                        a++,
                                        M -= F
                                    }
                                }
                            var B = v.pieShadowImage;
                            e.drawTextured(x, v.shadowVertexBuffer, v.indexBuffer, .6, d, B, true)
                        }
                        e.drawTextured(x, v.vertexBuffer, v.indexBuffer, 1, I ? f : P === this._HoverIndex ? h : d, w, true)
                    }
                    if (a) {
                        n.update(r),
                        e.drawPies(c.viewTransform, n, a, 40)
                    }
                }
            }
        }, {
            key: "clearSelections",
            value: function() {
                this._SelectedIndices.clear()
            }
        }, {
            key: "selectHover",
            value: function(e) {
                var t = this._SelectedIndices;
                s.default.isMultiSelect(e) || t.clear(),
                -1 !== this._HoverIndex && t.add(this._HoverIndex)
            }
        }, {
            key: "marqueeStarted",
            value: function() {
                this._PreMarqueeSelections = new Set(this._SelectedIndices)
            }
        }, {
            key: "marquee",
            value: function(e) {
                var t = this.stage.appContext.editingWeights;
                if (t) {
                    for (var n = e.isToggle, i = e.isDeselect, r = (o.mat2d.create(),
                    this.stage,
                    t.verts), a = t.showDeformed ? null : t.node.worldTransform, s = o.vec2.create(), l = r.length / 4, u = 0, c = e.rect, d = c[0][0], h = c[2][0], f = c[0][1], p = c[2][1], y = new Set(this._PreMarqueeSelections), m = new Set, v = 0; v < l; v++) {
                        var g = r[u]
                          , _ = r[u + 1];
                        if (u += 4,
                        a ? o.vec2.transformMat2d(s, [g, _], a) : (s[0] = g,
                        s[1] = _),
                        s[0] >= d && s[0] <= h && s[1] >= f && s[1] <= p)
                            if (i) {
                                if (y.has(v)) {
                                    y.delete(v);
                                    continue
                                }
                            } else {
                                if (n && y.has(v)) {
                                    y.delete(v);
                                    continue
                                }
                                m.add(v)
                            }
                    }
                    var b = true
                      , w = false
                      , O = void 0;
                    try {
                        for (var S, k = y[Symbol.iterator](); !(b = (S = k.next()).done); b = true) {
                            var P = S.value;
                            m.add(P)
                        }
                    } catch (e) {
                        w = true,
                        O = e
                    } finally {
                        try {
                            !b && k.return && k.return()
                        } finally {
                            if (w)
                                throw O
                        }
                    }
                    this._SelectedIndices = m
                }
            }
        }, {
            key: "hasSelection",
            get: function() {
                return 0 !== this._SelectedIndices.size
            }
        }, {
            key: "selectedVertices",
            get: function() {
                return Array.from(this._SelectedIndices)
            }
        }, {
            key: "selectedWeights",
            get: function() {
                var e = this.stage.appContext.editingWeights;
                if (!e)
                    return null;
                var t = e.node.weightData
                  , n = this._SelectedIndices
                  , i = new Map
                  , r = true
                  , o = false
                  , a = void 0;
                try {
                    for (var s, l = n[Symbol.iterator](); !(r = (s = l.next()).done); r = true)
                        for (var u = 8 * s.value, c = 0; c < 4; c++) {
                            var d = t[u + c]
                              , h = t[u + c + 4];
                            if (d > 0 && 0 !== h) {
                                d--;
                                var f = i.get(d);
                                void 0 === f ? i.set(d, h) : f !== h && i.set(d, false)
                            }
                        }
                } catch (e) {
                    o = true,
                    a = e
                } finally {
                    try {
                        !r && l.return && l.return()
                    } finally {
                        if (o)
                            throw a
                    }
                }
                return i
            }
        }, {
            key: "position",
            get: function() {
                return o.mat2d.getTranslation(o.vec2.create(), this.renderTransform)
            },
            set: function(e) {
                this.renderTransform = o.mat2d.fromTranslation(o.mat2d.create(), e),
                this._HoverIndex = -1;
                var t = this.stage.appContext.editingWeights;
                if (t) {
                    o.mat2d.create();
                    for (var n = this.stage, i = (n.viewTransform,
                    1 / n.scale), r = 8 * i, a = r * r, s = (o.mat2d.fromScaling(o.mat2d.create(), [i, i]),
                    this.stageContext), l = t.verts, u = t.showDeformed ? null : t.node.worldTransform, c = (s.vertexTargetImage,
                    o.vec2.create()), d = l.length / 4, h = 0, f = 0; f < d; f++) {
                        var p = l[h]
                          , y = l[h + 1] - 2 * i;
                        h += 4,
                        u ? o.vec2.transformMat2d(c, [p, y], u) : (c[0] = p,
                        c[1] = y),
                        o.vec2.squaredDistance(c, e) < a && (this._HoverIndex = f)
                    }
                }
            }
        }]),
        t
    }(r.default);
    t.default = p,
    p.initializeStageContext = function(e, t) {
        t.vertexTargetImage = e.loadTexture(u.default.make("/images/vertex_paint_target.png"), a.default.MultiplyAlpha),
        t.pieShadowImage = e.loadTexture(u.default.make("/images/pie_shadow.png"), a.default.MultiplyAlpha);
        var n = [-8.5, -8.5, 0, 1, 8.5, -8.5, 1, 1, 8.5, 8.5, 1, 0, -8.5, 8.5, 0, 0]
          , i = [-39, -49, 0, 1, 39, -49, 1, 1, 39, 29, 1, 0, -39, 29, 0, 0]
          , r = [-8.5, -8.5, 8.5, -8.5, 8.5, 8.5, -8.5, 8.5]
          , o = [0, 1, 2, 2, 3, 0];
        t.vertexBuffer = e.makeVertexBuffer(n),
        t.shadowVertexBuffer = e.makeVertexBuffer(i),
        t.cVertexBuffer = e.makeVertexBuffer(r),
        t.indexBuffer = e.makeIndexBuffer(o),
        t.points = n,
        t.index = o
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = s(n(0)), a = s(n(1));
    function s(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function l(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var u = (l((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                isFocused: false,
                input: null
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "focus",
            value: function(e) {
                this.setState({
                    isFocused: true,
                    input: t.formatValue(this.props.value, this.props.rate)
                });
                var n = this.inputField;
                setTimeout((function() {
                    n.setSelectionRange(0, n.value.length)
                }
                ), 0)
            }
        }, {
            key: "parse",
            value: function(e, t) {
                var n = e.split(":");
                return 0 == n.length || 1 == n.length ? Math.round(Number.parseFloat(e)) : 2 == n.length ? Math.round(Number.parseFloat(n[0])) * t + Math.round(Number.parseFloat(n[1])) : 60 * Math.round(Number.parseFloat(n[0])) * t + Math.round(Number.parseFloat(n[1])) * t + Math.round(Number.parseFloat(n[2]))
            }
        }, {
            key: "blur",
            value: function(e) {
                if (null !== this.state.input) {
                    var t = this.parse(e.target.value, this.props.rate);
                    this.props.onValueChanged && !isNaN(t) && this.props.onValueChanged(t)
                }
                this.setState({
                    isFocused: false
                })
            }
        }, {
            key: "inputText",
            value: function(e) {
                this.setState({
                    input: e.target.value
                })
            }
        }, {
            key: "keyDown",
            value: function(e) {
                switch (e.keyCode) {
                case 13:
                    this.inputField.blur();
                    break;
                case 27:
                    this.state.input = null,
                    this.inputField.blur()
                }
            }
        }, {
            key: "setInputField",
            value: function(e) {
                this.inputField = e
            }
        }, {
            key: "render",
            value: function() {
                var e = (this.state.isFocused ? this.state.input : t.formatValue(this.props.value, this.props.rate)) || "";
                return o.default.createElement("input", {
                    className: this.props.className,
                    type: "text",
                    ref: this.setInputField,
                    value: e,
                    onKeyDown: this.keyDown,
                    onChange: this.inputText,
                    onFocus: this.focus,
                    onBlur: this.blur
                })
            }
        }]),
        t
    }(o.default.Component)).prototype, "focus", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "focus"), i.prototype),
    l(i.prototype, "blur", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "blur"), i.prototype),
    l(i.prototype, "inputText", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "inputText"), i.prototype),
    l(i.prototype, "keyDown", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "keyDown"), i.prototype),
    l(i.prototype, "setInputField", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setInputField"), i.prototype),
    i);
    t.default = u,
    u.formatValue = function(e, t) {
        if (t) {
            var n = Math.floor(e)
              , i = n / t
              , r = Math.floor(i / 60);
            e = (0 == r ? "00" : r < 10 ? "0" + r : r) + ":" + (0 == (i = Math.floor(i - 60 * r)) ? "00" : i < 10 ? "0" + i : i) + ":" + (0 == (n -= (i + 60 * r) * t) ? "00" : n < 10 ? "0" + n : n)
        } else
            e = Math.round(e);
        return e
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    });
    t.default = function e() {
        !function(e, t) {
            if (!(e instanceof t))
                throw new TypeError("Cannot call a class as a function")
        }(this, e)
    }
}
, function(e, t, n) {
    "use strict";
    var i;
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , o = $(n(12))
      , a = $(n(1))
      , s = $(n(428))
      , l = $(n(267))
      , u = $(n(208))
      , c = $(n(344))
      , d = $(n(237))
      , h = $(n(398))
      , f = $(n(510))
      , p = $(n(596))
      , y = $(n(443))
      , m = $(n(599))
      , v = $(n(514))
      , g = $(n(600))
      , _ = $(n(598))
      , b = $(n(597))
      , w = $(n(694))
      , O = $(n(1216))
      , S = $(n(184))
      , k = $(n(464))
      , P = $(n(382))
      , E = $(n(519))
      , T = $(n(604))
      , C = $(n(445))
      , x = $(n(717))
      , I = $(n(399))
      , D = $(n(384))
      , M = $(n(448))
      , A = $(n(1217))
      , j = $(n(396))
      , L = $(n(581))
      , R = $(n(315))
      , F = $(n(383))
      , B = $(n(261))
      , V = $(n(201))
      , N = $(n(372))
      , z = $(n(1218))
      , W = $(n(371))
      , H = $(n(722))
      , U = $(n(609))
      , K = $(n(723))
      , G = $(n(610))
      , X = $(n(611))
      , J = $(n(724))
      , Y = $(n(725))
      , q = $(n(243))
      , Q = $(n(358))
      , Z = $(n(262));
    function $(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function ee(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    function te(e, t) {
        if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function")
    }
    var ne = function() {
        function e(t) {
            te(this, e),
            this._HistoryList = [],
            this._RemoveList = [],
            this._AddList = [],
            this._NotifyList = [],
            this._Actor = t
        }
        return r(e, [{
            key: "processChanges",
            value: function() {
                var e = new Set
                  , t = new Set
                  , n = true
                  , i = false
                  , r = void 0;
                try {
                    for (var o, a = this._HistoryList[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                        var s = o.value
                          , l = s.from
                          , u = s.to
                          , c = true
                          , d = false
                          , h = void 0;
                        try {
                            for (var f, p = l[Symbol.iterator](); !(c = (f = p.next()).done); c = true) {
                                var y = f.value;
                                if (-1 === u.indexOf(y)) {
                                    if (!y.hasChildren) {
                                        e.add(y);
                                        continue
                                    }
                                    y.all((function(t) {
                                        e.add(t)
                                    }
                                    ))
                                }
                            }
                        } catch (e) {
                            d = true,
                            h = e
                        } finally {
                            try {
                                !c && p.return && p.return()
                            } finally {
                                if (d)
                                    throw h
                            }
                        }
                        var m = true
                          , v = false
                          , g = void 0;
                        try {
                            for (var _, b = u[Symbol.iterator](); !(m = (_ = b.next()).done); m = true) {
                                var w = _.value;
                                if (-1 === l.indexOf(w)) {
                                    if (!w.hasChildren) {
                                        t.add(w);
                                        continue
                                    }
                                    w.all((function(e) {
                                        t.add(e)
                                    }
                                    ))
                                }
                            }
                        } catch (e) {
                            v = true,
                            g = e
                        } finally {
                            try {
                                !m && b.return && b.return()
                            } finally {
                                if (v)
                                    throw g
                            }
                        }
                    }
                } catch (e) {
                    i = true,
                    r = e
                } finally {
                    try {
                        !n && a.return && a.return()
                    } finally {
                        if (i)
                            throw r
                    }
                }
                var O = true
                  , S = false
                  , k = void 0;
                try {
                    for (var P, E = e[Symbol.iterator](); !(O = (P = E.next()).done); O = true) {
                        P.value.onRemovedFromActor()
                    }
                } catch (e) {
                    S = true,
                    k = e
                } finally {
                    try {
                        !O && E.return && E.return()
                    } finally {
                        if (S)
                            throw k
                    }
                }
                var T = true
                  , C = false
                  , x = void 0;
                try {
                    for (var I, D = t[Symbol.iterator](); !(T = (I = D.next()).done); T = true) {
                        I.value.onAddedToActor()
                    }
                } catch (e) {
                    C = true,
                    x = e
                } finally {
                    try {
                        !T && D.return && D.return()
                    } finally {
                        if (C)
                            throw x
                    }
                }
            }
        }, {
            key: "add",
            value: function(e, t, n) {
                this._HistoryList.push({
                    item: e,
                    from: t,
                    to: n
                })
            }
        }, {
            key: "changeChildren",
            value: function(e, t, n) {
                this._NotifyList.push(e),
                e.silentlySetChildren(n.slice(0));
                for (var i = 0; i < t.length; i++) {
                    var r = t[i];
                    -1 === n.indexOf(r) && this._RemoveList.push(r)
                }
                for (var o = 0; o < n.length; o++) {
                    var a = n[o];
                    -1 === t.indexOf(a) && this._AddList.push({
                        parent: e,
                        child: a
                    })
                }
            }
        }, {
            key: "commitChanges",
            value: function(e) {
                var t = this._Actor
                  , n = function(n) {
                    n.hasChildren ? n.all((function(i) {
                        i.stageItem && e.queueRemove(i.stageItem),
                        n.constructor === c.default && (i.isCollapsedVisibility = false),
                        i.constructor === l.default && t.drawOrder.removeImage(i)
                    }
                    )) : n.stageItem && e.queueRemove(n.stageItem),
                    n.setParent(null)
                }
                  , i = true
                  , r = false
                  , o = void 0;
                try {
                    for (var a, s = this._RemoveList[Symbol.iterator](); !(i = (a = s.next()).done); i = true) {
                        n(a.value)
                    }
                } catch (e) {
                    r = true,
                    o = e
                } finally {
                    try {
                        !i && s.return && s.return()
                    } finally {
                        if (r)
                            throw o
                    }
                }
                var u = this._AddList
                  , d = true
                  , h = false
                  , f = void 0;
                try {
                    for (var p, y = u[Symbol.iterator](); !(d = (p = y.next()).done); d = true) {
                        var m = p.value
                          , v = m.child
                          , g = m.parent;
                        v.hasChildren ? v.all((function(n) {
                            n.stageItem && e.queueAdd(n.stageItem),
                            n.constructor === l.default && t.drawOrder.addImage(n)
                        }
                        )) : v.stageItem && e.queueAdd(v.stageItem),
                        v.setParent(g);
                        var _ = v;
                        if (_.hasChildren)
                            for (var b = 0; b < _.children.length; b++) {
                                var w = _.children[b];
                                w.parent != _ && w.setParent(_)
                            }
                    }
                } catch (e) {
                    h = true,
                    f = e
                } finally {
                    try {
                        !d && y.return && y.return()
                    } finally {
                        if (h)
                            throw f
                    }
                }
                for (var O = 0; O < this._NotifyList.length; O++) {
                    this._NotifyList[O].notifyChildrenChanged()
                }
                t.forceRedraw()
            }
        }, {
            key: "reset",
            value: function() {
                this._RemoveList = [],
                this._AddList = [],
                this._NotifyList = []
            }
        }, {
            key: "undo",
            value: function(e) {
                this.reset();
                for (var t = 0; t < this._HistoryList.length; t++) {
                    var n = this._HistoryList[t];
                    this.changeChildren(n.item, n.to, n.from)
                }
                this.commitChanges(e)
            }
        }, {
            key: "redo",
            value: function(e) {
                this.reset();
                for (var t = 0; t < this._HistoryList.length; t++) {
                    var n = this._HistoryList[t];
                    this.changeChildren(n.item, n.from, n.to)
                }
                this.commitChanges(e)
            }
        }]),
        e
    }()
      , ie = (ee((i = function(e) {
        function t() {
            te(this, t);
            var e = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this));
            return e._Root = new u.default(e),
            e._Root.name = "Hierarchy",
            e._Assets = [],
            e._AssetFolder = new x.default,
            e._TempAssetLookup = null,
            e._AssetsUpdated = false,
            e._Animations = [],
            e._NodeLookup = {},
            e._WhenNodesLoadedActions = [],
            e._PlayingAnimations = [],
            e._IsTimeTraveling = false,
            e._DrawOrder = new O.default,
            e._ForceRedraw = false,
            e._LastFullState = new Map,
            e._DependencyGraph = null,
            e._AreDependenciesDirty = false,
            e._IsKeyStateDirty = false,
            e._ChildrenChanged = false,
            e
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "updateDependencies",
            value: function() {
                var e = new A.default(this._Root);
                return this._DependencyGraph = e,
                this._AreDependenciesDirty = false,
                this._Root.updateDependencies(e),
                this.dispatch("dependenciesUpdate"),
                e.sort()
            }
        }, {
            key: "notifyChildrenChanged",
            value: function() {
                this._ChildrenChanged = true
            }
        }, {
            key: "notifyAssetChildrenChanged",
            value: function() {
                this._AssetsUpdated = true
            }
        }, {
            key: "forceRedraw",
            value: function() {
                this._ForceRedraw = true
            }
        }, {
            key: "loadAssets",
            value: function(e) {
                var t = this;
                return new Promise((function(n, i) {
                    var r = e;
                    if (r) {
                        r instanceof Array && (r = {
                            id: "folder-1",
                            type: "folder",
                            children: r
                        });
                        var o = new x.default;
                        t._AssetFolder = o,
                        o.read(t, r, (function() {
                            n(this)
                        }
                        ))
                    } else
                        n()
                }
                ))
            }
        }, {
            key: "loadHierarchy",
            value: function(e) {
                var n = this;
                return new Promise((function(i, r) {
                    if (n.initNodeLookup(),
                    e.root && "node" == e.root.type) {
                        var o = t.registeredNodes[e.root.type];
                        n._Root.read(n, e.root),
                        n._Root.name = "Hierarchy",
                        o.stageCtr && (n._Root.stageItem = new o.stageCtr(n._Root)),
                        e.root.children && n.recurseLoad(e.root.children, n._Root),
                        n._DrawOrder.updateDrawOrder()
                    }
                    for (var a = 0; a < n._WhenNodesLoadedActions.length; a++)
                        n._WhenNodesLoadedActions[a]();
                    if (n._WhenNodesLoadedActions = [],
                    e.animations)
                        for (var s = 0; s < e.animations.length; s++) {
                            var l = e.animations[s]
                              , u = new Q.default(n);
                            u.read(n, l),
                            n.addAnimation(u, true)
                        }
                    n.clearNodeLookup(),
                    n._AreDependenciesDirty = true,
                    n.advance(0),
                    n.getJournalEntry(),
                    i()
                }
                ))
            }
        }, {
            key: "load",
            value: function(e) {
                return Promise.all([this.loadAssets(e.assets), this.loadHierarchy(e)])
            }
        }, {
            key: "whenNodesLoaded",
            value: function(e) {
                this._WhenNodesLoadedActions.push(e)
            }
        }, {
            key: "assetUpdated",
            value: function() {
                this._AssetsUpdated = true,
                this._ChildrenChanged = true
            }
        }, {
            key: "assetNeedsRuntimeAsset",
            value: function(e) {
                this.dispatch("assetNeedsRuntimeAsset", e)
            }
        }, {
            key: "cleanup",
            value: function() {
                var e = this;
                this._AssetFolder.all((function(t) {
                    e.removeAssetListeners(t)
                }
                ))
            }
        }, {
            key: "addAssets",
            value: function(e, t) {
                for (var n = 0; n < e.length; n++)
                    this.addAsset(e[n], true);
                t || (this.dispatch("assetListChanged"),
                this.dispatch("revise"))
            }
        }, {
            key: "removeAssetListeners",
            value: function(e) {
                e.removeEventListener("update", this.assetUpdated)
            }
        }, {
            key: "addAssetListener",
            value: function(e) {
                this.removeAssetListeners(e),
                e.addEventListener("update", this.assetUpdated)
            }
        }, {
            key: "addAsset",
            value: function(e, t) {
                e.parent || this._AssetFolder.add(e);
                var n = this;
                e.all((function(e) {
                    n.addAssetListener(e)
                }
                )),
                t || (this.dispatch("assetListChanged"),
                this.dispatch("revise"))
            }
        }, {
            key: "removeAsset",
            value: function(e) {
                e.parent && e.parent.remove(e),
                e.isSelected = false,
                this.removeAssetListeners(e),
                this.dispatch("assetListChanged")
            }
        }, {
            key: "removeNonNodes",
            value: function(e) {
                for (var t = 0; t < e.length; t++) {
                    var n = e[t];
                    switch (n.constructor) {
                    case Q.default:
                        this.removeAnimation(n);
                        break;
                    default:
                        this.removeAsset(n)
                    }
                }
            }
        }, {
            key: "removeAssets",
            value: function(e) {
                for (var t = 0; t < e.length; t++) {
                    switch (e[t].constructor) {
                    case C.default:
                    case T.default:
                    case E.default:
                    case P.default:
                    case x.default:
                        this.removeAsset(e[t])
                    }
                }
            }
        }, {
            key: "serialize",
            value: function(e, t) {
                for (var n = {
                    root: this._Root.serialize(e),
                    assets: this._AssetFolder.serialize().children,
                    animations: []
                }, i = t || this._Animations, r = 0; r < i.length; r++) {
                    var o = i[r];
                    n.animations.push(o.serialize())
                }
                return n
            }
        }, {
            key: "isStable",
            value: function() {
                for (var e = 0; e < this._Animations.length; e++) {
                    if (!this._Animations[e].isStable)
                        return false
                }
                return true
            }
        }, {
            key: "recurseLoad",
            value: function(e, n) {
                for (var i = this, r = 0; r < e.length; r++) {
                    var o = e[r]
                      , a = null;
                    if (o.type && (a = t.registeredNodes[o.type])) {
                        var s = this.addNodeType(a.ctr, n, o);
                        s && o.children && this.recurseLoad(o.children, s)
                    } else
                        switch (o.type) {
                        case "ikTarget":
                            switch (function() {
                                var e = i.addNodeType(u.default, n, o);
                                if (!e)
                                    return "continue";
                                o.children && i.recurseLoad(o.children, e),
                                o.id = j.default.ID++;
                                var t = i.addNodeType(p.default, null, null, true);
                                return t ? (o.isEnabled = true,
                                t.read(i, o),
                                t.target = e,
                                i.whenNodesLoaded((function() {
                                    var e = t._InfluencedBones;
                                    if (e.length) {
                                        var n = e[e.length - 1];
                                        n && (n.add(t),
                                        this._Graph && t.updateDependencies(this._Graph))
                                    }
                                }
                                )),
                                "break") : "continue"
                            }()) {
                            case "continue":
                                continue
                            }
                        }
                }
            }
        }, {
            key: "onAnimationRenamed",
            value: function() {
                this.dispatch("animationRenamed")
            }
        }, {
            key: "onAnimationOrderChanged",
            value: function() {
                this.dispatch("animationListChanged")
            }
        }, {
            key: "createAnimation",
            value: function() {
                var e = new Q.default(this);
                return e.read(this, {
                    name: "Untitled"
                }),
                this.addAnimation(e, false, 0)
            }
        }, {
            key: "addAnimation",
            value: function(e, t, n) {
                return e.addEventListener("nameChanged", this.onAnimationRenamed),
                e.addEventListener("orderChange", this.onAnimationOrderChanged),
                void 0 === n ? this._Animations.push(e) : this._Animations.splice(n, 0, e),
                t || (this.revise(),
                this.dispatch("animationListChanged")),
                e
            }
        }, {
            key: "removeAnimations",
            value: function(e) {
                var t = true
                  , n = false
                  , i = void 0;
                try {
                    for (var r, o = e[Symbol.iterator](); !(t = (r = o.next()).done); t = true) {
                        var a = r.value;
                        this.removeAnimation(a)
                    }
                } catch (e) {
                    n = true,
                    i = e
                } finally {
                    try {
                        !t && o.return && o.return()
                    } finally {
                        if (n)
                            throw i
                    }
                }
            }
        }, {
            key: "removeAnimation",
            value: function(e) {
                var t = this._Animations.indexOf(e);
                -1 != t && this._Animations.splice(t, 1),
                e.setActor(null),
                e.removeEventListener("nameChanged", this.onAnimationRenamed),
                e.removeEventListener("orderChange", this.onAnimationOrderChanged),
                this.dispatch("animationListChanged"),
                this.revise()
            }
        }, {
            key: "duplicateAnimations",
            value: function(e) {
                var t = []
                  , n = true
                  , i = false
                  , r = void 0;
                try {
                    for (var o, a = e[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                        var s = o.value;
                        t.push(this.duplicateAnimation(s))
                    }
                } catch (e) {
                    i = true,
                    r = e
                } finally {
                    try {
                        !n && a.return && a.return()
                    } finally {
                        if (i)
                            throw r
                    }
                }
                return t
            }
        }, {
            key: "duplicateAnimation",
            value: function(e) {
                var t = new Q.default(this);
                this.registerNodeLookup();
                var n = e.serialize();
                return delete n.id,
                n.name = e.name + " Duplicate",
                t.read(this, n),
                this.clearNodeLookup(),
                this.addAnimation(t, false, 0)
            }
        }, {
            key: "removeAnimatedProperty",
            value: function(e, t) {
                for (var n = 0; n < this._Animations.length; n++) {
                    var i = this._Animations[n].getKeyedNode(e);
                    i && i.removeProperty(t)
                }
            }
        }, {
            key: "addTempAssetLookup",
            value: function(e, t) {
                this._TempAssetLookup && this._TempAssetLookup.set(e, t)
            }
        }, {
            key: "getAsset",
            value: function(e) {
                var t = null;
                return this._TempAssetLookup && (t = this._TempAssetLookup.get(e)) || this._AssetFolder.all((function(n) {
                    if (n.id === e)
                        return t = n,
                        false
                }
                )),
                t
            }
        }, {
            key: "getNodeWithRefId",
            value: function(e) {
                var t = this._NodeLookup
                  , n = null;
                return t && (n = t[e]) || this._Root.eachChildRecursive((function(t) {
                    if (t.refId == e)
                        return n = t,
                        false
                }
                )),
                n
            }
        }, {
            key: "getAssetWithRefId",
            value: function(e) {
                var t = null;
                return this._AssetFolder.all((function(n) {
                    if (n.refId === e)
                        return t = n,
                        false
                }
                )),
                t
            }
        }, {
            key: "getAssetTypeNamed",
            value: function(e, t) {
                var n = null;
                return this._AssetFolder.all((function(i) {
                    if (i instanceof e && i.name === t)
                        return n = i,
                        false
                }
                )),
                n
            }
        }, {
            key: "isAssetUsed",
            value: function(e) {
                if (e.constructor !== P.default)
                    return true;
                var t = false;
                return this._Root.all((function(n) {
                    if (void 0 !== n.asset && n.asset === e)
                        return t = true,
                        false
                }
                )),
                t
            }
        }, {
            key: "addPlayingAnimation",
            value: function(e) {
                -1 === this._PlayingAnimations.indexOf(e) && (this._PlayingAnimations.push(e),
                this.dispatch("play"))
            }
        }, {
            key: "removePlayingAnimation",
            value: function(e) {
                var t = this._PlayingAnimations.indexOf(e);
                -1 !== t && (this._PlayingAnimations.splice(t, 1),
                this.dispatch("play"))
            }
        }, {
            key: "stopAnimations",
            value: function() {
                for (var e = 0; e < this._PlayingAnimations.length; e++)
                    this._PlayingAnimations[e].isPlaying = false;
                this._PlayingAnimations.length = 0
            }
        }, {
            key: "onNodeAdded",
            value: function(e) {
                switch (e.constructor) {
                case l.default:
                    this._DrawOrder.addImage(e)
                }
            }
        }, {
            key: "onNodeRemoved",
            value: function(e) {
                switch (e.constructor) {
                case l.default:
                    this._DrawOrder.removeImage(e)
                }
            }
        }, {
            key: "advance",
            value: function(e, t, n, i) {
                var r = this
                  , o = this._ForceRedraw;
                if (this._ForceRedraw = false,
                this._AreDependenciesDirty) {
                    o = true;
                    var a = function(e) {
                        if (!r.updateDependencies() && i.undo())
                            return i.removeRestOfJournal(),
                            i.alert({
                                title: "Cyclic Dependency.",
                                message: "The last operation caused a cyclic dependency and has been reverted.",
                                type: S.default.Types.Default,
                                buttons: []
                            }),
                            "continue";
                        var t = 0;
                        return r._Root.all((function(e) {
                            e.treeIndex = t,
                            t++
                        }
                        )),
                        "break"
                    };
                    e: for (var s = 0; s < 10; s++) {
                        switch (a()) {
                        case "continue":
                            continue;
                        case "break":
                            break e
                        }
                    }
                }
                var l = this._DependencyGraph;
                if (t) {
                    for (var u = false, c = this._PlayingAnimations.slice(0), d = [], h = 0; h < c.length; h++) {
                        var f = c[h];
                        f === t && (u = true),
                        f.advance(e, n && f === t) && d.push({
                            animation: f,
                            mix: 1,
                            position: f.position
                        })
                    }
                    u || t.advance(e, n) && d.push({
                        animation: t,
                        mix: 1,
                        position: t.position
                    }),
                    d.length && this.updateAnimations(d),
                    0 === this._PlayingAnimations.length && this._IsKeyStateDirty && (this._IsKeyStateDirty = false,
                    this._Root.all((function(e) {
                        e._IsKeyStateDirty && (e._IsKeyStateDirty = false,
                        e.dispatch("keyState"))
                    }
                    )))
                }
                return l && l.update() && (o = true),
                this._DrawOrder.advance() && (o = true),
                this._ChildrenChanged && (this._ChildrenChanged = false,
                this.dispatch("childrenChanged", this)),
                this._AssetsUpdated && (o = true,
                this._AssetsUpdated = false,
                this._DrawOrder && this._DrawOrder.dispatch("childrenChanged", this),
                this._AssetFolder && this._AssetFolder.dispatch("childrenChanged", this),
                this.dispatch("assetListChanged")),
                o
            }
        }, {
            key: "initNodeLookup",
            value: function() {
                this._NodeLookup = {};
                var e = this;
                this.getNode = function(t) {
                    return e._NodeLookup[t]
                }
            }
        }, {
            key: "registerNodeLookup",
            value: function() {
                this.initNodeLookup();
                var e = this._NodeLookup;
                this._Root.all((function(t) {
                    t && t.refId && (e[t.refId] = t)
                }
                ))
            }
        }, {
            key: "clearNodeLookup",
            value: function() {
                for (var e = this._Animations, t = new Map, n = 0; n < e.length; n++) {
                    var i = e[n];
                    t.get(i.refId) ? i.assignID() : t.set(i.refId, i)
                }
                this._NodeLookup = null,
                delete this.getNode
            }
        }, {
            key: "markDependenciesDirty",
            value: function() {
                this._AreDependenciesDirty = true
            }
        }, {
            key: "addNodeType",
            value: function(e, n, i, r) {
                !n || n instanceof L.default || (console.warn("Actor.addNodeType tried to parent to a non-container, will parent to " + (r ? "null" : "root") + " instead."),
                n = null);
                var o = t.registeredNodeTypes.get(e);
                if (!o)
                    return null;
                n || r || (n = this._Root);
                var a = new o.ctr(this);
                return i && a.read(this, i),
                this._NodeLookup && (this._NodeLookup[a.refId] = a),
                n && (n.add(a),
                this._Graph && a.updateDependencies(this._Graph)),
                o.stageCtr && (a.stageItem = new o.stageCtr(a),
                i && true === i.locked && (a.stageItem.isLocked = true)),
                a.constructor === l.default && this._DrawOrder.addImage(a),
                a
            }
        }, {
            key: "importFiles",
            value: function(e, n, i) {
                for (var r = this, o = 0, a = 0; a < e.length; a++) {
                    var s = e[a]
                      , l = s.name
                      , u = l.lastIndexOf(".");
                    if (-1 != u) {
                        var c = l.substr(u + 1).toLowerCase()
                          , d = t.registeredImporterForExtensions[c];
                        if (d) {
                            o++;
                            var h = new Worker(Z.default.getWorkerScript(d.entry));
                            h.onmessage = function(e) {
                                this.terminate(),
                                r.import(e.data, n),
                                --o <= 0 && i(true)
                            }
                            ,
                            h.postMessage(s)
                        }
                    }
                }
                0 === o && i(false)
            }
        }, {
            key: "import",
            value: function(e, n) {
                this.initNodeLookup();
                var i = false;
                if (e.assets) {
                    this._TempAssetLookup = new Map;
                    for (var r = 0; r < e.assets.length; r++) {
                        var o = e.assets[r]
                          , a = t.registeredAssets[o.type];
                        if (a && (!this.getAsset(o.id) || o.generateNewId)) {
                            var s = new a.ctr(this);
                            s.read(this, o),
                            this.addAsset(s),
                            i = true
                        }
                    }
                }
                if (e.nodes) {
                    var l = []
                      , u = this._Root;
                    if (n) {
                        var c = n.selectedItems
                          , d = null
                          , h = true
                          , f = false
                          , p = void 0;
                        try {
                            for (var y, m = c[Symbol.iterator](); !(h = (y = m.next()).done); h = true) {
                                var v = y.value;
                                if (null !== d && v.node !== d) {
                                    d = null;
                                    break
                                }
                                d = v.node
                            }
                        } catch (e) {
                            f = true,
                            p = e
                        } finally {
                            try {
                                !h && m.return && m.return()
                            } finally {
                                if (f)
                                    throw p
                            }
                        }
                        if (u = d || this._Root,
                        e.nodes) {
                            var g = true
                              , _ = false
                              , b = void 0;
                            try {
                                for (var w, O = e.nodes[Symbol.iterator](); !(g = (w = O.next()).done); g = true) {
                                    var S = w.value;
                                    S.id === u.refId && S.type === u.constructor.registeredActorName && S.name === u.name && (u = u.parent || this._Root)
                                }
                            } catch (e) {
                                _ = true,
                                b = e
                            } finally {
                                try {
                                    !g && O.return && O.return()
                                } finally {
                                    if (_)
                                        throw b
                                }
                            }
                        }
                    }
                    this.recurseLoad(e.nodes, u),
                    this._DrawOrder.updateDrawOrder(),
                    n && (u.eachChildRecursive((function(e) {
                        var t = e.stageItem;
                        t && (t.stage || (t.addToStage(n),
                        e.parent === u && l.push(t)))
                    }
                    )),
                    n.selectItems(l))
                }
                this._TempAssetLookup = null;
                for (var k = 0; k < this._WhenNodesLoadedActions.length; k++)
                    this._WhenNodesLoadedActions[k]();
                for (var P in this._WhenNodesLoadedActions = [],
                this._NodeLookup)
                    this._NodeLookup[P].newRefId();
                if (e.animations) {
                    for (var E = 0; E < e.animations.length; E++) {
                        var T = e.animations[E]
                          , C = new Q.default(this);
                        C.read(this, T),
                        this.addAnimation(C, true)
                    }
                    this.dispatch("animationListChanged")
                }
                this.clearNodeLookup(),
                i && this.dispatch("assetListChanged"),
                i && this.dispatch("revise")
            }
        }, {
            key: "makeAssetWithWorker",
            value: function(e, n) {
                var i = this
                  , r = new Worker(Z.default.getWorkerScript(n));
                return new Promise((function(o, a) {
                    r.onmessage = function(r) {
                        if (r.data.error)
                            a(new Error(n + " failed to make an asset from file " + e.name));
                        else {
                            var s = r.data
                              , l = t.registeredAssets[s.type];
                            if (l) {
                                var u = new l.ctr(i);
                                u.read(i, s, (function() {
                                    o(u)
                                }
                                ))
                            } else
                                a(new Error(n + " returned an unknown asset type " + l + " for file " + e.name))
                        }
                    }
                    ,
                    r.postMessage(e)
                }
                ))
            }
        }, {
            key: "makeAsset",
            value: function(e, n) {
                k.default.isPrototypeOf(n) && (n = t.registeredAssetTypes.get(n));
                var i = e.lastIndexOf(".");
                if (-1 != i && (e = e.substr(0, i)),
                !n && -1 != i) {
                    var r = e.substr(i + 1).toLowerCase();
                    n = t.registeredAssetExtensionToType[r]
                }
                if (!n)
                    return null;
                var o = new n.ctr(this);
                return o.read(this, {
                    name: e,
                    id: null,
                    type: n.mime
                }),
                o
            }
        }, {
            key: "makeAssetWithType",
            value: function(e, t) {
                var n = this.makeAsset(e.name, t);
                return n ? new Promise((function(t, i) {
                    n.file = e,
                    n.fromFile(e, (function() {
                        t(n)
                    }
                    ))
                }
                )) : Promise.reject(new Error("Could not find an asset type for file with name " + e.name))
            }
        }, {
            key: "makeImageSequenceAsset",
            value: function(e) {
                var n = new C.default;
                n.file = 2,
                n.name = e.name;
                for (var i = [], r = e.items, o = 0; o < r.length; o++) {
                    var a = r[o]
                      , s = t.registeredAssets[a.type];
                    if (!s) {
                        var l = a.name.toLowerCase();
                        s = t.registeredAssetExtensionToType[l]
                    }
                    i.push(this.makeAssetWithType(r[o], s))
                }
                return new Promise((function(e, t) {
                    Promise.all(i).then((function(i) {
                        for (var r = 0; r < i.length; r++) {
                            var o = i[r];
                            o instanceof P.default && n.add(o, true)
                        }
                        n.children.length > 0 ? e(n) : t(new Error("Sequence named " + n.name + " created with no frames."))
                    }
                    ))
                }
                ))
            }
        }, {
            key: "makeAssets",
            value: function(e) {
                for (var n = [], i = [], r = 0; r < e.length; r++) {
                    var o = e[r];
                    if (1 === o.items.length) {
                        var a = o.items[0]
                          , s = a.name
                          , l = s.lastIndexOf(".");
                        if (-1 != l) {
                            var u = s.substr(l + 1).toLowerCase()
                              , c = t.registeredAssetExtensionToType[u];
                            c ? c.workerScript ? i.push(this.makeAssetWithWorker(a, c.workerScript)) : i.push(this.makeAssetWithType(a, c)) : n.push(a)
                        }
                    } else
                        i.push(this.makeImageSequenceAsset(o))
                }
                return new Promise((function(e, t) {
                    Promise.all(i).then((function(t) {
                        e({
                            assets: t,
                            unprocessed: n
                        })
                    }
                    ))
                }
                ))
            }
        }, {
            key: "revise",
            value: function() {
                this.dispatch("revise")
            }
        }, {
            key: "getJournalEntry",
            value: function() {
                var e = new Map
                  , t = [];
                this._Root.all((function(n) {
                    var i = {
                        item: n,
                        entry: n.serializeHistory()
                    };
                    t.push(i),
                    e.set(n, i)
                }
                )),
                this._AssetFolder.all((function(n) {
                    var i = {
                        item: n,
                        entry: n.serializeHistory()
                    };
                    t.push(i),
                    e.set(n, i)
                }
                ));
                var n = []
                  , i = null
                  , r = this._LastFullState
                  , o = true
                  , a = false
                  , l = void 0;
                try {
                    for (var u, c = t[Symbol.iterator](); !(o = (u = c.next()).done); o = true) {
                        var d = u.value
                          , h = d.item
                          , f = d.entry
                          , p = r.get(h);
                        if (p) {
                            p = p.entry;
                            var y = f;
                            for (var m in y) {
                                var v = true
                                  , g = y[m]
                                  , _ = p[m];
                                if (void 0 !== g && void 0 !== _) {
                                    if (null === g)
                                        v = g === _;
                                    else
                                        switch (g.constructor) {
                                        case w.default:
                                            if (!_ || g.id !== _.id) {
                                                n.push(new s.default(h,m,_,g));
                                                continue
                                            }
                                            break;
                                        case Boolean:
                                        case Number:
                                        case String:
                                            g !== _ && (v = false);
                                            break;
                                        case Array:
                                        case Float32Array:
                                            if (_ && g.length === _.length) {
                                                for (var b = 0; b < g.length; b++)
                                                    if (g[b] !== _[b]) {
                                                        v = false;
                                                        break
                                                    }
                                            } else
                                                v = false;
                                            break;
                                        default:
                                            g != _ && (v = false)
                                        }
                                    if (!v)
                                        if ("children" == m) {
                                            i || (i = new ne(this),
                                            n.push(i)),
                                            i.add(h, _, g);
                                            for (var O = 0; O < _.length; O++) {
                                                var S = _[O];
                                                if (-1 == g.indexOf(S)) {
                                                    if (e.has(S))
                                                        continue;
                                                    var k = {
                                                        item: S,
                                                        entry: S.serializeHistory()
                                                    };
                                                    t.push(k),
                                                    e.set(S, k)
                                                }
                                            }
                                        } else
                                            n.push(new s.default(h,m,_,g))
                                }
                            }
                        }
                    }
                } catch (e) {
                    a = true,
                    l = e
                } finally {
                    try {
                        !o && c.return && c.return()
                    } finally {
                        if (a)
                            throw l
                    }
                }
                return i && i.processChanges(),
                n.length && this.dispatch("revise"),
                this._LastFullState = e,
                n
            }
        }, {
            key: "updateAnimations",
            value: function(e) {
                for (var t = 0; t < e.length; t++) {
                    var n = e[t];
                    n.animation.interpolate(n.position)
                }
                this._Root.all((function(t) {
                    var n = t instanceof u.default
                      , i = n
                      , r = n
                      , o = false
                      , a = false
                      , s = false
                      , p = false
                      , m = false
                      , v = false
                      , g = false
                      , _ = t instanceof c.default;
                    switch (t instanceof y.default && (r = false,
                    i = false,
                    p = true),
                    t.constructor) {
                    case D.default:
                        v = true;
                        break;
                    case f.default:
                        r = false,
                        i = false;
                        break;
                    case I.default:
                        m = true,
                        i = false,
                        r = false;
                        break;
                    case M.default:
                    case h.default:
                        i = false,
                        r = false;
                        break;
                    case d.default:
                        o = true,
                        t.parent.constructor === d.default && (i = false);
                        break;
                    case l.default:
                        a = true,
                        t.useVertexDeform && (s = true),
                        g = t.asset instanceof C.default
                    }
                    _ && (t.frameActiveChild = t.rigActiveChild),
                    i && (t.framePosX = t.rigTranslation[0],
                    t.framePosY = t.rigTranslation[1]),
                    r && (t.frameScaleX = t.rigScale[0],
                    t.frameScaleY = t.rigScale[1],
                    t.frameRotation = t.rigRotation,
                    t.frameOpacity = t.rigOpacity),
                    g && (t.frameSequence = t.rigSequence);
                    var b = null;
                    s && (b = t.rigVertices),
                    a && (t.frameDrawOrder = t.rigDrawOrder),
                    o && (t.frameLength = t.rigLength),
                    p && (t.frameStrength = t.rigStrength);
                    for (var w = 0; w < e.length; w++) {
                        var O = e[w]
                          , S = O.animation.getKeyedNode(t)
                          , k = O.mix;
                        if (0 != k && S) {
                            var P = S.props
                              , E = void 0;
                            if (v && (E = P.frameIsCollisionEnabled) && (t.frameIsCollisionEnabled = E.frameValue),
                            m)
                                switch (t.propertyType) {
                                case I.default.Type.Integer:
                                    if (E = P.frameIntValue) {
                                        var T = k;
                                        t.frameIntValue = 1 == T ? E.frameValue : t.frameIntValue * (1 - T) + E.frameValue * T
                                    }
                                    break;
                                case I.default.Type.Float:
                                    if (E = P.frameFloatValue) {
                                        var x = k;
                                        t.frameFloatValue = 1 == x ? E.frameValue : t.frameFloatValue * (1 - x) + E.frameValue * x
                                    }
                                    break;
                                case I.default.Type.String:
                                    (E = P.frameStringValue) && (t.frameStringValue = E.frameValue);
                                    break;
                                case I.default.Type.Boolean:
                                    (E = P.frameBooleanValue) && (t.frameBooleanValue = E.frameValue)
                                }
                            if (_ && (E = P.frameActiveChild) && (t.frameActiveChild = E.frameValue),
                            i) {
                                if (E = P.framePosX) {
                                    var A = k;
                                    t.framePosX = 1 == A ? E.frameValue : t.framePosX * (1 - A) + E.frameValue * A
                                }
                                if (E = P.framePosY) {
                                    var j = k;
                                    t.framePosY = 1 == j ? E.frameValue : t.framePosY * (1 - j) + E.frameValue * j
                                }
                            }
                            if (g && (E = P.frameSequence)) {
                                var L = k;
                                t.frameSequence = 1 == L ? E.frameValue : t.frameSequence * (1 - L) + E.frameValue * L
                            }
                            if (E = P.frameScaleX) {
                                var R = k;
                                t.frameScaleX = 1 == R ? E.frameValue : t.frameScaleX * (1 - R) + E.frameValue * R
                            }
                            if (E = P.frameScaleY) {
                                var F = k;
                                t.frameScaleY = 1 == F ? E.frameValue : t.frameScaleY * (1 - F) + E.frameValue * F
                            }
                            if (E = P.frameRotation) {
                                var B = k;
                                t.frameRotation = 1 == B ? E.frameValue : t.frameRotation * (1 - B) + E.frameValue * B
                            }
                            if (E = P.frameOpacity) {
                                var V = k;
                                t.frameOpacity = 1 == V ? E.frameValue : t.frameOpacity * (1 - V) + E.frameValue * V
                            }
                            if (p && (E = P.frameStrength)) {
                                var N = k;
                                t.frameStrength = 1 == N ? E.frameValue : t.frameStrength * (1 - N) + E.frameValue * N
                            }
                            if (o && (E = P.frameLength)) {
                                var z = k;
                                t.frameLength = 1 == z ? E.frameValue : t.frameLength * (1 - z) + E.frameValue * z
                            }
                            if (s && (E = P.frameVertices)) {
                                var W = k;
                                if (1 == W)
                                    b = E.frameValue;
                                else
                                    for (var H = E.frameValue, U = 1 - W, K = 0; K < b.length; K++)
                                        b[K] = b[K] * U + H[K] * W
                            }
                        }
                    }
                    b && (t.frameVertices = b)
                }
                ));
                for (var i = 0; i < e.length; i++) {
                    var r = e[i]
                      , o = r.animation.getKeyedNode(Q.default.OrderObject);
                    if (o) {
                        var a = r.mix;
                        o.props.frameDrawOrder;
                        if (0 != a) {
                            var s = o.props.frameDrawOrder.frameValue;
                            for (var p in s) {
                                var m = s[p];
                                m.obj.frameDrawOrder = m.v
                            }
                        }
                    }
                }
                this.dispatch("frameUpdated")
            }
        }, {
            key: "dependencyGraph",
            get: function() {
                return this._DependencyGraph
            }
        }, {
            key: "root",
            get: function() {
                return this._Root
            }
        }, {
            key: "isTimeTraveling",
            get: function() {
                return this._IsTimeTraveling
            },
            set: function(e) {
                this._IsTimeTraveling = e
            }
        }, {
            key: "drawOrder",
            get: function() {
                return this._DrawOrder
            }
        }, {
            key: "useAnimationValues",
            set: function(e) {
                this._Root.all((function(t) {
                    t.useAnimationValues = e
                }
                )),
                this._DrawOrder.forceUpdate()
            }
        }, {
            key: "unprocessedAssets",
            get: function() {
                var e = [];
                return this._AssetFolder.eachChildRecursive((function(t) {
                    t.id || e.push(t)
                }
                )),
                e
            }
        }, {
            key: "assets",
            get: function() {
                return this._Assets
            }
        }, {
            key: "assetFolder",
            get: function() {
                return this._AssetFolder
            }
        }, {
            key: "animations",
            get: function() {
                return this._Animations
            },
            set: function(e) {
                this._Animations = e,
                this.dispatch("animationListChanged")
            }
        }, {
            key: "orderedAnimations",
            get: function() {
                return this._Animations.slice(0).sort((function(e, t) {
                    return e.order - t.order
                }
                ))
            }
        }, {
            key: "hasPlayingAnimations",
            get: function() {
                return this._PlayingAnimations.length > 0
            }
        }, {
            key: "isLoadingBitmaps",
            get: function() {
                var e = false;
                return this._AssetFolder.all((function(t) {
                    if ((t instanceof P.default || t instanceof T.default) && !t.bitmap)
                        return e = true,
                        false
                }
                )),
                e
            }
        }, {
            key: "isMissingBitmaps",
            get: function() {
                var e = false;
                return this._AssetFolder.all((function(t) {
                    if ((t instanceof P.default || t instanceof T.default) && t.isMissing)
                        return e = true,
                        false
                }
                )),
                e
            }
        }]),
        t
    }(o.default)).prototype, "assetUpdated", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "assetUpdated"), i.prototype),
    ee(i.prototype, "assetNeedsRuntimeAsset", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "assetNeedsRuntimeAsset"), i.prototype),
    ee(i.prototype, "onAnimationRenamed", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onAnimationRenamed"), i.prototype),
    ee(i.prototype, "onAnimationOrderChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onAnimationOrderChanged"), i.prototype),
    ee(i.prototype, "makeAssets", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "makeAssets"), i.prototype),
    i);
    t.default = ie,
    ie.registeredNodes = {},
    ie.registeredNodeTypes = new Map,
    ie.registeredImporterForExtensions = {},
    ie.registerImporter = function(e, t) {
        for (var n = {
            entry: t
        }, i = 0; i < e.length; i++) {
            var r = e[i].toLowerCase();
            ie.registeredImporterForExtensions[r] = n
        }
    }
    ,
    ie.registerNodeType = function(e, t, n) {
        t.registeredActorName = e;
        var i = ie.registeredNodes[e] = {
            ctr: t,
            stageCtr: n || null,
            name: e
        };
        ie.registeredNodeTypes.set(t, i)
    }
    ,
    ie.registeredAssets = {},
    ie.registeredAssetTypes = new Map,
    ie.registeredAssetExtensionToType = {},
    ie.registerAsset = function(e, t, n, i) {
        var r = {
            ctr: n,
            ext: t,
            mime: e,
            workerScript: i
        };
        ie.registeredAssets[e] = r,
        ie.registeredAssetTypes.set(n, r);
        for (var o = 0; o < t.length; o++) {
            var a = t[o];
            ie.registeredAssetExtensionToType[a] = r
        }
    }
    ,
    ie.getAssetTypeExtensions = function(e) {
        var t = [];
        for (var n in ie.registeredAssets) {
            var i = ie.registeredAssets[n];
            i.ctr === e && (t = t.concat(i.ext))
        }
        return t
    }
    ,
    ie.getAssetTypeMimes = function(e) {
        var t = [];
        for (var n in ie.registeredAssets) {
            var i = ie.registeredAssets[n];
            i.ctr === e && (t = t.concat(i.mime))
        }
        return t
    }
    ,
    ie.getImageExtensions = function() {
        return ie.getAssetTypeExtensions(P.default)
    }
    ,
    ie.getImageMimeTypes = function() {
        return ie.getAssetTypeMimes(P.default)
    }
    ,
    ie.registerImporter(["zip"], "ZipImporter.js"),
    ie.registerImporter(["nma2d"], "ZipImporter.js"),
    ie.registerNodeType("component", j.default, F.default),
    ie.registerNodeType("solo", c.default, F.default),
    ie.registerNodeType("node", u.default, F.default),
    ie.registerNodeType("image", l.default, B.default),
    ie.registerNodeType("bone", d.default, V.default),
    ie.registerNodeType("jellyBone", h.default, N.default),
    ie.registerNodeType("ikConstraint", p.default, U.default),
    ie.registerNodeType("transformConstraint", m.default, K.default),
    ie.registerNodeType("distanceConstraint", v.default, G.default),
    ie.registerNodeType("translationConstraint", g.default, X.default),
    ie.registerNodeType("scaleConstraint", _.default, J.default),
    ie.registerNodeType("stageConstraint", b.default, Y.default),
    ie.registerNodeType("jelly", f.default, f.default.StageItem),
    ie.registerNodeType("customProperty", I.default, z.default),
    ie.registerNodeType("collider", D.default, W.default),
    ie.registerNodeType("event", M.default, H.default),
    ie.registerNodeType("rootBone", R.default, q.default),
    ie.registerAsset("image/layered", ["psd"], E.default, "PsdImporter.js"),
    ie.registerAsset("image/sequence", [], C.default),
    ie.registerAsset("image/raw", [], P.default),
    ie.registerAsset("image/png", ["png"], P.default),
    ie.registerAsset("image/jpg", ["jpg", "jpeg"], P.default),
    ie.registerAsset("folder", [], x.default)
}
, , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , function(e, t, n) {
    "use strict";
    (function(e) {
        var t = r(n(19))
          , i = r(n(690));
        function r(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }
        (0,
        t.default)(e, i.default, true)
    }
    ).call(this, n(163)(e))
}
, , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = function(e) {
        return Math.pow(2, Math.round(Math.log(e) / Math.log(2)))
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = u(n(1)), a = n(2), s = u(n(397)), l = u(n(370));
    function u(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var c, d, h, f, p, y, m = (i = function() {
        function e(t) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e),
            this._StageImage = t,
            this._Node = t.node,
            this._Stage = t.stage,
            this._IsEnabled = false,
            this._WasEnabledForLastUpdate = false,
            this._StageVertices = [],
            this._StageEdges = [],
            this._InverseWorldTransform = a.mat2d.create(),
            this._WorldTransform = this._Node.worldTransform,
            a.mat2d.invert(this._InverseWorldTransform, this._WorldTransform),
            this._Node.addEventListener("worldTransform", this.updateTransform),
            this._UpdateTimeout = null,
            this._LastUpdateEnabled = false
        }
        return r(e, [{
            key: "updateTransform",
            value: function() {
                a.mat2d.invert(this._InverseWorldTransform, this._WorldTransform),
                this.updateItems()
            }
        }, {
            key: "updateItems",
            value: function() {
                if (this._IsEnabled || this._WasEnabledForLastUpdate) {
                    this._WasEnabledForLastUpdate = this._IsEnabled;
                    var e = this._Node.meshData
                      , t = false
                      , n = e.verts
                      , i = e.deform;
                    if (i && i.verts && i.verts.length == n.length && i.edges)
                        n = i.verts;
                    else {
                        e.deform || (t = true,
                        e.deform = {}),
                        n = e.deform.verts && e.deform.verts.length == n.length ? e.deform.verts : e.deform.verts = new Float32Array(n);
                        var r = []
                          , o = e.editor.c
                          , u = e.editor.cc;
                        if (u > 2) {
                            for (var c = 2, d = 1; d < u; d++)
                                r.push(o[c - 2], o[c - 1], o[c], o[c + 1]),
                                c += 2;
                            r.push(o[c - 2], o[c - 1], o[0], o[1]);
                            for (var h = e.editor.ie, f = h.length / 2, p = 0, y = 0; y < f; y++) {
                                var m = 2 * h[p++]
                                  , v = 2 * h[p++];
                                r.push(o[m], o[m + 1], o[v], o[v + 1])
                            }
                            e.deform.edges = this.buildEdges(e.verts, new Float32Array(r))
                        }
                    }
                    this._Node.useAnimationValues && (e.deform.animatedVerts && e.deform.animatedVerts.length == n.length || (e.deform.animatedVerts = new Float32Array(n)),
                    n = e.deform.animatedVerts);
                    for (var g = n.length / 4, _ = 0, b = 0, w = e.deform.edges, O = w.length / 2, S = this._Node.weightData, k = this._Node.connectedBones, P = S && k.length, E = P && this._Node.boneTransformsArray, T = this._StageVertices, C = this._StageEdges, x = this._WorldTransform, I = this._InverseWorldTransform, D = 0; D < g; D++) {
                        var M = a.vec2.set(a.vec2.create(), n[_], n[_ + 1])
                          , A = void 0;
                        if (D < T.length ? (A = T[D]).setDeformBuffer(n) : (A = new l.default(x,I,n,_),
                        T.push(A),
                        A.addToStage(this._Stage),
                        A.parent = this._StageImage,
                        A.selectionPanelItem = this._StageImage),
                        P && this._IsEnabled) {
                            for (var j = new Float32Array(6), L = M[0], R = M[1], F = x[0] * L + x[2] * R + x[4], B = x[1] * L + x[3] * R + x[5], V = 0; V < 4; V++)
                                for (var N = S[b + V], z = S[b + V + 4], W = 6 * N, H = 0; H < 6; H++)
                                    j[H] += E[W + H] * z;
                            A.setBoneTransform(j),
                            L = j[0] * F + j[2] * B + j[4],
                            R = j[1] * F + j[3] * B + j[5],
                            M[0] = I[0] * L + I[2] * R + I[4],
                            M[1] = I[1] * L + I[3] * R + I[5],
                            b += 8
                        } else
                            A.setBoneTransform(null);
                        A.position = M,
                        A.isVisible = this._IsEnabled,
                        _ += 4
                    }
                    for (var U = g; U < T.length; U++) {
                        var K = T[U];
                        K.cleanup(),
                        K.removeFromStage(),
                        T.splice(U, 1),
                        U--
                    }
                    for (var G = 0, X = 0; X < O; X++) {
                        var J = void 0
                          , Y = T[w[G++]]
                          , q = T[w[G++]];
                        X < C.length ? ((J = C[X]).vtxA = Y,
                        J.vtxB = q) : (J = new s.default(Y,q,true),
                        C.push(J),
                        J.addToStage(this._Stage),
                        J.parent = this._StageImage,
                        J.selectionPanelItem = this._StageImage),
                        J.isVisible = this._IsEnabled
                    }
                    for (var Q = O; Q < C.length; Q++) {
                        var Z = C[Q];
                        Z.cleanup(),
                        Z.removeFromStage(),
                        C.splice(Q, 1),
                        Q--
                    }
                    t && this._Stage.appContext.captureJournalEntry()
                }
            }
        }, {
            key: "cleanup",
            value: function() {
                for (var e = 0; e < this._StageVertices.length; e++) {
                    var t = this._StageVertices[e];
                    t.cleanup(),
                    t.removeFromStage()
                }
                this._StageVertices.length = 0;
                for (var n = 0; n < this._StageEdges.length; n++) {
                    var i = this._StageEdges[n];
                    i.cleanup(),
                    i.removeFromStage()
                }
                this._StageVertices.length = 0,
                this._Node.removeEventListener("worldTransform", this.updateTransform)
            }
        }, {
            key: "buildEdges",
            value: function(e, t) {
                for (var n = t.length / 4, i = 0, r = e.length / 4, o = [], l = 0; l < n; l++) {
                    for (var u = a.vec2.set(a.vec2.create(), t[i++], t[i++]), c = a.vec2.set(a.vec2.create(), t[i++], t[i++]), d = 0, h = [], f = 0; f < r; f++) {
                        var p = e[d++]
                          , y = e[d++];
                        if (p == u[0] && y == u[1] || p == c[0] && y == c[1])
                            h.push({
                                idx: f
                            });
                        else
                            s.default.squaredDistanceToSegment(u, c, p, y) < 1e-4 && h.push({
                                idx: f
                            });
                        d += 2
                    }
                    if (2 == h.length)
                        o.push(h[0].idx, h[1].idx);
                    else if (h.length > 2) {
                        for (var m = 0; m < h.length; m++) {
                            var v = h[m]
                              , g = 4 * v.idx
                              , _ = u[0] - e[g]
                              , b = u[1] - e[g + 1];
                            v.d = _ * _ + b * b
                        }
                        h.sort((function(e, t) {
                            return e.d - t.d
                        }
                        ));
                        for (var w = 1; w < h.length; w++)
                            o.push(h[w - 1].idx, h[w].idx)
                    }
                }
                return o
            }
        }, {
            key: "isEnabled",
            get: function() {
                return this._IsEnabled
            },
            set: function(e) {
                if (this._IsEnabled != e) {
                    clearTimeout(this._UpdateTimeout),
                    this._IsEnabled = e;
                    var t = this;
                    this._UpdateTimeout = setTimeout((function() {
                        t._LastUpdateEnabled != t._IsEnabled && (t.updateItems(),
                        t._Stage.redraw(),
                        t._LastUpdateEnabled = t._IsEnabled)
                    }
                    ), 15)
                }
            }
        }]),
        e
    }(),
    c = i.prototype,
    d = "updateTransform",
    h = [o.default],
    f = Object.getOwnPropertyDescriptor(i.prototype, "updateTransform"),
    p = i.prototype,
    y = {},
    Object.keys(f).forEach((function(e) {
        y[e] = f[e]
    }
    )),
    y.enumerable = !!y.enumerable,
    y.configurable = !!y.configurable,
    ("value"in y || y.initializer) && (y.writable = true),
    y = h.slice().reverse().reduce((function(e, t) {
        return t(c, d, e) || e
    }
    ), y),
    p && void 0 !== y.initializer && (y.value = y.initializer ? y.initializer.call(p) : void 0,
    y.initializer = void 0),
    void 0 === y.initializer && (Object.defineProperty(c, d, y),
    y = null),
    i);
    t.default = m
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = l(n(381))
      , o = l(n(397))
      , a = n(2)
      , s = l(n(11));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var u = function() {
        function e(t) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e),
            this._Jellies = t;
            for (var n = this._WorldPositions = new Array(t.length), i = 0; i < t.length; i++) {
                var r = t[i];
                n[i] = a.vec2.clone(r.worldPosition)
            }
        }
        return i(e, [{
            key: "advance",
            value: function(e, t) {
                for (var n = this._WorldPositions, i = this._Jellies, r = 0; r < i.length; r++) {
                    var l = i[r]
                      , u = l.node
                      , c = u.jelly
                      , d = n[r];
                    a.vec2.add(d, d, t);
                    var h = l.isIn
                      , f = h ? a.vec2.create() : a.vec2.set(a.vec2.create(), u.length, 0)
                      , p = h ? c.inDirection : c.outDirection
                      , y = c.unitControlLength;
                    p = a.vec2.scale(a.vec2.create(), p, 2 * y);
                    var m = a.vec2.add(a.vec2.create(), f, p)
                      , v = a.vec2.transformMat2d(a.vec2.create(), f, u.worldTransform)
                      , g = a.vec2.transformMat2d(a.vec2.create(), m, u.worldTransform)
                      , _ = a.mat2d.invert(a.mat2d.create(), u.worldTransform);
                    if (!_)
                        return void s.default.warn("Failed to invert transform space", u.worldTransform);
                    var b = o.default.pointOnSegment(g, v, d[0], d[1])
                      , w = a.vec2.transformMat2d(a.vec2.create(), b, _)
                      , O = a.vec2.length(a.vec2.subtract(a.vec2.create(), w, f)) / y;
                    h ? c.easeIn = O : c.easeOut = O
                }
            }
        }, {
            key: "complete",
            value: function() {}
        }]),
        e
    }();
    t.default = u,
    u.make = function(e, t) {
        for (var n = [], i = 0; i < t.length; i++) {
            var o = t[i];
            if (o.node)
                switch (o.constructor) {
                case r.default:
                    n.push(o)
                }
        }
        if (0 != n.length)
            return new u(n)
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = n(313);
    var a = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n._Snap = false,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "onKeyDown",
            value: function(e) {
                this.snap = e.shiftKey
            }
        }, {
            key: "onKeyUp",
            value: function(e) {
                this.snap = e.shiftKey
            }
        }, {
            key: "snap",
            get: function() {
                return this._Snap
            },
            set: function(e) {
                if (this._Snap !== e) {
                    this._Snap = e;
                    var t = true
                      , n = false
                      , i = void 0;
                    try {
                        for (var r, o = this._ActiveTransformers[Symbol.iterator](); !(t = (r = o.next()).done); t = true) {
                            var a = r.value;
                            a.onSnapChange && a.onSnapChange(e)
                        }
                    } catch (e) {
                        n = true,
                        i = e
                    } finally {
                        try {
                            !t && o.return && o.return()
                        } finally {
                            if (n)
                                throw i
                        }
                    }
                }
            }
        }]),
        t
    }(((i = o) && i.__esModule ? i : {
        default: i
    }).default);
    t.default = a
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = n(2)
      , o = u(n(589))
      , a = u(n(243))
      , s = u(n(201))
      , l = u(n(315));
    function u(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var c = function() {
        function e(t, n, i, s, l) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e),
            this._CompensateImages = t,
            this._Stage = n,
            this._TopJoint = i,
            this._IKJoints = s,
            this._TargetJoint = l,
            this._TransformMatrix = r.mat2d.create(),
            this._Target = new o.default,
            this._Target.addToStage(n);
            for (var u = this._TargetJoint; u.parentJoint; )
                u = u.parentJoint;
            a.default.transformChain(u);
            var c = this._TargetJoint.renderTransform;
            this._TransformMatrix[4] = c[4],
            this._TransformMatrix[5] = c[5],
            this._Target.renderTransform = this._TransformMatrix
        }
        return i(e, [{
            key: "advance",
            value: function(e, t) {
                for (var n = this._TargetJoint; n.parentJoint; )
                    n = n.parentJoint;
                a.default.transformChain(n);
                var i = this._Target.renderTransform;
                this._TransformMatrix[4] = i[4] + t[0],
                this._TransformMatrix[5] = i[5] + t[1],
                this._Target.renderTransform = this._TransformMatrix;
                for (var o = this._TargetJoint; o.parentJoint; ) {
                    var s = o.parentJoint
                      , l = r.mat2d.getTranslation(r.vec2.create(), o.renderTransform)
                      , u = r.mat2d.getTranslation(r.vec2.create(), s.renderTransform)
                      , c = r.vec2.subtract(r.vec2.create(), l, u);
                    o.bone.ikWorldLength = r.vec2.length(c),
                    o.bone.ikAngle = Math.atan2(c[1], c[0]);
                    var d = s.node.worldTransform
                      , h = r.mat2d.invert(r.mat2d.create(), d)
                      , f = r.vec2.transformMat2d(r.vec2.create(), u, h)
                      , p = r.vec2.transformMat2d(r.vec2.create(), l, h)
                      , y = r.vec2.subtract(r.vec2.create(), p, f);
                    o.bone.localIkAngle = Math.atan2(y[1], y[0]),
                    o = s
                }
                this._TargetJoint.renderTransform = this._TransformMatrix,
                o = this._TargetJoint;
                for (var m = []; o.parentJoint && (m.push(o),
                o != this._TopJoint); ) {
                    var v = o.bone.ikWorldLength
                      , g = o.parentJoint
                      , _ = r.mat2d.getTranslation(r.vec2.create(), o.renderTransform)
                      , b = r.mat2d.getTranslation(r.vec2.create(), g.renderTransform)
                      , w = r.vec2.subtract(r.vec2.create(), b, _);
                    r.vec2.normalize(w, w),
                    r.vec2.scale(w, w, v);
                    var O = r.vec2.add(r.vec2.create(), _, w);
                    this._TransformMatrix[4] = O[0],
                    this._TransformMatrix[5] = O[1],
                    g.renderTransform = this._TransformMatrix,
                    o = g
                }
                for (var S = m.length - 1; S >= 0; S--) {
                    var k = m[S]
                      , P = k.bone.ikWorldLength
                      , E = k.bone.stageItem.parentJoint
                      , T = r.mat2d.getTranslation(r.vec2.create(), E.renderTransform);
                    if (k != this._TargetJoint && -1 == this._IKJoints.indexOf(k)) {
                        var C = 0
                          , x = 0;
                        if (E.bone.stageItem.parentJoint) {
                            var I = r.mat2d.getTranslation(r.vec2.create(), E.bone.stageItem.parentJoint.renderTransform)
                              , D = r.vec2.subtract(r.vec2.create(), T, I);
                            x = Math.atan2(D[1], D[0])
                        }
                        C = x + k.bone.localIkAngle;
                        var M = r.vec2.add(r.vec2.create(), T, [Math.cos(C) * P, Math.sin(C) * P]);
                        this._TransformMatrix[4] = M[0],
                        this._TransformMatrix[5] = M[1],
                        k.renderTransform = this._TransformMatrix
                    } else {
                        var A = r.mat2d.getTranslation(r.vec2.create(), k.renderTransform)
                          , j = r.vec2.subtract(r.vec2.create(), A, T);
                        r.vec2.normalize(j, j),
                        r.vec2.scale(j, j, P);
                        var L = r.vec2.add(r.vec2.create(), T, j);
                        if (k.bone.constrainAngles && void 0 !== k.bone.minAngle) {
                            var R = Math.atan2(j[1], j[0])
                              , F = 0;
                            if (E.bone.stageItem.parentJoint) {
                                var B = r.mat2d.getTranslation(r.vec2.create(), E.bone.stageItem.parentJoint.renderTransform)
                                  , V = r.vec2.subtract(r.vec2.create(), T, B);
                                F = Math.atan2(V[1], V[0])
                            }
                            var N = R - F;
                            if (N < k.bone.minAngle || N > k.bone.maxAngle) {
                                var z = F + Math.min(k.bone.maxAngle, Math.max(N, k.bone.minAngle));
                                L = r.vec2.add(r.vec2.create(), T, [Math.cos(z) * P, Math.sin(z) * P])
                            }
                        }
                        this._TransformMatrix[4] = L[0],
                        this._TransformMatrix[5] = L[1],
                        k.renderTransform = this._TransformMatrix
                    }
                }
                for (var W = m.length - 1; W >= 0; W--)
                    a.default.align(m[W], this._CompensateImages)
            }
        }, {
            key: "complete",
            value: function() {
                this._Target.removeFromStage()
            }
        }]),
        e
    }();
    t.default = c,
    c.make = function(e, t) {
        for (var n = [], i = null, r = null, o = -1, u = 0; u < t.length; u++) {
            var d = t[u];
            d.constructor === s.default ? -1 == n.indexOf(d.joint) && (d.joint.node.treeDepth > o && (o = d.joint.node.treeDepth,
            r = d.joint),
            n.push(d.joint)) : d.constructor === a.default && d.bone && d.bone.constructor !== l.default && (i = d)
        }
        if (null == i) {
            if (null == r)
                return;
            i = r
        }
        for (var h = n.slice(0), f = 0; f < h.length; f++)
            for (var p = h[f].parentJoint; p; ) {
                if (p && -1 != h.indexOf(p)) {
                    h.splice(f, 1),
                    f--;
                    break
                }
                p = p.parentJoint
            }
        for (var y = 0; y < h.length; y++) {
            for (var m = h[y], v = i.parentJoint; v && v != m; )
                v = v.parentJoint;
            null == v && (h.splice(y, 1),
            y--)
        }
        return 0 == h.length && h.push(i),
        1 != h.length ? null : null != i.bone ? new c(e.stage.settings.compensateImages,e.stage,h[0],n,i) : void 0
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = l(n(0)), a = l(n(1)), s = l(n(3));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function u(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var c = (u((i = function(e) {
        function t(e) {
            return function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t),
            function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "toggleCheck",
            value: function() {
                this.props.onValueChange && this.props.onValueChange(!this.props.value, this.props.data)
            }
        }, {
            key: "select",
            value: function() {
                this.props.onSelected && this.props.onSelected(this.props.data)
            }
        }, {
            key: "render",
            value: function() {
                return o.default.createElement("div", {
                    className: this.props.isSelected ? "CheckboxWrapper CheckboxWrapperSelected" : "CheckboxWrapper",
                    onClick: this.select
                }, o.default.createElement("div", {
                    className: "Checkbox",
                    onClick: this.props.isSelectable ? this.toggleCheck : null
                }, o.default.createElement("svg", {
                    className: "CheckboxCheck",
                    style: {
                        opacity: this.props.value ? 1 : 0
                    }
                }, o.default.createElement("use", {
                    xlinkHref: s.default.make("/images/symbol-defs.svg#icon-check-small")
                }))), o.default.createElement("div", {
                    className: "CheckboxLabel"
                }, this.props.label), this.props.isCover ? o.default.createElement("div", {
                    className: "ShotCoverBadge"
                }, "COVER") : null)
            }
        }]),
        t
    }(o.default.Component)).prototype, "toggleCheck", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleCheck"), i.prototype),
    u(i.prototype, "select", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "select"), i.prototype),
    i);
    t.default = c
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r, o = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), a = d(n(0)), s = d(n(1)), l = d(n(23)), u = d(n(594)), c = n(2);
    function d(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function h(e, t) {
        if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function")
    }
    function f(e, t) {
        if (!e)
            throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    function p(e, t) {
        if ("function" != typeof t && null !== t)
            throw new TypeError("Super expression must either be null or a function, not " + typeof t);
        e.prototype = Object.create(t && t.prototype, {
            constructor: {
                value: e,
                enumerable: false,
                writable: true,
                configurable: true
            }
        }),
        t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
    }
    function y(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var m = (y((i = function(e) {
        function t(e) {
            h(this, t);
            var n = f(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                open: false,
                hsv: c.vec3.create(),
                left: 0,
                top: 0
            },
            n.lastRGB = new Uint8Array([255, 255, 255]),
            n
        }
        return p(t, e),
        o(t, [{
            key: "componentWillUnmount",
            value: function() {
                window.removeEventListener("mousedown", this.close, true),
                window.removeEventListener("mousemove", this.dragGrabber, true),
                window.removeEventListener("mouseup", this.releaseGrabber, true),
                window.removeEventListener("mousemove", this.dragHueGrabber, true)
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                var t = e.color;
                t && (c.vec3.exactEquals(t, this.lastRGB) || this.setToRGB(t))
            }
        }, {
            key: "setToRGB",
            value: function(e, t) {
                c.vec3.copy(this.lastRGB, e);
                var n = function(e, t, n) {
                    e /= 255,
                    t /= 255,
                    n /= 255;
                    var i, r, o = Math.max(e, t, n), a = Math.min(e, t, n), s = o, l = o - a;
                    if (r = 0 == o ? 0 : l / o,
                    o == a)
                        i = 0;
                    else {
                        switch (o) {
                        case e:
                            i = (t - n) / l + (t < n ? 6 : 0);
                            break;
                        case t:
                            i = (n - e) / l + 2;
                            break;
                        case n:
                            i = (e - t) / l + 4
                        }
                        i /= 6
                    }
                    return [i, r, s]
                }(e[0], e[1], e[2]);
                this.setState({
                    hsv: n
                }),
                t && this.props.onColorChange && this.props.onColorChange(new Uint8Array(this.lastRGB))
            }
        }, {
            key: "setToHSV",
            value: function(e, t) {
                var n = g(e[0], e[1], e[2]);
                c.vec3.copy(this.lastRGB, n),
                this.setState({
                    hsv: e
                }),
                t && this.props.onColorChange && this.props.onColorChange(new Uint8Array(this.lastRGB))
            }
        }, {
            key: "open",
            value: function(e) {
                e.preventDefault(),
                e.stopPropagation(),
                window.addEventListener("mousedown", this.close, true);
                var t = l.default.findDOMNode(this.preview).getBoundingClientRect()
                  , n = void 0;
                n = window.innerHeight - t.bottom - 0 < 371 ? t.top - 0 - 371 : t.bottom + 0,
                window.innerWidth - t.left < 200 ? t.right : t.left,
                this.setState({
                    open: true,
                    left: t.left,
                    top: n
                })
            }
        }, {
            key: "close",
            value: function(e) {
                for (var t = e.target; null !== t; t = t.parentNode)
                    if (t === this.root)
                        return;
                e.preventDefault(),
                e.stopPropagation(),
                window.removeEventListener("mousedown", this.close, true),
                this.setState({
                    open: false
                })
            }
        }, {
            key: "pressGrabber",
            value: function(e) {
                e.preventDefault(),
                e.stopPropagation(),
                this.placeGrabber(e),
                window.addEventListener("mousemove", this.dragGrabber, true),
                window.addEventListener("mouseup", this.releaseGrabber, true)
            }
        }, {
            key: "dragGrabber",
            value: function(e) {
                e.preventDefault(),
                e.stopPropagation(),
                this.placeGrabber(e)
            }
        }, {
            key: "releaseGrabber",
            value: function(e) {
                e.preventDefault(),
                e.stopPropagation(),
                window.removeEventListener("mousemove", this.dragGrabber, true),
                window.removeEventListener("mouseup", this.releaseGrabber, true),
                window.removeEventListener("mousemove", this.dragHueGrabber, true)
            }
        }, {
            key: "placeGrabber",
            value: function(e) {
                var t = l.default.findDOMNode(this.graph).getBoundingClientRect()
                  , n = Math.min(1, Math.max(0, (e.clientX - t.left) / t.width))
                  , i = Math.min(1, Math.max(0, 1 - (e.clientY - t.top) / t.height))
                  , r = c.vec3.clone(this.state.hsv);
                r[1] = n,
                r[2] = i,
                this.setToHSV(r, true)
            }
        }, {
            key: "pressHueGrabber",
            value: function(e) {
                e.preventDefault(),
                e.stopPropagation(),
                this.placeHueGrabber(e),
                window.addEventListener("mousemove", this.dragHueGrabber, true),
                window.addEventListener("mouseup", this.releaseGrabber, true)
            }
        }, {
            key: "dragHueGrabber",
            value: function(e) {
                e.preventDefault(),
                e.stopPropagation(),
                this.placeHueGrabber(e)
            }
        }, {
            key: "placeHueGrabber",
            value: function(e) {
                var t = l.default.findDOMNode(this.hueGraph).getBoundingClientRect()
                  , n = Math.min(1, Math.max(0, (e.clientX - t.left) / t.width))
                  , i = c.vec3.clone(this.state.hsv);
                i[0] = n,
                this.setToHSV(i, true)
            }
        }, {
            key: "setRoot",
            value: function(e) {
                this.root = e
            }
        }, {
            key: "setGraph",
            value: function(e) {
                this.graph = e
            }
        }, {
            key: "setHueGraph",
            value: function(e) {
                this.hueGraph = e
            }
        }, {
            key: "mouseDown",
            value: function(e) {
                e.stopPropagation()
            }
        }, {
            key: "setH",
            value: function(e) {
                this.props.color;
                var t = c.vec3.clone(this.state.hsv);
                t[0] = Math.min(1, Math.max(0, parseInt(e) / 360)) || t[0],
                this.setToHSV(t, true)
            }
        }, {
            key: "setS",
            value: function(e) {
                this.props.color;
                var t = c.vec3.clone(this.state.hsv);
                t[1] = Math.min(1, Math.max(0, parseInt(e) / 100)) || t[0],
                this.setToHSV(t, true)
            }
        }, {
            key: "setV",
            value: function(e) {
                this.props.color;
                var t = c.vec3.clone(this.state.hsv);
                t[2] = Math.min(1, Math.max(0, parseInt(e) / 100)) || t[0],
                this.setToHSV(t, true)
            }
        }, {
            key: "setR",
            value: function(e) {
                var t = new Uint8Array(this.lastRGB);
                t[0] = Math.min(255, Math.max(0, parseInt(e))) || t[0],
                this.setToRGB(t, true)
            }
        }, {
            key: "setG",
            value: function(e) {
                this.props.color;
                var t = new Uint8Array(this.lastRGB);
                t[1] = Math.min(255, Math.max(0, parseInt(e))) || t[1],
                this.setToRGB(t, true)
            }
        }, {
            key: "setB",
            value: function(e) {
                this.props.color;
                var t = new Uint8Array(this.lastRGB);
                t[2] = Math.min(255, Math.max(0, parseInt(e))) || t[2],
                this.setToRGB(t, true)
            }
        }, {
            key: "setHex",
            value: function(e) {
                var t = u.default.fromInputValue(e) || this.props.color;
                this.setToRGB(t, true)
            }
        }, {
            key: "setPreview",
            value: function(e) {
                this.preview = e
            }
        }, {
            key: "render",
            value: function() {
                var e = this.state.hsv
                  , t = new Uint8Array(g(e[0], e[1], e[2]))
                  , n = new Uint8Array(g(e[0], 1, 1))
                  , i = "rgb(" + t.join(",") + ")"
                  , r = "rgb(" + n.join(",") + ")"
                  , o = u.default.toDisplayValue(t)
                  , s = this.state
                  , l = s.left
                  , c = s.top;
                return a.default.createElement("div", {
                    ref: this.setRoot,
                    className: "ClrPck",
                    onMouseDown: this.mouseDown
                }, a.default.createElement("div", {
                    ref: this.setPreview,
                    className: "ClrPckPrv",
                    style: {
                        background: i
                    },
                    onMouseDown: this.open
                }), a.default.createElement("div", {
                    className: "ClrPckMenu",
                    style: {
                        display: this.state.open ? null : "none",
                        left: l + "px",
                        top: c + "px"
                    }
                }, a.default.createElement("div", {
                    ref: this.setGraph,
                    className: "ClrPckSVGraph",
                    style: {
                        background: r
                    },
                    onMouseDown: this.pressGrabber
                }, a.default.createElement("div", {
                    className: "ClrPckSVLighten"
                }), a.default.createElement("div", {
                    className: "ClrPckSVDarken"
                }), a.default.createElement("div", {
                    className: "ClrPckSVGrabber",
                    style: {
                        left: 100 * e[1] + "%",
                        top: 100 * (1 - e[2]) + "%"
                    }
                }, a.default.createElement("div", {
                    style: {
                        background: i
                    }
                }, a.default.createElement("div", null)))), a.default.createElement("div", {
                    ref: this.setHueGraph,
                    className: "ClrPckHGraph",
                    onMouseDown: this.pressHueGrabber
                }, a.default.createElement("div", {
                    className: "ClrPckHGrabber",
                    style: {
                        left: 100 * e[0] + "%",
                        background: r
                    }
                })), a.default.createElement("div", {
                    className: "ClrPckInput"
                }, a.default.createElement("div", null, a.default.createElement("div", null, "H"), a.default.createElement(v, {
                    value: Math.round(360 * e[0]),
                    onChange: this.setH
                }), a.default.createElement("div", null, "S"), a.default.createElement(v, {
                    value: Math.round(100 * e[1]),
                    onChange: this.setS
                }), a.default.createElement("div", null, "B"), a.default.createElement(v, {
                    value: Math.round(100 * e[2]),
                    onChange: this.setV
                })), a.default.createElement("div", null, a.default.createElement("div", null, "R"), a.default.createElement(v, {
                    value: t[0],
                    onChange: this.setR
                }), a.default.createElement("div", null, "G"), a.default.createElement(v, {
                    value: t[1],
                    onChange: this.setG
                }), a.default.createElement("div", null, "B"), a.default.createElement(v, {
                    value: t[2],
                    onChange: this.setB
                })), a.default.createElement("div", null, a.default.createElement("div", null, "Hex"), a.default.createElement(v, {
                    className: "ClrPckInputLong",
                    value: o,
                    onChange: this.setHex
                })))))
            }
        }]),
        t
    }(a.default.Component)).prototype, "open", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "open"), i.prototype),
    y(i.prototype, "close", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "close"), i.prototype),
    y(i.prototype, "pressGrabber", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "pressGrabber"), i.prototype),
    y(i.prototype, "dragGrabber", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "dragGrabber"), i.prototype),
    y(i.prototype, "releaseGrabber", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "releaseGrabber"), i.prototype),
    y(i.prototype, "pressHueGrabber", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "pressHueGrabber"), i.prototype),
    y(i.prototype, "dragHueGrabber", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "dragHueGrabber"), i.prototype),
    y(i.prototype, "setRoot", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setRoot"), i.prototype),
    y(i.prototype, "setGraph", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setGraph"), i.prototype),
    y(i.prototype, "setHueGraph", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setHueGraph"), i.prototype),
    y(i.prototype, "mouseDown", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseDown"), i.prototype),
    y(i.prototype, "setH", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setH"), i.prototype),
    y(i.prototype, "setS", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setS"), i.prototype),
    y(i.prototype, "setV", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setV"), i.prototype),
    y(i.prototype, "setR", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setR"), i.prototype),
    y(i.prototype, "setG", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setG"), i.prototype),
    y(i.prototype, "setB", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setB"), i.prototype),
    y(i.prototype, "setHex", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setHex"), i.prototype),
    y(i.prototype, "setPreview", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setPreview"), i.prototype),
    i);
    t.default = m;
    var v = (y((r = function(e) {
        function t(e) {
            h(this, t);
            var n = f(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                focused: false,
                input: ""
            },
            n
        }
        return p(t, e),
        o(t, [{
            key: "componentWillUnmount",
            value: function() {
                window.removeEventListener("mousedown", this.losefocus, true)
            }
        }, {
            key: "losefocus",
            value: function(e) {
                this.state.input = null,
                this.input.blur(),
                window.removeEventListener("mousedown", this.losefocus, true)
            }
        }, {
            key: "focus",
            value: function(e) {
                e.target.select(),
                e.preventDefault(),
                e.stopPropagation(),
                this.setState({
                    focused: true,
                    input: this.props.value
                }),
                window.addEventListener("mousedown", this.losefocus, true)
            }
        }, {
            key: "blur",
            value: function(e) {
                this.state.input && this.props.onChange && this.props.onChange(e.target.value),
                this.setState({
                    focused: false
                })
            }
        }, {
            key: "keyDown",
            value: function(e) {
                switch (e.keyCode) {
                case 13:
                    this.input.blur();
                    break;
                case 27:
                    this.state.input = null,
                    this.input.blur()
                }
            }
        }, {
            key: "change",
            value: function(e) {
                this.setState({
                    input: e.target.value
                })
            }
        }, {
            key: "setInput",
            value: function(e) {
                this.input = e
            }
        }, {
            key: "render",
            value: function() {
                var e = this.state.focused ? this.state.input : this.props.value;
                return a.default.createElement("input", {
                    className: this.props.className,
                    ref: this.setInput,
                    type: "text",
                    value: e,
                    onFocus: this.focus,
                    onBlur: this.blur,
                    onChange: this.change,
                    onKeyDown: this.keyDown
                })
            }
        }]),
        t
    }(a.default.Component)).prototype, "losefocus", [s.default], Object.getOwnPropertyDescriptor(r.prototype, "losefocus"), r.prototype),
    y(r.prototype, "focus", [s.default], Object.getOwnPropertyDescriptor(r.prototype, "focus"), r.prototype),
    y(r.prototype, "blur", [s.default], Object.getOwnPropertyDescriptor(r.prototype, "blur"), r.prototype),
    y(r.prototype, "keyDown", [s.default], Object.getOwnPropertyDescriptor(r.prototype, "keyDown"), r.prototype),
    y(r.prototype, "change", [s.default], Object.getOwnPropertyDescriptor(r.prototype, "change"), r.prototype),
    y(r.prototype, "setInput", [s.default], Object.getOwnPropertyDescriptor(r.prototype, "setInput"), r.prototype),
    r);
    function g(e, t, n) {
        var i, r, o, a = Math.floor(6 * e), s = 6 * e - a, l = n * (1 - t), u = n * (1 - s * t), c = n * (1 - (1 - s) * t);
        switch (a % 6) {
        case 0:
            i = n,
            r = c,
            o = l;
            break;
        case 1:
            i = u,
            r = n,
            o = l;
            break;
        case 2:
            i = l,
            r = n,
            o = c;
            break;
        case 3:
            i = l,
            r = u,
            o = n;
            break;
        case 4:
            i = c,
            r = l,
            o = n;
            break;
        case 5:
            i = n,
            r = l,
            o = u
        }
        return [255 * i, 255 * r, 255 * o]
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    });
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }();
    var r = function() {
        function e() {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e)
        }
        return i(e, null, [{
            key: "toDisplayValue",
            value: function(e) {
                return this.toInputValue(e) + " Â°"
            }
        }, {
            key: "toInputValue",
            value: function(e) {
                return Math.round(180 * e / Math.PI).toFixed()
            }
        }, {
            key: "fromDisplayValue",
            value: function(e) {
                var t = Number.parseFloat(e) / 180 * Math.PI;
                if (Number.isNaN(t))
                    throw "Invalid input";
                return t
            }
        }, {
            key: "fromInputValue",
            value: function(e) {
                return this.fromDisplayValue(e)
            }
        }]),
        e
    }();
    t.default = r
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = n(314);
    var o = function(e) {
        function t(e, n, i, r) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var o = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e, n));
            o._StageItem = i;
            for (var a = o._Actor.imageNodes.slice(0), s = o._StageItem.node.drawOrder, l = 0; l < a.length; l++) {
                var u = a[l];
                if (u.drawOrder === r) {
                    u.drawOrder = s;
                    break
                }
            }
            o._StageItem.node.drawOrder = r,
            a.sort((function(e, t) {
                return e.drawOrder === t.drawOrder ? e.treeIndex - t.treeIndex : e.drawOrder - t.drawOrder
            }
            ));
            for (var c = 0; c < a.length; c++) {
                a[c].drawOrder = c + 1
            }
            return o
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        t
    }(((i = r) && i.__esModule ? i : {
        default: i
    }).default);
    t.default = o
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = l(n(12))
      , o = l(n(713))
      , a = l(n(601))
      , s = l(n(358));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var u = function(e) {
        function t(e, n, i) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var r = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this));
            r._Group = e,
            r._Animation = n,
            r._Property = i,
            r._KeyFrames = [],
            r._FrameValue = 0,
            r._In = 0,
            r._HasHover = false,
            r._IsSelected = false,
            r._CanGraph = true,
            r._ForceHold = false,
            r.setGraphValue = "frameRotation" == i ? r.setRotationGraphValue : r.getGraphValue,
            r.getGraphValue = "frameRotation" == i ? r.getRotationGraphValue : r.getGraphValue;
            var o = [87 / 255, 165 / 255, 225 / 255, .3];
            switch (i) {
            case "frameStringValue":
            case "frameBooleanValue":
            case "frameIsCollisionEnabled":
            case "frameActiveChild":
                r.interpolate = r.interpolateHoldKeyFrame,
                r._CanGraph = false,
                r._ForceHold = true;
                break;
            case "frameTrigger":
                r.interpolate = r.interpolateKeyFrame,
                r.findTriggeredFrames = r.findPassedFrames,
                r._CanGraph = false,
                r._ForceHold = true;
                break;
            case "frameDrawOrder":
                r.interpolate = r.interpolateOrder,
                r._CanGraph = false,
                r._ForceHold = true;
                break;
            case "frameVertices":
                r.interpolate = r.interpolateVertices,
                r._CanGraph = false;
                break;
            default:
                r.interpolate = r.interpolateKeyFrame
            }
            switch (i) {
            case "framePosX":
            case "frameScaleX":
                o = [236 / 255, 62 / 255, 74 / 255, 1];
                break;
            case "framePosY":
            case "frameScaleY":
                o = [103 / 255, 254 / 255, 217 / 255, 1];
                break;
            case "frameRotation":
                o = [1, 161 / 255, 0, 1]
            }
            return r._Color = o,
            r
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "setGraphValue",
            value: function(e) {
                return e
            }
        }, {
            key: "getGraphValue",
            value: function(e) {
                return e
            }
        }, {
            key: "setRotationGraphValue",
            value: function(e) {
                return e / 180 * Math.PI
            }
        }, {
            key: "getRotationGraphValue",
            value: function(e) {
                return e / Math.PI * 180
            }
        }, {
            key: "serializeFrame",
            value: function(e, t) {
                var n = e.value;
                if (null === n)
                    n = 0;
                else if ("frameActiveChild" === this._Property)
                    n = n ? n.refId : 0;
                else if (n.constructor === Object) {
                    var i = {};
                    for (var r in n)
                        i[r] = n[r].v;
                    n = i
                } else
                    n.constructor === Float32Array && (n = Array.prototype.slice.call(n));
                var o = {
                    t: e.time,
                    v: n,
                    i: e._Type
                };
                switch (e._Type) {
                case a.default.Type.Asymmetric:
                case a.default.Type.Mirrored:
                case a.default.Type.Disconnected:
                    Number.isFinite(e._InFactor) && (o.if = e._InFactor),
                    Number.isFinite(e._InValue) && (o.iv = e._InValue),
                    Number.isFinite(e._OutFactor) && (o.of = e._OutFactor),
                    Number.isFinite(e._OutValue) && (o.ov = e._OutValue);
                    break;
                case a.default.Type.Hold:
                    Number.isFinite(e._InFactor) && (o.if = e._InFactor),
                    Number.isFinite(e._InValue) && (o.iv = e._InValue)
                }
                return o
            }
        }, {
            key: "serialize",
            value: function() {
                for (var e = [], t = 0; t < this._KeyFrames.length; t++) {
                    var n = this._KeyFrames[t];
                    e.push(this.serializeFrame(n))
                }
                return e
            }
        }, {
            key: "deserialize",
            value: function(e, t) {
                for (var n = {}, i = 0, r = 0; r < t.length; r++) {
                    var o = t[r]
                      , s = o.v;
                    if (null != s) {
                        if ("frameActiveChild" === this._Property)
                            s = e.getNode(s);
                        else if (s.constructor === Object) {
                            var l = {};
                            for (var u in s) {
                                var c = e.getNode(u);
                                c && (l[c.refId] = {
                                    obj: c,
                                    v: s[u]
                                })
                            }
                            s = l
                        } else
                            s.constructor === Array && (s = new Float32Array(s));
                        var d = new a.default(this._Group,this._Animation,this,o.t,s);
                        this._ForceHold && o.i !== a.default.Type.Hold ? d._Type = a.default.Type.Hold : d._Type = o.i,
                        void 0 !== o.if && Number.isFinite(o.if) && (d._InFactor = o.if),
                        void 0 !== o.iv && Number.isFinite(o.iv) && (d._InValue = o.iv),
                        void 0 !== o.of && Number.isFinite(o.of) && (d._OutFactor = o.of),
                        void 0 !== o.ov && Number.isFinite(o.ov) && (d._OutValue = o.ov),
                        n[d.time] ? i++ : (n[d.time] = 1,
                        this._KeyFrames.push(d))
                    }
                }
                i && console.log("GOT DUPES", i),
                this.syncPreviousNextKeyFrames()
            }
        }, {
            key: "interpolateVertices",
            value: function(e) {
                if (this._KeyFrames.length) {
                    var t = s.default.KeyFrameLocation(e, this._KeyFrames, 0, this._KeyFrames.length - 1);
                    if (0 == t) {
                        var n = this._KeyFrames[0];
                        this._Group.node[this._Property + "KS"] = e == n.time ? 2 : 0,
                        this._FrameValue = n.value
                    } else if (t < this._KeyFrames.length) {
                        var i = this._KeyFrames[t - 1]
                          , r = this._KeyFrames[t]
                          , o = (e - i.time) / (r.time - i.time);
                        if ((o < 0 || o > 1) && console.log("NO!!!", o),
                        1 == o)
                            this._Group.node[this._Property + "KS"] = 2,
                            this._FrameValue = r.value;
                        else {
                            this._Group.node[this._Property + "KS"] = 0;
                            var a = i.value.length;
                            this.temp && this.temp.length == a || (this.temp = new Float32Array(a));
                            for (var l = this.temp, u = i.value, c = r.value, d = 1 - o, h = 0; h < a; h++)
                                l[h] = u[h] * d + c[h] * o;
                            this._FrameValue = l
                        }
                    } else {
                        var f = this._KeyFrames[t - 1];
                        this._Group.node[this._Property + "KS"] = e == f.time ? 2 : 0,
                        this._FrameValue = f.value
                    }
                }
            }
        }, {
            key: "interpolateOrder",
            value: function(e) {
                if (this._KeyFrames.length) {
                    var t = s.default.KeyFrameLocation(e, this._KeyFrames, 0, this._KeyFrames.length - 1);
                    if (0 == t) {
                        var n = this._KeyFrames[0];
                        this._Animation.orderKeyState = e == n.time ? 2 : 0,
                        this._FrameValue = n.value
                    } else if (t < this._KeyFrames.length) {
                        var i = this._KeyFrames[t - 1]
                          , r = this._KeyFrames[t]
                          , o = (e - i.time) / (r.time - i.time);
                        (o < 0 || o > 1) && console.log("NO!!!", o),
                        1 == o ? (this._Animation.orderKeyState = 2,
                        this._FrameValue = r.value) : (this._Animation.orderKeyState = 0,
                        this._FrameValue = i.value)
                    } else {
                        var a = this._KeyFrames[t - 1];
                        this._Animation.orderKeyState = e == a.time ? 2 : 0,
                        this._FrameValue = a.value
                    }
                }
            }
        }, {
            key: "getInterpolatedValue",
            value: function(e) {
                if (!this._KeyFrames.length)
                    return 0;
                var t = s.default.KeyFrameLocation(e, this._KeyFrames, 0, this._KeyFrames.length - 1);
                if (0 == t)
                    return this._KeyFrames[0]._Value;
                if (t < this._KeyFrames.length) {
                    var n = this._KeyFrames[t - 1]
                      , i = this._KeyFrames[t];
                    return e == i.time ? i._Value : n.interpolate(e)
                }
                return this._KeyFrames[t - 1]._Value
            }
        }, {
            key: "findPassedFrames",
            value: function(e, t) {
                var n = s.default.KeyFrameLocation(t, this._KeyFrames, 0, this._KeyFrames.length - 1);
                if (0 === n)
                    return this._KeyFrames.length > 0 && this._KeyFrames[0].time === t ? [this._KeyFrames[0]] : null;
                for (var i = [], r = n - 1; r >= 0; r--) {
                    var o = this._KeyFrames[r];
                    if (!(o.time > e))
                        break;
                    i.push(o)
                }
                return i
            }
        }, {
            key: "interpolateHoldKeyFrame",
            value: function(e) {
                if (this._KeyFrames.length) {
                    var t = s.default.KeyFrameLocation(e, this._KeyFrames, 0, this._KeyFrames.length - 1);
                    if (0 == t) {
                        var n = this._KeyFrames[0];
                        this._Group.node[this._Property + "KS"] = n.time == e ? 2 : 0,
                        this._FrameValue = n._Value
                    } else if (t < this._KeyFrames.length) {
                        var i = this._KeyFrames[t - 1]
                          , r = this._KeyFrames[t];
                        e == r.time ? (this._Group.node[this._Property + "KS"] = 2,
                        this._FrameValue = r._Value) : (this._Group.node[this._Property + "KS"] = 0,
                        this._FrameValue = i._Value)
                    } else {
                        var o = this._KeyFrames[t - 1];
                        this._Group.node[this._Property + "KS"] = e == o.time ? 2 : 0,
                        this._FrameValue = o._Value
                    }
                }
            }
        }, {
            key: "interpolateKeyFrame",
            value: function(e) {
                if (this._KeyFrames.length) {
                    var t = s.default.KeyFrameLocation(e, this._KeyFrames, 0, this._KeyFrames.length - 1);
                    if (0 == t) {
                        var n = this._KeyFrames[0];
                        this._Group.node[this._Property + "KS"] = n.time == e ? 2 : 0,
                        this._FrameValue = n._Value
                    } else if (t < this._KeyFrames.length) {
                        var i = this._KeyFrames[t - 1]
                          , r = this._KeyFrames[t];
                        e == r.time ? (this._Group.node[this._Property + "KS"] = 2,
                        this._FrameValue = r._Value) : (this._Group.node[this._Property + "KS"] = 0,
                        this._FrameValue = i.interpolate(e))
                    } else {
                        var o = this._KeyFrames[t - 1];
                        this._Group.node[this._Property + "KS"] = e == o.time ? 2 : 0,
                        this._FrameValue = o._Value
                    }
                }
            }
        }, {
            key: "getValue",
            value: function(e) {
                var t = this.getKey(e);
                return t ? t.value : null
            }
        }, {
            key: "getKey",
            value: function(e) {
                var t, n = s.default.KeyFrameLocation(e, this._KeyFrames, 0, this._KeyFrames.length - 1);
                return n < this._KeyFrames.length && (t = this._KeyFrames[n]).time === e ? t : null
            }
        }, {
            key: "updateValue",
            value: function(e, t) {
                var n, i = s.default.KeyFrameLocation(e, this._KeyFrames, 0, this._KeyFrames.length - 1);
                return i < this._KeyFrames.length && (n = this._KeyFrames[i]).time === e ? (n.value = t,
                this.dispatch("update", n)) : (n = new a.default(this._Group,this._Animation,this,e,t),
                this._KeyFrames.splice(i, 0, n),
                this.syncPreviousNextKeyFrames(),
                this.dispatch("add", n),
                this._Group.dispatch("add", n),
                this._Animation.dispatch("update"),
                this._Animation.onKeyFrameAdded(n)),
                n
            }
        }, {
            key: "syncPreviousNextKeyFrames",
            value: function() {
                for (var e = null, t = 0; t < this._KeyFrames.length; t++) {
                    var n = this._KeyFrames[t];
                    n._Idx = t,
                    e ? (n.prv != e && (n._Dirty = true),
                    e.nxt != n && (e._Dirty = true),
                    n.prv = e,
                    e.nxt = n) : (null != n.prv && (n._Dirty = true),
                    n.prv = null),
                    e = n
                }
                e && (null != e.nxt && (e._Dirty = true),
                e.nxt = null)
            }
        }, {
            key: "reSort",
            value: function() {
                (0,
                o.default)(this._KeyFrames, (function(e, t) {
                    return e.time - t.time
                }
                )),
                this.syncPreviousNextKeyFrames()
            }
        }, {
            key: "getClosestKey",
            value: function(e, t) {
                var n = s.default.KeyFrameLocation(e, this._KeyFrames, 0, this._KeyFrames.length - 1)
                  , i = n - 1
                  , r = t || Number.MAX_Value
                  , o = -1;
                if (i >= 0 && i < this._KeyFrames.length) {
                    var a = Math.abs(e - this._KeyFrames[i].time);
                    a < r && (r = a,
                    o = i)
                }
                var l = n;
                if (l >= 0 && l < this._KeyFrames.length) {
                    var u = Math.abs(e - this._KeyFrames[l].time);
                    u < r && (r = u,
                    o = l)
                }
                return -1 == o ? null : this._KeyFrames[o]
            }
        }, {
            key: "getKeysInRange",
            value: function(e, t) {
                var n = s.default.KeyFrameLocation(e, this._KeyFrames, 0, this._KeyFrames.length - 1)
                  , i = s.default.KeyFrameLocation(t, this._KeyFrames, 0, this._KeyFrames.length - 1);
                return this._KeyFrames.slice(n, i)
            }
        }, {
            key: "getKeysInRangeIdx",
            value: function(e, t) {
                return {
                    start: s.default.KeyFrameLocation(e, this._KeyFrames, 0, this._KeyFrames.length - 1),
                    end: s.default.KeyFrameLocation(t, this._KeyFrames, 0, this._KeyFrames.length - 1)
                }
            }
        }, {
            key: "setKey",
            value: function() {
                this.updateValue(this._Animation.position, this._Group.node[this._Property]),
                this._Group.node[this._Property + "KS"] = 2
            }
        }, {
            key: "removeKey",
            value: function() {
                var e = this.getKey(this._Animation.position);
                return !!e && (e.remove(),
                this._Animation.dispatch("update"),
                true)
            }
        }, {
            key: "setPositionToNextKey",
            value: function() {
                var e = s.default.KeyFrameLocation(this._Animation.position, this._KeyFrames, 0, this._KeyFrames.length - 1);
                if (e < this._KeyFrames.length) {
                    var t = this._KeyFrames[e];
                    this._Animation.position == t.time && e + 1 < this._KeyFrames.length && (t = this._KeyFrames[e + 1]),
                    this._Animation.position = t.time
                }
            }
        }, {
            key: "setPositionToPreviousKey",
            value: function() {
                var e = s.default.KeyFrameLocation(this._Animation.position, this._KeyFrames, 0, this._KeyFrames.length - 1);
                if (e - 1 < this._KeyFrames.length && e - 1 >= 0) {
                    var t = this._KeyFrames[e - 1];
                    this._Animation.position == t.time && e - 2 >= 0 && (t = this._KeyFrames[e - 2]),
                    this._Animation.position = t.time
                }
            }
        }, {
            key: "add",
            value: function(e) {
                var t = 0 == this._KeyFrames.length;
                return this._KeyFrames.push(e),
                t && this._Group.showProperty(this),
                true
            }
        }, {
            key: "remove",
            value: function(e) {
                var t = this._KeyFrames.indexOf(e);
                return -1 != t && (this._KeyFrames.splice(t, 1),
                0 == this._KeyFrames.length && this._Group.hideProperty(this),
                this.syncPreviousNextKeyFrames(),
                true)
            }
        }, {
            key: "canGraph",
            get: function() {
                return this._CanGraph
            }
        }, {
            key: "forceHold",
            get: function() {
                return this._ForceHold
            }
        }, {
            key: "cssColor",
            get: function() {
                return this._CssColor || (this._CssColor = "rgba(" + Math.round(255 * this.color[0]) + "," + Math.round(255 * this.color[1]) + "," + Math.round(255 * this.color[2]) + "," + this.color[3] + ")"),
                this._CssColor
            }
        }, {
            key: "color",
            get: function() {
                return this._Color
            }
        }, {
            key: "group",
            get: function() {
                return this._Group
            }
        }, {
            key: "hasHover",
            get: function() {
                return this._HasHover
            },
            set: function(e) {
                this._HasHover != e && (this._HasHover = e,
                this.dispatch("hover"),
                this._Animation.dispatch("update"))
            }
        }, {
            key: "isSelected",
            get: function() {
                return this._IsSelected
            },
            set: function(e) {
                this._IsSelected != e && (this._IsSelected = e,
                this.dispatch("selected", this._IsSelected),
                this._Animation.dispatch("update"))
            }
        }, {
            key: "frameValue",
            get: function() {
                return this._FrameValue
            }
        }, {
            key: "keyFrames",
            get: function() {
                return this._KeyFrames
            }
        }, {
            key: "property",
            get: function() {
                return this._Property
            }
        }, {
            key: "animation",
            get: function() {
                return this._Animation
            }
        }]),
        t
    }(r.default);
    t.default = u
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    });
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }();
    function r(e) {
        var t = Math.pow(Math.abs(e), 1 / 3);
        return e < 0 ? -t : t
    }
    function o(e, t, n, i, r) {
        return e * (1 - r) * (1 - r) * (1 - r) + 3 * t * r * (1 - r) * (1 - r) + 3 * n * r * r * (1 - r) + i * r * r * r
    }
    var a = function() {
        function e(t, n, i, r) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e);
            var o = t[1]
              , a = t[0]
              , s = n[1]
              , l = n[0]
              , u = i[1]
              , c = i[0]
              , d = r[1]
              , h = r[0];
            this._E = d - 3 * u + 3 * s - o,
            this._F = 3 * u - 6 * s + 3 * o,
            this._G = 3 * s - 3 * o,
            this._H = o,
            this._Y0a = o,
            this._X0a = a,
            this._Y1a = s,
            this._X1a = l,
            this._Y2a = u,
            this._X2a = c,
            this._Y3a = d,
            this._X3a = h
        }
        return i(e, [{
            key: "get",
            value: function(e) {
                for (var t = this._X0a - e, n = this._X1a - e, i = this._X2a - e, o = function(e, t, n, i) {
                    if (Math.abs(e) < Number.EPSILON) {
                        if (e = t,
                        t = n,
                        n = i,
                        Math.abs(e) < Number.EPSILON)
                            return e = t,
                            t = n,
                            Math.abs(e) < Number.EPSILON ? [] : [-t / e];
                        var o = t * t - 4 * e * n;
                        return Math.abs(o) < Number.EPSILON ? [-t / (2 * e)] : o > 0 ? [(-t + Math.sqrt(o)) / (2 * e), (-t - Math.sqrt(o)) / (2 * e)] : []
                    }
                    var a = (3 * e * n - t * t) / (3 * e * e)
                      , s = (2 * t * t * t - 9 * e * t * n + 27 * e * e * i) / (27 * e * e * e)
                      , l = void 0;
                    if (Math.abs(a) < Number.EPSILON)
                        l = [r(-s)];
                    else if (Math.abs(s) < Number.EPSILON)
                        l = [0].concat(a < 0 ? [Math.sqrt(-a), -Math.sqrt(-a)] : []);
                    else {
                        var u = s * s / 4 + a * a * a / 27;
                        if (Math.abs(u) < Number.EPSILON)
                            l = [-1.5 * s / a, 3 * s / a];
                        else if (u > 0) {
                            var c = r(-s / 2 - Math.sqrt(u));
                            l = [c - a / (3 * c)]
                        } else {
                            var d = 2 * Math.sqrt(-a / 3)
                              , h = Math.acos(3 * s / a / d) / 3
                              , f = 2 * Math.PI / 3;
                            l = [d * Math.cos(h), d * Math.cos(h - f), d * Math.cos(h - 2 * f)]
                        }
                    }
                    for (var p = 0; p < l.length; p++)
                        l[p] -= t / (3 * e);
                    return l
                }(this._X3a - e - 3 * i + 3 * n - t, 3 * i - 6 * n + 3 * t, 3 * n - 3 * t, t), a = 0, s = 0; s < o.length; s++) {
                    var l = o[s];
                    if (l >= 0 && l <= 1) {
                        a = l;
                        break
                    }
                }
                return function(e, t, n, i, r) {
                    return t * (e * e * e) + n * (e * e) + i * e + r
                }(a, this._E, this._F, this._G, this._H)
            }
        }, {
            key: "getBounds",
            value: function() {
                if (this.bounds)
                    return this.bounds;
                var e = this._Y0a
                  , t = this._X0a
                  , n = this._Y1a
                  , i = this._X1a
                  , r = this._Y2a
                  , a = this._X2a
                  , s = this._Y3a
                  , l = this._X3a
                  , u = 3 * l - 9 * a + 9 * i - 3 * t
                  , c = 6 * t - 12 * i + 6 * a
                  , d = 3 * i - 3 * t
                  , h = c * c - 4 * u * d
                  , f = t
                  , p = t;
                if (l < f && (f = l),
                l > p && (p = l),
                h >= 0) {
                    var y = (-c + Math.sqrt(h)) / (2 * u);
                    if (y > 0 && y < 1) {
                        var m = o(t, i, a, l, y);
                        m < f && (f = m),
                        m > p && (p = m)
                    }
                    var v = (-c - Math.sqrt(h)) / (2 * u);
                    if (v > 0 && v < 1) {
                        var g = o(t, i, a, l, v);
                        g < f && (f = g),
                        g > p && (p = g)
                    }
                }
                var _ = e
                  , b = e;
                if (s < _ && (_ = s),
                s > b && (b = s),
                (h = (c = 6 * e - 12 * n + 6 * r) * c - 4 * (u = 3 * s - 9 * r + 9 * n - 3 * e) * (d = 3 * n - 3 * e)) >= 0) {
                    var w = (-c + Math.sqrt(h)) / (2 * u);
                    if (w > 0 && w < 1) {
                        var O = o(e, n, r, s, w);
                        O < _ && (_ = O),
                        O > b && (b = O)
                    }
                    var S = (-c - Math.sqrt(h)) / (2 * u);
                    if (S > 0 && S < 1) {
                        var k = o(e, n, r, s, S);
                        k < _ && (_ = k),
                        k > b && (b = k)
                    }
                }
                return this.bounds = [_, b],
                this.bounds
            }
        }]),
        e
    }();
    t.default = a
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = function e(t) {
        if (!t || t.constructor !== Object)
            return t;
        var n = {};
        for (var i in t) {
            var r = t[i];
            r ? r.constructor === Object ? n[i] = e(r) : r.constructor === Array ? n[i] = r.slice(0) : n[i] = r : n[i] = r
        }
        return n
    }
}
, , , , , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    });
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }();
    var r = function() {
        function e(t) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e);
            var n = {
                premultipliedAlpha: false,
                preserveDrawingBuffer: true
            };
            this._GL = t.getContext("webgl", n) || t.getContext("experimental-webgl", n),
            this._LastFrameBufferBinding = null
        }
        return i(e, [{
            key: "dispose",
            value: function() {
                this._FrameBuffer && this._FrameBuffer.dispose()
            }
        }, {
            key: "bindOffscreenFrameBuffer",
            value: function(e, t, n) {
                var i = this._FrameBuffer;
                return i || (i = this._FrameBuffer = new o(this,e,t,n)),
                i.bind(t, n),
                i
            }
        }, {
            key: "unbindOffscreenFrameBuffer",
            value: function() {
                var e = this._FrameBuffer;
                if (e) {
                    var t = e.read();
                    return e.unbind(),
                    t
                }
            }
        }, {
            key: "gl",
            get: function() {
                return this._GL
            }
        }]),
        e
    }();
    function o(e, t, n, i) {
        var r = e.gl
          , o = r.createFramebuffer()
          , a = r.createTexture();
        r.bindTexture(r.TEXTURE_2D, a),
        r.texParameteri(r.TEXTURE_2D, r.TEXTURE_MAG_FILTER, r.NEAREST),
        r.texParameteri(r.TEXTURE_2D, r.TEXTURE_MIN_FILTER, r.NEAREST),
        r.texParameteri(r.TEXTURE_2D, r.TEXTURE_WRAP_S, r.CLAMP_TO_EDGE),
        r.texParameteri(r.TEXTURE_2D, r.TEXTURE_WRAP_T, r.CLAMP_TO_EDGE);
        var s = n
          , l = i;
        r.texImage2D(r.TEXTURE_2D, 0, r.RGBA, s, l, 0, r.RGBA, r.UNSIGNED_BYTE, null),
        r.bindTexture(r.TEXTURE_2D, null),
        r.bindFramebuffer(r.FRAMEBUFFER, o),
        r.framebufferTexture2D(r.FRAMEBUFFER, r.COLOR_ATTACHMENT0, r.TEXTURE_2D, a, 0),
        r.bindFramebuffer(r.FRAMEBUFFER, null);
        var u = null
          , c = 0
          , d = 0;
        t.invalidateCache(),
        this.bind = function(n, i) {
            e._LastFrameBufferBinding !== o && (u = e._LastFrameBufferBinding,
            c = t.viewportWidth,
            d = t.viewportHeight),
            s == n && l == i || (s = n,
            l = i,
            r.bindTexture(r.TEXTURE_2D, a),
            r.texImage2D(r.TEXTURE_2D, 0, r.RGBA, n, i, 0, r.RGBA, r.UNSIGNED_BYTE, null),
            r.bindTexture(r.TEXTURE_2D, null)),
            r.bindFramebuffer(r.FRAMEBUFFER, o),
            t.setSize(n, i),
            r.viewport(0, 0, n, i),
            r.clearColor(.3628, .3628, .3628, 0),
            r.clear(r.COLOR_BUFFER_BIT),
            e._LastFrameBufferBinding = o,
            t.invalidateCache()
        }
        ,
        this.__defineGetter__("texture", (function() {
            return a
        }
        )),
        this.unbind = function() {
            r.bindFramebuffer(r.FRAMEBUFFER, u),
            t.setSize(c, d),
            e._LastFrameBufferBinding = u
        }
        ,
        this.dispose = function() {
            r.deleteFramebuffer(o),
            r.deleteTexture(a)
        }
        ,
        this.read = function() {
            var e = new Uint8Array(s * l * 4);
            return r.readPixels(0, 0, s, l, r.RGBA, r.UNSIGNED_BYTE, e),
            e
        }
    }
    t.default = r
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    });
    var i = {
        Common: [{
            keys: ["p"],
            action: "pick-parent"
        }, {
            keys: ["`"],
            action: "switch-mode"
        }, {
            keys: ["h"],
            action: "hover-show-in-hierarchy"
        }, {
            keys: ["v"],
            action: "next-selection-filter"
        }, {
            keys: ["shift", "v"],
            action: "previous-selection-filter"
        }, {
            keys: [","],
            action: "previous-key-frame"
        }, {
            keys: ["."],
            action: "next-key-frame"
        }, {
            keys: ["k"],
            action: "key-selected"
        }, {
            keys: ["backspace"],
            action: "delete"
        }, {
            keys: ["delete"],
            action: "delete"
        }, {
            keys: ["esc"],
            action: "cancel"
        }, {
            keys: ["t"],
            action: "translate-tool"
        }, {
            keys: ["shift", "t"],
            action: "key-selected-translation"
        }, {
            keys: ["c"],
            action: "draw-mesh-tool"
        }, {
            keys: ["c"],
            action: "select-children-tool"
        }, {
            keys: ["p"],
            action: "paint-weight-tool"
        }, {
            keys: ["r"],
            action: "rotate-tool"
        }, {
            keys: ["shift", "r"],
            action: "key-selected-rotation"
        }, {
            keys: ["shift", "l"],
            action: "key-selected-length"
        }, {
            keys: ["s"],
            action: "scale-tool"
        }, {
            keys: ["shift", "s"],
            action: "key-selected-scale"
        }, {
            keys: ["w"],
            action: "ik-tool"
        }, {
            keys: ["b"],
            action: "bone-tool"
        }, {
            keys: ["g"],
            action: "node-tool"
        }, {
            keys: ["y"],
            action: "solo-tool"
        }, {
            keys: ["q"],
            action: "collider-tool"
        }, {
            keys: ["space"],
            action: "pan"
        }, {
            keys: ["f"],
            action: "zoom-fit"
        }, {
            keys: ["space"],
            action: "toggle-play"
        }, {
            keys: ["home"],
            action: "timeline-start"
        }, {
            keys: ["end"],
            action: "timeline-end"
        }, {
            keys: ["1"],
            action: "item1"
        }, {
            keys: ["2"],
            action: "item2"
        }, {
            keys: ["3"],
            action: "item3"
        }, {
            keys: ["4"],
            action: "item4"
        }, {
            keys: ["5"],
            action: "item5"
        }, {
            keys: ["6"],
            action: "item6"
        }, {
            keys: ["7"],
            action: "item7"
        }, {
            keys: ["8"],
            action: "item8"
        }, {
            keys: ["9"],
            action: "item9"
        }, {
            keys: ["0"],
            action: "item10"
        }, {
            keys: ["]"],
            action: "brush-size-up"
        }, {
            keys: ["["],
            action: "send-backward"
        }, {
            keys: ["]"],
            action: "bring-forward"
        }, {
            keys: ["["],
            action: "brush-size-down"
        }, {
            keys: ["shift", "]"],
            action: "brush-feather-down"
        }, {
            keys: ["shift", "["],
            action: "brush-feather-up"
        }, {
            keys: ["shift", "]"],
            action: "send-to-front"
        }, {
            keys: ["shift", "["],
            action: "send-to-back"
        }, {
            keys: ["alt", "]"],
            action: "brush-strength-up"
        }, {
            keys: ["alt", "["],
            action: "brush-strength-down"
        }, {
            keys: ["left"],
            action: "nudge-left"
        }, {
            keys: ["right"],
            action: "nudge-right"
        }, {
            keys: ["up"],
            action: "nudge-up"
        }, {
            keys: ["down"],
            action: "nudge-down"
        }, {
            keys: ["shift", "left"],
            action: "bump-left"
        }, {
            keys: ["shift", "right"],
            action: "bump-right"
        }, {
            keys: ["shift", "up"],
            action: "bump-up"
        }, {
            keys: ["shift", "down"],
            action: "bump-down"
        }, {
            keys: ["shift", "/"],
            action: "show-shortcuts-modal"
        }],
        OSX: [{
            keys: ["command", "d"],
            action: "deselect"
        }, {
            keys: ["command", "c"],
            action: "copy"
        }, {
            keys: ["command", "v"],
            action: "paste"
        }, {
            keys: ["command", "x"],
            action: "cut"
        }, {
            keys: ["command", "z"],
            action: "undo"
        }, {
            keys: ["shift", "command", "z"],
            action: "redo"
        }, {
            keys: ["command", "="],
            action: "zoom-in"
        }, {
            keys: ["command", "-"],
            action: "zoom-out"
        }, {
            keys: ["command", "0"],
            action: "zoom-100"
        }, {
            keys: ["command", "g"],
            action: "group"
        }, {
            keys: ["command", "y"],
            action: "group-solo"
        }, {
            keys: ["command", "a"],
            action: "select-all"
        }, {
            keys: ["command", "left"],
            action: "prev-frame"
        }, {
            keys: ["command", "right"],
            action: "next-frame"
        }, {
            keys: ["shift", "command", "left"],
            action: "prev-10-frames"
        }, {
            keys: ["shift", "command", "right"],
            action: "next-10-frames"
        }, {
            keys: ["command", "]"],
            action: "next-item"
        }, {
            keys: ["command", "["],
            action: "prev-item"
        }, {
            keys: ["command", "f"],
            action: "find"
        }, {
            keys: ["command", ";"],
            action: "toggle-rulers"
        }, {
            keys: ["shift", "command", ";"],
            action: "reset-rulers"
        }, {
            keys: ["command", "s"],
            action: "force-revision"
        }, {
            keys: ["command", "j"],
            action: "duplicate"
        }],
        Windows: [{
            keys: ["ctrl", "d"],
            action: "deselect"
        }, {
            keys: ["ctrl", "c"],
            action: "copy"
        }, {
            keys: ["ctrl", "v"],
            action: "paste"
        }, {
            keys: ["ctrl", "x"],
            action: "cut"
        }, {
            keys: ["ctrl", "z"],
            action: "undo"
        }, {
            keys: ["shift", "ctrl", "z"],
            action: "redo"
        }, {
            keys: ["ctrl", "="],
            action: "zoom-in"
        }, {
            keys: ["ctrl", "-"],
            action: "zoom-out"
        }, {
            keys: ["ctrl", "0"],
            action: "zoom-100"
        }, {
            keys: ["ctrl", "g"],
            action: "group"
        }, {
            keys: ["ctrl", "y"],
            action: "group-solo"
        }, {
            keys: ["ctrl", "a"],
            action: "select-all"
        }, {
            keys: ["ctrl", "left"],
            action: "prev-frame"
        }, {
            keys: ["ctrl", "right"],
            action: "next-frame"
        }, {
            keys: ["shift", "ctrl", "left"],
            action: "prev-10-frames"
        }, {
            keys: ["shift", "ctrl", "right"],
            action: "next-10-frames"
        }, {
            keys: ["ctrl", "]"],
            action: "next-item"
        }, {
            keys: ["ctrl", "["],
            action: "prev-item"
        }, {
            keys: ["ctrl", "f"],
            action: "find"
        }, {
            keys: ["ctrl", ";"],
            action: "toggle-rulers"
        }, {
            keys: ["shift", "ctrl", ";"],
            action: "reset-rulers"
        }, {
            keys: ["ctrl", "s"],
            action: "force-revision"
        }, {
            keys: ["ctrl", "j"],
            action: "duplicate"
        }]
    };
    i.OSX = i.OSX.concat(i.Common),
    i.Windows = i.Windows.concat(i.Common),
    t.default = {
        Common: i.Common,
        OSX: i.OSX,
        Windows: i.Windows
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = c(n(0)), a = c(n(197)), s = c(n(4)), l = c(n(1)), u = c(n(3));
    function c(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function d(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var h = (d((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                accentSend: false,
                sent: false
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "componentWillMount",
            value: function() {
                this.accentSend = false
            }
        }, {
            key: "reload",
            value: function() {
                window.location.reload()
            }
        }, {
            key: "sendMessage",
            value: function() {
                this.text.value.trim() && (this.context.nima.errorFeedback(this.text.value.trim()),
                this.setState({
                    sent: true
                }))
            }
        }, {
            key: "onInput",
            value: function() {
                var e = this.text.value.trim();
                e = !!e,
                this.accentSend != e && (this.accentSend = e,
                this.setState({
                    accentSend: e
                }))
            }
        }, {
            key: "setText",
            value: function(e) {
                this.text = e
            }
        }, {
            key: "render",
            value: function() {
                return o.default.createElement("div", {
                    className: "FullscreenWarningWrapper"
                }, this.state.sent ? o.default.createElement("div", {
                    className: "FullscreenWarning"
                }, o.default.createElement("svg", {
                    className: "CrashIcon"
                }, o.default.createElement("use", {
                    xlinkHref: u.default.make("/images/symbol-defs.svg#icon-bug")
                })), o.default.createElement("div", {
                    className: "FullscreenWarningHeader"
                }, "You Found a Bug!"), o.default.createElement("div", {
                    className: "FullscreenCrashTxt"
                }, "Thanks for sending us feedback!"), o.default.createElement("div", {
                    className: "FullscreenWarningBtns"
                }, o.default.createElement(a.default, {
                    label: "Reload",
                    accentBtn: false,
                    onPress: this.reload
                }))) : o.default.createElement("div", {
                    className: "FullscreenWarning"
                }, o.default.createElement("svg", {
                    className: "CrashIcon"
                }, o.default.createElement("use", {
                    xlinkHref: u.default.make("/images/symbol-defs.svg#icon-bug")
                })), o.default.createElement("div", {
                    className: "FullscreenWarningHeader"
                }, "You Found a Bug!"), o.default.createElement("div", {
                    className: "FullscreenCrashTxt"
                }, "Our team has been notified, but it would be really helpful if you could give us some details about what you were doing. Rest assured that our team is looking into it!"), o.default.createElement("textarea", {
                    ref: this.setText,
                    placeholder: "Tell us what went wrong...",
                    onChange: this.onInput
                }), o.default.createElement("div", {
                    className: "FullscreenWarningBtns"
                }, o.default.createElement(a.default, {
                    label: "Send Message",
                    accentBtn: this.state.accentSend,
                    onPress: this.sendMessage
                }), o.default.createElement(a.default, {
                    label: "Reload",
                    accentBtn: false,
                    onPress: this.reload
                }))))
            }
        }]),
        t
    }(o.default.Component)).prototype, "reload", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "reload"), i.prototype),
    d(i.prototype, "sendMessage", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "sendMessage"), i.prototype),
    d(i.prototype, "onInput", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "onInput"), i.prototype),
    d(i.prototype, "setText", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "setText"), i.prototype),
    i);
    t.default = h,
    h.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = l(n(0)), a = l(n(197)), s = l(n(1));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function u(e, t) {
        if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function")
    }
    function c(e, t) {
        if (!e)
            throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    function d(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var h = (d((i = function(e) {
        function t() {
            return u(this, t),
            c(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "backToFiles",
            value: function() {
                window.location = "/my/characters"
            }
        }, {
            key: "continueAnyway",
            value: function() {
                this.props.onContinueAnyway && this.props.onContinueAnyway()
            }
        }, {
            key: "render",
            value: function() {
                return o.default.createElement("div", {
                    className: "FullscreenWarningWrapper"
                }, o.default.createElement("div", {
                    className: "FullscreenWarning"
                }, o.default.createElement("div", {
                    className: "FullscreenWarningHeader"
                }, "Nima is not optimized for this browser yet."), o.default.createElement("div", {
                    className: "FullscreenWarningTxt"
                }, "For the best experience, we recommend using ", o.default.createElement("a", {
                    href: "https://www.google.com/chrome"
                }, "Chrome"), " or ", o.default.createElement("a", {
                    href: "https://mozilla.org/firefox"
                }, "Firefox"), "."), o.default.createElement("div", {
                    className: "FullscreenWarningBtns"
                }, o.default.createElement(a.default, {
                    label: "Continue Anyway",
                    accentBtn: false,
                    onPress: this.continueAnyway
                }), o.default.createElement(a.default, {
                    label: "Back to Your Files",
                    accentBtn: true,
                    onPress: this.backToFiles
                }))))
            }
        }]),
        t
    }(o.default.Component)).prototype, "backToFiles", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "backToFiles"), i.prototype),
    d(i.prototype, "continueAnyway", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "continueAnyway"), i.prototype),
    i);
    t.default = h
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = l(n(0)), a = l(n(197)), s = l(n(1));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function u(e, t) {
        if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function")
    }
    function c(e, t) {
        if (!e)
            throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    var d, h, f, p, y, m, v = (i = function(e) {
        function t() {
            return u(this, t),
            c(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "backToFiles",
            value: function() {
                window.location = "/my/characters"
            }
        }, {
            key: "readMoreInfo",
            value: function() {
                window.location = this.props.error.helpLink
            }
        }, {
            key: "render",
            value: function() {
                var e = this.props.error;
                return o.default.createElement("div", {
                    className: "FullscreenWarningWrapper"
                }, o.default.createElement("div", {
                    className: "FullscreenWarning"
                }, o.default.createElement("div", {
                    className: "FullscreenWarningHeader"
                }, e.title), o.default.createElement("div", {
                    className: "FullscreenWarningTxt"
                }, e.description), o.default.createElement("div", {
                    className: "FullscreenWarningBtns"
                }, o.default.createElement(a.default, {
                    label: "Help",
                    accentBtn: false,
                    onPress: this.readMoreInfo
                }), o.default.createElement(a.default, {
                    label: "Back to Your Files",
                    accentBtn: true,
                    onPress: this.backToFiles
                }))))
            }
        }]),
        t
    }(o.default.Component),
    d = i.prototype,
    h = "readMoreInfo",
    f = [s.default],
    p = Object.getOwnPropertyDescriptor(i.prototype, "readMoreInfo"),
    y = i.prototype,
    m = {},
    Object.keys(p).forEach((function(e) {
        m[e] = p[e]
    }
    )),
    m.enumerable = !!m.enumerable,
    m.configurable = !!m.configurable,
    ("value"in m || m.initializer) && (m.writable = true),
    m = f.slice().reverse().reduce((function(e, t) {
        return t(d, h, e) || e
    }
    ), m),
    y && void 0 !== m.initializer && (m.value = m.initializer ? m.initializer.call(y) : void 0,
    m.initializer = void 0),
    void 0 === m.initializer && (Object.defineProperty(d, h, m),
    m = null),
    i);
    t.default = v
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r, o = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), a = O(n(0)), s = O(n(1)), l = O(n(4)), u = O(n(1116)), c = O(n(1117)), d = O(n(386)), h = O(n(714)), f = O(n(358)), p = O(n(1119)), y = O(n(1123)), m = O(n(1125)), v = O(n(1128)), g = O(n(1130)), _ = O(n(13)), b = O(n(605)), w = O(n(3));
    function O(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function S(e, t) {
        if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function")
    }
    function k(e, t) {
        if (!e)
            throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    function P(e, t) {
        if ("function" != typeof t && null !== t)
            throw new TypeError("Super expression must either be null or a function, not " + typeof t);
        e.prototype = Object.create(t && t.prototype, {
            constructor: {
                value: e,
                enumerable: false,
                writable: true,
                configurable: true
            }
        }),
        t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
    }
    function E(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var T = (E((i = function(e) {
        function t(e) {
            S(this, t);
            var n = k(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.assetPaneHeightFactor = .33,
            n.state = {
                assets: null,
                name: n.props.file.name,
                hierarchy: null,
                orderKeyFrameHandler: null,
                hierarchyPaneHeight: 0,
                assetPaneHeight: 0
            },
            n._GrabberY = void 0,
            n
        }
        return P(t, e),
        o(t, [{
            key: "componentWillMount",
            value: function() {
                this.isFiltering = false;
                var e = this.context.nima;
                e && (e.addEventListener("actorLoaded", this.onActorLoaded),
                e.addEventListener("fileRenamed", this.onFileRenamed),
                e.stage.addEventListener("selectionChanged", this.onStageSelectionChanged),
                e.addEventListener("selectionChanged", this.onNonStageItemSelectionsChanged),
                window.addEventListener("resize", this.onWindowResize),
                this._Width = this.props.width,
                this._SelectionPanelWidth = this.props.selectionPanelWidth)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                _.default.cancel(this.doForceUpdate);
                var e = this.context.nima;
                e && (e.removeEventListener("actorLoaded", this.onActorLoaded),
                e.removeEventListener("fileRenamed", this.onFileRenamed),
                e.stage.removeEventListener("selectionChanged", this.onStageSelectionChanged),
                e.removeEventListener("selectionChanged", this.onNonStageItemSelectionsChanged),
                window.removeEventListener("resize", this.onWindowResize))
            }
        }, {
            key: "onWindowResize",
            value: function(e) {
                this.updateSize()
            }
        }, {
            key: "updateSize",
            value: function(e) {
                if (this.root) {
                    var t = this.root.getBoundingClientRect()
                      , n = t.height - this.headerHeight - 96
                      , i = n * this.assetPaneHeightFactor;
                    e && (this._GrabberY = e,
                    i = Math.min(n, Math.max(0, t.height - e - 48)),
                    this.assetPaneHeightFactor = i / n);
                    var r = n - i;
                    this.resizeGrabber.setBottom(i + 48 - 3),
                    this.setState({
                        hierarchyPaneHeight: r,
                        assetPaneHeight: i
                    })
                }
            }
        }, {
            key: "resize",
            value: function(e) {
                this.updateSize(e.clientY)
            }
        }, {
            key: "startResize",
            value: function() {
                window.addEventListener("mousemove", this.resize, true),
                window.addEventListener("mouseup", this.endResize, true)
            }
        }, {
            key: "endResize",
            value: function() {
                window.removeEventListener("mousemove", this.resize, true),
                window.removeEventListener("mouseup", this.endResize, true),
                this.props.onHierarchyPanelsResized && void 0 !== this._GrabberY && this.props.onHierarchyPanelsResized(this._GrabberY)
            }
        }, {
            key: "setFilter",
            value: function(e) {
                this.filter = e,
                this.updateFilter()
            }
        }, {
            key: "find",
            value: function() {
                this.filter.show()
            }
        }, {
            key: "componentDidMount",
            value: function() {
                var e = this.context.nima.getPreference("editor") || {};
                this._GrabberY = e.grabberY || void 0,
                this.updateSize(this._GrabberY)
            }
        }, {
            key: "onFileRenamed",
            value: function(e) {
                this.setState({
                    name: e.name
                })
            }
        }, {
            key: "onActorLoaded",
            value: function(e) {
                var t = new h.default(e);
                e.drawOrder.isNameReadOnly = true,
                e.drawOrder.name = "Draw Order",
                e.animationFolder = t,
                this.setState((function(n, i) {
                    return {
                        hierarchy: e.root,
                        assets: e.assetFolder,
                        actor: e,
                        animations: t
                    }
                }
                ))
            }
        }, {
            key: "onStageSelectionChanged",
            value: function(e, t) {
                e.length && this.context.nima.clearSelections()
            }
        }, {
            key: "onNonStageItemSelectionsChanged",
            value: function(e, t) {
                if (this.context.nima.editingAnimation) {
                    for (var n = [], i = 0; i < e.length; i++) {
                        var r = e[i];
                        r.constructor === f.default && (-1 === n.indexOf(r) && n.push(r))
                    }
                    if (clearTimeout(this.expandTreeTimeout),
                    this.suppressTreeExpansion || t === this)
                        return;
                    this.secondaryPanel.animationPane.show(n)
                } else
                    e.length && this.context.nima.stage.clearSelections(false, true)
            }
        }, {
            key: "changeName",
            value: function(e) {
                this.setState({
                    name: e
                }),
                this.context.nima.changeFileName(e)
            }
        }, {
            key: "bringHoverIntoView",
            value: function() {
                var e = this.context.nima.stage.hoverItem;
                e && e.node && this.hierarchy && this.hierarchy.show(e.node)
            }
        }, {
            key: "dragOrder",
            value: function(e) {
                if (e.preventDefault(),
                !this.dragImage) {
                    var t = this.dragImage = document.createElement("div");
                    t.className = "HierarchyDragGhost";
                    for (var n = this.drag.items, i = n.length - 1; i >= 0; i--) {
                        var r = n[i];
                        r.row.setIsDragging(true);
                        var o = document.createElement("div");
                        o.innerText = r.node.name,
                        t.appendChild(o)
                    }
                    document.body.appendChild(t)
                }
                var a = this.dragImage.getBoundingClientRect();
                this.dragImage.style.left = Math.round(e.clientX - a.width / 2) + "px",
                this.dragImage.style.top = Math.round(e.clientY - a.height / 2) + "px"
            }
        }, {
            key: "releaseOrder",
            value: function(e) {
                if (this.dragImage) {
                    for (var t = this.drag, n = t.items, i = this.currentDragOrder, r = 0; r < n.length; r++) {
                        var o = n[r];
                        o.row.setIsDragging(false);
                        var a = i.indexOf(o.node);
                        o.oldIndex = a + 1
                    }
                    if (this.drag.target) {
                        i.slice(0);
                        var s = this.drag.target.props.data
                          , l = i.indexOf(s);
                        1 !== this.drag.target.state.drop && (l += 1);
                        for (var u = [], c = 0; c < n.length; c++) {
                            var d = n[c];
                            u.push(d.node);
                            var h = i.indexOf(d.node);
                            i.splice(h, 1),
                            h < l && l--
                        }
                        Array.prototype.splice.apply(i, [l, 0].concat(u));
                        for (var f = 0; f < i.length; f++) {
                            i[f].hierarchySortOrder = f + 1
                        }
                        this.context.nima.captureJournalEntry()
                    }
                    this.dragImage ? this.dragImage.parentNode === document.body && document.body.removeChild(this.dragImage) : t.isMultiSelect || (this.suppressTreeExpansion = true,
                    this.context.nima.stage.selectItem(t.hitItem.stageItem, false),
                    this.suppressTreeExpansion = false),
                    this.dragImage = null
                }
                this.drag = null,
                this.topOrderRow.setDragSibling(null),
                window.removeEventListener("mousemove", this.dragOrder, true),
                window.removeEventListener("mouseup", this.releaseOrder, true)
            }
        }, {
            key: "forceSetupWorkspace",
            value: function() {
                this.workspaceToggle.forceSetupWorkspace()
            }
        }, {
            key: "switchWorkspace",
            value: function(e) {
                this.secondaryPanel.activeIndex = "SetupButton" === e ? 0 : 1,
                this.props.onSwitchedToggle && this.props.onSwitchedToggle(e)
            }
        }, {
            key: "setAnimationMode",
            value: function(e) {
                e && this.setEditingAnimation(e)
            }
        }, {
            key: "setEditingAnimation",
            value: function(e) {
                this.setState({
                    orderKeyFrameHandler: e ? {
                        dispatcher: e,
                        event: "keyState",
                        get state() {
                            return this.dispatcher.orderKeyState
                        },
                        setKey: function() {
                            this.dispatcher.setOrderKey()
                        }
                    } : null
                })
            }
        }, {
            key: "setMeshMode",
            value: function(e) {
                this.root && (this.meshMode = e,
                this.translateMesh(e))
            }
        }, {
            key: "translateMesh",
            value: function(e) {
                this.root.style.transform = e ? "translate3D(-" + this._Width + "px, 0, 0)" : null
            }
        }, {
            key: "translatePanelOut",
            value: function(e) {
                this.root.style.transform = e ? "translate3D(-" + (this._Width + this._SelectionPanelWidth) + "px, 0, 0)" : null
            }
        }, {
            key: "setWidth",
            value: function(e) {
                this._Width = e,
                this.root.style.width = e + "px"
            }
        }, {
            key: "setSelectionPanelWidth",
            value: function(e) {
                this._SelectionPanelWidth = e
            }
        }, {
            key: "setAssetTip",
            value: function(e) {
                this.assetTip = e
            }
        }, {
            key: "setHeader",
            value: function(e) {
                this.header = e,
                e && (this.headerHeight = e.getBoundingClientRect().height)
            }
        }, {
            key: "setRoot",
            value: function(e) {
                this.root = e
            }
        }, {
            key: "filterChange",
            value: function(e) {
                this.isFiltering = e,
                this.updateFilter()
            }
        }, {
            key: "updateFilter",
            value: function() {
                var e = this.hierarchy
                  , t = this.isFiltering
                  , n = this.secondaryPanel
                  , i = this.drawOrder;
                e && e.updateFilter(t),
                i && i.updateFilter(t),
                n && (n.animationPane && n.animationPane.updateFilter(t),
                n.assetsPane && n.assetsPane.updateFilter(t))
            }
        }, {
            key: "setHierarchy",
            value: function(e) {
                this.hierarchy = e
            }
        }, {
            key: "setSecondaryPanel",
            value: function(e) {
                this.secondaryPanel = e
            }
        }, {
            key: "setDrawOrder",
            value: function(e) {
                this.drawOrder = e
            }
        }, {
            key: "setWorkspaceToggle",
            value: function(e) {
                this.workspaceToggle = e
            }
        }, {
            key: "setResizeGrabber",
            value: function(e) {
                this.resizeGrabber = e
            }
        }, {
            key: "render",
            value: function() {
                var e = this.context.nima
                  , t = !e || !e.hasWriteAccess
                  , n = this.state
                  , i = n.actor
                  , r = n.assets
                  , o = n.animations
                  , s = n.orderKeyFrameHandler
                  , l = this.props.file;
                return a.default.createElement("div", {
                    ref: this.setRoot,
                    id: "HierarchyPanel",
                    style: {
                        width: this._Width + "px",
                        transform: this.meshMode ? "translate3D(-" + this._Width + "px, 0, 0)" : null
                    }
                }, a.default.createElement("div", {
                    ref: this.setHeader
                }, a.default.createElement("div", {
                    className: "EditorHeader"
                }, a.default.createElement("svg", {
                    className: "MenuIcon",
                    onClick: this.props.onLogoClick,
                    onMouseEnter: this.props.onLogoHover
                }, a.default.createElement("use", {
                    xlinkHref: w.default.make("/images/symbol-defs.svg#icon-menu")
                })), a.default.createElement(u.default, {
                    name: t ? l.name : this.state.name,
                    onNameChanged: this.changeName,
                    readOnly: t
                }), t ? null : a.default.createElement("svg", {
                    className: "InfoIcon",
                    onClick: this.props.onShowPropertiesModal
                }, a.default.createElement("use", {
                    xlinkHref: w.default.make("/images/symbol-defs.svg#icon-info")
                }))), a.default.createElement(c.default, {
                    ref: this.setWorkspaceToggle,
                    onSwitched: this.switchWorkspace
                })), a.default.createElement(g.default, null, a.default.createElement(p.default, {
                    icon: "icon-character",
                    title: "Hierarchy",
                    ref: this.setHierarchy,
                    actor: i,
                    data: this.state.hierarchy,
                    height: this.state.hierarchyPaneHeight
                }), a.default.createElement(y.default, {
                    icon: "icon-order",
                    title: "Draw Order",
                    keyFrameHandler: s,
                    ref: this.setDrawOrder,
                    data: i && i.drawOrder,
                    height: this.state.hierarchyPaneHeight
                })), a.default.createElement(b.default, {
                    ref: this.setResizeGrabber,
                    isHorizontal: true,
                    onMouseDown: this.startResize
                }), a.default.createElement(C, {
                    contentHeight: this.state.assetPaneHeight,
                    ref: this.setSecondaryPanel,
                    actor: i,
                    assets: r,
                    animations: o,
                    showAssetTip: this.state.showAssetTip
                }), a.default.createElement(d.default, {
                    ref: this.setFilter,
                    onFilter: this.filterChange
                }))
            }
        }, {
            key: "animationFolder",
            get: function() {
                return this.state.animations
            }
        }]),
        t
    }(a.default.Component)).prototype, "onWindowResize", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "onWindowResize"), i.prototype),
    E(i.prototype, "resize", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "resize"), i.prototype),
    E(i.prototype, "startResize", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "startResize"), i.prototype),
    E(i.prototype, "endResize", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "endResize"), i.prototype),
    E(i.prototype, "setFilter", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setFilter"), i.prototype),
    E(i.prototype, "onFileRenamed", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "onFileRenamed"), i.prototype),
    E(i.prototype, "onActorLoaded", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "onActorLoaded"), i.prototype),
    E(i.prototype, "onStageSelectionChanged", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "onStageSelectionChanged"), i.prototype),
    E(i.prototype, "onNonStageItemSelectionsChanged", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "onNonStageItemSelectionsChanged"), i.prototype),
    E(i.prototype, "changeName", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "changeName"), i.prototype),
    E(i.prototype, "dragOrder", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "dragOrder"), i.prototype),
    E(i.prototype, "releaseOrder", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "releaseOrder"), i.prototype),
    E(i.prototype, "forceSetupWorkspace", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "forceSetupWorkspace"), i.prototype),
    E(i.prototype, "switchWorkspace", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "switchWorkspace"), i.prototype),
    E(i.prototype, "setAssetTip", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setAssetTip"), i.prototype),
    E(i.prototype, "setHeader", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setHeader"), i.prototype),
    E(i.prototype, "setRoot", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setRoot"), i.prototype),
    E(i.prototype, "filterChange", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "filterChange"), i.prototype),
    E(i.prototype, "setHierarchy", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setHierarchy"), i.prototype),
    E(i.prototype, "setSecondaryPanel", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setSecondaryPanel"), i.prototype),
    E(i.prototype, "setDrawOrder", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setDrawOrder"), i.prototype),
    E(i.prototype, "setWorkspaceToggle", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setWorkspaceToggle"), i.prototype),
    E(i.prototype, "setResizeGrabber", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setResizeGrabber"), i.prototype),
    i);
    t.default = T,
    T.contextTypes = {
        nima: l.default.object
    };
    var C = (E((r = function(e) {
        function t(e) {
            S(this, t);
            var n = k(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {},
            n
        }
        return P(t, e),
        o(t, [{
            key: "onEditingAnimationChanged",
            value: function() {
                this.forceUpdate()
            }
        }, {
            key: "componentWillMount",
            value: function() {
                var e = this.context.nima;
                e && e.addEventListener("editingAnimationChanged", this.onEditingAnimationChanged)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                _.default.cancel(this.doForceUpdate);
                var e = this.context.nima;
                e && e.removeEventListener("editingAnimationChanged", this.onEditingAnimationChanged)
            }
        }, {
            key: "setTabPanel",
            value: function(e) {
                this.tabPanel = e
            }
        }, {
            key: "setAnimationPane",
            value: function(e) {
                this.animationPane = e
            }
        }, {
            key: "setAssetsPane",
            value: function(e) {
                this.assetsPane = e
            }
        }, {
            key: "render",
            value: function() {
                var e = this.context.nima
                  , t = this.props
                  , n = t.actor
                  , i = t.animations
                  , r = t.assets
                  , o = t.contentHeight
                  , s = !!e.editingAnimation;
                return a.default.createElement(g.default, {
                    ref: this.setTabPanel
                }, a.default.createElement(m.default, {
                    icon: "icon-picture",
                    isHidden: s,
                    ref: this.setAssetsPane,
                    title: "Assets",
                    actor: n,
                    data: r,
                    height: o
                }), a.default.createElement(v.default, {
                    icon: "icon-animations",
                    isHidden: !s,
                    ref: this.setAnimationPane,
                    title: "Animations",
                    actor: n,
                    data: i,
                    height: o
                }))
            }
        }, {
            key: "activeIndex",
            get: function() {
                return this.tabPanel && this.tabPanel.activeIndex
            },
            set: function(e) {
                this.tabPanel && (this.tabPanel.activeIndex = e)
            }
        }]),
        t
    }(a.default.Component)).prototype, "onEditingAnimationChanged", [s.default], Object.getOwnPropertyDescriptor(r.prototype, "onEditingAnimationChanged"), r.prototype),
    E(r.prototype, "setTabPanel", [s.default], Object.getOwnPropertyDescriptor(r.prototype, "setTabPanel"), r.prototype),
    E(r.prototype, "setAnimationPane", [s.default], Object.getOwnPropertyDescriptor(r.prototype, "setAnimationPane"), r.prototype),
    E(r.prototype, "setAssetsPane", [s.default], Object.getOwnPropertyDescriptor(r.prototype, "setAssetsPane"), r.prototype),
    r);
    C.contextTypes = {
        nima: l.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = l(n(0)), a = l(n(4)), s = l(n(1));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function u(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var c = (u((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                name: n.props.name || "",
                textValue: n.props.name
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "componentWillMount",
            value: function() {
                this.recalculateInputBounds = true,
                this.fileName = this.props.name,
                this.focused = false
            }
        }, {
            key: "setTextInput",
            value: function(e) {
                this.textInput = e
            }
        }, {
            key: "setHiddenDiv",
            value: function(e) {
                this.hiddenDiv = e
            }
        }, {
            key: "nameInputKeyDown",
            value: function(e) {
                switch (e.keyCode) {
                case 13:
                    this.textInput.blur();
                    break;
                case 27:
                    this.setState({
                        name: this.fileName
                    }),
                    this.textInput.value = this.fileName,
                    this.textInput.blur()
                }
            }
        }, {
            key: "nameInputChange",
            value: function(e) {
                if (this.props.readOnly)
                    return false;
                this.recalculateInputBounds = true,
                this.setState({
                    name: e.target.value
                }),
                this.updateInputFieldWidth(e.target.value)
            }
        }, {
            key: "nameInputBlurred",
            value: function(e) {
                this.props.readOnly || (e.target.value != this.fileName && this.props.onNameChanged && (this.props.onNameChanged(e.target.value),
                this.fileName = e.target.value),
                this.focused = false)
            }
        }, {
            key: "nameInputFocused",
            value: function(e) {
                this.focused = true,
                this.fileName = this.props.name
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.name != this.props.name && (this.recalculateInputBounds = true,
                this.fileName = e.name,
                this.focused || this.setState({
                    name: this.fileName,
                    textValue: this.fileName
                }))
            }
        }, {
            key: "updateInputFieldWidth",
            value: function(e) {
                this.setState({
                    textValue: e
                })
            }
        }, {
            key: "componentDidUpdate",
            value: function() {
                this.recalculateInputBounds && (this.calcTextWidth = this.hiddenDiv.getBoundingClientRect().width,
                this.calcTextWidth != this.state.newWidth && (this.setState({
                    newWidth: this.calcTextWidth
                }),
                this.recalculateInputBounds = false))
            }
        }, {
            key: "render",
            value: function() {
                return o.default.createElement("div", {
                    className: "CharacterName"
                }, o.default.createElement("input", {
                    className: "ProjectTitle",
                    ref: this.setTextInput,
                    autoComplete: "off",
                    type: "text",
                    value: this.state.name,
                    onKeyDown: this.nameInputKeyDown,
                    onChange: this.nameInputChange,
                    onBlur: this.nameInputBlurred,
                    onFocus: this.nameInputFocused,
                    style: {
                        width: this.state.newWidth ? this.state.newWidth : null,
                        pointerEvents: this.props.readOnly ? "none" : null
                    }
                }), o.default.createElement("div", {
                    ref: this.setHiddenDiv,
                    className: "ProjectTitle",
                    style: {
                        visibility: "hidden",
                        whiteSpace: "pre",
                        display: "inline-block",
                        position: "absolute"
                    }
                }, this.state.textValue))
            }
        }]),
        t
    }(o.default.Component)).prototype, "setTextInput", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setTextInput"), i.prototype),
    u(i.prototype, "setHiddenDiv", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setHiddenDiv"), i.prototype),
    u(i.prototype, "nameInputKeyDown", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "nameInputKeyDown"), i.prototype),
    u(i.prototype, "nameInputChange", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "nameInputChange"), i.prototype),
    u(i.prototype, "nameInputBlurred", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "nameInputBlurred"), i.prototype),
    u(i.prototype, "nameInputFocused", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "nameInputFocused"), i.prototype),
    i);
    t.default = c,
    c.contextTypes = {
        nima: a.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = l(n(0)), a = l(n(1)), s = l(n(1118));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var u, c, d, h, f, p, y = (i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                selectedToggle: "SetupButton"
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "toggleChanged",
            value: function(e) {
                this.selectedToggle != e && (this.selectedToggle = e,
                this.setState({
                    selectedToggle: e
                }),
                this.props.onSwitched && this.props.onSwitched(e))
            }
        }, {
            key: "forceSetupWorkspace",
            value: function() {
                this.toggleChanged("SetupButton")
            }
        }, {
            key: "render",
            value: function() {
                return o.default.createElement("div", {
                    className: "WorkspaceToggle"
                }, o.default.createElement(s.default, {
                    id: "SetupButton",
                    text: "SETUP",
                    isSelected: "SetupButton" == this.state.selectedToggle,
                    onSelected: this.toggleChanged
                }), o.default.createElement(s.default, {
                    id: "AnimateButton",
                    text: "ANIMATE",
                    isSelected: "AnimateButton" == this.state.selectedToggle,
                    onSelected: this.toggleChanged
                }), o.default.createElement("div", {
                    id: "ToggleHighlight",
                    className: "SetupButton" == this.state.selectedToggle ? "ToggleHighlightSetup" : "ToggleHighlightAnimate"
                }))
            }
        }]),
        t
    }(o.default.Component),
    u = i.prototype,
    c = "toggleChanged",
    d = [a.default],
    h = Object.getOwnPropertyDescriptor(i.prototype, "toggleChanged"),
    f = i.prototype,
    p = {},
    Object.keys(h).forEach((function(e) {
        p[e] = h[e]
    }
    )),
    p.enumerable = !!p.enumerable,
    p.configurable = !!p.configurable,
    ("value"in p || p.initializer) && (p.writable = true),
    p = d.slice().reverse().reduce((function(e, t) {
        return t(u, c, e) || e
    }
    ), p),
    f && void 0 !== p.initializer && (p.value = p.initializer ? p.initializer.call(f) : void 0,
    p.initializer = void 0),
    void 0 === p.initializer && (Object.defineProperty(u, c, p),
    p = null),
    i);
    t.default = y
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = s(n(0)), a = s(n(1));
    function s(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function l(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var u = (l((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                hover: false
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "mouseOver",
            value: function() {
                this.setState({
                    hover: true
                })
            }
        }, {
            key: "mouseOut",
            value: function() {
                this.setState({
                    hover: false
                })
            }
        }, {
            key: "mouseDown",
            value: function() {
                this.props.onSelected && this.props.onSelected(this.props.id)
            }
        }, {
            key: "render",
            value: function() {
                return o.default.createElement("div", {
                    onClick: this.mouseDown,
                    onMouseEnter: this.mouseOver,
                    onMouseLeave: this.mouseOut,
                    id: this.props.id,
                    className: this.props.isSelected ? "workspaceToggleActive" : this.state.hover ? "workspaceToggleHover" : null
                }, this.props.text)
            }
        }]),
        t
    }(o.default.Component)).prototype, "mouseOver", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseOver"), i.prototype),
    l(i.prototype, "mouseOut", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseOut"), i.prototype),
    l(i.prototype, "mouseDown", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseDown"), i.prototype),
    i);
    t.default = u
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = _(n(0)), a = _(n(1)), s = _(n(4)), l = _(n(386)), u = _(n(9)), c = _(n(237)), d = _(n(208)), h = _(n(396)), f = _(n(315)), p = _(n(344)), y = _(n(267)), m = _(n(170)), v = _(n(1120)), g = _(n(602));
    function _(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function b(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var w = (b((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {},
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "componentWillMount",
            value: function() {
                var e = this.context.nima;
                e && (this.setActor(this.props.actor),
                e.stage.addEventListener("selectionChanged", this.onStageSelectionChanged))
            }
        }, {
            key: "onStageSelectionChanged",
            value: function(e, t) {
                e.length && this.context.nima.clearSelections();
                if (t !== this) {
                    var n = []
                      , i = true
                      , r = false
                      , o = void 0;
                    try {
                        for (var a, s = e[Symbol.iterator](); !(i = (a = s.next()).done); i = true) {
                            var l = a.value;
                            l.node && -1 === e.indexOf(l.node) && n.push(l.node)
                        }
                    } catch (e) {
                        r = true,
                        o = e
                    } finally {
                        try {
                            !i && s.return && s.return()
                        } finally {
                            if (r)
                                throw o
                        }
                    }
                    this.tree && this.tree.show(n)
                }
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.actor != this.props.actor && this.setActor(e.actor)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setActor(null)
            }
        }, {
            key: "onActorChildrenChanged",
            value: function() {
                this.forceUpdate()
            }
        }, {
            key: "setActor",
            value: function(e) {
                if (this.actor !== e) {
                    var t = this.actor;
                    t && t.removeEventListener("childrenChanged", this.onActorChildrenChanged),
                    this.actor = e,
                    e && e.addEventListener("childrenChanged", this.onActorChildrenChanged)
                }
            }
        }, {
            key: "renderHierarchyItem",
            value: function(e, t, n) {
                return o.default.createElement(v.default, {
                    isDragging: t,
                    dropTargetState: n,
                    item: e,
                    onSelected: this.onHierarchySelection
                })
            }
        }, {
            key: "spaceHierarchyItem",
            value: function(e) {
                return e.parent instanceof p.default ? 2 : 1
            }
        }, {
            key: "updateFilter",
            value: function(e) {
                this.tree && this.tree.overrideExpansion(e ? function(e) {
                    return 0 != (e.filterState & l.default.Expanded)
                }
                : null)
            }
        }, {
            key: "isHierarchyProperty",
            value: function(e) {
                return !(e instanceof d.default)
            }
        }, {
            key: "getHierarchyItemChildren",
            value: function(e) {
                if (!e.hierarchyChildren)
                    return null;
                var t = []
                  , n = true
                  , i = false
                  , r = void 0;
                try {
                    for (var o, a = e.hierarchyChildren[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                        var s = o.value;
                        s.hideInHierarchy || s.filterState === l.default.Hidden || t.push(s)
                    }
                } catch (e) {
                    i = true,
                    r = e
                } finally {
                    try {
                        !n && a.return && a.return()
                    } finally {
                        if (i)
                            throw r
                    }
                }
                return t
            }
        }, {
            key: "setTree",
            value: function(e) {
                this.tree = e
            }
        }, {
            key: "onHierarchySelection",
            value: function(e, t) {
                var n = this.context.nima.stage;
                if (t.stageItem && t.parent)
                    if (t.stageItem.isSelected && u.default.isMultiSelect(e))
                        n.deSelectItem(t.stageItem, this);
                    else if (e.shiftKey) {
                        if (0 === n.selectedItems.length)
                            n.selectItem(t.stageItem, false, false, this);
                        else {
                            var i = this.tree.getRangeItems(n.selectedItems.map((function(e) {
                                return e.node
                            }
                            )), t);
                            null !== i && (i = i.map((function(e) {
                                return e.stageItem
                            }
                            )),
                            n.clearSelections(true, true),
                            n.selectItems(i, true, false, this))
                        }
                    } else {
                        u.default.isMultiSelect(e) || n.clearSelections(true, true),
                        n.selectItem(t.stageItem, true, false, this)
                    }
            }
        }, {
            key: "makeDragGhost",
            value: function(e) {
                var t = this.dragImage = document.createElement("div");
                return t.className = "HierarchyDragGhost",
                t.innerText = e.name,
                t
            }
        }, {
            key: "allowDrag",
            value: function(e) {
                switch (e.constructor) {
                case y.default:
                case f.default:
                case d.default:
                case p.default:
                    return true;
                default:
                    return false
                }
            }
        }, {
            key: "allowDrop",
            value: function(e, t, n) {
                t || (t = this.actor.root);
                var i = this.context.nima.stage.currentOperation;
                if (i && (t instanceof d.default ? i.target(t, this.getActualIndex(e, t, n)) : i.target(null)),
                e instanceof h.default && !e.isValidParent(t))
                    return false;
                if (e.constructor === f.default && t.constructor === c.default) {
                    for (var r = t.parent; r && r.constructor !== f.default; )
                        r = r.parent;
                    if (r === e)
                        return false
                }
                return true
            }
        }, {
            key: "getActualIndex",
            value: function(e, t, n) {
                var i = this.getHierarchyItemChildren(t)[n]
                  , r = t.hierarchyChildren.filter((function(t) {
                    return t !== e
                }
                ));
                if (!r)
                    return -1;
                for (var o = 0; o < r.length; o++)
                    if (r[o] === i)
                        return o
            }
        }, {
            key: "drop",
            value: function(e, t, n) {
                this.context.nima.stage.currentOperation || (t || (t = this.actor.root),
                e.parent && e.parent.remove(e),
                t.add(e, false, this.getActualIndex(e, t, n)),
                e instanceof d.default && e.compensate(),
                this.context.nima.captureJournalEntry())
            }
        }, {
            key: "show",
            value: function(e) {
                this.tree.show(e)
            }
        }, {
            key: "mouseEnter",
            value: function(e) {
                var t = this.context.nima.stage.currentOperation;
                if (t) {
                    var n = t.meta;
                    this.tree.handoffDrag(n),
                    t.meta = this.tree
                }
            }
        }, {
            key: "mouseLeave",
            value: function(e) {
                var t = this.context.nima.stage.currentOperation;
                t && t.target(null)
            }
        }, {
            key: "render",
            value: function() {
                var e = false
                  , t = false;
                return this.props.data && (e = this.props.data),
                e.children && 0 === e.children.length && (t = true),
                o.default.createElement("div", {
                    className: g.default.Pane
                }, o.default.createElement(m.default, {
                    onMouseEnter: this.mouseEnter,
                    onMouseLeave: this.mouseLeave,
                    ref: this.setTree,
                    makeDragGhost: this.makeDragGhost,
                    allowDrag: this.allowDrag,
                    drop: this.drop,
                    allowDrop: this.allowDrop,
                    data: this.props.data,
                    showFirstLine: true,
                    height: this.props.height,
                    iconWidth: 15,
                    iconHeight: 15,
                    rowHeight: 35,
                    getChildren: this.getHierarchyItemChildren,
                    isProperty: this.isHierarchyProperty,
                    renderItem: this.renderHierarchyItem,
                    spaceItem: this.spaceHierarchyItem,
                    expandedItems: this.context.nima.expandedItems
                }), t ? o.default.createElement("div", {
                    className: "Tip"
                }, "Your hierarchy is empty. Drag some assets onto the stage or into this panel.") : null)
            }
        }]),
        t
    }(o.default.Component)).prototype, "onStageSelectionChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onStageSelectionChanged"), i.prototype),
    b(i.prototype, "onActorChildrenChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onActorChildrenChanged"), i.prototype),
    b(i.prototype, "setActor", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setActor"), i.prototype),
    b(i.prototype, "renderHierarchyItem", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "renderHierarchyItem"), i.prototype),
    b(i.prototype, "spaceHierarchyItem", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "spaceHierarchyItem"), i.prototype),
    b(i.prototype, "isHierarchyProperty", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "isHierarchyProperty"), i.prototype),
    b(i.prototype, "getHierarchyItemChildren", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "getHierarchyItemChildren"), i.prototype),
    b(i.prototype, "setTree", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setTree"), i.prototype),
    b(i.prototype, "onHierarchySelection", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onHierarchySelection"), i.prototype),
    b(i.prototype, "makeDragGhost", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "makeDragGhost"), i.prototype),
    b(i.prototype, "allowDrag", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "allowDrag"), i.prototype),
    b(i.prototype, "allowDrop", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "allowDrop"), i.prototype),
    b(i.prototype, "drop", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "drop"), i.prototype),
    b(i.prototype, "mouseEnter", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseEnter"), i.prototype),
    b(i.prototype, "mouseLeave", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseLeave"), i.prototype),
    i);
    t.default = w,
    w.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = _(n(0)), a = _(n(4)), s = _(n(267)), l = _(n(1)), u = _(n(20)), c = _(n(715)), d = _(n(344)), h = _(n(208)), f = _(n(358)), p = _(n(13)), y = _(n(386)), m = _(n(170)), v = _(n(518)), g = _(n(3));
    function _(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function b(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var w = (b((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                editing: false,
                hover: false
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "doForceUpdate",
            value: function() {
                this.forceUpdate()
            }
        }, {
            key: "debounceForcedUpdate",
            value: function() {
                (0,
                p.default)(this.doForceUpdate)
            }
        }, {
            key: "setKeyFrame",
            value: function(e) {
                e.stopPropagation();
                var t = this.item;
                if (t) {
                    var n = t.keyFrameHandler;
                    n && (n.setKey(this.context.nima),
                    this.context.nima.captureJournalEntry())
                }
            }
        }, {
            key: "setItem",
            value: function(e) {
                var t = this.item;
                if (t !== e) {
                    var n = this.context.nima;
                    if (t) {
                        var i = t.keyFrameHandler;
                        i && (i.dispatcher.removeEventListener(i.event, this.debounceForcedUpdate),
                        n.removeEventListener("editingAnimationChanged", this.debounceForcedUpdate)),
                        t.removeEventListener("displayChange", this.debounceForcedUpdate),
                        t.removeEventListener("visibilityChange", this.debounceForcedUpdate),
                        t.removeEventListener("renderCollapseChange", this.debounceForcedUpdate),
                        t.visibilityItem && (t.visibilityItem.removeEventListener("hoverChange", this.debounceForcedUpdate),
                        t.visibilityItem.removeEventListener("lockedChange", this.debounceForcedUpdate)),
                        t.stageItem ? t.stageItem.removeEventListener("selectedChange", this.debounceForcedUpdate) : t.removeEventListener("selectedChange", this.debounceForcedUpdate)
                    }
                    if (this.item = e,
                    e) {
                        var r = e.keyFrameHandler;
                        r && (r.dispatcher.addEventListener(r.event, this.debounceForcedUpdate),
                        n.addEventListener("editingAnimationChanged", this.debounceForcedUpdate)),
                        e.addEventListener("displayChange", this.debounceForcedUpdate),
                        e.addEventListener("visibilityChange", this.debounceForcedUpdate),
                        e.addEventListener("renderCollapseChange", this.debounceForcedUpdate),
                        e.visibilityItem && (e.visibilityItem.addEventListener("hoverChange", this.debounceForcedUpdate),
                        e.visibilityItem.addEventListener("lockedChange", this.debounceForcedUpdate)),
                        e.stageItem ? e.stageItem.addEventListener("selectedChange", this.debounceForcedUpdate) : e.addEventListener("selectedChange", this.debounceForcedUpdate),
                        this.state.hover && e.stageItem && e.stageItem.stage && (this.context.nima.stage.hoverItem = e.stageItem)
                    }
                }
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.item != this.props.item && this.setItem(e.item)
            }
        }, {
            key: "componentWillMount",
            value: function() {
                this.setItem(this.props.item)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                p.default.cancel(this.doForceUpdate),
                this.setItem(null)
            }
        }, {
            key: "mouseEnter",
            value: function() {
                this.setState({
                    hover: true
                });
                var e = this.item;
                e && e.stageItem && e.stageItem.stage && (this.context.nima.stage.hoverItem = e.stageItem)
            }
        }, {
            key: "mouseLeave",
            value: function() {
                this.setState({
                    hover: false
                });
                var e = this.item;
                e && e.stageItem && this.context.nima.stage.hoverItem === e.stageItem && (this.context.nima.stage.hoverItem = null)
            }
        }, {
            key: "mouseDown",
            value: function(e) {
                if (e.preventDefault(),
                e.stopPropagation(),
                this.item) {
                    var t = Date.now();
                    if (this.clickTime) {
                        var n = t - this.clickTime;
                        if (delete this.clickTime,
                        n < 200 && this.editableName.startEdit())
                            return
                    }
                    this.clickTime = t,
                    this.props.onSelected && this.props.onSelected(e, this.item)
                }
            }
        }, {
            key: "toggleVisibility",
            value: function(e) {
                e.stopPropagation();
                var t = this.item;
                if (t && t.visibilityItem) {
                    var n = this.context.nima;
                    if (e.altKey)
                        if (n.lastAltVisibility && n.lastAltVisibility.item === t && n.lastAltVisibility.meta === e.metaKey)
                            for (var i = n.lastAltVisibility.selection, r = 0; r < i.length; r++) {
                                var o = i[r];
                                o.isVisible = !o.isVisible
                            }
                        else {
                            var a = []
                              , s = [];
                            t.isVisible || (s.push(t),
                            t.isVisible = true),
                            e.metaKey || !t.all ? a.push(t) : t.all((function(e) {
                                a.push(e)
                            }
                            )),
                            n.actor.root.all((function(e) {
                                -1 === a.indexOf(e) && e.isVisible && (s.push(e),
                                e.isVisible = false)
                            }
                            )),
                            n.lastAltVisibility = {
                                selection: s,
                                item: t,
                                meta: e.metaKey
                            }
                        }
                    else {
                        if (e.metaKey || !t.all)
                            t.isVisible = !t.isVisible;
                        else {
                            var l = !t.isVisible;
                            t.all((function(e) {
                                e.isVisible = l
                            }
                            ))
                        }
                        delete n.lastAltVisibility
                    }
                    t.stageItem && t.stageItem.stage && t.stageItem.stage.redraw()
                }
            }
        }, {
            key: "toggleLocked",
            value: function(e) {
                e.stopPropagation();
                var t = this.item;
                if (t && t.visibilityItem) {
                    if (e.metaKey || !t.all)
                        t.isLocked = !t.isLocked;
                    else {
                        var n = !t.isLocked;
                        t.all((function(e) {
                            e.isLocked = n
                        }
                        ))
                    }
                    t.stageItem && t.stageItem.stage && t.stageItem.stage.redraw()
                }
            }
        }, {
            key: "toggleActive",
            value: function(e) {
                e.stopPropagation();
                var t = this.item;
                t && t.parent && (t.parent.activeChild = t,
                t.stageItem && t.stageItem.stage && t.stageItem.stage.redraw())
            }
        }, {
            key: "setEditableName",
            value: function(e) {
                this.editableName = e
            }
        }, {
            key: "render",
            value: function() {
                var e = this.context.nima.stage
                  , t = this.props
                  , n = t.item
                  , i = t.dropTargetState
                  , r = t.isDragging
                  , a = n.stageItem
                  , l = n.visibilityItem
                  , p = this.state
                  , _ = p.editing
                  , b = p.hover
                  , w = n.uiHierIconClass
                  , O = n.uiIcon
                  , S = O ? g.default.make("/images/symbol-defs.svg#" + O) : null
                  , k = !r && a ? a.isSelected : n.isSelected
                  , P = l && e && e.hoverItem === l || false
                  , E = n instanceof h.default
                  , T = !E || n.isVisible
                  , C = l && l.isLocked || false
                  , x = n.filterState
                  , I = !T || 0 != (x & (y.default.SemiHidden | y.default.Collapsed))
                  , D = false
                  , M = this.context.nima.editingAnimation && n.keyFrameHandler
                  , A = n.parent;
                A instanceof d.default && (D = A.activeChild === n),
                r && (b = false);
                var j = !_ && (b || I) && !!l && !(n instanceof f.default)
                  , L = b || C
                  , R = !r && (b || P)
                  , F = E
                  , B = this.toggleVisibility
                  , V = this.toggleLocked
                  , N = [u.default.ItemContent];
                switch (k ? N.push(u.default.Selected) : R ? N.push(u.default.Hovered) : I && N.push(u.default.Hidden),
                i) {
                case m.default.DropTargetParent:
                    N.push(u.default.DropTargetParent);
                    break;
                case m.default.DropTarget:
                    N.push(u.default.DropTarget);
                    break;
                case m.default.DropDisabled:
                    N.push(u.default.DropDisabled)
                }
                var z = null;
                if (n instanceof s.default) {
                    var W = n.asset;
                    W && W.imgSrc && (z = "url('" + W.imgSrc + "')")
                }
                return o.default.createElement("div", {
                    className: u.default.ItemContentWrapper,
                    onClick: this.mouseDown,
                    onMouseEnter: this.mouseEnter,
                    onMouseLeave: this.mouseLeave
                }, A instanceof d.default ? o.default.createElement("div", {
                    style: {
                        display: "inline-block"
                    },
                    className: u.default.Toggle,
                    onMouseEnter: this.enterToggleActive,
                    onClick: this.toggleActive
                }, o.default.createElement("div", {
                    style: {
                        opacity: D ? 1 : 0
                    }
                })) : null, o.default.createElement("div", {
                    className: N.join(" ")
                }, o.default.createElement("div", {
                    className: u.default.TreeIcon + (z ? " " + u.default.TreeIconBG : ""),
                    style: {
                        backgroundImage: z || null
                    }
                }, z ? null : o.default.createElement("svg", {
                    className: w,
                    style: {
                        pointerEvents: "none"
                    }
                }, o.default.createElement("use", {
                    xlinkHref: S
                }))), o.default.createElement(v.default, {
                    ref: this.setEditableName,
                    item: n
                }), L && F ? o.default.createElement("svg", {
                    className: u.default.HierarchyLockBtn + (I ? " " + u.default.HierarchyLockBtnHidden : ""),
                    onClick: V
                }, o.default.createElement("use", {
                    xlinkHref: g.default.make("/images/symbol-defs.svg#" + (C ? "icon-lock-layer" : "icon-unlock-layer"))
                })) : null, j ? o.default.createElement("svg", {
                    className: u.default.HierarchyHideBtn + (I ? " " + u.default.HierarchyHideBtnHidden : ""),
                    onClick: B
                }, o.default.createElement("use", {
                    xlinkHref: I ? g.default.make("/images/symbol-defs.svg#icon-eye-crossed") : g.default.make("/images/symbol-defs.svg#icon-eye")
                })) : null), M ? o.default.createElement("div", {
                    className: 0 == M.state ? c.default.HieararchyKey : 1 == M.state ? c.default.HieararchyKeyChanged : c.default.HieararchyKeyed,
                    onClick: this.setKeyFrame
                }) : null, null, null)
            }
        }]),
        t
    }(o.default.Component)).prototype, "doForceUpdate", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "doForceUpdate"), i.prototype),
    b(i.prototype, "debounceForcedUpdate", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "debounceForcedUpdate"), i.prototype),
    b(i.prototype, "setKeyFrame", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "setKeyFrame"), i.prototype),
    b(i.prototype, "mouseEnter", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseEnter"), i.prototype),
    b(i.prototype, "mouseLeave", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseLeave"), i.prototype),
    b(i.prototype, "mouseDown", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseDown"), i.prototype),
    b(i.prototype, "toggleVisibility", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleVisibility"), i.prototype),
    b(i.prototype, "toggleLocked", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleLocked"), i.prototype),
    b(i.prototype, "toggleActive", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleActive"), i.prototype),
    b(i.prototype, "setEditableName", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "setEditableName"), i.prototype),
    i);
    t.default = w,
    w.contextTypes = {
        nima: a.default.object
    }
}
, function(e, t, n) {
    (t = e.exports = n(7)(false)).push([e.i, '.source-client-source-editors-nima-ui-Components-Hierarchy-HierarchyKey-HieararchyKey-150oq, .source-client-source-editors-nima-ui-Components-Hierarchy-HierarchyKey-HieararchyKeyChanged-2RTRh, .source-client-source-editors-nima-ui-Components-Hierarchy-HierarchyKey-HieararchyKeyed-1YdVx {\n  position: relative;\n  height: 100%;\n  width: 20px; }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-HierarchyKey-HieararchyKey-150oq:hover:after {\n  border: 1px solid rgba(0, 0, 0, 0.5); }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-HierarchyKey-HieararchyKey-150oq:after, .source-client-source-editors-nima-ui-Components-Hierarchy-HierarchyKey-HieararchyKeyChanged-2RTRh:after, .source-client-source-editors-nima-ui-Components-Hierarchy-HierarchyKey-HieararchyKeyed-1YdVx:after {\n  content: "";\n  width: 7px;\n  height: 7px;\n  position: absolute;\n  border: 1px solid rgba(0, 0, 0, 0.3);\n  right: 7px;\n  top: 50%;\n  transform: rotate(45deg) translate(-50%, -50%);\n  box-sizing: border-box;\n  transition: background 0.1s ease-in-out, border 0.1s ease-out; }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-HierarchyKey-HieararchyKeyed-1YdVx:after {\n  background: #57a5e0;\n  border: 1px solid rgba(0, 0, 0, 0); }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-HierarchyKey-HieararchyKeyChanged-2RTRh:after {\n  background: rgba(87, 165, 224, 0);\n  border: 1px solid #ec3e4a; }\n', ""]),
    t.locals = {
        HieararchyKey: "source-client-source-editors-nima-ui-Components-Hierarchy-HierarchyKey-HieararchyKey-150oq",
        HieararchyKeyChanged: "source-client-source-editors-nima-ui-Components-Hierarchy-HierarchyKey-HieararchyKeyChanged-2RTRh",
        HieararchyKeyed: "source-client-source-editors-nima-ui-Components-Hierarchy-HierarchyKey-HieararchyKeyed-1YdVx"
    }
}
, function(e, t, n) {
    (t = e.exports = n(7)(false)).push([e.i, ".source-client-source-editors-nima-ui-Components-Hierarchy-Pane-Pane-3tJVV {\n  position: relative;\n  overflow: hidden; }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-Pane-PaneButtonsWrapper-3AIED {\n  height: 65px;\n  display: flex;\n  align-items: center;\n  padding-left: 15px; }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-Pane-PaneButton-2HaVc {\n  margin-left: 5px;\n  background: rgba(0, 0, 0, 0.04);\n  height: 25px;\n  display: flex;\n  align-items: center;\n  padding: 0 10px;\n  border-radius: 5px;\n  text-transform: uppercase;\n  font-weight: 500;\n  color: #888;\n  font-size: 10px;\n  transition: background .1s ease-in-out, color .1s ease-in-out; }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-Pane-PaneButton-2HaVc svg {\n  fill: #888;\n  transition: fill .1s ease-in-out; }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-Pane-PaneButton-2HaVc:hover {\n  color: #333;\n  background: rgba(0, 0, 0, 0.07); }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-Pane-PaneButton-2HaVc:hover svg {\n  fill: #333; }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-Pane-PaneButton-2HaVc:active {\n  background: rgba(0, 0, 0, 0.1); }\n", ""]),
    t.locals = {
        Pane: "source-client-source-editors-nima-ui-Components-Hierarchy-Pane-Pane-3tJVV",
        PaneButtonsWrapper: "source-client-source-editors-nima-ui-Components-Hierarchy-Pane-PaneButtonsWrapper-3AIED",
        PaneButton: "source-client-source-editors-nima-ui-Components-Hierarchy-Pane-PaneButton-2HaVc"
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = f(n(0)), a = f(n(1)), s = f(n(4)), l = f(n(386)), u = f(n(9)), c = f(n(344)), d = f(n(170)), h = f(n(1124));
    function f(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function p(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var y = (p((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {},
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "componentWillMount",
            value: function() {
                this.setData(this.props.data)
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.data != this.props.data && this.setData(e.data)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setData(null)
            }
        }, {
            key: "onChildrenChanged",
            value: function() {
                this.isFiltering ? this.updateFilter(true) : this.forceUpdate()
            }
        }, {
            key: "setData",
            value: function(e) {
                if (this.data !== e) {
                    var t = this.data;
                    t && t.removeEventListener("childrenChanged", this.onChildrenChanged),
                    this.data = e,
                    e && e.addEventListener("childrenChanged", this.onChildrenChanged)
                }
            }
        }, {
            key: "renderHierarchyItem",
            value: function(e, t, n) {
                return o.default.createElement(h.default, {
                    isDragging: t,
                    dropTargetState: n,
                    item: e,
                    onSelected: this.onDrawOrderSelection
                })
            }
        }, {
            key: "spaceHierarchyItem",
            value: function(e) {
                return e.parent instanceof c.default ? 2 : 1
            }
        }, {
            key: "updateFilter",
            value: function(e) {
                if (this.isFiltering = e,
                this.tree) {
                    var t = e ? this.fullData.filter((function(e) {
                        return e.filterState !== l.default.Hidden
                    }
                    )) : null;
                    this.setState({
                        overrideData: t
                    })
                }
            }
        }, {
            key: "getChildren",
            value: function(e) {
                return null
            }
        }, {
            key: "setTree",
            value: function(e) {
                this.tree = e
            }
        }, {
            key: "onDrawOrderSelection",
            value: function(e, t) {
                var n = this.context.nima.stage;
                if (t.stageItem && t.parent)
                    if (t.stageItem.isSelected && u.default.isMultiSelect(e))
                        n.deSelectItem(t.stageItem, this);
                    else if (e.shiftKey) {
                        if (0 === n.selectedItems.length)
                            n.selectItem(t.stageItem, false, false, this);
                        else {
                            var i = this.tree.getRangeItems(n.selectedItems.map((function(e) {
                                return e.node
                            }
                            )), t);
                            null !== i && (i = i.map((function(e) {
                                return e.stageItem
                            }
                            )),
                            n.clearSelections(true, true),
                            n.selectItems(i, true, false, this))
                        }
                    } else {
                        u.default.isMultiSelect(e) || n.clearSelections(true, true),
                        n.selectItem(t.stageItem, true, false, this)
                    }
            }
        }, {
            key: "makeDragGhost",
            value: function(e) {
                var t = this.dragImage = document.createElement("div");
                return t.className = "HierarchyDragGhost",
                t.innerText = e.name,
                t
            }
        }, {
            key: "allowDrag",
            value: function(e) {
                return true
            }
        }, {
            key: "allowDrop",
            value: function(e, t, n) {
                return !t
            }
        }, {
            key: "drop",
            value: function(e, t, n) {
                var i = this.displayData;
                if (i) {
                    var r = 0
                      , o = this.fullData.map((function(e) {
                        return {
                            image: e,
                            order: ++r
                        }
                    }
                    ))
                      , a = this.fullData.indexOf(e);
                    if (n < i.length) {
                        var s = i[n]
                          , l = o.find((function(e) {
                            return e.image === s
                        }
                        ));
                        l && (o[a].order = l.order - .5)
                    } else
                        o[a].order = Number.MAX_VALUE;
                    o.sort((function(e, t) {
                        return t.order - e.order
                    }
                    ));
                    for (var u = 0; u < o.length; u++) {
                        o[u].image.hierarchySortOrder = u + 1
                    }
                    this.context.nima.captureJournalEntry()
                }
            }
        }, {
            key: "show",
            value: function(e) {
                this.tree.show(e)
            }
        }, {
            key: "render",
            value: function() {
                var e = this.displayData;
                return o.default.createElement(d.default, {
                    ref: this.setTree,
                    makeDragGhost: this.makeDragGhost,
                    allowDrag: this.allowDrag,
                    drop: this.drop,
                    allowDrop: this.allowDrop,
                    data: e,
                    showFirstLine: false,
                    hideFirstHorizontalLine: true,
                    height: this.props.height,
                    iconWidth: 15,
                    iconHeight: 15,
                    rowHeight: 35,
                    getChildren: this.getChildren,
                    renderItem: this.renderHierarchyItem,
                    spaceItem: this.spaceHierarchyItem
                })
            }
        }, {
            key: "displayData",
            get: function() {
                return this.state.overrideData || this.fullData
            }
        }, {
            key: "fullData",
            get: function() {
                return this.props.data && this.props.data.images.slice(0).reverse()
            }
        }]),
        t
    }(o.default.Component)).prototype, "onChildrenChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onChildrenChanged"), i.prototype),
    p(i.prototype, "setData", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setData"), i.prototype),
    p(i.prototype, "renderHierarchyItem", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "renderHierarchyItem"), i.prototype),
    p(i.prototype, "spaceHierarchyItem", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "spaceHierarchyItem"), i.prototype),
    p(i.prototype, "getChildren", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "getChildren"), i.prototype),
    p(i.prototype, "setTree", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setTree"), i.prototype),
    p(i.prototype, "onDrawOrderSelection", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onDrawOrderSelection"), i.prototype),
    p(i.prototype, "makeDragGhost", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "makeDragGhost"), i.prototype),
    p(i.prototype, "allowDrag", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "allowDrag"), i.prototype),
    p(i.prototype, "allowDrop", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "allowDrop"), i.prototype),
    p(i.prototype, "drop", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "drop"), i.prototype),
    i);
    t.default = y,
    y.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = v(n(0)), a = v(n(4)), s = v(n(267)), l = v(n(1)), u = v(n(20)), c = v(n(344)), d = v(n(358)), h = v(n(13)), f = v(n(386)), p = v(n(170)), y = v(n(518)), m = v(n(3));
    function v(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function g(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var _ = m.default.make("/images/symbol-defs.svg#icon-drag-order")
      , b = (g((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                editing: false,
                hover: false
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "doForceUpdate",
            value: function() {
                this.forceUpdate()
            }
        }, {
            key: "debounceForcedUpdate",
            value: function() {
                (0,
                h.default)(this.doForceUpdate)
            }
        }, {
            key: "setEditableName",
            value: function(e) {
                this.editableName = e
            }
        }, {
            key: "setItem",
            value: function(e) {
                var t = this.item;
                t !== e && (t && (t.removeEventListener("visibilityChange", this.debounceForcedUpdate),
                t.removeEventListener("renderCollapseChange", this.debounceForcedUpdate),
                t.visibilityItem && (t.visibilityItem.removeEventListener("hoverChange", this.debounceForcedUpdate),
                t.visibilityItem.removeEventListener("lockedChange", this.debounceForcedUpdate)),
                t.stageItem ? t.stageItem.removeEventListener("selectedChange", this.debounceForcedUpdate) : t.removeEventListener("selectedChange", this.debounceForcedUpdate)),
                this.item = e,
                e && (e.addEventListener("visibilityChange", this.debounceForcedUpdate),
                e.addEventListener("renderCollapseChange", this.debounceForcedUpdate),
                e.visibilityItem && (e.visibilityItem.addEventListener("hoverChange", this.debounceForcedUpdate),
                e.visibilityItem.addEventListener("lockedChange", this.debounceForcedUpdate)),
                e.stageItem ? e.stageItem.addEventListener("selectedChange", this.debounceForcedUpdate) : e.addEventListener("selectedChange", this.debounceForcedUpdate)))
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.item != this.props.item && this.setItem(e.item)
            }
        }, {
            key: "componentWillMount",
            value: function() {
                this.setItem(this.props.item)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                h.default.cancel(this.doForceUpdate),
                this.setItem(null)
            }
        }, {
            key: "mouseEnter",
            value: function() {
                this.setState({
                    hover: true
                });
                var e = this.item;
                e && e.stageItem && e.stageItem.stage && (this.context.nima.stage.hoverItem = e.stageItem)
            }
        }, {
            key: "mouseLeave",
            value: function() {
                this.setState({
                    hover: false
                });
                var e = this.item;
                e && e.stageItem && this.context.nima.stage.hoverItem === e.stageItem && (this.context.nima.stage.hoverItem = null)
            }
        }, {
            key: "mouseDown",
            value: function(e) {
                if (e.preventDefault(),
                e.stopPropagation(),
                this.item) {
                    var t = Date.now();
                    if (this.clickTime) {
                        var n = t - this.clickTime;
                        if (delete this.clickTime,
                        n < 200 && this.editableName.startEdit())
                            return
                    }
                    this.clickTime = t,
                    this.props.onSelected && this.props.onSelected(e, this.item)
                }
            }
        }, {
            key: "toggleVisibility",
            value: function(e) {
                e.stopPropagation();
                var t = this.item;
                if (t && t.visibilityItem) {
                    var n = this.context.nima;
                    if (e.altKey)
                        if (n.lastAltVisibility && n.lastAltVisibility.item === t && n.lastAltVisibility.meta === e.metaKey)
                            for (var i = n.lastAltVisibility.selection, r = 0; r < i.length; r++) {
                                var o = i[r];
                                o.isVisible = !o.isVisible
                            }
                        else {
                            var a = []
                              , s = [];
                            t.isVisible || (s.push(t),
                            t.isVisible = true),
                            e.metaKey || !t.all ? a.push(t) : t.all((function(e) {
                                a.push(e)
                            }
                            )),
                            n.actor.root.all((function(e) {
                                -1 === a.indexOf(e) && e.isVisible && (s.push(e),
                                e.isVisible = false)
                            }
                            )),
                            n.lastAltVisibility = {
                                selection: s,
                                item: t,
                                meta: e.metaKey
                            }
                        }
                    else {
                        if (e.metaKey || !t.all)
                            t.isVisible = !t.isVisible;
                        else {
                            var l = !t.isVisible;
                            t.all((function(e) {
                                e.isVisible = l
                            }
                            ))
                        }
                        delete n.lastAltVisibility
                    }
                    t.stageItem && t.stageItem.stage && t.stageItem.stage.redraw()
                }
            }
        }, {
            key: "toggleLocked",
            value: function(e) {
                e.stopPropagation();
                var t = this.item;
                if (t && t.visibilityItem) {
                    if (e.metaKey || !t.all)
                        t.isLocked = !t.isLocked;
                    else {
                        var n = !t.isLocked;
                        t.all((function(e) {
                            e.isLocked = n
                        }
                        ))
                    }
                    t.stageItem && t.stageItem.stage && t.stageItem.stage.redraw()
                }
            }
        }, {
            key: "toggleActive",
            value: function(e) {
                e.stopPropagation();
                var t = this.item;
                t && t.parent && (t.parent.activeChild = t,
                t.stageItem && t.stageItem.stage && t.stageItem.stage.redraw())
            }
        }, {
            key: "render",
            value: function() {
                var e = this.context.nima.stage
                  , t = this.props
                  , n = t.item
                  , i = t.dropTargetState
                  , r = t.isDragging
                  , a = n.stageItem
                  , l = n.visibilityItem
                  , h = this.state
                  , v = h.editing
                  , g = h.hover
                  , b = !r && a ? a.isSelected : n.isSelected
                  , w = l && e && e.hoverItem === l || false
                  , O = n.isVisible
                  , S = l && l.isLocked || false
                  , k = n.filterState
                  , P = !O || 0 != (k & (f.default.SemiHidden | f.default.Collapsed))
                  , E = n.parent;
                E instanceof c.default && E.activeChild,
                r && (g = false);
                var T = !v && (g || P) && !!l && !(n instanceof d.default)
                  , C = g || S
                  , x = !r && (g || w)
                  , I = this.toggleVisibility
                  , D = this.toggleLocked
                  , M = [u.default.ItemContent];
                switch (b ? M.push(u.default.Selected) : x ? M.push(u.default.Hovered) : P && M.push(u.default.Hidden),
                i) {
                case p.default.DropTargetParent:
                    M.push(u.default.DropTargetParent);
                    break;
                case p.default.DropTarget:
                    M.push(u.default.DropTarget);
                    break;
                case p.default.DropDisabled:
                    M.push(u.default.DropDisabled)
                }
                var A = null;
                if (n instanceof s.default) {
                    var j = n.asset;
                    j && j.imgSrc && (A = "url('" + j.imgSrc + "')")
                }
                return o.default.createElement("div", {
                    className: u.default.ItemContentWrapper,
                    onClick: this.mouseDown,
                    onMouseEnter: this.mouseEnter,
                    onMouseLeave: this.mouseLeave
                }, o.default.createElement("svg", {
                    className: "HierarchyDragOrderIcon",
                    style: {
                        pointerEvents: "none"
                    }
                }, o.default.createElement("use", {
                    xlinkHref: _
                })), o.default.createElement("div", {
                    className: M.join(" ")
                }, o.default.createElement("div", {
                    className: u.default.TreeIcon + (A ? " " + u.default.TreeIconBG : ""),
                    style: {
                        backgroundImage: A || null
                    }
                }, A ? null : o.default.createElement("svg", {
                    className: "HierarchyImageIcon",
                    style: {
                        pointerEvents: "none"
                    }
                }, o.default.createElement("use", {
                    xlinkHref: m.default.make("/images/symbol-defs.svg#icon-picture")
                }))), o.default.createElement(y.default, {
                    ref: this.setEditableName,
                    item: n
                })), C ? o.default.createElement("svg", {
                    className: u.default.HierarchyLockBtn + (P ? " " + u.default.HierarchyLockBtnHidden : ""),
                    onMouseDown: D
                }, o.default.createElement("use", {
                    xlinkHref: m.default.make("/images/symbol-defs.svg#" + (S ? "icon-lock-layer" : "icon-unlock-layer"))
                })) : null, T ? o.default.createElement("svg", {
                    className: u.default.HierarchyHideBtn + (P ? " " + u.default.HierarchyHideBtnHidden : ""),
                    onMouseDown: I
                }, o.default.createElement("use", {
                    xlinkHref: P ? m.default.make("/images/symbol-defs.svg#icon-eye-crossed") : m.default.make("/images/symbol-defs.svg#icon-eye")
                })) : null, null, null)
            }
        }]),
        t
    }(o.default.Component)).prototype, "doForceUpdate", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "doForceUpdate"), i.prototype),
    g(i.prototype, "debounceForcedUpdate", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "debounceForcedUpdate"), i.prototype),
    g(i.prototype, "setEditableName", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "setEditableName"), i.prototype),
    g(i.prototype, "mouseEnter", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseEnter"), i.prototype),
    g(i.prototype, "mouseLeave", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseLeave"), i.prototype),
    g(i.prototype, "mouseDown", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseDown"), i.prototype),
    g(i.prototype, "toggleVisibility", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleVisibility"), i.prototype),
    g(i.prototype, "toggleLocked", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleLocked"), i.prototype),
    g(i.prototype, "toggleActive", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleActive"), i.prototype),
    i);
    t.default = b,
    b.contextTypes = {
        nima: a.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = w(n(0)), a = w(n(1)), s = w(n(4)), l = w(n(386)), u = w(n(9)), c = w(n(344)), d = w(n(1126)), h = w(n(382)), f = w(n(519)), p = w(n(445)), y = w(n(717)), m = n(2), v = w(n(170)), g = w(n(1127)), _ = w(n(602)), b = w(n(3));
    function w(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function O(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var S = (O((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {},
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "componentWillMount",
            value: function() {
                this.setData(this.props.data)
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.data != this.props.data && this.setData(e.data)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setData(null)
            }
        }, {
            key: "onChildrenChanged",
            value: function() {
                this.forceUpdate()
            }
        }, {
            key: "setData",
            value: function(e) {
                if (this.data !== e) {
                    var t = this.data;
                    t && t.removeEventListener("childrenChanged", this.onChildrenChanged),
                    this.data = e,
                    e && e.addEventListener("childrenChanged", this.onChildrenChanged)
                }
            }
        }, {
            key: "renderHierarchyItem",
            value: function(e, t, n) {
                return o.default.createElement(g.default, {
                    isDragging: t,
                    dropTargetState: n,
                    item: e,
                    onSelected: this.onAssetSelection
                })
            }
        }, {
            key: "spaceHierarchyItem",
            value: function(e) {
                return e.parent instanceof c.default ? 2 : 1
            }
        }, {
            key: "updateFilter",
            value: function(e) {
                this.tree && (this.tree.overrideExpansion(e ? function(e) {
                    return 0 != (e.filterState & l.default.Expanded)
                }
                : null),
                this.forceUpdate())
            }
        }, {
            key: "getChildren",
            value: function(e) {
                if (!e.hierarchyChildren)
                    return null;
                var t = []
                  , n = true
                  , i = false
                  , r = void 0;
                try {
                    for (var o, a = e.hierarchyChildren[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                        var s = o.value;
                        s.hideInHierarchy || s.filterState === l.default.Hidden || t.push(s)
                    }
                } catch (e) {
                    i = true,
                    r = e
                } finally {
                    try {
                        !n && a.return && a.return()
                    } finally {
                        if (i)
                            throw r
                    }
                }
                return t
            }
        }, {
            key: "setTree",
            value: function(e) {
                this.tree = e
            }
        }, {
            key: "onAssetSelection",
            value: function(e, t) {
                var n = this.context.nima;
                if (t.isSelected && u.default.isMultiSelect(e))
                    n.deselectItem(t, false);
                else if (e.shiftKey) {
                    var i = n.selectedItems;
                    if (0 === i.length)
                        n.selectItem(t, false, this);
                    else {
                        var r = this.tree.getRangeItems(i, t);
                        null !== r && (n.clearSelections(true),
                        n.selectItems(r, true, this))
                    }
                } else {
                    u.default.isMultiSelect(e) || n.clearSelections(true),
                    n.selectItem(t, true, this)
                }
            }
        }, {
            key: "makeDragGhost",
            value: function(e) {
                var t = this.dragImage = document.createElement("div");
                t.className = "HierarchyDragGhost",
                t.innerText = e.name;
                var n = this.context.nima;
                if (e instanceof f.default) {
                    if (e.hierarchyChildren.length) {
                        for (var i = new d.default(n.stage,n.actor,this.tree), r = 0; r < e.hierarchyChildren.length; r++) {
                            var o = e.hierarchyChildren[r];
                            i.addImage(o, m.vec2.set(m.vec2.create(), o.left, o.top))
                        }
                        i.start(),
                        n.stage.markMouseDown()
                    }
                } else if (e instanceof h.default || e instanceof p.default) {
                    var a = new d.default(n.stage,n.actor,this.tree);
                    a.addImage(e),
                    a.start(),
                    n.stage.markMouseDown()
                }
                return t
            }
        }, {
            key: "destroyDragGhost",
            value: function(e) {}
        }, {
            key: "allowDrag",
            value: function(e) {
                return true
            }
        }, {
            key: "allowDrop",
            value: function(e, t, n) {
                return null === t || t instanceof y.default
            }
        }, {
            key: "getActualIndex",
            value: function(e, t, n) {
                return n
            }
        }, {
            key: "drop",
            value: function(e, t, n) {
                t || (t = this.props.actor.assetFolder),
                e.parent && e.parent.remove(e),
                t.add(e, false, this.getActualIndex(e, t, n))
            }
        }, {
            key: "show",
            value: function(e) {
                this.tree.show(e)
            }
        }, {
            key: "mouseEnter",
            value: function(e) {
                var t = this.context.nima.stage.currentOperation;
                if (t) {
                    var n = t.meta;
                    this.tree.handoffDrag(n),
                    t.meta = this.tree
                }
            }
        }, {
            key: "setFileDialog",
            value: function(e) {
                this.fileDialog = e
            }
        }, {
            key: "onAssetFilesSelected",
            value: function(e) {
                var t = e.target.files;
                t && t.length && this.context.nima.addAssetsFromFiles(t)
            }
        }, {
            key: "addAsset",
            value: function() {
                this.fileDialog.dispatchEvent(new MouseEvent("click"))
            }
        }, {
            key: "addFolder",
            value: function() {
                var e = this.context.nima.actor
                  , t = e.makeAsset("New Folder", y.default);
                t.assignID(),
                e.addAsset(t),
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "render",
            value: function() {
                var e = this.getChildren
                  , t = this.props.data;
                return t && (t = e(t)),
                o.default.createElement("div", {
                    className: _.default.Pane
                }, o.default.createElement(v.default, {
                    ref: this.setTree,
                    onMouseEnter: this.mouseEnter,
                    makeDragGhost: this.makeDragGhost,
                    allowDrag: this.allowDrag,
                    drop: this.drop,
                    allowDrop: this.allowDrop,
                    data: t,
                    showFirstLine: false,
                    hideFirstHorizontalLine: true,
                    height: this.props.height - 65,
                    iconWidth: 40,
                    iconHeight: 30,
                    rowHeight: 50,
                    getChildren: e,
                    renderItem: this.renderHierarchyItem,
                    spaceItem: this.spaceHierarchyItem
                }), o.default.createElement("div", {
                    className: _.default.PaneButtonsWrapper
                }, o.default.createElement("div", {
                    className: _.default.PaneButton,
                    onClick: this.addAsset
                }, "Import"), o.default.createElement("div", {
                    className: _.default.PaneButton,
                    onClick: this.addFolder
                }, o.default.createElement("svg", {
                    className: "icon-folder-create"
                }, o.default.createElement("use", {
                    xlinkHref: b.default.make("/images/symbol-defs.svg#icon-folder-create")
                })))), t && 0 === t.length ? o.default.createElement("div", {
                    className: "Tip"
                }, "You haven't imported any assets yet. Drag and drop to import images and PSDs.") : null, o.default.createElement("input", {
                    ref: this.setFileDialog,
                    type: "file",
                    style: {
                        display: "none"
                    },
                    multiple: true,
                    onChange: this.onAssetFilesSelected
                }))
            }
        }]),
        t
    }(o.default.Component)).prototype, "onChildrenChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onChildrenChanged"), i.prototype),
    O(i.prototype, "setData", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setData"), i.prototype),
    O(i.prototype, "renderHierarchyItem", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "renderHierarchyItem"), i.prototype),
    O(i.prototype, "spaceHierarchyItem", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "spaceHierarchyItem"), i.prototype),
    O(i.prototype, "getChildren", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "getChildren"), i.prototype),
    O(i.prototype, "setTree", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setTree"), i.prototype),
    O(i.prototype, "onAssetSelection", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onAssetSelection"), i.prototype),
    O(i.prototype, "makeDragGhost", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "makeDragGhost"), i.prototype),
    O(i.prototype, "destroyDragGhost", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "destroyDragGhost"), i.prototype),
    O(i.prototype, "allowDrag", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "allowDrag"), i.prototype),
    O(i.prototype, "allowDrop", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "allowDrop"), i.prototype),
    O(i.prototype, "drop", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "drop"), i.prototype),
    O(i.prototype, "mouseEnter", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseEnter"), i.prototype),
    O(i.prototype, "setFileDialog", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setFileDialog"), i.prototype),
    O(i.prototype, "onAssetFilesSelected", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onAssetFilesSelected"), i.prototype),
    O(i.prototype, "addAsset", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "addAsset"), i.prototype),
    O(i.prototype, "addFolder", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "addFolder"), i.prototype),
    i);
    t.default = S,
    S.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = l(n(314))
      , o = l(n(267))
      , a = l(n(603))
      , s = n(2);
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var u = function(e) {
        function t(e, n, i) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var r = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e, n));
            return r._Meta = i,
            r._Images = [],
            r._Target = null,
            r._IsOverStage = false,
            r._Stage.clearSelections(),
            r._Stage.isSelectionDisabled = true,
            r
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "addImage",
            value: function(e, t) {
                var n = this._Actor.addNodeType(o.default);
                n && (n.width = e.width,
                n.height = e.height,
                n.opacity = .5,
                n.setAsset(e),
                n.hideInHierarchy = true,
                n.name = e.name,
                this._Images.push({
                    image: n,
                    translationOffset: t || s.vec2.create()
                }))
            }
        }, {
            key: "end",
            value: function() {
                for (var e = [], n = 0; n < this._Images.length; n++) {
                    var i = this._Images[n].image;
                    i.hideInHierarchy = false,
                    e.push(i.stageItem),
                    i.parent && (i.parent.notifyChildrenChanged(),
                    i.dispatch("drawOrderChange"))
                }
                var r = this._Stage;
                r.isSelectionDisabled = false,
                e.length && r.selectItems(e, false),
                function e(t, n, i) {
                    null === t && (t = Function.prototype);
                    var r = Object.getOwnPropertyDescriptor(t, n);
                    if (void 0 === r) {
                        var o = Object.getPrototypeOf(t);
                        return null === o ? void 0 : e(o, n, i)
                    }
                    if ("value"in r)
                        return r.value;
                    var a = r.get;
                    return void 0 !== a ? a.call(i) : void 0
                }(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "end", this).call(this),
                a.default.remove(this)
            }
        }, {
            key: "getTarget",
            value: function() {
                return this._Target
            }
        }, {
            key: "target",
            value: function(e, t) {
                this._Target = e;
                for (var n = 0; n < this._Images.length; n++) {
                    var i = this._Images[n]
                      , r = i.image
                      , o = i.translationOffset;
                    r.parent && r.parent.remove(r, true),
                    e ? (r.translation = o,
                    e.add(r, true, t),
                    r.opacity = 1,
                    a.default.set(this, "copy", 10)) : (this._Actor.root.add(r, true),
                    r.opacity = .5)
                }
                this.updateCursor()
            }
        }, {
            key: "cancel",
            value: function() {
                for (var e = 0; e < this._Images.length; e++) {
                    var t = this._Images[e].image;
                    t.parent && t.parent.remove(t),
                    t.stageItem.removeFromStage(),
                    t.setAsset(null)
                }
                this._Images.length = 0
            }
        }, {
            key: "mouseMove",
            value: function(e) {
                for (var t = 0; t < this._Images.length; t++) {
                    var n = this._Images[t]
                      , i = n.image;
                    i.stage || i.stageItem.addToStage(this._Stage),
                    this._Target || (i.translation = s.vec2.add(s.vec2.create(), e, n.translationOffset))
                }
                this.updateCursor()
            }
        }, {
            key: "updateCursor",
            value: function() {
                a.default.set(this, this._IsOverStage || this._Target ? "copy" : "no-drop", 10)
            }
        }, {
            key: "mouseUp",
            value: function() {
                this._IsOverStage || this._Target || this.cancel(),
                this.end()
            }
        }, {
            key: "mouseEnterStage",
            value: function() {
                for (var e = 0; e < this._Images.length; e++) {
                    this._Images[e].image.opacity = 1
                }
                this._IsOverStage = true,
                this.updateCursor()
            }
        }, {
            key: "mouseLeaveStage",
            value: function() {
                for (var e = 0; e < this._Images.length; e++) {
                    this._Images[e].image.opacity = .5
                }
                this._IsOverStage = false,
                this.updateCursor()
            }
        }, {
            key: "meta",
            get: function() {
                return this._Meta
            },
            set: function(e) {
                this._Meta = e
            }
        }]),
        t
    }(r.default);
    t.default = u
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = g(n(0)), a = g(n(4)), s = g(n(519)), l = g(n(1)), u = g(n(20)), c = g(n(344)), d = g(n(208)), h = g(n(13)), f = g(n(386)), p = g(n(170)), y = g(n(382)), m = g(n(518)), v = g(n(3));
    function g(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function _(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var b = (_((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                editing: false,
                hover: false
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "doForceUpdate",
            value: function() {
                this.forceUpdate()
            }
        }, {
            key: "debounceForcedUpdate",
            value: function() {
                (0,
                h.default)(this.doForceUpdate)
            }
        }, {
            key: "setItem",
            value: function(e) {
                var t = this.item;
                t !== e && (t && t.removeEventListener("selectedChange", this.debounceForcedUpdate),
                this.item = e,
                e && e.addEventListener("selectedChange", this.debounceForcedUpdate))
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.item != this.props.item && this.setItem(e.item)
            }
        }, {
            key: "componentWillMount",
            value: function() {
                this.setItem(this.props.item)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                h.default.cancel(this.doForceUpdate),
                this.setItem(null)
            }
        }, {
            key: "mouseEnter",
            value: function() {
                this.setState({
                    hover: true
                });
                var e = this.item;
                e && e.stageItem && e.stageItem.stage && (this.context.nima.stage.hoverItem = e.stageItem)
            }
        }, {
            key: "mouseLeave",
            value: function() {
                this.setState({
                    hover: false
                });
                var e = this.item;
                e && e.stageItem && this.context.nima.stage.hoverItem === e.stageItem && (this.context.nima.stage.hoverItem = null)
            }
        }, {
            key: "mouseDown",
            value: function(e) {
                if (e.preventDefault(),
                e.stopPropagation(),
                this.item) {
                    var t = Date.now();
                    if (this.clickTime) {
                        var n = t - this.clickTime;
                        if (delete this.clickTime,
                        n < 200 && this.editableName.startEdit())
                            return
                    }
                    this.clickTime = t,
                    this.props.onSelected && this.props.onSelected(e, this.item)
                }
            }
        }, {
            key: "setEditableName",
            value: function(e) {
                this.editableName = e
            }
        }, {
            key: "rightClick",
            value: function(e) {
                var t = this.props.item;
                if (t) {
                    var n = this.context.nima;
                    if (t instanceof y.default) {
                        var i = n.certainSelections((function(e) {
                            return e.constructor === y.default
                        }
                        ));
                        i.length > 1 && n.showContextMenu({
                            x: e.clientX,
                            y: e.clientY,
                            items: [{
                                name: "Convert to PSD",
                                select: function() {
                                    var e = document.createElement("input");
                                    e.addEventListener("change", (function(e) {
                                        var t = e.target.files && e.target.files.length && e.target.files[0];
                                        t && n.actor.makeAssets([{
                                            items: [t]
                                        }]).then((function(e) {
                                            if (e && e.assets && e.assets.length) {
                                                var t = e.assets[0];
                                                if (t.constructor === s.default) {
                                                    var r = []
                                                      , o = true
                                                      , a = false
                                                      , l = void 0;
                                                    try {
                                                        for (var u, c = t.children[Symbol.iterator](); !(o = (u = c.next()).done); o = true) {
                                                            var d = u.value
                                                              , h = true
                                                              , f = false
                                                              , p = void 0;
                                                            try {
                                                                for (var y, m = i[Symbol.iterator](); !(h = (y = m.next()).done); h = true) {
                                                                    var v = y.value;
                                                                    if (d.name === v.name) {
                                                                        r.push(v),
                                                                        v.replaceWith(d, n.actor);
                                                                        break
                                                                    }
                                                                }
                                                            } catch (e) {
                                                                f = true,
                                                                p = e
                                                            } finally {
                                                                try {
                                                                    !h && m.return && m.return()
                                                                } finally {
                                                                    if (f)
                                                                        throw p
                                                                }
                                                            }
                                                        }
                                                    } catch (e) {
                                                        a = true,
                                                        l = e
                                                    } finally {
                                                        try {
                                                            !o && c.return && c.return()
                                                        } finally {
                                                            if (a)
                                                                throw l
                                                        }
                                                    }
                                                    r.length && (n.actor.removeAssets(r),
                                                    n.actor.addAsset(t),
                                                    n.captureJournalEntry())
                                                }
                                            }
                                        }
                                        ))
                                    }
                                    )),
                                    e.setAttribute("type", "file"),
                                    e.click()
                                }
                            }]
                        })
                    }
                }
            }
        }, {
            key: "render",
            value: function() {
                var e = this.props
                  , t = e.item
                  , n = e.dropTargetState
                  , i = e.isDragging
                  , r = this.state.hover
                  , a = t.uiIcon
                  , l = a ? v.default.make("/images/symbol-defs.svg#" + a) : null
                  , h = !i && t.isSelected
                  , y = !(t instanceof d.default) || t.isVisible
                  , g = t.filterState
                  , _ = !y || 0 != (g & (f.default.SemiHidden | f.default.Collapsed))
                  , b = false
                  , w = t.parent;
                w instanceof c.default && (b = w.activeChild === t),
                i && (r = false);
                var O = !i && r
                  , S = [u.default.ItemContent];
                switch (h ? S.push(u.default.Selected) : O ? S.push(u.default.Hovered) : _ && S.push(u.default.Hidden),
                n) {
                case p.default.DropTargetParent:
                    S.push(u.default.DropTargetParent);
                    break;
                case p.default.DropTarget:
                    S.push(u.default.DropTarget);
                    break;
                case p.default.DropDisabled:
                    S.push(u.default.DropDisabled)
                }
                var k = t.imgSrc ? "url('" + t.imgSrc + "')" : null
                  , P = null;
                switch (t.constructor) {
                case s.default:
                    P = u.default.PsdDecor
                }
                return o.default.createElement("div", {
                    className: u.default.ItemContentWrapper,
                    onClick: this.mouseDown,
                    onMouseEnter: this.mouseEnter,
                    onMouseLeave: this.mouseLeave,
                    onContextMenu: this.rightClick
                }, w instanceof c.default ? o.default.createElement("div", {
                    style: {
                        display: "inline-block"
                    },
                    className: u.default.Toggle,
                    onMouseEnter: this.enterToggleActive,
                    onClick: this.toggleActive
                }, o.default.createElement("div", {
                    style: {
                        opacity: b ? 1 : 0
                    }
                })) : null, o.default.createElement("div", {
                    className: S.join(" ")
                }, o.default.createElement("div", {
                    className: u.default.TreeIcon + (k ? " " + u.default.AssetIconBG : ""),
                    style: {
                        backgroundImage: k || null
                    }
                }, k ? P ? o.default.createElement("div", {
                    className: u.default.ThumbDecor
                }, o.default.createElement("svg", {
                    className: P,
                    style: {
                        pointerEvents: "none"
                    }
                }, o.default.createElement("use", {
                    xlinkHref: l
                }))) : null : o.default.createElement("svg", {
                    className: "HierarchyImageIcon",
                    style: {
                        pointerEvents: "none"
                    }
                }, o.default.createElement("use", {
                    xlinkHref: l
                }))), o.default.createElement(m.default, {
                    ref: this.setEditableName,
                    item: t
                })), null, null)
            }
        }]),
        t
    }(o.default.Component)).prototype, "doForceUpdate", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "doForceUpdate"), i.prototype),
    _(i.prototype, "debounceForcedUpdate", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "debounceForcedUpdate"), i.prototype),
    _(i.prototype, "mouseEnter", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseEnter"), i.prototype),
    _(i.prototype, "mouseLeave", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseLeave"), i.prototype),
    _(i.prototype, "mouseDown", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseDown"), i.prototype),
    _(i.prototype, "setEditableName", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "setEditableName"), i.prototype),
    _(i.prototype, "rightClick", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "rightClick"), i.prototype),
    i);
    t.default = b,
    b.contextTypes = {
        nima: a.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = y(n(0)), a = y(n(1)), s = y(n(4)), l = y(n(386)), u = y(n(9)), c = y(n(170)), d = y(n(1129)), h = y(n(602)), f = y(n(358)), p = y(n(3));
    function y(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function m(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var v = (m((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {},
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "componentWillMount",
            value: function() {
                this.setData(this.props.data)
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.data != this.props.data && this.setData(e.data)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setData(null)
            }
        }, {
            key: "onChildrenChanged",
            value: function() {
                this.forceUpdate()
            }
        }, {
            key: "setData",
            value: function(e) {
                if (this.data !== e) {
                    var t = this.data;
                    t && t.removeEventListener("childrenChanged", this.onChildrenChanged),
                    this.data = e,
                    e && e.addEventListener("childrenChanged", this.onChildrenChanged)
                }
            }
        }, {
            key: "renderItem",
            value: function(e, t, n) {
                return o.default.createElement(d.default, {
                    isDragging: t,
                    dropTargetState: n,
                    item: e,
                    onSelected: this.onAnimationSelected
                })
            }
        }, {
            key: "updateFilter",
            value: function(e) {
                this.tree && (this.tree.overrideExpansion(e ? function(e) {
                    return 0 != (e.filterState & l.default.Expanded)
                }
                : null),
                this.forceUpdate())
            }
        }, {
            key: "getChildren",
            value: function(e) {
                if (!e.hierarchyChildren)
                    return null;
                var t = []
                  , n = true
                  , i = false
                  , r = void 0;
                try {
                    for (var o, a = e.hierarchyChildren[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                        var s = o.value;
                        s.hideInHierarchy || s.filterState === l.default.Hidden || t.push(s)
                    }
                } catch (e) {
                    i = true,
                    r = e
                } finally {
                    try {
                        !n && a.return && a.return()
                    } finally {
                        if (i)
                            throw r
                    }
                }
                return t
            }
        }, {
            key: "setTree",
            value: function(e) {
                this.tree = e
            }
        }, {
            key: "onAnimationSelected",
            value: function(e, t) {
                var n = this.context.nima;
                if (2 !== e.button || !t.isSelected) {
                    var i = this.context.nima.stage;
                    i.selectedItems.length > 0 && i.clearSelections(true),
                    this.context.nima.clearCertainSelections((function(e) {
                        return e.constructor !== f.default
                    }
                    ))
                }
                if (t.isSelected && u.default.isMultiSelect(e))
                    n.deselectItem(t, false);
                else if (e.shiftKey) {
                    var r = n.selectedItems;
                    if (0 === r.length)
                        n.selectItem(t, false, this);
                    else {
                        var o = this.tree.getRangeItems(r, t);
                        null !== o && (n.clearSelections(true),
                        n.selectItems(o, true, this))
                    }
                } else {
                    u.default.isMultiSelect(e) || n.clearSelections(true),
                    n.selectItem(t, true, this)
                }
            }
        }, {
            key: "makeDragGhost",
            value: function(e, t) {
                var n = this.context.nima
                  , i = this.props.data;
                if (i) {
                    e.isSelected || this.onAnimationSelected(t, e);
                    var r = i.hierarchyChildren
                      , o = n.selectedItems
                      , a = this.dragImage = document.createElement("div");
                    a.className = "HierarchyDragGhost";
                    var s = o.filter((function(e) {
                        return e.constructor === f.default
                    }
                    )).sort((function(e, t) {
                        return e.order - t.order
                    }
                    ))
                      , l = true
                      , u = false
                      , c = void 0;
                    try {
                        for (var d, h = s[Symbol.iterator](); !(l = (d = h.next()).done); l = true) {
                            var p = d.value
                              , y = document.createElement("div");
                            y.innerText = p.name,
                            a.appendChild(y)
                        }
                    } catch (e) {
                        u = true,
                        c = e
                    } finally {
                        try {
                            !l && h.return && h.return()
                        } finally {
                            if (u)
                                throw c
                        }
                    }
                    var m = 0
                      , v = r.map((function(e) {
                        return {
                            animation: e,
                            order: ++m,
                            isDragging: -1 !== s.indexOf(e)
                        }
                    }
                    ));
                    return this.dragData = {
                        order: v,
                        dragItems: s
                    },
                    {
                        ghost: a,
                        items: s
                    }
                }
            }
        }, {
            key: "allowDrag",
            value: function(e) {
                return true
            }
        }, {
            key: "allowDrop",
            value: function(e, t, n) {
                return !t
            }
        }, {
            key: "drop",
            value: function(e, t, n) {
                for (var i = this.context.nima, r = this.dragData, o = r.order, a = r.dragItems, s = [], l = 0; l <= o.length; l++) {
                    var u = o[l];
                    if (l === n) {
                        var c = true
                          , d = false
                          , h = void 0;
                        try {
                            for (var f, p = a[Symbol.iterator](); !(c = (f = p.next()).done); c = true) {
                                var y = f.value;
                                s.push(y)
                            }
                        } catch (e) {
                            d = true,
                            h = e
                        } finally {
                            try {
                                !c && p.return && p.return()
                            } finally {
                                if (d)
                                    throw h
                            }
                        }
                    }
                    u && !u.isDragging && s.push(u.animation)
                }
                for (var m = 0; m < s.length; m++)
                    s[m].order = m;
                i.captureJournalEntry()
            }
        }, {
            key: "show",
            value: function(e) {
                this.tree.show(e)
            }
        }, {
            key: "addAnimation",
            value: function() {
                var e = this.context.nima.actor.createAnimation();
                e.editImmediately = true,
                this.context.nima.editingAnimation = e,
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "render",
            value: function() {
                var e = this.getChildren
                  , t = this.props.data;
                return t && (t = e(t)),
                o.default.createElement("div", {
                    className: h.default.Pane
                }, o.default.createElement(c.default, {
                    ref: this.setTree,
                    makeDragGhost: this.makeDragGhost,
                    allowDrag: this.allowDrag,
                    drop: this.drop,
                    allowDrop: this.allowDrop,
                    data: t,
                    showFirstLine: false,
                    hideFirstHorizontalLine: true,
                    height: this.props.height - 65,
                    iconWidth: 15,
                    iconHeight: 15,
                    rowHeight: 35,
                    getChildren: e,
                    renderItem: this.renderItem
                }), o.default.createElement("div", {
                    className: h.default.PaneButtonsWrapper
                }, o.default.createElement("div", {
                    className: h.default.PaneButton,
                    onClick: this.addAnimation
                }, o.default.createElement("svg", {
                    className: "icon-plus"
                }, o.default.createElement("use", {
                    xlinkHref: p.default.make("/images/symbol-defs.svg#icon-plus")
                })))))
            }
        }]),
        t
    }(o.default.Component)).prototype, "onChildrenChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onChildrenChanged"), i.prototype),
    m(i.prototype, "setData", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setData"), i.prototype),
    m(i.prototype, "renderItem", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "renderItem"), i.prototype),
    m(i.prototype, "getChildren", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "getChildren"), i.prototype),
    m(i.prototype, "setTree", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setTree"), i.prototype),
    m(i.prototype, "onAnimationSelected", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onAnimationSelected"), i.prototype),
    m(i.prototype, "makeDragGhost", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "makeDragGhost"), i.prototype),
    m(i.prototype, "allowDrag", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "allowDrag"), i.prototype),
    m(i.prototype, "allowDrop", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "allowDrop"), i.prototype),
    m(i.prototype, "drop", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "drop"), i.prototype),
    m(i.prototype, "addAnimation", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "addAnimation"), i.prototype),
    i);
    t.default = v,
    v.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = y(n(0)), a = y(n(4)), s = y(n(1)), l = y(n(20)), u = y(n(358)), c = y(n(13)), d = (y(n(386)),
    y(n(170))), h = y(n(518)), f = y(n(714)), p = y(n(3));
    function y(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function m(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var v = (m((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                editing: false,
                hover: false
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "doForceUpdate",
            value: function() {
                this.forceUpdate()
            }
        }, {
            key: "debounceForcedUpdate",
            value: function() {
                (0,
                c.default)(this.doForceUpdate)
            }
        }, {
            key: "setItem",
            value: function(e) {
                var t = this.item;
                t !== e && (t && (t.removeEventListener("nameChanged", this.debounceForcedUpdate),
                t.removeEventListener("selectedChange", this.debounceForcedUpdate),
                t.removeEventListener("activeChange", this.debounceForcedUpdate),
                t.removeEventListener("play", this.debounceForcedUpdate)),
                this.item = e,
                e && (e.addEventListener("nameChanged", this.debounceForcedUpdate),
                e.addEventListener("selectedChange", this.debounceForcedUpdate),
                e.addEventListener("activeChange", this.debounceForcedUpdate),
                e.addEventListener("play", this.debounceForcedUpdate)))
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.item != this.props.item && this.setItem(e.item)
            }
        }, {
            key: "componentDidUpdate",
            value: function() {
                var e = this.props.item;
                e && e.editImmediately && this.editableName && (e.editImmediately = false,
                this.editableName.startEdit())
            }
        }, {
            key: "componentWillMount",
            value: function() {
                this.setItem(this.props.item)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                c.default.cancel(this.doForceUpdate),
                this.setItem(null)
            }
        }, {
            key: "mouseEnter",
            value: function() {
                this.setState({
                    hover: true
                });
                this.item
            }
        }, {
            key: "mouseLeave",
            value: function() {
                this.setState({
                    hover: false
                });
                this.item
            }
        }, {
            key: "mouseDown",
            value: function(e) {
                if (e.preventDefault(),
                e.stopPropagation(),
                this.item) {
                    var t = Date.now();
                    if (this.clickTime) {
                        var n = t - this.clickTime;
                        if (delete this.clickTime,
                        n < 200 && this.editableName.startEdit())
                            return
                    }
                    this.clickTime = t,
                    this.props.onSelected && this.props.onSelected(e, this.item)
                }
            }
        }, {
            key: "toggleActive",
            value: function(e) {
                e.stopPropagation();
                var t = this.item;
                t && (this.context.nima.editingAnimation = t)
            }
        }, {
            key: "setEditableName",
            value: function(e) {
                this.editableName = e
            }
        }, {
            key: "rightClick",
            value: function(e) {
                var t = this.props.item;
                if (t) {
                    var n = this
                      , i = this.context.nima
                      , r = i.certainSelections((function(e) {
                        return e.constructor === u.default
                    }
                    ))
                      , o = r.length > 1 ? r : [t]
                      , a = [{
                        name: "Duplicate",
                        select: function() {
                            i.actor.duplicateAnimations(o),
                            i.captureJournalEntry()
                        }
                    }, {
                        name: "Delete",
                        select: function() {
                            i.actor.removeAnimations(o),
                            i.captureJournalEntry()
                        }
                    }];
                    o.length <= 1 && a.push({
                        name: "Rename",
                        select: function() {
                            n.editableName && n.editableName.startEdit()
                        }
                    }),
                    a.push({
                        type: "Divider"
                    }, {
                        type: "SubMenu",
                        name: "Sort",
                        items: [{
                            name: "Alphabetically",
                            select: function() {
                                i.sortAnimations(f.default.SortOrder.Alphabetical)
                            }
                        }, {
                            name: "Date Created",
                            select: function() {
                                i.sortAnimations(f.default.SortOrder.Created)
                            }
                        }]
                    }),
                    i.showContextMenu({
                        x: e.clientX,
                        y: e.clientY,
                        items: a
                    })
                }
            }
        }, {
            key: "togglePlay",
            value: function(e) {
                var t = this.props.item;
                e.stopPropagation(),
                e.preventDefault(),
                t.isPlaying = !t.isPlaying
            }
        }, {
            key: "render",
            value: function() {
                var e = this.context.nima
                  , t = this.props
                  , n = t.item
                  , i = t.dropTargetState
                  , r = t.isDragging
                  , a = this.state.hover
                  , s = n.uiHierIconClass
                  , u = n.uiIcon
                  , c = u ? p.default.make("/images/symbol-defs.svg#" + u) : null
                  , f = !r && n.isSelected
                  , y = e.editingAnimation === n;
                r && (a = false);
                var m = !r && a
                  , v = [l.default.ItemContent];
                switch (f ? v.push(l.default.Selected) : m && v.push(l.default.Hovered),
                i) {
                case d.default.DropTargetParent:
                    v.push(l.default.DropTargetParent);
                    break;
                case d.default.DropTarget:
                    v.push(l.default.DropTarget);
                    break;
                case d.default.DropDisabled:
                    v.push(l.default.DropDisabled)
                }
                return o.default.createElement("div", {
                    className: l.default.ItemContentWrapper,
                    onClick: this.mouseDown,
                    onMouseEnter: this.mouseEnter,
                    onMouseLeave: this.mouseLeave,
                    onContextMenu: this.rightClick
                }, o.default.createElement("div", {
                    style: {
                        display: "inline-block"
                    },
                    className: l.default.Toggle,
                    onMouseEnter: this.enterToggleActive,
                    onClick: this.toggleActive
                }, o.default.createElement("div", {
                    style: {
                        opacity: y ? 1 : 0
                    }
                })), o.default.createElement("div", {
                    className: v.join(" ")
                }, o.default.createElement("div", {
                    className: l.default.TreeIcon,
                    onClick: this.togglePlay
                }, o.default.createElement("svg", {
                    className: s,
                    style: {
                        pointerEvents: "none"
                    }
                }, o.default.createElement("use", {
                    xlinkHref: c
                }))), o.default.createElement(h.default, {
                    ref: this.setEditableName,
                    item: n
                })), null, null)
            }
        }]),
        t
    }(o.default.Component)).prototype, "doForceUpdate", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "doForceUpdate"), i.prototype),
    m(i.prototype, "debounceForcedUpdate", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "debounceForcedUpdate"), i.prototype),
    m(i.prototype, "mouseEnter", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseEnter"), i.prototype),
    m(i.prototype, "mouseLeave", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseLeave"), i.prototype),
    m(i.prototype, "mouseDown", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseDown"), i.prototype),
    m(i.prototype, "toggleActive", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleActive"), i.prototype),
    m(i.prototype, "setEditableName", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setEditableName"), i.prototype),
    m(i.prototype, "rightClick", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "rightClick"), i.prototype),
    m(i.prototype, "togglePlay", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "togglePlay"), i.prototype),
    i);
    t.default = v,
    v.contextTypes = {
        nima: a.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r, o = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), a = h(n(0)), s = h(n(1)), l = h(n(1131)), u = h(n(715)), c = h(n(4)), d = h(n(3));
    function h(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function f(e, t) {
        if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function")
    }
    function p(e, t) {
        if (!e)
            throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    function y(e, t) {
        if ("function" != typeof t && null !== t)
            throw new TypeError("Super expression must either be null or a function, not " + typeof t);
        e.prototype = Object.create(t && t.prototype, {
            constructor: {
                value: e,
                enumerable: false,
                writable: true,
                configurable: true
            }
        }),
        t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
    }
    function m(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var v = (m((i = function(e) {
        function t(e) {
            f(this, t);
            var n = p(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                activeIndex: 0
            },
            n
        }
        return y(t, e),
        o(t, [{
            key: "tabClick",
            value: function(e) {
                this.setState({
                    activeIndex: this.props.children.indexOf(e)
                })
            }
        }, {
            key: "render",
            value: function() {
                var e = this
                  , t = this.props.children
                  , n = Math.min(t.length - 1, this.state.activeIndex)
                  , i = n >= 0 ? t[n] : null
                  , r = 0;
                return a.default.createElement("div", {
                    className: l.default.TabPanel
                }, a.default.createElement("div", {
                    className: l.default.TabButtonsWrapper
                }, t.filter((function(e) {
                    return !e.props.isHidden
                }
                )).map((function(t) {
                    return a.default.createElement(g, {
                        key: r++,
                        active: i === t,
                        child: t,
                        onClick: e.tabClick,
                        label: t.props.title,
                        icon: t.props.icon,
                        keyFrameHandler: t.props.keyFrameHandler
                    })
                }
                ))), i)
            }
        }, {
            key: "activeIndex",
            set: function(e) {
                this.setState({
                    activeIndex: e
                })
            },
            get: function() {
                return this.state.activeIndex
            }
        }]),
        t
    }(a.default.Component)).prototype, "tabClick", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "tabClick"), i.prototype),
    i);
    t.default = v;
    var g = (m((r = function(e) {
        function t(e) {
            f(this, t);
            var n = p(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {},
            n
        }
        return y(t, e),
        o(t, [{
            key: "tabClick",
            value: function() {
                this.props.onClick(this.props.child)
            }
        }, {
            key: "doUpdate",
            value: function() {
                this.forceUpdate()
            }
        }, {
            key: "setKeyFrameHandler",
            value: function(e) {
                var t = this.keyFrameHandler;
                t && t.dispatcher.removeEventListener(t.event, this.doUpdate),
                this.keyFrameHandler = e,
                e && e.dispatcher.addEventListener(e.event, this.doUpdate)
            }
        }, {
            key: "setKeyFrame",
            value: function(e) {
                var t = this.props.keyFrameHandler;
                t && (e.stopPropagation(),
                t.setKey(this.context.nima),
                this.context.nima.captureJournalEntry())
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.keyFrameHandler != this.props.keyFrameHandler && this.setKeyFrameHandler(e.keyFrameHandler)
            }
        }, {
            key: "render",
            value: function() {
                var e = this.props.keyFrameHandler
                  , t = !!e
                  , n = t ? e.state : 0;
                return a.default.createElement("div", {
                    className: l.default.TabButton + (this.props.active ? " " + l.default.TabButtonActive : ""),
                    onClick: this.tabClick
                }, this.props.icon ? a.default.createElement("div", {
                    className: l.default.TabIcon
                }, a.default.createElement("svg", {
                    className: this.props.icon
                }, a.default.createElement("use", {
                    xlinkHref: d.default.make("/images/symbol-defs.svg#" + this.props.icon)
                }))) : null, a.default.createElement("span", {
                    title: this.props.label
                }, this.props.label), t ? a.default.createElement("div", {
                    className: 0 == n ? u.default.HieararchyKey : 1 == n ? u.default.HieararchyKeyChanged : u.default.HieararchyKeyed,
                    onClick: this.setKeyFrame,
                    style: {
                        marginTop: "1px"
                    }
                }) : null)
            }
        }]),
        t
    }(a.default.Component)).prototype, "tabClick", [s.default], Object.getOwnPropertyDescriptor(r.prototype, "tabClick"), r.prototype),
    m(r.prototype, "doUpdate", [s.default], Object.getOwnPropertyDescriptor(r.prototype, "doUpdate"), r.prototype),
    m(r.prototype, "setKeyFrame", [s.default], Object.getOwnPropertyDescriptor(r.prototype, "setKeyFrame"), r.prototype),
    r);
    g.contextTypes = {
        nima: c.default.object
    }
}
, function(e, t, n) {
    var i = n(1132);
    "string" == typeof i && (i = [[e.i, i, ""]]);
    var r = {
        insertAt: "top",
        hmr: true,
        transform: void 0
    };
    n(8)(i, r);
    i.locals && (e.exports = i.locals)
}
, function(e, t, n) {
    (t = e.exports = n(7)(false)).push([e.i, '.source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-TabPanel-2nl0x {\n  border-top: 1px solid rgba(0, 0, 0, 0.06); }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-TabPanel-2nl0x:before {\n  content: "";\n  background: linear-gradient(rgba(0, 0, 0, 0), black);\n  height: 10px;\n  position: absolute;\n  width: 100%;\n  opacity: .02;\n  margin-top: -10px;\n  pointer-events: none; }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-TabButtonsWrapper-EdFAS {\n  padding-left: 10px; }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-TabButton-3nCI4 {\n  height: 48px;\n  display: inline-flex;\n  align-items: center;\n  font-weight: 400;\n  font-size: 11px;\n  text-transform: uppercase;\n  border-top: 1px solid rgba(0, 0, 0, 0);\n  position: relative;\n  cursor: pointer;\n  margin: -1px 10px 0 10px;\n  color: #888;\n  transition: border-top .1s ease-in-out, color .1s ease-in-out; }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-TabButton-3nCI4:before,\n.source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-TabButton-3nCI4:after {\n  content: "";\n  position: absolute;\n  height: 100%;\n  width: 10px;\n  left: -10px;\n  top: 0; }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-TabButton-3nCI4:after {\n  left: initial;\n  right: -10px; }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-TabButton-3nCI4:hover {\n  color: #666; }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-TabButton-3nCI4 span:after {\n  content: attr(title);\n  font-weight: 600;\n  display: block;\n  height: 0;\n  visibility: hidden; }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-TabButtonActive-ZJ8ZJ {\n  border-top: 1px solid rgba(0, 0, 0, 0.5);\n  color: #333;\n  font-weight: 600; }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-TabButtonActive-ZJ8ZJ:hover {\n  color: #333; }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-TabIcon-2ZGjL {\n  fill: #888;\n  transition: fill .1s ease-in-out;\n  margin-right: 5px;\n  width: 15px;\n  height: 15px;\n  position: relative;\n  flex-shrink: 0; }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-TabButton-3nCI4:hover .source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-TabIcon-2ZGjL {\n  fill: #666; }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-TabButtonActive-ZJ8ZJ .source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-TabIcon-2ZGjL {\n  fill: #333; }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-TabButtonActive-ZJ8ZJ:hover .source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-TabIcon-2ZGjL {\n  fill: #333; }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-TabIcon-2ZGjL svg {\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  transform: translate(calc(-50% + 0.5px), calc(-50% + 0.5px)); }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-Pane-UXcRo {\n  position: relative; }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-AddButton-1TOms {\n  width: 100%;\n  height: 26px;\n  background: rgba(228, 228, 228, 0.95);\n  bottom: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 5px; }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-PlusIcon-P_J7P {\n  width: 20px;\n  height: 20px;\n  fill: #888; }\n\n.source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-AddButton-1TOms:hover .source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-PlusIcon-P_J7P {\n  fill: #333; }\n', ""]),
    t.locals = {
        TabPanel: "source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-TabPanel-2nl0x",
        TabButtonsWrapper: "source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-TabButtonsWrapper-EdFAS",
        TabButton: "source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-TabButton-3nCI4",
        TabButtonActive: "source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-TabButtonActive-ZJ8ZJ",
        TabIcon: "source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-TabIcon-2ZGjL",
        Pane: "source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-Pane-UXcRo",
        AddButton: "source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-AddButton-1TOms",
        PlusIcon: "source-client-source-editors-nima-ui-Components-Hierarchy-TabPanel-PlusIcon-P_J7P"
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = s(n(0)), a = s(n(1));
    function s(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function l(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var u = (l((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                value: 0
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "componentWillMount",
            value: function() {
                this.value = 0
            }
        }, {
            key: "setValue",
            value: function(e, t) {
                this.value != e && (this.value = e,
                !t && this.props.onValueChanged && this.props.onValueChanged(e),
                this.setState({
                    value: e
                }))
            }
        }, {
            key: "startDrag",
            value: function(e) {
                this.lastX = e.clientX,
                this.width = this.slider.getBoundingClientRect().width,
                this.grabberX = this.width * this.value,
                e.preventDefault(),
                e.stopPropagation(),
                window.addEventListener("mouseup", this.stopDrag, true),
                window.addEventListener("mousemove", this.drag, true)
            }
        }, {
            key: "stopDrag",
            value: function(e) {
                e.preventDefault(),
                e.stopPropagation(),
                window.removeEventListener("mouseup", this.stopDrag, true),
                window.removeEventListener("mousemove", this.drag, true),
                this.props.onValueChangeComplete && this.props.onValueChangeComplete()
            }
        }, {
            key: "drag",
            value: function(e) {
                e.preventDefault(),
                e.stopPropagation();
                var t = e.clientX - this.lastX;
                this.grabberX += t,
                this.grabberX < 0 ? (t += -this.grabberX,
                this.grabberX = 0) : this.grabberX > this.width && (t -= this.grabberX - this.width,
                this.grabberX = this.width),
                this.lastX += t,
                this.setValue(this.grabberX / this.width)
            }
        }, {
            key: "setSlider",
            value: function(e) {
                this.slider = e
            }
        }, {
            key: "render",
            value: function() {
                return o.default.createElement("div", {
                    ref: this.setSlider,
                    className: "Slider"
                }, o.default.createElement("div", {
                    className: "SliderTrack"
                }, o.default.createElement("div", {
                    className: "SliderActiveTrack",
                    style: {
                        width: 100 * this.state.value + "%"
                    }
                }, o.default.createElement("div", {
                    className: "SliderGrabber",
                    onMouseDown: this.startDrag
                }))))
            }
        }]),
        t
    }(o.default.Component)).prototype, "startDrag", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "startDrag"), i.prototype),
    l(i.prototype, "stopDrag", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "stopDrag"), i.prototype),
    l(i.prototype, "drag", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "drag"), i.prototype),
    l(i.prototype, "setSlider", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setSlider"), i.prototype),
    i);
    t.default = u
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = u(n(0)), a = u(n(4)), s = u(n(1)), l = u(n(347));
    function u(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function c(e, t) {
        if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function")
    }
    function d(e, t) {
        if (!e)
            throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    function h(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var f = (h((i = function(e) {
        function t() {
            return c(this, t),
            d(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "select",
            value: function() {
                this.props.onSelect && this.props.onSelect(this)
            }
        }, {
            key: "changeWeight",
            value: function(e, t) {
                var n = this.props.onWeightChanged;
                n && n(e, this.props.index),
                t || this.context.nima.captureJournalEntry()
            }
        }, {
            key: "commit",
            value: function() {
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "render",
            value: function() {
                var e = this.props.color
                  , t = "rgba(" + Math.round(255 * e[0]) + "," + Math.round(255 * e[1]) + "," + Math.round(255 * e[2]) + "," + e[3] + ")"
                  , n = "BonePaintRow" + (this.props.isSelected ? " BonePaintRowSelected" : "");
                return o.default.createElement("div", {
                    onMouseDown: this.select,
                    className: n
                }, o.default.createElement("svg", null, o.default.createElement("polygon", {
                    style: {
                        fill: t
                    },
                    points: "0 0 5 0 13 13 0 5 0 0"
                })), o.default.createElement("div", {
                    className: "BonePaintTitle"
                }, this.props.bone.name), null !== this.props.value ? o.default.createElement(l.default, {
                    value: void 0 === this.props.value ? 0 : this.props.value,
                    dragScale: .01,
                    onValueChanged: this.changeWeight,
                    onValueCommit: this.commit
                }) : null)
            }
        }]),
        t
    }(o.default.Component)).prototype, "select", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "select"), i.prototype),
    h(i.prototype, "changeWeight", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "changeWeight"), i.prototype),
    h(i.prototype, "commit", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "commit"), i.prototype),
    i);
    t.default = f,
    f.contextTypes = {
        nima: a.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = p(n(0)), a = p(n(1)), s = p(n(4)), l = p(n(310)), u = p(n(264)), c = p(n(718)), d = p(n(315)), h = p(n(237)), f = p(n(263));
    function p(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function y(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var m = (y((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                hasConstrast: false
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "hasContrastChange",
            value: function(e) {
                this.setState({
                    hasContrast: e
                })
            }
        }, {
            key: "setBoneItems",
            value: function(e) {
                var t = null;
                if (e)
                    for (var n = 0; n < e.length; n++) {
                        var i = e[n];
                        if (i.node) {
                            var r = i.node;
                            null === t && (t = []),
                            -1 === t.indexOf(r) && t.push(r)
                        }
                    }
                if (!(0,
                f.default)(this.actorBones, t)) {
                    if (this.actorBones)
                        for (var o = 0; o < this.actorBones.length; o++) {
                            this.actorBones[o].removeEventListener("hasContrastChange", this.hasContrastChange)
                        }
                    if (this.actorBones = t,
                    t) {
                        for (var a = true, s = 0; s < this.actorBones.length; s++) {
                            var l = this.actorBones[s];
                            l.hasContrast || (a = false),
                            l.addEventListener("hasContrastChange", this.hasContrastChange)
                        }
                        this.setState({
                            hasContrast: a
                        })
                    }
                }
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.stageItems != this.props.stageItems && this.setBoneItems(e.stageItems)
            }
        }, {
            key: "componentWillMount",
            value: function() {
                this.setBoneItems(this.props.stageItems)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setBoneItems(null)
            }
        }, {
            key: "toggleContrast",
            value: function(e) {
                this.context.nima.withSelected([d.default, h.default], (function(t) {
                    t.hasContrast = e
                }
                )),
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "sizeChanging",
            value: function(e) {
                e && this.context.nima.withSelected([d.default, h.default], (function(t) {
                    t.size = e
                }
                ))
            }
        }, {
            key: "sizeChangeComplete",
            value: function() {
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "render",
            value: function() {
                var e = null;
                return this.actorBones && this.actorBones.length && (e = this.actorBones[0].size),
                o.default.createElement(u.default, {
                    label: "Bone Options",
                    _key: "_BoneOpts"
                }, o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitleSwitch"
                }, "Contrast"), o.default.createElement(l.default, {
                    isOn: this.state.hasContrast,
                    onToggle: this.toggleContrast
                })), o.default.createElement(c.default, {
                    ref: "sizeSlider",
                    label: "Bone Size",
                    value: e,
                    minValue: h.default.MinimumSize,
                    maxValue: h.default.MaximumSize,
                    onValueChanged: this.sizeChanging,
                    onValueChangeComplete: this.sizeChangeComplete
                }))
            }
        }]),
        t
    }(o.default.Component)).prototype, "hasContrastChange", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "hasContrastChange"), i.prototype),
    y(i.prototype, "toggleContrast", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleContrast"), i.prototype),
    y(i.prototype, "sizeChanging", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "sizeChanging"), i.prototype),
    y(i.prototype, "sizeChangeComplete", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "sizeChangeComplete"), i.prototype),
    i);
    t.default = m,
    m.contextTypes = {
        nima: s.default.object
    },
    m.canMultiEdit = true,
    m.panelOrder = 3,
    m.validate = function(e, t) {
        return !e.state.isAnimationOpen
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = w(n(0)), a = w(n(1)), s = w(n(4)), l = w(n(348)), u = w(n(264)), c = w(n(310)), d = w(n(316)), h = w(n(719)), f = w(n(398)), p = w(n(184)), y = w(n(347)), m = w(n(1137)), v = w(n(1138)), g = w(n(13)), _ = w(n(263)), b = w(n(3));
    function w(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function O(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var S = (O((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                isJelly: false
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "eachJelly",
            value: function(e) {
                var t = true
                  , n = false
                  , i = void 0;
                try {
                    for (var r, o = this.actorBones[Symbol.iterator](); !(t = (r = o.next()).done); t = true) {
                        var a = r.value.jelly;
                        a && e(a)
                    }
                } catch (e) {
                    n = true,
                    i = e
                } finally {
                    try {
                        !t && o.return && o.return()
                    } finally {
                        if (n)
                            throw i
                    }
                }
            }
        }, {
            key: "changeJellySegments",
            value: function(e) {
                this.eachJelly((function(t) {
                    t.segments = e
                }
                )),
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "changeEaseIn",
            value: function(e, t) {
                this.eachJelly((function(t) {
                    t.easeIn = e
                }
                )),
                t || this.context.nima.captureJournalEntry()
            }
        }, {
            key: "changeEaseOut",
            value: function(e, t) {
                this.eachJelly((function(t) {
                    t.easeOut = e
                }
                )),
                t || this.context.nima.captureJournalEntry()
            }
        }, {
            key: "changeScaleIn",
            value: function(e, t) {
                this.eachJelly((function(t) {
                    t.scaleIn = e
                }
                )),
                t || this.context.nima.captureJournalEntry()
            }
        }, {
            key: "changeScaleOut",
            value: function(e, t) {
                this.eachJelly((function(t) {
                    t.scaleOut = e
                }
                )),
                t || this.context.nima.captureJournalEntry()
            }
        }, {
            key: "jellyChange",
            value: function() {
                (0,
                g.default)(this.revalidate)
            }
        }, {
            key: "revalidate",
            value: function() {
                this.forceUpdate()
            }
        }, {
            key: "toggleJelly",
            value: function(e) {
                var t = true
                  , n = false
                  , i = void 0;
                try {
                    for (var r, o = this.actorBones[Symbol.iterator](); !(t = (r = o.next()).done); t = true) {
                        r.value.isJelly = e
                    }
                } catch (e) {
                    n = true,
                    i = e
                } finally {
                    try {
                        !t && o.return && o.return()
                    } finally {
                        if (n)
                            throw i
                    }
                }
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "setBoneItems",
            value: function(e) {
                var t = null;
                if (e)
                    for (var n = 0; n < e.length; n++) {
                        var i = e[n];
                        if (i.node) {
                            var r = i.node;
                            if (r.constructor === f.default && !(r = r.parent))
                                continue;
                            null === t && (t = []),
                            -1 === t.indexOf(r) && t.push(r)
                        }
                    }
                if (!(0,
                _.default)(this.actorBones, t)) {
                    if (this.actorBones) {
                        var o = true
                          , a = false
                          , s = void 0;
                        try {
                            for (var l, u = this.actorBones[Symbol.iterator](); !(o = (l = u.next()).done); o = true) {
                                l.value.removeEventListener("jellyChange", this.jellyChange)
                            }
                        } catch (e) {
                            a = true,
                            s = e
                        } finally {
                            try {
                                !o && u.return && u.return()
                            } finally {
                                if (a)
                                    throw s
                            }
                        }
                    }
                    if (this.actorBones = t,
                    t) {
                        var c = true
                          , d = false
                          , h = void 0;
                        try {
                            for (var p, y = t[Symbol.iterator](); !(c = (p = y.next()).done); c = true) {
                                p.value.addEventListener("jellyChange", this.jellyChange)
                            }
                        } catch (e) {
                            d = true,
                            h = e
                        } finally {
                            try {
                                !c && y.return && y.return()
                            } finally {
                                if (d)
                                    throw h
                            }
                        }
                    }
                }
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.stageItems != this.props.stageItems && this.setBoneItems(e.stageItems)
            }
        }, {
            key: "componentWillMount",
            value: function() {
                this.setBoneItems(this.props.stageItems)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setBoneItems(null),
                g.default.cancel(this.revalidate)
            }
        }, {
            key: "changeDisplayIndex",
            value: function(e) {
                if (!(e < 0)) {
                    var t = k[e]
                      , n = true
                      , i = false
                      , r = void 0;
                    try {
                        for (var o, a = this.actorBones[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                            var s = o.value.jelly;
                            s && (s.hideJellies = !t.jelly,
                            s.hideBone = !t.bone)
                        }
                    } catch (e) {
                        i = true,
                        r = e
                    } finally {
                        try {
                            !n && a.return && a.return()
                        } finally {
                            if (i)
                                throw r
                        }
                    }
                    var l = null;
                    if (t.jelly) {
                        if (!t.bone) {
                            l = [];
                            var u = true
                              , c = false
                              , d = void 0;
                            try {
                                for (var h, f = this.actorBones[Symbol.iterator](); !(u = (h = f.next()).done); u = true) {
                                    var p = h.value.jellyBones;
                                    l = l.concat(p)
                                }
                            } catch (e) {
                                c = true,
                                d = e
                            } finally {
                                try {
                                    !u && f.return && f.return()
                                } finally {
                                    if (c)
                                        throw d
                                }
                            }
                        }
                    } else
                        l = this.actorBones.slice(0);
                    if (l) {
                        var y = this.context.nima.stage;
                        (0,
                        g.default)((function() {
                            var e = []
                              , t = true
                              , n = false
                              , i = void 0;
                            try {
                                for (var r, o = l[Symbol.iterator](); !(t = (r = o.next()).done); t = true) {
                                    var a = r.value;
                                    a.stageItem && e.push(a.stageItem)
                                }
                            } catch (e) {
                                n = true,
                                i = e
                            } finally {
                                try {
                                    !t && o.return && o.return()
                                } finally {
                                    if (n)
                                        throw i
                                }
                            }
                            y.selectItems(e)
                        }
                        ))
                    }
                    this.context.nima.captureJournalEntry()
                }
            }
        }, {
            key: "commit",
            value: function() {
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "pickedTarget",
            value: function(e, t) {
                this.pickTargetAlert && (this.pickTargetAlert.hide(),
                this.pickTargetAlert = null);
                var n = this.context.nima
                  , i = n.stage;
                i.clearRerouteSelection(this.rerouteCB),
                n.clearCancelCallback(this.cancelCB),
                i.clearExtraSelectionFilter(),
                delete this.rerouteCB,
                delete this.cancelCB,
                e && e(t)
            }
        }, {
            key: "pickTarget",
            value: function(e) {
                var t = this.context.nima
                  , n = t.stage;
                if (!this.pickTargetAlert && !n.soloItem) {
                    var i = this;
                    this.pickTargetAlert = t.alert({
                        title: "Pick Target",
                        message: "Select the item to use as a target.",
                        type: p.default.Types.State,
                        buttons: [{
                            label: "CLEAR",
                            action: function(t, n) {
                                i.pickedTarget(e, null),
                                e(null)
                            }
                        }, {
                            label: "CANCEL",
                            action: function(t, n) {
                                i.pickedTarget(e)
                            }
                        }]
                    }),
                    this.cancelCB = function(t) {
                        i.pickedTarget(e)
                    }
                    ,
                    this.rerouteCB = function(t) {
                        i.pickedTarget(e, t)
                    }
                    ,
                    t.setCancelCallback(this.cancelCB),
                    n.rerouteSelection(this.rerouteCB),
                    n.setExtraSelectionFilter((function(e) {
                        return !e.drawAfterSelections
                    }
                    ))
                }
            }
        }, {
            key: "pickInTarget",
            value: function() {
                var e = this
                  , t = this.context.nima;
                this.pickTarget((function(n) {
                    void 0 !== n && (e.eachJelly((function(e) {
                        t.detectDependencyCycles((function() {
                            e.inTarget = n.node
                        }
                        ))
                    }
                    )),
                    e.context.nima.captureJournalEntry())
                }
                ))
            }
        }, {
            key: "pickOutTarget",
            value: function() {
                var e = this
                  , t = this.context.nima;
                this.pickTarget((function(n) {
                    void 0 !== n && (e.eachJelly((function(e) {
                        t.detectDependencyCycles((function() {
                            e.outTarget = n.node
                        }
                        ))
                    }
                    )),
                    e.context.nima.captureJournalEntry())
                }
                ))
            }
        }, {
            key: "removeInTarget",
            value: function() {
                this.eachJelly((function(e) {
                    e.inTarget = null
                }
                )),
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "removeOutTarget",
            value: function() {
                this.eachJelly((function(e) {
                    console.log("REMOVING JELLY", e),
                    e.outTarget = null
                }
                )),
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "render",
            value: function() {
                var e = l.default.validate(t.Validation, this.actorBones)
                  , n = this.props.isAnimating
                  , i = e.isJelly
                  , r = e.segments
                  , a = e.easeIn
                  , s = e.easeOut
                  , f = e.scaleIn
                  , p = e.scaleOut
                  , g = e.displayIndex;
                e.inTarget;
                return o.default.createElement(u.default, {
                    _key: "_JellyOpts",
                    label: "Jelly Bones",
                    action: n ? null : o.default.createElement(c.default, {
                        isOn: i,
                        onToggle: this.toggleJelly
                    })
                }, o.default.createElement("div", {
                    className: "EditMeshOptions",
                    style: {
                        opacity: i ? 1 : .4,
                        pointerEvents: i ? "all" : "none"
                    }
                }, o.default.createElement("div", null, o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Segments"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(y.default, {
                    value: r,
                    converter: m.default,
                    onValueChanged: this.changeJellySegments,
                    onValueCommit: this.commit,
                    disabled: false
                }))), o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Ease In"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(y.default, {
                    value: a,
                    converter: v.default,
                    onValueChanged: this.changeEaseIn,
                    onValueCommit: this.commit,
                    disabled: false
                }))), o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Ease Out"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(y.default, {
                    value: s,
                    converter: v.default,
                    onValueChanged: this.changeEaseOut,
                    onValueCommit: this.commit,
                    disabled: false
                }))), o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Scale In"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(y.default, {
                    value: f,
                    dragScale: .001,
                    onValueChanged: this.changeScaleIn,
                    onValueCommit: this.commit,
                    disabled: false
                }))), o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Scale Out"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(y.default, {
                    value: p,
                    dragScale: .001,
                    onValueChanged: this.changeScaleOut,
                    onValueCommit: this.commit,
                    disabled: false
                }))), o.default.createElement("div", {
                    style: {
                        marginBottom: "10px"
                    }
                }, o.default.createElement("div", {
                    onClick: this.pickInTarget,
                    className: "SelectionPanelButton MeshBonesHeader",
                    style: {
                        borderRadius: e.inTarget ? null : "20px"
                    }
                }, o.default.createElement("span", null, "In Target"), o.default.createElement("svg", {
                    className: "AddButton"
                }, o.default.createElement("use", {
                    xlinkHref: b.default.make("/images/symbol-defs.svg#icon-plus")
                }))), e.inTarget ? o.default.createElement(h.default, {
                    key: e.inTarget.refId,
                    node: e.inTarget,
                    onRemove: this.removeInTarget
                }) : null), o.default.createElement("div", {
                    style: {
                        marginBottom: "20px"
                    }
                }, o.default.createElement("div", {
                    onClick: this.pickOutTarget,
                    className: "SelectionPanelButton MeshBonesHeader",
                    style: {
                        borderRadius: e.outTarget ? null : "20px"
                    }
                }, o.default.createElement("span", null, "Out Target"), o.default.createElement("svg", {
                    className: "AddButton"
                }, o.default.createElement("use", {
                    xlinkHref: b.default.make("/images/symbol-defs.svg#icon-plus")
                }))), e.outTarget ? o.default.createElement(h.default, {
                    key: e.outTarget.refId,
                    node: e.outTarget,
                    onRemove: this.removeOutTarget
                }) : null), o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Display"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(d.default, {
                    options: k,
                    selectedIndex: g,
                    onSelectionChanged: this.changeDisplayIndex
                }))))))
            }
        }]),
        t
    }(o.default.Component)).prototype, "changeJellySegments", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeJellySegments"), i.prototype),
    O(i.prototype, "changeEaseIn", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeEaseIn"), i.prototype),
    O(i.prototype, "changeEaseOut", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeEaseOut"), i.prototype),
    O(i.prototype, "changeScaleIn", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeScaleIn"), i.prototype),
    O(i.prototype, "changeScaleOut", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeScaleOut"), i.prototype),
    O(i.prototype, "jellyChange", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "jellyChange"), i.prototype),
    O(i.prototype, "revalidate", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "revalidate"), i.prototype),
    O(i.prototype, "toggleJelly", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleJelly"), i.prototype),
    O(i.prototype, "changeDisplayIndex", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeDisplayIndex"), i.prototype),
    O(i.prototype, "commit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "commit"), i.prototype),
    O(i.prototype, "pickInTarget", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "pickInTarget"), i.prototype),
    O(i.prototype, "pickOutTarget", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "pickOutTarget"), i.prototype),
    O(i.prototype, "removeInTarget", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "removeInTarget"), i.prototype),
    O(i.prototype, "removeOutTarget", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "removeOutTarget"), i.prototype),
    i);
    t.default = S;
    var k = [{
        label: "Jellies",
        jelly: true,
        bone: false
    }, {
        label: "Bone",
        jelly: false,
        bone: true
    }, {
        label: "Both",
        jelly: true,
        bone: true
    }];
    S.validate = function(e, t) {
        l.default.validate(S.Validation, t);
        return true
    }
    ,
    S.Validation = {
        displayIndex: {
            validate: function(e) {
                var t = !e.hideJellies
                  , n = !e.hideBone;
                return k.findIndex((function(e) {
                    return e.jelly === t && e.bone === n
                }
                ))
            }
        },
        isJelly: {
            validate: function(e) {
                return e.isJelly
            }
        },
        segments: {
            validate: function(e) {
                return e.jelly && e.jelly.segments || 0
            }
        },
        easeIn: {
            validate: function(e) {
                return e.jelly && e.jelly.easeIn || 0
            }
        },
        easeOut: {
            validate: function(e) {
                return e.jelly && e.jelly.easeOut || 0
            }
        },
        scaleIn: {
            validate: function(e) {
                return e.jelly && e.jelly.scaleIn || 1
            }
        },
        scaleOut: {
            validate: function(e) {
                return e.jelly && e.jelly.scaleOut || 1
            }
        },
        inTarget: {
            validate: function(e) {
                return e.jelly && e.jelly.inTarget || null
            }
        },
        outTarget: {
            validate: function(e) {
                return e.jelly && e.jelly.outTarget || null
            }
        }
    },
    S.canMultiEdit = true,
    S.panelOrder = 3,
    S.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    });
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }();
    var r = function() {
        function e() {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e)
        }
        return i(e, null, [{
            key: "toDisplayValue",
            value: function(e) {
                return Math.floor(e)
            }
        }, {
            key: "toInputValue",
            value: function(e) {
                return e
            }
        }, {
            key: "fromDisplayValue",
            value: function(e) {
                var t = Number.parseFloat(e);
                if (t < 2 || t > 10)
                    throw "Invalid input";
                return t
            }
        }, {
            key: "fromInputValue",
            value: function(e) {
                return this.fromDisplayValue(e)
            }
        }, {
            key: "defaultValue",
            get: function() {
                return 2
            }
        }, {
            key: "allowDrag",
            get: function() {
                return true
            }
        }, {
            key: "dragScale",
            get: function() {
                return 1
            }
        }, {
            key: "dragMin",
            get: function() {
                return 2
            }
        }, {
            key: "dragMax",
            get: function() {
                return 10
            }
        }]),
        e
    }();
    t.default = r
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    });
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }();
    var r = function() {
        function e() {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e)
        }
        return i(e, null, [{
            key: "toDisplayValue",
            value: function(e) {
                return Math.floor(100 * e) / 100
            }
        }, {
            key: "toInputValue",
            value: function(e) {
                return e
            }
        }, {
            key: "fromDisplayValue",
            value: function(e) {
                var t = Number.parseFloat(e);
                if (t < 0 || t > 2)
                    throw "Invalid input";
                return t
            }
        }, {
            key: "fromInputValue",
            value: function(e) {
                return this.fromDisplayValue(e)
            }
        }, {
            key: "defaultValue",
            get: function() {
                return .25
            }
        }, {
            key: "allowDrag",
            get: function() {
                return true
            }
        }, {
            key: "dragScale",
            get: function() {
                return .01
            }
        }, {
            key: "dragMin",
            get: function() {
                return 0
            }
        }, {
            key: "dragMax",
            get: function() {
                return 2
            }
        }]),
        e
    }();
    t.default = r
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = m(n(0)), a = m(n(1)), s = m(n(4)), l = m(n(348)), u = m(n(316)), c = m(n(197)), d = m(n(310)), h = m(n(264)), f = m(n(347)), p = m(n(384)), y = m(n(263));
    function m(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function v(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var g = (v((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {},
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "onUpdateCollider",
            value: function() {
                this.forceUpdate()
            }
        }, {
            key: "setItems",
            value: function(e) {
                if (!(0,
                y.default)(this.items, e)) {
                    if (this.items)
                        for (var t = 0; t < this.items.length; t++) {
                            var n = this.items[t];
                            n.node.removeEventListener("shapeChanged", this.onUpdateCollider),
                            n.node.removeEventListener("sizeChanged", this.onUpdateCollider),
                            n.node.removeEventListener("collisionEnabledChanged", this.onUpdateCollider),
                            n.node.removeEventListener("keyState", this.onUpdateCollider)
                        }
                    if (this.items = e,
                    this.items)
                        for (var i = 0; i < this.items.length; i++) {
                            var r = this.items[i];
                            r.node.addEventListener("shapeChanged", this.onUpdateCollider),
                            r.node.addEventListener("sizeChanged", this.onUpdateCollider),
                            r.node.addEventListener("collisionEnabledChanged", this.onUpdateCollider),
                            r.node.addEventListener("keyState", this.onUpdateCollider)
                        }
                }
            }
        }, {
            key: "onChildrenChanged",
            value: function(e) {
                this.forceUpdate()
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.stageItems != this.props.stageItems && this.setItems(e.stageItems)
            }
        }, {
            key: "componentWillMount",
            value: function() {
                this.setItems(this.props.stageItems)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setItems(null)
            }
        }, {
            key: "changeShape",
            value: function(e) {
                if (this.items)
                    for (var t = 0; t < this.items.length; t++) {
                        this.items[t].node.shape = e
                    }
                this.context.nima.captureJournalEntry(),
                this.forceUpdate()
            }
        }, {
            key: "setWidth",
            value: function(e, t) {
                for (var n = false, i = 0; i < this.items.length; i++) {
                    var r = this.items[i];
                    if (r.node)
                        switch (r.node.shape) {
                        case p.default.Shape.Rectangle:
                        case p.default.Shape.Triangle:
                            r.node.width = e,
                            n = true
                        }
                }
                !t && n && this.context.nima.captureJournalEntry()
            }
        }, {
            key: "setHeight",
            value: function(e, t) {
                for (var n = false, i = 0; i < this.items.length; i++) {
                    var r = this.items[i];
                    if (r.node)
                        switch (r.node.shape) {
                        case p.default.Shape.Rectangle:
                        case p.default.Shape.Triangle:
                            r.node.height = e,
                            n = true
                        }
                }
                !t && n && this.context.nima.captureJournalEntry()
            }
        }, {
            key: "setRadius",
            value: function(e, t) {
                for (var n = false, i = 0; i < this.items.length; i++) {
                    var r = this.items[i];
                    if (r.node)
                        switch (r.node.shape) {
                        case p.default.Shape.Circle:
                            r.node.radius = e,
                            n = true
                        }
                }
                !t && n && this.context.nima.captureJournalEntry()
            }
        }, {
            key: "toggleEnabled",
            value: function(e) {
                for (var t = false, n = 0; n < this.items.length; n++) {
                    var i = this.items[n];
                    i.node && (i.node.isCollisionEnabled = e,
                    t = true)
                }
                t && this.context.nima.captureJournalEntry()
            }
        }, {
            key: "commit",
            value: function() {
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "setEnabledKey",
            value: function() {
                for (var e = 0; e < this.items.length; e++) {
                    var t = this.items[e];
                    this.context.nima.editingAnimation.toggleKey(t.node, "frameIsCollisionEnabled")
                }
                this.context.nima.captureJournalEntry(),
                this.forceUpdate()
            }
        }, {
            key: "render",
            value: function() {
                var e = l.default.validate(t.Validation, this.items)
                  , n = this.props.selectionPanel
                  , i = this.props.isAnimating
                  , r = -1;
                if (this.items && this.items.length) {
                    r = this.items[0].node.shape;
                    for (var a = 1; a < this.items.length; a++) {
                        if (r != this.items[a].node.shape) {
                            r = -1;
                            break
                        }
                    }
                }
                return o.default.createElement(h.default, {
                    label: "Collider Options",
                    _key: "_ColliderOpts"
                }, o.default.createElement("div", {
                    className: "SelectionPanelProperty",
                    style: {
                        marginTop: "8px"
                    }
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitleSwitch"
                }, "Enabled"), o.default.createElement(d.default, {
                    isOn: e.enabled,
                    onToggle: this.toggleEnabled,
                    keyState: e.enabledKeyState,
                    isAnimating: i,
                    onSetKey: this.setEnabledKey
                })), i ? null : o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Shape"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(u.default, {
                    options: p.default.ShapeNames,
                    selectedIndex: r,
                    onSelectionChanged: this.changeShape
                }))), !i && e.hasWidth ? o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Width"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(f.default, {
                    value: e.width,
                    readOnly: i,
                    onValueChanged: this.setWidth,
                    onValueCommit: this.commit
                }))) : null, !i && e.hasHeight ? o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Height"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(f.default, {
                    value: e.height,
                    readOnly: i,
                    onValueChanged: this.setHeight,
                    onValueCommit: this.commit
                }))) : null, !i && e.hasRadius ? o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Radius"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(f.default, {
                    value: e.radius,
                    readOnly: i,
                    onValueChanged: this.setRadius,
                    onValueCommit: this.commit
                }))) : null, !i && e.hasMeshEditor ? o.default.createElement(c.default, {
                    label: "Edit Shape",
                    onPress: n.editMeshOn
                }) : null)
            }
        }]),
        t
    }(o.default.Component)).prototype, "onUpdateCollider", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onUpdateCollider"), i.prototype),
    v(i.prototype, "changeShape", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeShape"), i.prototype),
    v(i.prototype, "setWidth", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setWidth"), i.prototype),
    v(i.prototype, "setHeight", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setHeight"), i.prototype),
    v(i.prototype, "setRadius", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setRadius"), i.prototype),
    v(i.prototype, "toggleEnabled", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleEnabled"), i.prototype),
    v(i.prototype, "commit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "commit"), i.prototype),
    v(i.prototype, "setEnabledKey", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setEnabledKey"), i.prototype),
    i);
    t.default = g,
    g.validate = function(e, t) {
        return true
    }
    ,
    g.Validation = {
        shape: {
            validate: function(e) {
                return e.node && e.node.shape
            }
        },
        enabledKeyState: {
            validate: function(e) {
                return !!e.node && e.node.frameIsCollisionEnabledKS
            }
        },
        enabled: {
            validate: function(e) {
                return !!e.node && e.node.isCollisionEnabled
            }
        },
        hasWidth: {
            validate: function(e) {
                if (!e.node)
                    return false;
                switch (e.node.shape) {
                case p.default.Shape.Rectangle:
                case p.default.Shape.Triangle:
                    return true;
                default:
                    return false
                }
            }
        },
        width: {
            validate: function(e) {
                if (!e.node)
                    return false;
                switch (e.node.shape) {
                case p.default.Shape.Rectangle:
                case p.default.Shape.Triangle:
                    return e.node.width;
                default:
                    return false
                }
            }
        },
        hasHeight: {
            validate: function(e) {
                if (!e.node)
                    return false;
                switch (e.node.shape) {
                case p.default.Shape.Rectangle:
                case p.default.Shape.Triangle:
                    return true;
                default:
                    return false
                }
            }
        },
        height: {
            validate: function(e) {
                if (!e.node)
                    return false;
                switch (e.node.shape) {
                case p.default.Shape.Rectangle:
                case p.default.Shape.Triangle:
                    return e.node.height;
                default:
                    return false
                }
            }
        },
        hasRadius: {
            validate: function(e) {
                if (!e.node)
                    return false;
                switch (e.node.shape) {
                case p.default.Shape.Circle:
                    return true;
                default:
                    return false
                }
            }
        },
        radius: {
            validate: function(e) {
                if (!e.node)
                    return false;
                switch (e.node.shape) {
                case p.default.Shape.Circle:
                    return e.node.radius;
                default:
                    return false
                }
            }
        },
        hasMeshEditor: {
            validate: function(e) {
                if (!e.node)
                    return false;
                switch (e.node.shape) {
                case p.default.Shape.Line:
                case p.default.Shape.Polygon:
                    return true;
                default:
                    return false
                }
            }
        }
    },
    g.canMultiEdit = true,
    g.panelOrder = 2,
    g.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = S(n(0)), a = S(n(1)), s = S(n(4)), l = S(n(348)), u = S(n(264)), c = S(n(316)), d = S(n(347)), h = S(n(382)), f = S(n(445)), p = S(n(261)), y = S(n(710)), m = S(n(711)), v = S(n(1141)), g = S(n(1142)), _ = S(n(13)), b = S(n(263)), w = S(n(582)), O = S(n(208));
    function S(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function k(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var P = (k((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {},
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "itemPropertiesUpdated",
            value: function() {
                (0,
                _.default)(this.revalidate)
            }
        }, {
            key: "revalidate",
            value: function() {
                this.forceUpdate()
            }
        }, {
            key: "setItems",
            value: function(e) {
                if (!(0,
                b.default)(this.items, e)) {
                    if (this.items)
                        for (var t = 0; t < this.items.length; t++) {
                            var n = this.items[t];
                            n.node && (n.node.removeEventListener("displayChange", this.itemPropertiesUpdated),
                            n.node.removeEventListener("opacityChange", this.itemPropertiesUpdated),
                            n.node.removeEventListener("worldTransform", this.itemPropertiesUpdated),
                            n.node.removeEventListener("sequenceChange", this.itemPropertiesUpdated),
                            n.node.removeEventListener("keyState", this.itemPropertiesUpdated))
                        }
                    if (this.items = e,
                    e)
                        for (var i = 0; i < e.length; i++) {
                            var r = e[i];
                            r.node && (r.node.addEventListener("displayChange", this.itemPropertiesUpdated),
                            r.node.addEventListener("opacityChange", this.itemPropertiesUpdated),
                            r.node.addEventListener("worldTransform", this.itemPropertiesUpdated),
                            r.node.addEventListener("sequenceChange", this.itemPropertiesUpdated),
                            r.node.addEventListener("keyState", this.itemPropertiesUpdated))
                        }
                }
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.stageItems != this.props.stageItems && this.setItems(e.stageItems)
            }
        }, {
            key: "componentWillMount",
            value: function() {
                this.setItems(this.props.stageItems)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setItems(null),
                _.default.cancel(this.revalidate)
            }
        }, {
            key: "changeSequence",
            value: function(e, t) {
                for (var n = 0; n < this.items.length; n++) {
                    var i = this.items[n]
                      , r = new m.default(this.context.nima.stage,this.context.nima.actor,i,e);
                    r.silent = true,
                    r.start(),
                    r.end()
                }
                t || this.context.nima.captureJournalEntry()
            }
        }, {
            key: "changeOpacity",
            value: function(e, t) {
                for (var n = 0; n < this.items.length; n++) {
                    var i = this.items[n]
                      , r = new y.default(this.context.nima.stage,this.context.nima.actor,i,e);
                    r.silent = true,
                    r.start(),
                    r.end()
                }
                t || this.context.nima.captureJournalEntry()
            }
        }, {
            key: "changeDisplayType",
            value: function(e) {
                if (!(e < 0)) {
                    var t = E[e]
                      , n = true
                      , i = false
                      , r = void 0;
                    try {
                        for (var o, a = this.items[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                            var s = o.value;
                            s.node && s.node.constructor === O.default && (s.node.displayType = t.type)
                        }
                    } catch (e) {
                        i = true,
                        r = e
                    } finally {
                        try {
                            !n && a.return && a.return()
                        } finally {
                            if (i)
                                throw r
                        }
                    }
                    this.context.nima.captureJournalEntry()
                }
            }
        }, {
            key: "updateBlendMode",
            value: function(e) {
                for (var t = 0; t < this.items.length; t++) {
                    var n = this.items[t]
                      , i = new v.default(this.context.nima.stage,this.context.nima.actor,n,e);
                    i.silent = true,
                    i.start(),
                    i.end()
                }
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "keyOpacity",
            value: function(e) {
                for (var t = 0; t < this.items.length; t++) {
                    var n = this.items[t];
                    this.context.nima.editingAnimation.toggleKey(n.node, "frameOpacity")
                }
                this.context.nima.captureJournalEntry(),
                this.forceUpdate()
            }
        }, {
            key: "keySequence",
            value: function(e) {
                for (var t = 0; t < this.items.length; t++) {
                    var n = this.items[t];
                    this.context.nima.editingAnimation.toggleKey(n.node, "frameSequence")
                }
                this.context.nima.captureJournalEntry(),
                this.forceUpdate()
            }
        }, {
            key: "commit",
            value: function() {
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "render",
            value: function() {
                var e = l.default.validate(t.Validation, this.items)
                  , n = this.props.isAnimating
                  , i = this.props.disableInput;
                return o.default.createElement(u.default, {
                    label: "Render Options",
                    _key: "_RenderOpts"
                }, false !== e.displayTypeIndex ? o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Display"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(c.default, {
                    options: E,
                    selectedIndex: e.displayTypeIndex,
                    onSelectionChanged: this.changeDisplayType
                }))) : null, e.hasBlendMode && !n ? o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Blend"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(c.default, {
                    options: t.blendModes,
                    selectedIndex: e.blendIndex,
                    onSelectionChanged: this.updateBlendMode
                }))) : null, o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Opacity"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(d.default, {
                    value: e.opacity,
                    converter: g.default,
                    keyState: e.keyOpacity,
                    isAnimating: n,
                    onValueChanged: this.changeOpacity,
                    onValueCommit: this.commit,
                    disabled: i,
                    onSetKey: this.keyOpacity
                }))), e.hasSequence ? o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Frame"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(d.default, {
                    value: e.sequence,
                    keyState: e.keySequence,
                    isAnimating: n,
                    onValueChanged: this.changeSequence,
                    dragScale: 1,
                    onValueCommit: this.commit,
                    disabled: i,
                    onSetKey: this.keySequence
                }))) : null)
            }
        }]),
        t
    }(o.default.Component)).prototype, "itemPropertiesUpdated", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "itemPropertiesUpdated"), i.prototype),
    k(i.prototype, "revalidate", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "revalidate"), i.prototype),
    k(i.prototype, "changeSequence", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeSequence"), i.prototype),
    k(i.prototype, "changeOpacity", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeOpacity"), i.prototype),
    k(i.prototype, "changeDisplayType", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeDisplayType"), i.prototype),
    k(i.prototype, "updateBlendMode", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "updateBlendMode"), i.prototype),
    k(i.prototype, "keyOpacity", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "keyOpacity"), i.prototype),
    k(i.prototype, "keySequence", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "keySequence"), i.prototype),
    k(i.prototype, "commit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "commit"), i.prototype),
    i);
    t.default = P,
    P.blendModes = ["Normal", "Multiply", "Screen", "Linear Dodge (Add)"],
    P.validate = function(e, t) {
        var n = l.default.validate(P.Validation, t);
        return !(!n.hasOpacity && !n.hasBlendMode) && n
    }
    ;
    var E = [{
        label: "Empty",
        type: w.default.Empty
    }, {
        label: "Target",
        type: w.default.Target
    }];
    P.Validation = {
        hasOpacity: {
            validate: function(e) {
                switch (e.constructor) {
                case h.default:
                    return false
                }
                return true
            }
        },
        opacity: {
            validate: function(e) {
                return e.node ? e.node.opacity : 1
            },
            equals: function(e, t) {
                return l.default.isValue(e) && l.default.isValue(t) && e.constructor === Number && t.constructor === Number && Math.round(100 * e) === Math.round(100 * t)
            }
        },
        keyOpacity: {
            validate: function(e) {
                return e && e.node && e.node.frameOpacityKS
            }
        },
        hasBlendMode: {
            validate: function(e) {
                return e.constructor === p.default
            }
        },
        blendIndex: {
            validate: function(e) {
                return e && e.node && e.node.blendMode
            }
        },
        hasSequence: {
            validate: function(e) {
                return e.constructor === p.default && e.node && e.node.asset instanceof f.default
            }
        },
        sequence: {
            validate: function(e) {
                return e && e.node && e.node.sequence
            }
        },
        keySequence: {
            validate: function(e) {
                return e && e.node && e.node.frameSequenceKS
            }
        },
        displayTypeIndex: {
            validate: function(e) {
                var t = e.node;
                return !(!t || t.constructor !== O.default) && E.findIndex((function(e) {
                    return e.type === t.displayType
                }
                ))
            }
        }
    },
    P.canMultiEdit = true,
    P.panelOrder = 2,
    P.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = n(314);
    var o = function(e) {
        function t(e, n, i, r) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var o = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e, n));
            return o._StageItem = i,
            o._StageItem.node.blendMode = r,
            o
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        t
    }(((i = r) && i.__esModule ? i : {
        default: i
    }).default);
    t.default = o
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    });
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }();
    var r = function() {
        function e() {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e)
        }
        return i(e, null, [{
            key: "toDisplayValue",
            value: function(e) {
                return Math.floor(100 * e) / 100
            }
        }, {
            key: "toInputValue",
            value: function(e) {
                return e
            }
        }, {
            key: "fromDisplayValue",
            value: function(e) {
                var t = Number.parseFloat(e);
                if (t < 0)
                    throw "Invalid input";
                return t
            }
        }, {
            key: "fromInputValue",
            value: function(e) {
                return this.fromDisplayValue(e)
            }
        }, {
            key: "defaultValue",
            get: function() {
                return 1
            }
        }, {
            key: "allowDrag",
            get: function() {
                return true
            }
        }, {
            key: "dragScale",
            get: function() {
                return .005
            }
        }, {
            key: "dragFastScale",
            get: function() {
                return .01
            }
        }, {
            key: "dragMin",
            get: function() {
                return 0
            }
        }, {
            key: "dragMax",
            get: function() {
                return 1
            }
        }]),
        e
    }();
    t.default = r
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = d(n(0)), a = d(n(1)), s = d(n(4)), l = d(n(264)), u = d(n(310)), c = d(n(263));
    function d(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function h(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var f = (h((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                hasFilter: true,
                showBorder: true
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "showBorderChange",
            value: function(e) {
                this.setState({
                    showBorder: e
                })
            }
        }, {
            key: "filteringChange",
            value: function(e) {
                this.setState({
                    hasFilter: e
                })
            }
        }, {
            key: "setImageAssets",
            value: function(e) {
                if (!(0,
                c.default)(this.imageAssets, e)) {
                    if (this.imageAssets)
                        for (var t = 0; t < this.imageAssets.length; t++) {
                            var n = this.imageAssets[t];
                            n.removeEventListener("filteringChange", this.filteringChange),
                            n.removeEventListener("showBorderChange", this.showBorderChange)
                        }
                    if (this.imageAssets = e,
                    e) {
                        for (var i = true, r = true, o = 0; o < this.imageAssets.length; o++) {
                            var a = this.imageAssets[o];
                            a.isFilteringEnabled || (i = false),
                            a.showBorder || (r = false),
                            a.addEventListener("filteringChange", this.filteringChange),
                            a.addEventListener("showBorderChange", this.showBorderChange)
                        }
                        this.setState({
                            hasFilter: i,
                            showBorder: r
                        })
                    }
                }
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.stageItems != this.props.stageItems && this.setImageAssets(e.stageItems)
            }
        }, {
            key: "componentWillMount",
            value: function() {
                this.setImageAssets(this.props.stageItems)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setImageAssets(null)
            }
        }, {
            key: "toggleFilter",
            value: function(e) {
                if (this.imageAssets) {
                    for (var t = 0; t < this.imageAssets.length; t++) {
                        this.imageAssets[t].isFilteringEnabled = e
                    }
                    this.context.nima.captureJournalEntry()
                }
            }
        }, {
            key: "toggleShowBorder",
            value: function(e) {
                if (this.imageAssets) {
                    for (var t = 0; t < this.imageAssets.length; t++) {
                        this.imageAssets[t].showBorder = e
                    }
                    this.context.nima.captureJournalEntry()
                }
            }
        }, {
            key: "render",
            value: function() {
                return o.default.createElement("div", null, o.default.createElement(l.default, {
                    _key: "_IAFilteringOpts",
                    label: "Filtering Options"
                }, o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitleSwitch"
                }, "Linear"), o.default.createElement(u.default, {
                    isOn: this.state.hasFilter,
                    onToggle: this.toggleFilter
                }))), o.default.createElement(l.default, {
                    _key: "_IAEditorOpts",
                    label: "Editor Options"
                }, o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitleSwitch"
                }, "Show Border"), o.default.createElement(u.default, {
                    isOn: this.state.showBorder,
                    onToggle: this.toggleShowBorder
                }))))
            }
        }]),
        t
    }(o.default.Component)).prototype, "showBorderChange", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "showBorderChange"), i.prototype),
    h(i.prototype, "filteringChange", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "filteringChange"), i.prototype),
    h(i.prototype, "toggleFilter", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleFilter"), i.prototype),
    h(i.prototype, "toggleShowBorder", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleShowBorder"), i.prototype),
    i);
    t.default = f,
    f.canMultiEdit = true,
    f.validate = function(e, t) {
        return !e.state.isAnimationOpen
    }
    ,
    f.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = _(n(0)), a = _(n(1)), s = _(n(4)), l = _(n(264)), u = _(n(310)), c = _(n(197)), d = _(n(720)), h = _(n(606)), f = _(n(201)), p = _(n(372)), y = _(n(462)), m = _(n(184)), v = _(n(263)), g = _(n(3));
    function _(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function b(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var w = (b((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                isMesh: false,
                areWeightsEnabled: false,
                hasVertexDeformation: false
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "connectedBoneChange",
            value: function() {
                this.connectBones(this.image)
            }
        }, {
            key: "useCustomMeshChange",
            value: function() {
                this.setState({
                    isMesh: this.image.useCustomMesh
                })
            }
        }, {
            key: "useVertexDeformChange",
            value: function() {
                this.hasVertexDeformation = this.image.useVertexDeform,
                this.setState({
                    hasVertexDeformation: this.image.useVertexDeform
                })
            }
        }, {
            key: "keyStateChanged",
            value: function(e) {
                this.forceUpdate()
            }
        }, {
            key: "connectBones",
            value: function(e) {
                this.setState({
                    areWeightsEnabled: e && e.connectedBones.length > 0
                })
            }
        }, {
            key: "connectSelectedBones",
            value: function() {
                for (var e = this.context.nima.stage.selectedItems, t = [], n = 0; n < e.length; n++) {
                    var i = e[n];
                    i.node instanceof y.default && t.push(i.node)
                }
                if (this.image) {
                    for (var r = [], o = 0; o < this.image.connectedBones.length; o++)
                        r.push(this.image.connectedBones[o].node);
                    for (var a = 0; a < r.length; a++) {
                        var s = r[a];
                        -1 === t.indexOf(s) && this.image.disconnectBone(s, true)
                    }
                    for (var l = 0; l < t.length; l++) {
                        for (var u = t[l], c = false, d = 0; d < c.length; d++)
                            if (c[d].node === u) {
                                c = true;
                                break
                            }
                        c || this.image.connectBone(u, true)
                    }
                    this.setState({
                        areWeightsEnabled: this.image.connectedBones.length > 0
                    })
                }
                this.cancelConnectBone(),
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "cancelConnectBone",
            value: function() {
                var e = this.context.nima.stage;
                if (this.connectAlert && this.image) {
                    var t = this.image;
                    this.connectAlert.hide(),
                    this.connectAlert = null,
                    e.removeEventListener("selectionChanged", this.stageSelectionChanged),
                    this.context.nima.editor.clearHoldSelectedItem(t.stageItem),
                    e.selectItems([t.stageItem], false)
                }
                var n = this._ConnectableBones;
                if (n) {
                    var i = true
                      , r = false
                      , o = void 0;
                    try {
                        for (var a, s = n[Symbol.iterator](); !(i = (a = s.next()).done); i = true) {
                            var l = a.value;
                            l instanceof f.default && (l.hideHelpers = false)
                        }
                    } catch (e) {
                        r = true,
                        o = e
                    } finally {
                        try {
                            !i && s.return && s.return()
                        } finally {
                            if (r)
                                throw o
                        }
                    }
                    this._ConnectableBones = null
                }
                e.clearSoloItems(),
                this.context.nima.clearCancelCallback(this.cancelConnectBone),
                e.toolType === h.default && e.tool.close()
            }
        }, {
            key: "stageSelectionChanged",
            value: function() {
                if (this.connectAlert) {
                    for (var e = this.context.nima.stage.selectedItems, t = false, n = 0; n < e.length; n++) {
                        if (e[n].node instanceof y.default) {
                            t = true;
                            break
                        }
                    }
                    this.connectAlert.enableButton(1, t),
                    this.connectAlert.accentButton(1, t)
                }
            }
        }, {
            key: "connectBone",
            value: function() {
                if (!this.connectAlert && this.image) {
                    var e = this.context.nima.stage.getTypeItems([f.default, p.default])
                      , t = true
                      , n = false
                      , i = void 0;
                    try {
                        for (var r, o = e[Symbol.iterator](); !(t = (r = o.next()).done); t = true) {
                            var a = r.value;
                            a instanceof f.default && (a.hideHelpers = true)
                        }
                    } catch (e) {
                        n = true,
                        i = e
                    } finally {
                        try {
                            !t && o.return && o.return()
                        } finally {
                            if (n)
                                throw i
                        }
                    }
                    this._ConnectableBones = e,
                    this.context.nima.editor.holdSelectedItem(this.image.stageItem),
                    this.context.nima.stage.setSoloItems(e),
                    this.context.nima.setCancelCallback(this.cancelConnectBone);
                    for (var s = this.image.connectedBones, l = [], u = 0; u < s.length; u++)
                        l.push(s[u].node.stageItem);
                    this.context.nima.stage.selectItems(l),
                    this.context.nima.stage.addEventListener("selectionChanged", this.stageSelectionChanged),
                    this.context.nima.stage.toolType = h.default;
                    var c = this;
                    this.connectAlert = this.context.nima.alert({
                        title: "Select Bones",
                        message: "Select bones that will be used to deform the image.",
                        type: m.default.Types.State,
                        buttons: [{
                            label: "CANCEL",
                            action: function(e, t) {
                                c.cancelConnectBone()
                            }
                        }, {
                            label: "DONE",
                            isDisabled: true,
                            action: function(e, t) {
                                c.connectSelectedBones()
                            }
                        }]
                    }),
                    this.stageSelectionChanged()
                }
            }
        }, {
            key: "toggleMesh",
            value: function(e) {
                this.enableMesh(e),
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "enableMesh",
            value: function(e) {
                this.isMesh !== e && (this.isMesh = e,
                this.image.useCustomMesh = e)
            }
        }, {
            key: "toggleVertexDeformation",
            value: function(e) {
                this.enableVertexDeform(e),
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "enableVertexDeform",
            value: function(e) {
                this.hasVertexDeformation !== e && (this.hasVertexDeformation = e,
                this.image.useVertexDeform = e)
            }
        }, {
            key: "setItems",
            value: function(e) {
                (0,
                v.default)(this.items, e) || (this.image && (this.image.removeEventListener("connectedBoneChange", this.connectedBoneChange),
                this.image.removeEventListener("useCustomMeshChange", this.useCustomMeshChange),
                this.image.removeEventListener("useVertexDeformChange", this.useVertexDeformChange),
                this.image.removeEventListener("keyState", this.keyStateChanged),
                this.connectBones(null)),
                this.items = e,
                this.image = e && e[0].node,
                this.image && (this.image.addEventListener("connectedBoneChange", this.connectedBoneChange),
                this.image.addEventListener("useCustomMeshChange", this.useCustomMeshChange),
                this.image.addEventListener("useVertexDeformChange", this.useVertexDeformChange),
                this.image.addEventListener("keyState", this.keyStateChanged),
                this.isMesh = this.image.useCustomMesh,
                this.hasVertexDeformation = this.image.useVertexDeform,
                this.setState({
                    isMesh: this.image.useCustomMesh,
                    hasVertexDeformation: this.image.useVertexDeform
                }),
                this.connectBones(this.image)))
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.stageItems != this.props.stageItems && this.setItems(e.stageItems)
            }
        }, {
            key: "componentWillMount",
            value: function() {
                this.setItems(this.props.stageItems)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setItems(null)
            }
        }, {
            key: "setKey",
            value: function() {
                this.context.nima.editingAnimation.toggleKey(this.image, "frameVertices")
            }
        }, {
            key: "render",
            value: function() {
                var e = this.image
                  , t = this.props.selectionPanel
                  , n = this.props.isAnimating;
                if (!e)
                    return o.default.createElement("div", null);
                var i = []
                  , r = e && e.connectedBones;
                if (r)
                    for (var a = 0; a < r.length; a++) {
                        var s = r[a];
                        i.push(o.default.createElement(d.default, {
                            allowDisconnect: true,
                            key: s.node.refId,
                            bone: s.node,
                            image: e
                        }))
                    }
                var h = void 0;
                switch (e.frameVerticesKS) {
                case 0:
                    h = "SelectionPanelKey";
                    break;
                case 1:
                    h = "SelectionPanelKeyChanged";
                    break;
                case 2:
                    h = "SelectionPanelKeyed"
                }
                return o.default.createElement(l.default, {
                    _key: "_MeshOpts",
                    label: "Mesh",
                    action: n ? null : o.default.createElement(u.default, {
                        isOn: this.state.isMesh,
                        onToggle: this.toggleMesh
                    })
                }, o.default.createElement("div", {
                    className: "EditMeshOptions",
                    style: {
                        opacity: this.state.isMesh ? 1 : .4,
                        pointerEvents: this.state.isMesh ? "all" : "none"
                    }
                }, n ? o.default.createElement("div", {
                    className: "SelectionPanelProperty",
                    style: {
                        paddingTop: "10px"
                    }
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitleSwitch"
                }, "Vertex Deform"), o.default.createElement("div", {
                    className: h,
                    onMouseDown: this.setKey
                }, o.default.createElement("div", null))) : o.default.createElement("div", null, o.default.createElement(c.default, {
                    label: "Edit Mesh",
                    onPress: t.editMeshOn
                }), o.default.createElement(c.default, {
                    label: "Edit Weights",
                    disabled: !this.state.areWeightsEnabled,
                    onPress: t.editWeightsOn
                }), o.default.createElement("div", {
                    className: "SelectionPanelProperty",
                    style: {
                        paddingTop: "10px"
                    }
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitleSwitch"
                }, "Vertex Deform"), o.default.createElement(u.default, {
                    isOn: this.state.hasVertexDeformation,
                    onToggle: this.toggleVertexDeformation
                })), o.default.createElement("div", {
                    onClick: this.connectBone,
                    className: "SelectionPanelButton MeshBonesHeader",
                    style: {
                        borderRadius: r.length > 0 ? null : "20px"
                    }
                }, o.default.createElement("span", null, "Connected Bones"), o.default.createElement("svg", {
                    className: "AddButton"
                }, o.default.createElement("use", {
                    xlinkHref: g.default.make("/images/symbol-defs.svg#icon-plus")
                }))), i)))
            }
        }]),
        t
    }(o.default.Component)).prototype, "connectedBoneChange", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "connectedBoneChange"), i.prototype),
    b(i.prototype, "useCustomMeshChange", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "useCustomMeshChange"), i.prototype),
    b(i.prototype, "useVertexDeformChange", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "useVertexDeformChange"), i.prototype),
    b(i.prototype, "keyStateChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "keyStateChanged"), i.prototype),
    b(i.prototype, "cancelConnectBone", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "cancelConnectBone"), i.prototype),
    b(i.prototype, "stageSelectionChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "stageSelectionChanged"), i.prototype),
    b(i.prototype, "connectBone", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "connectBone"), i.prototype),
    b(i.prototype, "toggleMesh", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleMesh"), i.prototype),
    b(i.prototype, "toggleVertexDeformation", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleVertexDeformation"), i.prototype),
    b(i.prototype, "setKey", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setKey"), i.prototype),
    i);
    t.default = w,
    w.validate = function(e, t) {
        return !e.state.isAnimationOpen || !(1 !== t.length || !t[0] || !t[0].node.useVertexDeform)
    }
    ,
    w.canMultiEdit = false,
    w.panelOrder = 3,
    w.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = p(n(0)), a = p(n(1)), s = p(n(4)), l = p(n(264)), u = p(n(607)), c = p(n(448)), d = p(n(463)), h = p(n(263)), f = p(n(3));
    function p(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function y(e, t) {
        if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function")
    }
    function m(e, t) {
        if (!e)
            throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    function v(e, t) {
        if ("function" != typeof t && null !== t)
            throw new TypeError("Super expression must either be null or a function, not " + typeof t);
        e.prototype = Object.create(t && t.prototype, {
            constructor: {
                value: e,
                enumerable: false,
                writable: true,
                configurable: true
            }
        }),
        t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
    }
    function g(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var _ = (g((i = function(e) {
        function t(e) {
            y(this, t);
            var n = m(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {},
            n
        }
        return v(t, e),
        r(t, [{
            key: "hasContrastChange",
            value: function(e) {
                this.setState({
                    hasContrast: e
                })
            }
        }, {
            key: "setEventItems",
            value: function(e) {
                (0,
                h.default)(this.eventItems, e) || (this.eventNode && this.eventNode.removeEventListener("childrenChanged", this.onChildrenChanged),
                this.eventItems = e,
                e && e.length ? this.eventNode = e[0].node : this.eventNode = null,
                this.eventNode && this.eventNode.addEventListener("childrenChanged", this.onChildrenChanged),
                this.forceUpdate())
            }
        }, {
            key: "onChildrenChanged",
            value: function() {
                this.forceUpdate()
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.stageItems != this.props.stageItems && this.setEventItems(e.stageItems)
            }
        }, {
            key: "componentDidMount",
            value: function() {
                this.setEventItems(this.props.stageItems)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setEventItems(null)
            }
        }, {
            key: "addEvent",
            value: function() {
                var e = this.context.nima.actor.addNodeType(c.default, this.eventNode, {});
                e ? (e.stageItem.addToStage(this.context.nima.stage),
                this.context.nima.captureJournalEntry()) : console.error("Unable to make event.")
            }
        }, {
            key: "deleteEvent",
            value: function(e) {
                var t = new d.default(this.context.nima.stage,this.context.nima.actor,[e.stageItem],[]);
                t.start(),
                t.end()
            }
        }, {
            key: "setKey",
            value: function(e) {
                this.context.nima.editingAnimation.toggleKey(e, "frameTrigger"),
                this.context.nima.captureJournalEntry(),
                this.forceUpdate()
            }
        }, {
            key: "render",
            value: function() {
                var e = []
                  , t = this.eventNode;
                if (t && t.children) {
                    var n = this.props.isAnimating
                      , i = true
                      , r = false
                      , a = void 0;
                    try {
                        for (var s, u = t.children[Symbol.iterator](); !(i = (s = u.next()).done); i = true) {
                            var d = s.value;
                            d instanceof c.default && e.push(o.default.createElement(b, {
                                key: d.refId,
                                item: d,
                                isAnimating: n,
                                setKey: this.setKey,
                                onDelete: this.deleteEvent
                            }))
                        }
                    } catch (e) {
                        r = true,
                        a = e
                    } finally {
                        try {
                            !i && u.return && u.return()
                        } finally {
                            if (r)
                                throw a
                        }
                    }
                }
                return o.default.createElement(l.default, {
                    _key: "_EventOpts",
                    label: "Events",
                    className: "EventsContent",
                    action: this.props.isAnimating ? null : o.default.createElement("svg", {
                        className: "AddButton",
                        onClick: this.addEvent
                    }, o.default.createElement("use", {
                        xlinkHref: f.default.make("/images/symbol-defs.svg#icon-plus")
                    }))
                }, e.length > 0 ? e : o.default.createElement("div", {
                    className: "SelectionPanelEmptyMsg"
                }, "No events"))
            }
        }]),
        t
    }(o.default.Component)).prototype, "hasContrastChange", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "hasContrastChange"), i.prototype),
    g(i.prototype, "onChildrenChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onChildrenChanged"), i.prototype),
    g(i.prototype, "addEvent", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "addEvent"), i.prototype),
    g(i.prototype, "deleteEvent", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "deleteEvent"), i.prototype),
    g(i.prototype, "setKey", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setKey"), i.prototype),
    i);
    t.default = _;
    var b = function(e) {
        function t() {
            return y(this, t),
            m(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments))
        }
        return v(t, e),
        r(t, [{
            key: "keyState",
            get: function() {
                return this.item.frameTriggerKS
            }
        }]),
        t
    }(u.default);
    _.validate = function(e, t) {
        if (e.state.isAnimationOpen) {
            if (1 === t.length)
                for (var n = t[0].node, i = n.children.length - 1; i >= 0; i--) {
                    if (n.children[i].constructor === c.default)
                        return true
                }
            return false
        }
        return true
    }
    ,
    _.contextTypes = {
        nima: s.default.object
    },
    _.canMultiEdit = false,
    _.panelOrder = 4
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = v(n(0)), a = v(n(1)), s = v(n(4)), l = v(n(264)), u = v(n(310)), c = v(n(720)), d = v(n(606)), h = v(n(184)), f = v(n(201)), p = v(n(237)), y = v(n(263)), m = v(n(3));
    function v(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function g(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var _ = (g((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                invertDirection: false,
                isSingleMode: false
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "influencedBoneChange",
            value: function() {
                this.connectBones(this.constraint)
            }
        }, {
            key: "connectBones",
            value: function(e) {
                if (this.influencedBones)
                    for (var t = 0; t < this.influencedBones.length; t++)
                        this.influencedBones[t].isConnected = false;
                if (this.influencedBones = [],
                e)
                    for (var n = 0; n < e.influencedBones.length; n++) {
                        var i = e.influencedBones[n];
                        i.stageItem.isConnected = true,
                        this.influencedBones.push(i.stageItem)
                    }
                this.forceUpdate()
            }
        }, {
            key: "connectedBonesChanged",
            value: function() {
                this.connectBones(this.constraint),
                this.forceUpdate()
            }
        }, {
            key: "updateInvertDirection",
            value: function(e) {
                this.setState({
                    invertDirection: e
                })
            }
        }, {
            key: "strengthChange",
            value: function() {
                this.forceUpdate()
            }
        }, {
            key: "setConstraintItems",
            value: function(e) {
                if (!(0,
                y.default)(this.stageItems, e)) {
                    if (this.stageItems) {
                        if (1 === this.stageItems.length) {
                            var t = this.stageItems[0].node;
                            t.removeEventListener("influencedBoneChange", this.influencedBoneChange),
                            t.removeEventListener("connectedBonesChanged", this.connectedBonesChanged)
                        }
                        for (var n = 0; n < this.stageItems.length; n++) {
                            this.stageItems[n].node.removeEventListener("invertDirectionChange", this.updateInvertDirection)
                        }
                    }
                    this.stageItems = e;
                    var i = true;
                    if (this.constraint = null,
                    this.stageItems) {
                        if (1 === this.stageItems.length) {
                            var r = this.stageItems[0].node;
                            r.addEventListener("influencedBoneChange", this.influencedBoneChange),
                            r.addEventListener("connectedBonesChanged", this.connectedBonesChanged),
                            this.constraint = r,
                            this.connectBones(this.constraint)
                        } else
                            this.influencedBones = [];
                        for (var o = 0; o < this.stageItems.length; o++) {
                            var a = this.stageItems[o].node;
                            a.invertDirection || (i = false),
                            a.addEventListener("invertDirectionChange", this.updateInvertDirection)
                        }
                    } else
                        this.connectBones(null);
                    this.setState({
                        isSingleMode: this.stageItems && 1 === this.stageItems.length,
                        invertDirection: i
                    })
                }
            }
        }, {
            key: "connectSelectedBones",
            value: function() {
                var e = this
                  , t = this.context.nima.stage.selectedItems
                  , n = this.constraint
                  , i = n.parent;
                t.unshift(i.stageItem);
                for (var r = [], o = null, a = -1, s = [], l = 0; l < t.length; l++) {
                    var u = t[l];
                    u.constructor === f.default && (s.push(u.node),
                    u.joint.node.treeDepth > a && (a = u.node.treeDepth,
                    o = u.node))
                }
                if (o) {
                    r.push(o);
                    for (var c = 0; c < s.length; c++) {
                        var d = s[c];
                        o.isChildOf(d) && r.push(d)
                    }
                }
                n && function() {
                    for (var t = [], i = 0; i < n.influencedBones.length; i++)
                        t.push(n.influencedBones[i]);
                    for (var o = 0; o < t.length; o++) {
                        var a = t[o];
                        -1 === r.indexOf(a) && (n.removeBoneInfluence(a, true),
                        a.stageItem.isConnected = false)
                    }
                    e.influencedBones.length = 0;
                    for (var s = e, l = function(n) {
                        var i = r[n];
                        e.context.nima.detectDependencyCycles((function() {
                            -1 === t.indexOf(i) && (s.constraint.influenceBone(i, true),
                            i.stageItem.isConnected = true),
                            s.influencedBones.push(i.stageItem)
                        }
                        ))
                    }, u = 0; u < r.length; u++)
                        l(u)
                }(),
                this.cancelConnectBone();
                var h = n.influencedBones;
                if (h && h.length) {
                    var p = h[h.length - 1];
                    p !== n.parent && p.add(n)
                }
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "cancelConnectBone",
            value: function() {
                var e = this.context.nima.stage;
                if (this.connectAlert && this.constraint) {
                    var t = this.constraint;
                    this.connectAlert.hide(),
                    this.connectAlert = null,
                    e.removeEventListener("selectionChanged", this.stageSelectionChanged),
                    this.context.nima.editor.clearHoldSelectedItem(t.stageItem),
                    e.selectItems([t.stageItem], false)
                }
                e.clearSoloItems(),
                this.context.nima.clearCancelCallback(this.cancelConnectBone),
                e.toolType === d.default && e.tool.close()
            }
        }, {
            key: "getValidInfluenceBones",
            value: function() {
                if (!this.state.isSingleMode)
                    return [];
                for (var e = [], t = this.stageItems[0].node.parent.parent; t instanceof p.default; t = t.parent)
                    e.push(t.stageItem);
                return e
            }
        }, {
            key: "connectBone",
            value: function() {
                if (this.connectAlert)
                    console.log("ALREADY HAVE A CONNECT STATE");
                else if (this.constraint) {
                    var e = this.constraint
                      , t = this.context.nima;
                    t.editor.holdSelectedItem(this.constraint.stageItem),
                    t.stage.setSoloItems(this.getValidInfluenceBones()),
                    t.setCancelCallback(this.cancelConnectBone),
                    t.stage.selectItems(this.influencedBones.filter((function(t) {
                        return t.node !== e.parent
                    }
                    )));
                    var n = this;
                    t.stage.addEventListener("selectionChanged", this.stageSelectionChanged),
                    t.stage.toolType = d.default,
                    this.connectAlert = t.alert({
                        title: "Select Bones",
                        message: "Select bones from the same chain to be affected by the IK constraint.",
                        type: h.default.Types.State,
                        buttons: [{
                            label: "CANCEL",
                            action: function(e, t) {
                                n.cancelConnectBone()
                            }
                        }, {
                            label: "DONE",
                            isDisabled: true,
                            action: function(e, t) {
                                n.connectSelectedBones()
                            }
                        }]
                    }),
                    this.stageSelectionChanged()
                }
            }
        }, {
            key: "toggleInvertDirection",
            value: function(e) {
                if (this.stageItems) {
                    for (var t = 0; t < this.stageItems.length; t++) {
                        this.stageItems[t].node.invertDirection = e
                    }
                    this.context.nima.captureJournalEntry()
                }
            }
        }, {
            key: "stageSelectionChanged",
            value: function() {
                if (this.connectAlert) {
                    for (var e = this.context.nima.stage.selectedItems, t = false, n = 0; n < e.length; n++) {
                        if (e[n].constructor === f.default) {
                            t = true;
                            break
                        }
                    }
                    this.connectAlert.enableButton(1, t),
                    this.connectAlert.accentButton(1, t)
                }
            }
        }, {
            key: "keyStrength",
            value: function(e) {
                if (this.stageItems) {
                    for (var t = 0; t < this.stageItems.length; t++) {
                        var n = this.stageItems[t].node;
                        this.context.nima.editingAnimation.toggleKey(n, "frameStrength")
                    }
                    this.context.nima.captureJournalEntry(),
                    this.forceUpdate()
                }
            }
        }, {
            key: "changeStrength",
            value: function(e, t) {
                if (this.stageItems) {
                    for (var n = 0; n < this.stageItems.length; n++) {
                        this.stageItems[n].node.strength = e
                    }
                    t || this.context.nima.captureJournalEntry(),
                    this.forceUpdate()
                }
            }
        }, {
            key: "commit",
            value: function() {
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.stageItems != this.props.stageItems && this.setConstraintItems(e.stageItems)
            }
        }, {
            key: "componentWillMount",
            value: function() {
                this.setConstraintItems(this.props.stageItems)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setConstraintItems(null)
            }
        }, {
            key: "disconnectBone",
            value: function(e) {
                this.constraint.removeBoneInfluence(e),
                this.context.nima.stage.updateHighlights()
            }
        }, {
            key: "render",
            value: function() {
                var e = []
                  , t = this.influencedBones || []
                  , n = this.state.isSingleMode;
                if (n && t)
                    for (var i = this.stageItems[0].node, r = i.parent, a = 0; a < t.length; a++) {
                        var s = t[a].node;
                        e.push(o.default.createElement(c.default, {
                            allowDisconnect: s !== r,
                            key: s.refId,
                            bone: s,
                            constraint: i,
                            disconnect: this.disconnectBone
                        }))
                    }
                return o.default.createElement(l.default, {
                    label: "IK Options"
                }, o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitleSwitch"
                }, "Invert Direction"), o.default.createElement(u.default, {
                    isOn: this.state.invertDirection,
                    onToggle: this.toggleInvertDirection
                })), n ? o.default.createElement("div", null, o.default.createElement("div", {
                    onClick: this.connectBone,
                    className: "MeshBonesHeader",
                    style: {
                        borderRadius: t.length > 0 ? null : "20px"
                    }
                }, o.default.createElement("span", null, "Influenced Bones"), o.default.createElement("svg", {
                    className: "AddButton"
                }, o.default.createElement("use", {
                    xlinkHref: m.default.make("/images/symbol-defs.svg#icon-plus")
                }))), e) : null)
            }
        }]),
        t
    }(o.default.Component)).prototype, "influencedBoneChange", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "influencedBoneChange"), i.prototype),
    g(i.prototype, "connectedBonesChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "connectedBonesChanged"), i.prototype),
    g(i.prototype, "updateInvertDirection", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "updateInvertDirection"), i.prototype),
    g(i.prototype, "strengthChange", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "strengthChange"), i.prototype),
    g(i.prototype, "cancelConnectBone", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "cancelConnectBone"), i.prototype),
    g(i.prototype, "connectBone", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "connectBone"), i.prototype),
    g(i.prototype, "toggleInvertDirection", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleInvertDirection"), i.prototype),
    g(i.prototype, "stageSelectionChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "stageSelectionChanged"), i.prototype),
    g(i.prototype, "keyStrength", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "keyStrength"), i.prototype),
    g(i.prototype, "changeStrength", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeStrength"), i.prototype),
    g(i.prototype, "commit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "commit"), i.prototype),
    g(i.prototype, "disconnectBone", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "disconnectBone"), i.prototype),
    i);
    t.default = _,
    _.canMultiEdit = true,
    _.panelOrder = 3,
    _.validate = function(e, t) {
        return !e.state.isAnimationOpen
    }
    ,
    _.Validation = {},
    _.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = f(n(0)), a = f(n(1)), s = f(n(4)), l = f(n(348)), u = f(n(264)), c = f(n(316)), d = f(n(263)), h = f(n(357));
    function f(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function p(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var y = (p((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {},
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "updateTransformProperties",
            value: function() {
                this.forceUpdate()
            }
        }, {
            key: "setConstraintItems",
            value: function(e) {
                if (!(0,
                d.default)(this.stageItems, e)) {
                    if (this.stageItems)
                        for (var t = 0; t < this.stageItems.length; t++) {
                            this.stageItems[t].node.removeEventListener("changeTransformConstraint", this.updateTransformProperties)
                        }
                    if (this.stageItems = e,
                    this.constraint = null,
                    this.stageItems)
                        for (var n = 0; n < this.stageItems.length; n++) {
                            this.stageItems[n].node.addEventListener("changeTransformConstraint", this.updateTransformProperties)
                        }
                }
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.stageItems != this.props.stageItems && this.setConstraintItems(e.stageItems)
            }
        }, {
            key: "componentWillMount",
            value: function() {
                this.setConstraintItems(this.props.stageItems)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setConstraintItems(null)
            }
        }, {
            key: "changeSourceIndex",
            value: function(e) {
                if (!(e < 0)) {
                    var t = m[e]
                      , n = true
                      , i = false
                      , r = void 0;
                    try {
                        for (var o, a = this.stageItems[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                            var s = o.value;
                            s.node && (s.node.sourceSpace = t.space)
                        }
                    } catch (e) {
                        i = true,
                        r = e
                    } finally {
                        try {
                            !n && a.return && a.return()
                        } finally {
                            if (i)
                                throw r
                        }
                    }
                    this.context.nima.captureJournalEntry()
                }
            }
        }, {
            key: "changeDestIndex",
            value: function(e) {
                if (!(e < 0)) {
                    var t = m[e]
                      , n = true
                      , i = false
                      , r = void 0;
                    try {
                        for (var o, a = this.stageItems[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                            var s = o.value;
                            s.node && (s.node.destSpace = t.space)
                        }
                    } catch (e) {
                        i = true,
                        r = e
                    } finally {
                        try {
                            !n && a.return && a.return()
                        } finally {
                            if (i)
                                throw r
                        }
                    }
                    this.context.nima.captureJournalEntry()
                }
            }
        }, {
            key: "render",
            value: function() {
                var e = l.default.validate(t.Validation, this.stageItems)
                  , n = e.sourceSpaceIndex
                  , i = e.destSpaceIndex;
                return o.default.createElement(u.default, {
                    label: "Transform"
                }, o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Source Space"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(c.default, {
                    options: m,
                    selectedIndex: n,
                    onSelectionChanged: this.changeSourceIndex
                }))), o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Dest Space"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(c.default, {
                    options: m,
                    selectedIndex: i,
                    onSelectionChanged: this.changeDestIndex
                }))))
            }
        }]),
        t
    }(o.default.Component)).prototype, "updateTransformProperties", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "updateTransformProperties"), i.prototype),
    p(i.prototype, "changeSourceIndex", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeSourceIndex"), i.prototype),
    p(i.prototype, "changeDestIndex", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeDestIndex"), i.prototype),
    i);
    t.default = y;
    var m = [{
        label: "Local",
        space: h.default.Local
    }, {
        label: "World",
        space: h.default.World
    }];
    y.canMultiEdit = true,
    y.panelOrder = 3,
    y.validate = function(e, t) {
        return !e.state.isAnimationOpen && l.default.validate(y.Validation, t)
    }
    ,
    y.Validation = {
        sourceSpaceIndex: {
            validate: function(e) {
                var t = e.node;
                return !!t && m.findIndex((function(e) {
                    return e.space === t.sourceSpace
                }
                ))
            }
        },
        destSpaceIndex: {
            validate: function(e) {
                var t = e.node;
                return !!t && m.findIndex((function(e) {
                    return e.space === t.destSpace
                }
                ))
            }
        }
    },
    y.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = y(n(0)), a = y(n(1)), s = y(n(4)), l = y(n(348)), u = y(n(264)), c = y(n(316)), d = y(n(263)), h = n(514), f = y(n(347)), p = y(n(197));
    function y(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function m(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var v = (m((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {},
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "updateTransformProperties",
            value: function() {
                this.forceUpdate()
            }
        }, {
            key: "setConstraintItems",
            value: function(e) {
                if (!(0,
                d.default)(this.stageItems, e)) {
                    if (this.stageItems)
                        for (var t = 0; t < this.stageItems.length; t++) {
                            this.stageItems[t].node.removeEventListener("changeDistanceConstraint", this.updateTransformProperties)
                        }
                    if (this.stageItems = e,
                    this.constraint = null,
                    this.stageItems)
                        for (var n = 0; n < this.stageItems.length; n++) {
                            this.stageItems[n].node.addEventListener("changeDistanceConstraint", this.updateTransformProperties)
                        }
                }
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.stageItems != this.props.stageItems && this.setConstraintItems(e.stageItems)
            }
        }, {
            key: "componentWillMount",
            value: function() {
                this.setConstraintItems(this.props.stageItems)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setConstraintItems(null)
            }
        }, {
            key: "changeModeIndex",
            value: function(e) {
                if (!(e < 0)) {
                    var t = g[e]
                      , n = true
                      , i = false
                      , r = void 0;
                    try {
                        for (var o, a = this.stageItems[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                            var s = o.value;
                            s.node && (s.node.mode = t.mode)
                        }
                    } catch (e) {
                        i = true,
                        r = e
                    } finally {
                        try {
                            !n && a.return && a.return()
                        } finally {
                            if (i)
                                throw r
                        }
                    }
                    this.context.nima.captureJournalEntry()
                }
            }
        }, {
            key: "changeDistance",
            value: function(e, t) {
                var n = true
                  , i = false
                  , r = void 0;
                try {
                    for (var o, a = this.stageItems[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                        var s = o.value;
                        s.node && (s.node.distance = e)
                    }
                } catch (e) {
                    i = true,
                    r = e
                } finally {
                    try {
                        !n && a.return && a.return()
                    } finally {
                        if (i)
                            throw r
                    }
                }
                t || this.context.nima.captureJournalEntry()
            }
        }, {
            key: "setDistance",
            value: function() {
                var e = true
                  , t = false
                  , n = void 0;
                try {
                    for (var i, r = this.stageItems[Symbol.iterator](); !(e = (i = r.next()).done); e = true) {
                        var o = i.value;
                        o.node && o.node.resetDistance()
                    }
                } catch (e) {
                    t = true,
                    n = e
                } finally {
                    try {
                        !e && r.return && r.return()
                    } finally {
                        if (t)
                            throw n
                    }
                }
            }
        }, {
            key: "render",
            value: function() {
                var e = l.default.validate(t.Validation, this.stageItems)
                  , n = e.modeIndex
                  , i = e.distance;
                return o.default.createElement(u.default, {
                    label: "Transform"
                }, o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Mode"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(c.default, {
                    options: g,
                    selectedIndex: n,
                    onSelectionChanged: this.changeModeIndex
                }))), o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Distance"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(f.default, {
                    value: i,
                    keyState: 0,
                    isAnimating: false,
                    onValueChanged: this.changeDistance,
                    dragScale: 1,
                    onValueCommit: this.commit,
                    disabled: false,
                    onSetKey: null
                }))), o.default.createElement(p.default, {
                    label: "Use Current Distance",
                    onPress: this.setDistance
                }))
            }
        }]),
        t
    }(o.default.Component)).prototype, "updateTransformProperties", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "updateTransformProperties"), i.prototype),
    m(i.prototype, "changeModeIndex", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeModeIndex"), i.prototype),
    m(i.prototype, "changeDistance", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeDistance"), i.prototype),
    m(i.prototype, "setDistance", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setDistance"), i.prototype),
    i);
    t.default = v;
    var g = [{
        label: "Closer Than",
        mode: h.DistanceMode.Closer
    }, {
        label: "Further Than",
        mode: h.DistanceMode.Further
    }, {
        label: "Exactly",
        mode: h.DistanceMode.Exact
    }];
    v.canMultiEdit = true,
    v.panelOrder = 3,
    v.validate = function(e, t) {
        return !e.state.isAnimationOpen && l.default.validate(v.Validation, t)
    }
    ,
    v.Validation = {
        modeIndex: {
            validate: function(e) {
                var t = e.node;
                return !!t && g.findIndex((function(e) {
                    return e.mode === t.mode
                }
                ))
            }
        },
        distance: {
            validate: function(e) {
                var t = e.node;
                return !!t && t.distance
            }
        }
    },
    v.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = y(n(0)), a = y(n(1)), s = y(n(4)), l = y(n(348)), u = y(n(264)), c = y(n(316)), d = y(n(263)), h = y(n(357)), f = y(n(310)), p = y(n(721));
    function y(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function m(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var v = (m((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {},
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "updateTransformProperties",
            value: function() {
                this.forceUpdate()
            }
        }, {
            key: "setConstraintItems",
            value: function(e) {
                if (!(0,
                d.default)(this.stageItems, e)) {
                    if (this.stageItems)
                        for (var t = 0; t < this.stageItems.length; t++) {
                            this.stageItems[t].node.removeEventListener("changeConstraint", this.updateTransformProperties)
                        }
                    if (this.stageItems = e,
                    this.constraint = null,
                    this.stageItems)
                        for (var n = 0; n < this.stageItems.length; n++) {
                            this.stageItems[n].node.addEventListener("changeConstraint", this.updateTransformProperties)
                        }
                }
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.stageItems != this.props.stageItems && this.setConstraintItems(e.stageItems)
            }
        }, {
            key: "componentWillMount",
            value: function() {
                this.setConstraintItems(this.props.stageItems)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setConstraintItems(null)
            }
        }, {
            key: "changeSourceIndex",
            value: function(e) {
                if (!(e < 0)) {
                    var t = g[e]
                      , n = true
                      , i = false
                      , r = void 0;
                    try {
                        for (var o, a = this.stageItems[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                            var s = o.value;
                            s.node && (s.node.sourceSpace = t.space)
                        }
                    } catch (e) {
                        i = true,
                        r = e
                    } finally {
                        try {
                            !n && a.return && a.return()
                        } finally {
                            if (i)
                                throw r
                        }
                    }
                    this.context.nima.captureJournalEntry()
                }
            }
        }, {
            key: "changeDestIndex",
            value: function(e) {
                if (!(e < 0)) {
                    var t = g[e]
                      , n = true
                      , i = false
                      , r = void 0;
                    try {
                        for (var o, a = this.stageItems[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                            var s = o.value;
                            s.node && (s.node.destSpace = t.space)
                        }
                    } catch (e) {
                        i = true,
                        r = e
                    } finally {
                        try {
                            !n && a.return && a.return()
                        } finally {
                            if (i)
                                throw r
                        }
                    }
                    this.context.nima.captureJournalEntry()
                }
            }
        }, {
            key: "changeMinMaxIndex",
            value: function(e) {
                if (!(e < 0)) {
                    var t = g[e]
                      , n = true
                      , i = false
                      , r = void 0;
                    try {
                        for (var o, a = this.stageItems[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                            var s = o.value;
                            s.node && (s.node.minMaxSpace = t.space)
                        }
                    } catch (e) {
                        i = true,
                        r = e
                    } finally {
                        try {
                            !n && a.return && a.return()
                        } finally {
                            if (i)
                                throw r
                        }
                    }
                    this.context.nima.captureJournalEntry()
                }
            }
        }, {
            key: "toggleCopyX",
            value: function(e) {
                var t = true
                  , n = false
                  , i = void 0;
                try {
                    for (var r, o = this.stageItems[Symbol.iterator](); !(t = (r = o.next()).done); t = true) {
                        var a = r.value;
                        a.node && (a.node.copyX = e)
                    }
                } catch (e) {
                    n = true,
                    i = e
                } finally {
                    try {
                        !t && o.return && o.return()
                    } finally {
                        if (n)
                            throw i
                    }
                }
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "changeScaleX",
            value: function(e, t) {
                var n = true
                  , i = false
                  , r = void 0;
                try {
                    for (var o, a = this.stageItems[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                        var s = o.value;
                        s.node && (s.node.scaleX = e)
                    }
                } catch (e) {
                    i = true,
                    r = e
                } finally {
                    try {
                        !n && a.return && a.return()
                    } finally {
                        if (i)
                            throw r
                    }
                }
                t || this.context.nima.captureJournalEntry()
            }
        }, {
            key: "toggleMinX",
            value: function(e) {
                var t = true
                  , n = false
                  , i = void 0;
                try {
                    for (var r, o = this.stageItems[Symbol.iterator](); !(t = (r = o.next()).done); t = true) {
                        var a = r.value;
                        a.node && (a.node.enableMinX = e)
                    }
                } catch (e) {
                    n = true,
                    i = e
                } finally {
                    try {
                        !t && o.return && o.return()
                    } finally {
                        if (n)
                            throw i
                    }
                }
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "changeMinX",
            value: function(e, t) {
                var n = true
                  , i = false
                  , r = void 0;
                try {
                    for (var o, a = this.stageItems[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                        var s = o.value;
                        s.node && (s.node.minX = e)
                    }
                } catch (e) {
                    i = true,
                    r = e
                } finally {
                    try {
                        !n && a.return && a.return()
                    } finally {
                        if (i)
                            throw r
                    }
                }
                t || this.context.nima.captureJournalEntry()
            }
        }, {
            key: "toggleMaxX",
            value: function(e) {
                var t = true
                  , n = false
                  , i = void 0;
                try {
                    for (var r, o = this.stageItems[Symbol.iterator](); !(t = (r = o.next()).done); t = true) {
                        var a = r.value;
                        a.node && (a.node.enableMaxX = e)
                    }
                } catch (e) {
                    n = true,
                    i = e
                } finally {
                    try {
                        !t && o.return && o.return()
                    } finally {
                        if (n)
                            throw i
                    }
                }
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "changeMaxX",
            value: function(e, t) {
                var n = true
                  , i = false
                  , r = void 0;
                try {
                    for (var o, a = this.stageItems[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                        var s = o.value;
                        s.node && (s.node.maxX = e)
                    }
                } catch (e) {
                    i = true,
                    r = e
                } finally {
                    try {
                        !n && a.return && a.return()
                    } finally {
                        if (i)
                            throw r
                    }
                }
                t || this.context.nima.captureJournalEntry()
            }
        }, {
            key: "toggleCopyY",
            value: function(e) {
                var t = true
                  , n = false
                  , i = void 0;
                try {
                    for (var r, o = this.stageItems[Symbol.iterator](); !(t = (r = o.next()).done); t = true) {
                        var a = r.value;
                        a.node && (a.node.copyY = e)
                    }
                } catch (e) {
                    n = true,
                    i = e
                } finally {
                    try {
                        !t && o.return && o.return()
                    } finally {
                        if (n)
                            throw i
                    }
                }
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "changeScaleY",
            value: function(e, t) {
                var n = true
                  , i = false
                  , r = void 0;
                try {
                    for (var o, a = this.stageItems[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                        var s = o.value;
                        s.node && (s.node.scaleY = e)
                    }
                } catch (e) {
                    i = true,
                    r = e
                } finally {
                    try {
                        !n && a.return && a.return()
                    } finally {
                        if (i)
                            throw r
                    }
                }
                t || this.context.nima.captureJournalEntry()
            }
        }, {
            key: "toggleMinY",
            value: function(e) {
                var t = true
                  , n = false
                  , i = void 0;
                try {
                    for (var r, o = this.stageItems[Symbol.iterator](); !(t = (r = o.next()).done); t = true) {
                        var a = r.value;
                        a.node && (a.node.enableMinY = e)
                    }
                } catch (e) {
                    n = true,
                    i = e
                } finally {
                    try {
                        !t && o.return && o.return()
                    } finally {
                        if (n)
                            throw i
                    }
                }
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "changeMinY",
            value: function(e, t) {
                var n = true
                  , i = false
                  , r = void 0;
                try {
                    for (var o, a = this.stageItems[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                        var s = o.value;
                        s.node && (s.node.minY = e)
                    }
                } catch (e) {
                    i = true,
                    r = e
                } finally {
                    try {
                        !n && a.return && a.return()
                    } finally {
                        if (i)
                            throw r
                    }
                }
                t || this.context.nima.captureJournalEntry()
            }
        }, {
            key: "toggleMaxY",
            value: function(e) {
                var t = true
                  , n = false
                  , i = void 0;
                try {
                    for (var r, o = this.stageItems[Symbol.iterator](); !(t = (r = o.next()).done); t = true) {
                        var a = r.value;
                        a.node && (a.node.enableMaxY = e)
                    }
                } catch (e) {
                    n = true,
                    i = e
                } finally {
                    try {
                        !t && o.return && o.return()
                    } finally {
                        if (n)
                            throw i
                    }
                }
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "changeMaxY",
            value: function(e, t) {
                var n = true
                  , i = false
                  , r = void 0;
                try {
                    for (var o, a = this.stageItems[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                        var s = o.value;
                        s.node && (s.node.maxY = e)
                    }
                } catch (e) {
                    i = true,
                    r = e
                } finally {
                    try {
                        !n && a.return && a.return()
                    } finally {
                        if (i)
                            throw r
                    }
                }
                t || this.context.nima.captureJournalEntry()
            }
        }, {
            key: "commit",
            value: function() {
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "toggleOffset",
            value: function(e) {
                var t = true
                  , n = false
                  , i = void 0;
                try {
                    for (var r, o = this.stageItems[Symbol.iterator](); !(t = (r = o.next()).done); t = true) {
                        var a = r.value;
                        a.node && (a.node.offset = e)
                    }
                } catch (e) {
                    n = true,
                    i = e
                } finally {
                    try {
                        !t && o.return && o.return()
                    } finally {
                        if (n)
                            throw i
                    }
                }
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "render",
            value: function() {
                this.props.isAnimating;
                var e = l.default.validate(t.Validation, this.stageItems)
                  , n = e.sourceSpaceIndex
                  , i = e.destSpaceIndex
                  , r = e.minMaxSpaceIndex
                  , a = e.enableMinX || e.enableMinY || e.enableMaxX || e.enableMaxY
                  , s = e.copyX || e.copyY;
                return [o.default.createElement(u.default, {
                    label: "Constrain X",
                    key: "constrainX"
                }, o.default.createElement(p.default, {
                    label: "Copy X",
                    onToggle: this.toggleCopyX,
                    isOn: e.copyX,
                    disabled: !e.copyX,
                    value: e.scaleX,
                    onValueChanged: this.changeScaleX,
                    dragScale: .005,
                    onValueCommit: this.commit
                }), o.default.createElement(p.default, {
                    label: "Min",
                    onToggle: this.toggleMinX,
                    isOn: e.enableMinX,
                    disabled: !e.enableMinX,
                    value: e.minX,
                    onValueChanged: this.changeMinX,
                    dragScale: .005,
                    onValueCommit: this.commit
                }), o.default.createElement(p.default, {
                    label: "Max",
                    onToggle: this.toggleMaxX,
                    isOn: e.enableMaxX,
                    disabled: !e.enableMaxX,
                    value: e.maxX,
                    onValueChanged: this.changeMaxX,
                    dragScale: .005,
                    onValueCommit: this.commit
                })), o.default.createElement(u.default, {
                    label: "Constrain Y",
                    key: "constrainY"
                }, o.default.createElement(p.default, {
                    label: "Copy Y",
                    onToggle: this.toggleCopyY,
                    isOn: e.copyY,
                    disabled: !e.copyY,
                    value: e.scaleY,
                    onValueChanged: this.changeScaleY,
                    dragScale: .005,
                    onValueCommit: this.commit
                }), o.default.createElement(p.default, {
                    label: "Min",
                    onToggle: this.toggleMinY,
                    isOn: e.enableMinY,
                    disabled: !e.enableMinY,
                    value: e.minY,
                    onValueChanged: this.changeMinY,
                    dragScale: .005,
                    onValueCommit: this.commit
                }), o.default.createElement(p.default, {
                    label: "Max",
                    onToggle: this.toggleMaxY,
                    isOn: e.enableMaxY,
                    disabled: !e.enableMaxY,
                    value: e.maxY,
                    onValueChanged: this.changeMaxY,
                    dragScale: .005,
                    onValueCommit: this.commit
                })), o.default.createElement(u.default, {
                    label: "Constraint Space",
                    key: "constrainSpace"
                }, o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitleSwitch"
                }, "Offset"), o.default.createElement(f.default, {
                    isOn: e.offset,
                    onToggle: this.toggleOffset,
                    disabled: !s
                })), o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Source"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(c.default, {
                    options: g,
                    selectedIndex: n,
                    onSelectionChanged: this.changeSourceIndex,
                    disabled: !s
                }))), o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Destination"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(c.default, {
                    options: g,
                    selectedIndex: i,
                    onSelectionChanged: this.changeDestIndex,
                    disabled: !s
                }))), o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Min/Max"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(c.default, {
                    options: g,
                    selectedIndex: r,
                    onSelectionChanged: this.changeMinMaxIndex,
                    disabled: !a
                }))))]
            }
        }]),
        t
    }(o.default.Component)).prototype, "updateTransformProperties", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "updateTransformProperties"), i.prototype),
    m(i.prototype, "changeSourceIndex", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeSourceIndex"), i.prototype),
    m(i.prototype, "changeDestIndex", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeDestIndex"), i.prototype),
    m(i.prototype, "changeMinMaxIndex", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeMinMaxIndex"), i.prototype),
    m(i.prototype, "toggleCopyX", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleCopyX"), i.prototype),
    m(i.prototype, "changeScaleX", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeScaleX"), i.prototype),
    m(i.prototype, "toggleMinX", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleMinX"), i.prototype),
    m(i.prototype, "changeMinX", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeMinX"), i.prototype),
    m(i.prototype, "toggleMaxX", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleMaxX"), i.prototype),
    m(i.prototype, "changeMaxX", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeMaxX"), i.prototype),
    m(i.prototype, "toggleCopyY", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleCopyY"), i.prototype),
    m(i.prototype, "changeScaleY", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeScaleY"), i.prototype),
    m(i.prototype, "toggleMinY", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleMinY"), i.prototype),
    m(i.prototype, "changeMinY", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeMinY"), i.prototype),
    m(i.prototype, "toggleMaxY", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleMaxY"), i.prototype),
    m(i.prototype, "changeMaxY", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeMaxY"), i.prototype),
    m(i.prototype, "commit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "commit"), i.prototype),
    m(i.prototype, "toggleOffset", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleOffset"), i.prototype),
    i);
    t.default = v;
    var g = [{
        label: "Local",
        space: h.default.Local
    }, {
        label: "World",
        space: h.default.World
    }];
    v.canMultiEdit = true,
    v.panelOrder = 3,
    v.validate = function(e, t) {
        return !e.state.isAnimationOpen && l.default.validate(v.Validation, t)
    }
    ,
    v.Validation = {
        offset: {
            validate: function(e) {
                var t = e.node;
                return !!t && t.offset
            }
        },
        copyX: {
            validate: function(e) {
                var t = e.node;
                return !!t && t.copyX
            }
        },
        copyY: {
            validate: function(e) {
                var t = e.node;
                return !!t && t.copyY
            }
        },
        scaleX: {
            validate: function(e) {
                var t = e.node;
                return !!t && t.scaleX
            }
        },
        scaleY: {
            validate: function(e) {
                var t = e.node;
                return !!t && t.scaleY
            }
        },
        minX: {
            validate: function(e) {
                var t = e.node;
                return !!t && t.minX
            }
        },
        minY: {
            validate: function(e) {
                var t = e.node;
                return !!t && t.minY
            }
        },
        maxX: {
            validate: function(e) {
                var t = e.node;
                return !!t && t.maxX
            }
        },
        maxY: {
            validate: function(e) {
                var t = e.node;
                return !!t && t.maxY
            }
        },
        enableMinX: {
            validate: function(e) {
                var t = e.node;
                return !!t && t.enableMinX
            }
        },
        enableMinY: {
            validate: function(e) {
                var t = e.node;
                return !!t && t.enableMinY
            }
        },
        enableMaxX: {
            validate: function(e) {
                var t = e.node;
                return !!t && t.enableMaxX
            }
        },
        enableMaxY: {
            validate: function(e) {
                var t = e.node;
                return !!t && t.enableMaxY
            }
        },
        sourceSpaceIndex: {
            validate: function(e) {
                var t = e.node;
                return !!t && g.findIndex((function(e) {
                    return e.space === t.sourceSpace
                }
                ))
            }
        },
        destSpaceIndex: {
            validate: function(e) {
                var t = e.node;
                return !!t && g.findIndex((function(e) {
                    return e.space === t.destSpace
                }
                ))
            }
        },
        minMaxSpaceIndex: {
            validate: function(e) {
                var t = e.node;
                return !!t && g.findIndex((function(e) {
                    return e.space === t.minMaxSpace
                }
                ))
            }
        }
    },
    v.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = l(n(0)), a = l(n(1)), s = l(n(3));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var u, c, d, h, f, p, y = (i = function(e) {
        function t(e) {
            return function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t),
            function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "toggleCheck",
            value: function() {
                this.props.onValueChange(!this.props.value)
            }
        }, {
            key: "render",
            value: function() {
                return o.default.createElement("div", {
                    className: "Checkbox",
                    onClick: this.toggleCheck
                }, o.default.createElement("svg", {
                    className: "CheckboxCheck",
                    style: {
                        opacity: this.props.value ? 1 : 0
                    }
                }, o.default.createElement("use", {
                    xlinkHref: s.default.make("/images/symbol-defs.svg#icon-check-small")
                })))
            }
        }]),
        t
    }(o.default.Component),
    u = i.prototype,
    c = "toggleCheck",
    d = [a.default],
    h = Object.getOwnPropertyDescriptor(i.prototype, "toggleCheck"),
    f = i.prototype,
    p = {},
    Object.keys(h).forEach((function(e) {
        p[e] = h[e]
    }
    )),
    p.enumerable = !!p.enumerable,
    p.configurable = !!p.configurable,
    ("value"in p || p.initializer) && (p.writable = true),
    p = d.slice().reverse().reduce((function(e, t) {
        return t(u, c, e) || e
    }
    ), p),
    f && void 0 !== p.initializer && (p.value = p.initializer ? p.initializer.call(f) : void 0,
    p.initializer = void 0),
    void 0 === p.initializer && (Object.defineProperty(u, c, p),
    p = null),
    i);
    t.default = y
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = y(n(0)), a = y(n(1)), s = y(n(4)), l = y(n(348)), u = y(n(264)), c = y(n(316)), d = y(n(263)), h = y(n(357)), f = y(n(310)), p = y(n(721));
    function y(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function m(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var v = (m((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {},
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "updateTransformProperties",
            value: function() {
                this.forceUpdate()
            }
        }, {
            key: "setConstraintItems",
            value: function(e) {
                if (!(0,
                d.default)(this.stageItems, e)) {
                    if (this.stageItems)
                        for (var t = 0; t < this.stageItems.length; t++) {
                            this.stageItems[t].node.removeEventListener("changeConstraint", this.updateTransformProperties)
                        }
                    if (this.stageItems = e,
                    this.constraint = null,
                    this.stageItems)
                        for (var n = 0; n < this.stageItems.length; n++) {
                            this.stageItems[n].node.addEventListener("changeConstraint", this.updateTransformProperties)
                        }
                }
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.stageItems != this.props.stageItems && this.setConstraintItems(e.stageItems)
            }
        }, {
            key: "componentWillMount",
            value: function() {
                this.setConstraintItems(this.props.stageItems)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setConstraintItems(null)
            }
        }, {
            key: "changeSourceIndex",
            value: function(e) {
                if (!(e < 0)) {
                    var t = g[e]
                      , n = true
                      , i = false
                      , r = void 0;
                    try {
                        for (var o, a = this.stageItems[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                            var s = o.value;
                            s.node && (s.node.sourceSpace = t.space)
                        }
                    } catch (e) {
                        i = true,
                        r = e
                    } finally {
                        try {
                            !n && a.return && a.return()
                        } finally {
                            if (i)
                                throw r
                        }
                    }
                    this.context.nima.captureJournalEntry()
                }
            }
        }, {
            key: "changeDestIndex",
            value: function(e) {
                if (!(e < 0)) {
                    var t = g[e]
                      , n = true
                      , i = false
                      , r = void 0;
                    try {
                        for (var o, a = this.stageItems[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                            var s = o.value;
                            s.node && (s.node.destSpace = t.space)
                        }
                    } catch (e) {
                        i = true,
                        r = e
                    } finally {
                        try {
                            !n && a.return && a.return()
                        } finally {
                            if (i)
                                throw r
                        }
                    }
                    this.context.nima.captureJournalEntry()
                }
            }
        }, {
            key: "changeMinMaxIndex",
            value: function(e) {
                if (!(e < 0)) {
                    var t = g[e]
                      , n = true
                      , i = false
                      , r = void 0;
                    try {
                        for (var o, a = this.stageItems[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                            var s = o.value;
                            s.node && (s.node.minMaxSpace = t.space)
                        }
                    } catch (e) {
                        i = true,
                        r = e
                    } finally {
                        try {
                            !n && a.return && a.return()
                        } finally {
                            if (i)
                                throw r
                        }
                    }
                    this.context.nima.captureJournalEntry()
                }
            }
        }, {
            key: "toggleCopy",
            value: function(e) {
                var t = true
                  , n = false
                  , i = void 0;
                try {
                    for (var r, o = this.stageItems[Symbol.iterator](); !(t = (r = o.next()).done); t = true) {
                        var a = r.value;
                        a.node && (a.node.copy = e)
                    }
                } catch (e) {
                    n = true,
                    i = e
                } finally {
                    try {
                        !t && o.return && o.return()
                    } finally {
                        if (n)
                            throw i
                    }
                }
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "changeScale",
            value: function(e, t) {
                var n = true
                  , i = false
                  , r = void 0;
                try {
                    for (var o, a = this.stageItems[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                        var s = o.value;
                        s.node && (s.node.scale = e)
                    }
                } catch (e) {
                    i = true,
                    r = e
                } finally {
                    try {
                        !n && a.return && a.return()
                    } finally {
                        if (i)
                            throw r
                    }
                }
                t || this.context.nima.captureJournalEntry()
            }
        }, {
            key: "toggleMin",
            value: function(e) {
                var t = true
                  , n = false
                  , i = void 0;
                try {
                    for (var r, o = this.stageItems[Symbol.iterator](); !(t = (r = o.next()).done); t = true) {
                        var a = r.value;
                        a.node && (a.node.enableMin = e)
                    }
                } catch (e) {
                    n = true,
                    i = e
                } finally {
                    try {
                        !t && o.return && o.return()
                    } finally {
                        if (n)
                            throw i
                    }
                }
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "changeMin",
            value: function(e, t) {
                var n = true
                  , i = false
                  , r = void 0;
                try {
                    for (var o, a = this.stageItems[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                        var s = o.value;
                        s.node && (s.node.min = e)
                    }
                } catch (e) {
                    i = true,
                    r = e
                } finally {
                    try {
                        !n && a.return && a.return()
                    } finally {
                        if (i)
                            throw r
                    }
                }
                t || this.context.nima.captureJournalEntry()
            }
        }, {
            key: "toggleMax",
            value: function(e) {
                var t = true
                  , n = false
                  , i = void 0;
                try {
                    for (var r, o = this.stageItems[Symbol.iterator](); !(t = (r = o.next()).done); t = true) {
                        var a = r.value;
                        a.node && (a.node.enableMax = e)
                    }
                } catch (e) {
                    n = true,
                    i = e
                } finally {
                    try {
                        !t && o.return && o.return()
                    } finally {
                        if (n)
                            throw i
                    }
                }
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "changeMax",
            value: function(e, t) {
                var n = true
                  , i = false
                  , r = void 0;
                try {
                    for (var o, a = this.stageItems[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                        var s = o.value;
                        s.node && (s.node.max = e)
                    }
                } catch (e) {
                    i = true,
                    r = e
                } finally {
                    try {
                        !n && a.return && a.return()
                    } finally {
                        if (i)
                            throw r
                    }
                }
                t || this.context.nima.captureJournalEntry()
            }
        }, {
            key: "commit",
            value: function() {
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "toggleOffset",
            value: function(e) {
                var t = true
                  , n = false
                  , i = void 0;
                try {
                    for (var r, o = this.stageItems[Symbol.iterator](); !(t = (r = o.next()).done); t = true) {
                        var a = r.value;
                        a.node && (a.node.offset = e)
                    }
                } catch (e) {
                    n = true,
                    i = e
                } finally {
                    try {
                        !t && o.return && o.return()
                    } finally {
                        if (n)
                            throw i
                    }
                }
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "render",
            value: function() {
                this.props.isAnimating;
                var e = l.default.validate(t.Validation, this.stageItems)
                  , n = e.sourceSpaceIndex
                  , i = e.destSpaceIndex
                  , r = e.minMaxSpaceIndex
                  , a = e.enableMin || e.enableMax
                  , s = e.copy;
                return [o.default.createElement(u.default, {
                    label: "Constrain " + (e.constraintName || "Value"),
                    key: "constrainValue"
                }, o.default.createElement(p.default, {
                    label: "Copy",
                    onToggle: this.toggleCopy,
                    isOn: e.copy,
                    disabled: !e.copy,
                    value: e.scale,
                    onValueChanged: this.changeScale,
                    dragScale: .005,
                    onValueCommit: this.commit
                }), o.default.createElement(p.default, {
                    label: "Min",
                    onToggle: this.toggleMin,
                    isOn: e.enableMin,
                    converter: e.inputConverter,
                    disabled: !e.enableMin,
                    value: e.min,
                    onValueChanged: this.changeMin,
                    dragScale: .005,
                    onValueCommit: this.commit
                }), o.default.createElement(p.default, {
                    label: "Max",
                    onToggle: this.toggleMax,
                    isOn: e.enableMax,
                    converter: e.inputConverter,
                    disabled: !e.enableMax,
                    value: e.max,
                    onValueChanged: this.changeMax,
                    dragScale: .005,
                    onValueCommit: this.commit
                })), o.default.createElement(u.default, {
                    label: "Constraint Space",
                    key: "constrainSpace"
                }, o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitleSwitch"
                }, "Offset"), o.default.createElement(f.default, {
                    isOn: e.offset,
                    onToggle: this.toggleOffset,
                    disabled: !s
                })), o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Source"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(c.default, {
                    options: g,
                    selectedIndex: n,
                    onSelectionChanged: this.changeSourceIndex,
                    disabled: !s
                }))), o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Destination"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(c.default, {
                    options: g,
                    selectedIndex: i,
                    onSelectionChanged: this.changeDestIndex,
                    disabled: !s
                }))), o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Min/Max"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(c.default, {
                    options: g,
                    selectedIndex: r,
                    onSelectionChanged: this.changeMinMaxIndex,
                    disabled: !a
                }))))]
            }
        }]),
        t
    }(o.default.Component)).prototype, "updateTransformProperties", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "updateTransformProperties"), i.prototype),
    m(i.prototype, "changeSourceIndex", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeSourceIndex"), i.prototype),
    m(i.prototype, "changeDestIndex", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeDestIndex"), i.prototype),
    m(i.prototype, "changeMinMaxIndex", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeMinMaxIndex"), i.prototype),
    m(i.prototype, "toggleCopy", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleCopy"), i.prototype),
    m(i.prototype, "changeScale", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeScale"), i.prototype),
    m(i.prototype, "toggleMin", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleMin"), i.prototype),
    m(i.prototype, "changeMin", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeMin"), i.prototype),
    m(i.prototype, "toggleMax", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleMax"), i.prototype),
    m(i.prototype, "changeMax", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeMax"), i.prototype),
    m(i.prototype, "commit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "commit"), i.prototype),
    m(i.prototype, "toggleOffset", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleOffset"), i.prototype),
    i);
    t.default = v;
    var g = [{
        label: "Local",
        space: h.default.Local
    }, {
        label: "World",
        space: h.default.World
    }];
    v.canMultiEdit = true,
    v.panelOrder = 3,
    v.validate = function(e, t) {
        return !e.state.isAnimationOpen && l.default.validate(v.Validation, t)
    }
    ,
    v.Validation = {
        constraintName: {
            validate: function(e) {
                var t = e.node;
                return !!t && t.constructor.constraintName
            }
        },
        inputConverter: {
            validate: function(e) {
                var t = e.node;
                return !!t && t.constructor.converter
            }
        },
        offset: {
            validate: function(e) {
                var t = e.node;
                return !!t && t.offset
            }
        },
        copy: {
            validate: function(e) {
                var t = e.node;
                return !!t && t.copy
            }
        },
        scale: {
            validate: function(e) {
                var t = e.node;
                return !!t && t.scale
            }
        },
        min: {
            validate: function(e) {
                var t = e.node;
                return !!t && t.min
            }
        },
        max: {
            validate: function(e) {
                var t = e.node;
                return !!t && t.max
            }
        },
        enableMin: {
            validate: function(e) {
                var t = e.node;
                return !!t && t.enableMin
            }
        },
        enableMax: {
            validate: function(e) {
                var t = e.node;
                return !!t && t.enableMax
            }
        },
        sourceSpaceIndex: {
            validate: function(e) {
                var t = e.node;
                return !!t && g.findIndex((function(e) {
                    return e.space === t.sourceSpace
                }
                ))
            }
        },
        destSpaceIndex: {
            validate: function(e) {
                var t = e.node;
                return !!t && g.findIndex((function(e) {
                    return e.space === t.destSpace
                }
                ))
            }
        },
        minMaxSpaceIndex: {
            validate: function(e) {
                var t = e.node;
                return !!t && g.findIndex((function(e) {
                    return e.space === t.minMaxSpace
                }
                ))
            }
        }
    },
    v.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = E(n(0)), a = E(n(1)), s = E(n(4)), l = E(n(348)), u = E(n(264)), c = E(n(347)), d = E(n(310)), h = E(n(243)), f = E(n(383)), p = E(n(261)), y = E(n(201)), m = E(n(371)), v = E(n(382)), g = n(2), _ = E(n(263)), b = E(n(1153)), w = E(n(705)), O = E(n(707)), S = E(n(708)), k = E(n(709)), P = E(n(13));
    function E(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function T(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var C = (T((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {},
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "itemPropertiesUpdated",
            value: function() {
                this.context.nima.editingAnimation && this.context.nima.editingAnimation.isPlaying || (0,
                P.default)(this.revalidate)
            }
        }, {
            key: "revalidate",
            value: function() {
                this.forceUpdate()
            }
        }, {
            key: "setItems",
            value: function(e) {
                if (!(0,
                _.default)(this.items, e)) {
                    if (this.items)
                        for (var t = 0; t < this.items.length; t++) {
                            var n = this.items[t];
                            n.node && (n.node.removeEventListener("worldTransform", this.itemPropertiesUpdated),
                            n.node.removeEventListener("keyState", this.itemPropertiesUpdated))
                        }
                    if (this.items = e,
                    e)
                        for (var i = 0; i < e.length; i++) {
                            var r = e[i];
                            r.node && (r.node.addEventListener("worldTransform", this.itemPropertiesUpdated),
                            r.node.addEventListener("keyState", this.itemPropertiesUpdated))
                        }
                }
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.stageItems != this.props.stageItems && this.setItems(e.stageItems)
            }
        }, {
            key: "componentWillMount",
            value: function() {
                this.setItems(this.props.stageItems)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setItems(null),
                P.default.cancel(this.revalidate)
            }
        }, {
            key: "toggleLockBones",
            value: function(e) {
                this.context.nima.stage.settings.compensateBones = e,
                this.forceUpdate()
            }
        }, {
            key: "toggleLockImages",
            value: function(e) {
                this.context.nima.stage.settings.compensateImages = e,
                this.forceUpdate()
            }
        }, {
            key: "setTranslateY",
            value: function(e) {
                this.translateYRef = e
            }
        }, {
            key: "setTranslateX",
            value: function(e) {
                this.translateXRef = e
            }
        }, {
            key: "translateX",
            value: function(e, t) {
                for (var n = 0; n < this.items.length; n++) {
                    var i = this.items[n]
                      , r = void 0;
                    (r = i === h.default ? new b.default(this.context.nima.stage,this.context.nima.actor,i,[e, this.translateYRef.props.value]) : new w.default(this.context.nima.stage,this.context.nima.actor,i,e)).silent = true,
                    r.start(),
                    r.end()
                }
                t || this.context.nima.captureJournalEntry()
            }
        }, {
            key: "translateY",
            value: function(e, t) {
                for (var n = 0; n < this.items.length; n++) {
                    var i = this.items[n]
                      , r = void 0;
                    (r = i.constructor === h.default ? new b.default(this.context.nima.stage,this.context.nima.actor,i,[this.translateXRef.props.value, e]) : new O.default(this.context.nima.stage,this.context.nima.actor,i,e)).silent = true,
                    r.start(),
                    r.end()
                }
                t || this.context.nima.captureJournalEntry()
            }
        }, {
            key: "rotate",
            value: function(e, n) {
                for (var i = 0; i < this.items.length; i++) {
                    var r = this.items[i]
                      , o = t.Validation.rotation.validate(r)
                      , a = e / 180 * Math.PI - o
                      , s = new S.default(this.context.nima.stage,this.context.nima.actor,r,a);
                    s.silent = true,
                    s.start(),
                    s.end()
                }
                n || this.context.nima.captureJournalEntry()
            }
        }, {
            key: "scaleX",
            value: function(e, t) {
                for (var n = 0; n < this.items.length; n++) {
                    var i = this.items[n].node;
                    i.scale = [e, i.scale[1]]
                }
                t || this.context.nima.captureJournalEntry()
            }
        }, {
            key: "scaleY",
            value: function(e, t) {
                for (var n = 0; n < this.items.length; n++) {
                    var i = this.items[n].node;
                    i.scale = [i.scale[0], e]
                }
                t || this.context.nima.captureJournalEntry()
            }
        }, {
            key: "elongate",
            value: function(e, t) {
                var n = new k.default(this.context.nima.stage,this.context.nima.actor,this.items,e);
                n.silent = t,
                n.start(),
                n.end()
            }
        }, {
            key: "keyTranslateX",
            value: function(e) {
                for (var n = false, i = 0; i < this.items.length; i++) {
                    var r = this.items[i];
                    t.Validation.animatesTranslation.validate(r) && (this.context.nima.editingAnimation.toggleKey(r.node, "framePosX"),
                    n = true)
                }
                n && (this.context.nima.captureJournalEntry(),
                this.forceUpdate())
            }
        }, {
            key: "keyTranslateY",
            value: function(e) {
                for (var n = false, i = 0; i < this.items.length; i++) {
                    var r = this.items[i];
                    t.Validation.animatesTranslation.validate(r) && (this.context.nima.editingAnimation.toggleKey(r.node, "framePosY"),
                    n = true)
                }
                n && (this.context.nima.captureJournalEntry(),
                this.forceUpdate())
            }
        }, {
            key: "keyScaleX",
            value: function(e) {
                for (var t = 0; t < this.items.length; t++) {
                    var n = this.items[t];
                    this.context.nima.editingAnimation.toggleKey(n.node, "frameScaleX")
                }
                this.context.nima.captureJournalEntry(),
                this.forceUpdate()
            }
        }, {
            key: "keyScaleY",
            value: function(e) {
                for (var t = 0; t < this.items.length; t++) {
                    var n = this.items[t];
                    this.context.nima.editingAnimation.toggleKey(n.node, "frameScaleY")
                }
                this.forceUpdate()
            }
        }, {
            key: "keyRotation",
            value: function(e) {
                for (var t = 0; t < this.items.length; t++) {
                    var n = this.items[t];
                    this.context.nima.editingAnimation.toggleKey(n.node, "frameRotation")
                }
                this.context.nima.captureJournalEntry(),
                this.forceUpdate()
            }
        }, {
            key: "keyLength",
            value: function(e) {
                for (var t = 0; t < this.items.length; t++) {
                    var n = this.items[t];
                    this.context.nima.editingAnimation.toggleKey(n.node, "frameLength")
                }
                this.context.nima.captureJournalEntry(),
                this.forceUpdate()
            }
        }, {
            key: "commit",
            value: function() {
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "render",
            value: function() {
                var e = l.default.validate(t.Validation, this.items)
                  , n = this.props.isAnimating
                  , i = this.props.disableInput;
                return o.default.createElement(u.default, {
                    _key: "_TransformOpts",
                    label: "Transform"
                }, e.hasLength ? o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Length"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(c.default, {
                    value: e.length,
                    keyState: e.lengthKeyState,
                    isAnimating: n,
                    onValueChanged: this.elongate,
                    onValueCommit: this.commit,
                    disabled: i,
                    onSetKey: this.keyLength
                }))) : null, e.hasTranslation ? o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Translation"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(c.default, {
                    ref: this.setTranslateX,
                    label: "X",
                    value: e.translationX,
                    keyState: e.translationKeyStateX,
                    isAnimating: n && e.animatesTranslation,
                    onValueChanged: this.translateX,
                    onValueCommit: this.commit,
                    disabled: i,
                    onSetKey: this.keyTranslateX
                }), o.default.createElement(c.default, {
                    ref: this.setTranslateY,
                    label: "Y",
                    value: e.translationY,
                    keyState: e.translationKeyStateY,
                    isAnimating: n && e.animatesTranslation,
                    onValueChanged: this.translateY,
                    onValueCommit: this.commit,
                    disabled: i,
                    onSetKey: this.keyTranslateY
                }))) : null, e.hasRotation ? o.default.createElement("div", {
                    className: "SelectionPanelProperty",
                    style: {
                        marginTop: "8px",
                        marginBottom: "8px"
                    }
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Rotation"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(c.default, {
                    value: false !== e.rotation && 180 * e.rotation / Math.PI,
                    keyState: e.rotationKeyState,
                    isAnimating: n,
                    unit: " Â°",
                    onValueChanged: this.rotate,
                    onValueCommit: this.commit,
                    disabled: i,
                    onSetKey: this.keyRotation
                }))) : null, e.hasScale ? o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Scale"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(c.default, {
                    label: "X",
                    value: e.scaleX,
                    keyState: e.scaleKeyStateX,
                    isAnimating: n,
                    onValueChanged: this.scaleX,
                    dragScale: .001,
                    onValueCommit: this.commit,
                    disabled: i,
                    onSetKey: this.keyScaleX
                }), o.default.createElement(c.default, {
                    label: "Y",
                    value: e.scaleY,
                    keyState: e.scaleKeyStateY,
                    isAnimating: n,
                    onValueChanged: this.scaleY,
                    dragScale: .001,
                    onValueCommit: this.commit,
                    disabled: i,
                    onSetKey: this.keyScaleY
                }))) : null, n ? null : o.default.createElement("div", {
                    className: "SelectionPanelProperty",
                    style: {
                        marginTop: "8px"
                    }
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitleSwitch"
                }, "Freeze Joints"), o.default.createElement(d.default, {
                    isOn: this.context.nima.stage.settings.compensateBones,
                    onToggle: this.toggleLockBones
                })), n ? null : o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitleSwitch"
                }, "Freeze Images"), o.default.createElement(d.default, {
                    isOn: this.context.nima.stage.settings.compensateImages,
                    onToggle: this.toggleLockImages
                })))
            }
        }]),
        t
    }(o.default.Component)).prototype, "itemPropertiesUpdated", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "itemPropertiesUpdated"), i.prototype),
    T(i.prototype, "revalidate", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "revalidate"), i.prototype),
    T(i.prototype, "toggleLockBones", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleLockBones"), i.prototype),
    T(i.prototype, "toggleLockImages", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleLockImages"), i.prototype),
    T(i.prototype, "setTranslateY", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setTranslateY"), i.prototype),
    T(i.prototype, "setTranslateX", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setTranslateX"), i.prototype),
    T(i.prototype, "translateX", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "translateX"), i.prototype),
    T(i.prototype, "translateY", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "translateY"), i.prototype),
    T(i.prototype, "rotate", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "rotate"), i.prototype),
    T(i.prototype, "scaleX", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "scaleX"), i.prototype),
    T(i.prototype, "scaleY", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "scaleY"), i.prototype),
    T(i.prototype, "elongate", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "elongate"), i.prototype),
    T(i.prototype, "keyTranslateX", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "keyTranslateX"), i.prototype),
    T(i.prototype, "keyTranslateY", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "keyTranslateY"), i.prototype),
    T(i.prototype, "keyScaleX", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "keyScaleX"), i.prototype),
    T(i.prototype, "keyScaleY", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "keyScaleY"), i.prototype),
    T(i.prototype, "keyRotation", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "keyRotation"), i.prototype),
    T(i.prototype, "keyLength", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "keyLength"), i.prototype),
    T(i.prototype, "commit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "commit"), i.prototype),
    i);
    t.default = C,
    C.validate = function(e, t) {
        var n = l.default.validate(C.Validation, t);
        return !!(n.hasLength || n.hasTranslation || n.hasRotation || n.hasScale) && n
    }
    ,
    C.Validation = {
        hasLength: {
            validate: function(e) {
                return e.constructor === y.default
            }
        },
        length: {
            validate: function(e) {
                return e.node && e.node.length
            },
            equals: function(e, t) {
                return l.default.isValue(e) && l.default.isValue(t) && e.constructor === Number && t.constructor === Number && Math.round(e) === Math.round(t)
            }
        },
        lengthKeyState: {
            validate: function(e) {
                return e.node && e.node.frameLengthKS
            }
        },
        hasTranslation: {
            validate: function(e) {
                switch (e.constructor) {
                case y.default:
                case v.default:
                    return false;
                case p.default:
                    return !e.node.isConnectedToBones
                }
                return true
            }
        },
        translationX: {
            validate: function(e) {
                switch (e.constructor) {
                case f.default:
                case p.default:
                case y.default:
                case m.default:
                    return e.node.translation[0];
                case h.default:
                    if (e.parentJoint) {
                        var t = e.renderTransform;
                        return g.mat2d.getTranslation(g.vec2.create(), t)[0]
                    }
                    return e.node.translation[0]
                }
                return null
            },
            equals: function(e, t) {
                return l.default.isValue(e) && l.default.isValue(t) && e.constructor === Number && t.constructor === Number && Math.round(100 * e) === Math.round(100 * t)
            }
        },
        translationY: {
            validate: function(e) {
                switch (e.constructor) {
                case f.default:
                case p.default:
                case y.default:
                case m.default:
                    return e.node.translation[1];
                case h.default:
                    if (e.parentJoint) {
                        var t = e.renderTransform;
                        return g.mat2d.getTranslation(g.vec2.create(), t)[1]
                    }
                    return e.node.translation[1]
                }
                return null
            },
            equals: function(e, t) {
                return l.default.isValue(e) && l.default.isValue(t) && e.constructor === Number && t.constructor === Number && Math.round(100 * e) === Math.round(100 * t)
            }
        },
        animatesTranslation: {
            validate: function(e) {
                switch (e.constructor) {
                case p.default:
                    return !e.node.isConnectedToBones;
                case y.default:
                    return false;
                case h.default:
                    return !e.parentJoint;
                default:
                    return true
                }
            }
        },
        translationKeyStateX: {
            validate: function(e) {
                return e && e.node && e.node.framePosXKS
            }
        },
        translationKeyStateY: {
            validate: function(e) {
                return e && e.node && e.node.framePosYKS
            }
        },
        hasRotation: {
            validate: function(e) {
                switch (e.constructor) {
                case h.default:
                    return !e.parentJoint;
                case p.default:
                    return !e.node.isConnectedToBones;
                case y.default:
                case f.default:
                case m.default:
                    return true
                }
                return false
            }
        },
        rotation: {
            validate: function(e) {
                switch (e.constructor) {
                case f.default:
                case p.default:
                case y.default:
                case m.default:
                    return e.node.rotation;
                case h.default:
                    if (!e.parentJoint)
                        return e.node.rotation;
                    break;
                default:
                    return 0
                }
            },
            equals: function(e, t) {
                return l.default.isValue(e) && l.default.isValue(t) && e.constructor === Number && t.constructor === Number && Math.round(100 * e) === Math.round(100 * t)
            }
        },
        rotationKeyState: {
            validate: function(e) {
                return e && e.node ? e.node.frameRotationKS : null
            }
        },
        hasScale: {
            validate: function(e) {
                switch (e.constructor) {
                case h.default:
                    return !e.parentJoint;
                case p.default:
                    return !e.node.isConnectedToBones;
                case y.default:
                case f.default:
                case m.default:
                    return true
                }
                return false
            }
        },
        scaleX: {
            validate: function(e) {
                switch (e.constructor) {
                case h.default:
                case f.default:
                case p.default:
                case y.default:
                case m.default:
                    return e.node.scale[0];
                default:
                    return false
                }
            },
            equals: function(e, t) {
                return l.default.isValue(e) && l.default.isValue(t) && e.constructor === Number && t.constructor === Number && Math.round(100 * e) === Math.round(100 * t)
            }
        },
        scaleKeyStateX: {
            validate: function(e) {
                return e && e.node ? e.node.frameScaleXKS : null
            }
        },
        scaleY: {
            validate: function(e) {
                switch (e.constructor) {
                case h.default:
                case f.default:
                case p.default:
                case y.default:
                case m.default:
                    return e.node.scale[1];
                default:
                    return false
                }
            },
            equals: function(e, t) {
                return l.default.isValue(e) && l.default.isValue(t) && e.constructor === Number && t.constructor === Number && Math.round(100 * e) === Math.round(100 * t)
            }
        },
        scaleKeyStateY: {
            validate: function(e) {
                return e && e.node ? e.node.frameScaleYKS : null
            }
        }
    },
    C.canMultiEdit = true,
    C.panelOrder = 1,
    C.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = l(n(314))
      , r = n(2)
      , o = l(n(513))
      , a = l(n(446))
      , s = l(n(243));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var u = function(e) {
        function t(e, n, i, l) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var u = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e, n));
            if (u._StageItem = i,
            u._StageItem.constructor !== s.default || u._StageItem.isRoot) {
                if (u._StageItem.node.parent) {
                    var c = r.mat2d.fromRotation(r.mat2d.create(), u._StageItem.node.rotation);
                    c[4] = l[0],
                    c[5] = l[1],
                    r.mat2d.scale(c, c, u._StageItem.node.scale);
                    var d = r.mat2d.mul(r.mat2d.create(), u._StageItem.node.parent.worldTransform, c);
                    l = r.mat2d.getTranslation(r.vec2.create(), d)
                }
                var h = u._StageItem.node.worldTranslation
                  , f = r.vec2.subtract(r.vec2.create(), l, h);
                new a.default(u._Stage.settings.compensateBones,u._Stage.settings.compensateImages,[u._StageItem.node]).advance(null, f)
            } else {
                var p = r.mat2d.getTranslation(r.vec2.create(), u._StageItem.renderTransform)
                  , y = r.vec2.subtract(r.vec2.create(), l, p);
                new o.default(u._Stage.settings.compensateBones,u._Stage.settings.compensateImages,[u._StageItem]).advance(null, y)
            }
            return u
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        t
    }(i.default);
    t.default = u
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = p(n(0)), a = p(n(1)), s = p(n(4)), l = p(n(264)), u = p(n(1155)), c = p(n(399)), d = p(n(463)), h = p(n(263)), f = p(n(3));
    function p(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function y(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var m = (y((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {},
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "setItems",
            value: function(e) {
                (0,
                h.default)(this.items, e) || (this.component && this.component.removeEventListener("childrenChanged", this.onChildrenChanged),
                this.items = e,
                this.component = e && e[0].node,
                this.component && this.component.addEventListener("childrenChanged", this.onChildrenChanged))
            }
        }, {
            key: "onChildrenChanged",
            value: function(e) {
                this.forceUpdate()
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.stageItems != this.props.stageItems && this.setItems(e.stageItems)
            }
        }, {
            key: "componentWillMount",
            value: function() {
                this.setItems(this.props.stageItems)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setItems(null)
            }
        }, {
            key: "addCustomProperty",
            value: function() {
                var e = this.context.nima.actor.addNodeType(c.default, this.component, {});
                e ? (e.stageItem.addToStage(this.context.nima.stage),
                this.context.nima.captureJournalEntry()) : console.error("Unable to make custom property.")
            }
        }, {
            key: "deleteCustomProperty",
            value: function(e) {
                var t = new d.default(this.context.nima.stage,this.context.nima.actor,[e.stageItem],[]);
                t.start(),
                t.end()
            }
        }, {
            key: "render",
            value: function() {
                var e = this.props.isAnimating
                  , t = []
                  , n = this.component;
                if (n)
                    for (var i = n.children.length - 1; i >= 0; i--) {
                        var r = n.children[i];
                        r.constructor === c.default && t.push(o.default.createElement(u.default, {
                            key: r.refId,
                            property: r,
                            onDelete: this.deleteCustomProperty,
                            isAnimating: e
                        }))
                    }
                return o.default.createElement(l.default, {
                    _key: "_CustomOpts",
                    label: "Custom Properties",
                    action: this.props.isAnimating ? null : o.default.createElement("svg", {
                        className: "AddButton",
                        onClick: this.addCustomProperty
                    }, o.default.createElement("use", {
                        xlinkHref: f.default.make("/images/symbol-defs.svg#icon-plus")
                    }))
                }, o.default.createElement("div", {
                    className: "EditCustomOptions"
                }, t.length > 0 ? t : o.default.createElement("div", {
                    className: "SelectionPanelEmptyMsg"
                }, "No custom properties")))
            }
        }]),
        t
    }(o.default.Component)).prototype, "onChildrenChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onChildrenChanged"), i.prototype),
    y(i.prototype, "addCustomProperty", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "addCustomProperty"), i.prototype),
    y(i.prototype, "deleteCustomProperty", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "deleteCustomProperty"), i.prototype),
    i);
    t.default = m,
    m.validate = function(e, t) {
        if (e.state.isAnimationOpen) {
            if (1 === t.length)
                for (var n = t[0].node, i = n.children.length - 1; i >= 0; i--) {
                    if (n.children[i].constructor === c.default)
                        return true
                }
            return false
        }
        return true
    }
    ,
    m.canMultiEdit = false,
    m.panelOrder = 5,
    m.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = f(n(0)), a = f(n(1)), s = f(n(4)), l = f(n(347)), u = f(n(316)), c = f(n(399)), d = f(n(471)), h = f(n(3));
    function f(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function p(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var y = (p((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {},
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "propertyUpdate",
            value: function() {
                this.context.nima.editingAnimation && this.context.nima.editingAnimation.isPlaying || this.forceUpdate()
            }
        }, {
            key: "setProperty",
            value: function(e) {
                this.property !== e && (this.property && (this.property.removeEventListener("update", this.propertyUpdate),
                this.property.removeEventListener("valueChanged", this.propertyUpdate),
                this.property.removeEventListener("typeChanged", this.propertyUpdate),
                this.property.removeEventListener("keyState", this.propertyUpdate)),
                this.property = e,
                e && (e.addEventListener("update", this.propertyUpdate),
                e.addEventListener("valueChanged", this.propertyUpdate),
                e.addEventListener("typeChanged", this.propertyUpdate),
                e.addEventListener("keyState", this.propertyUpdate)))
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.property != this.props.property && this.setProperty(e.property)
            }
        }, {
            key: "componentWillMount",
            value: function() {
                this.setProperty(this.props.property)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setProperty(null)
            }
        }, {
            key: "deleteProperty",
            value: function(e) {
                this.props.onDelete && this.props.onDelete(this.props.property)
            }
        }, {
            key: "changeName",
            value: function(e) {
                console.log("DOING CHANGE NAME", e);
                var t = new d.default(this.context.nima.stage,this.context.nima.actor,this.props.property,e);
                t.start(),
                t.end()
            }
        }, {
            key: "changePropertyType",
            value: function(e) {
                this.props.property.propertyType = e,
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "changeValue",
            value: function(e, t) {
                switch (this.props.property.propertyType) {
                case c.default.Type.String:
                    this.props.property.stringValue = e;
                    break;
                case c.default.Type.Integer:
                    this.props.property.intValue = e;
                    break;
                case c.default.Type.Float:
                    this.props.property.floatValue = e
                }
                t || this.context.nima.captureJournalEntry()
            }
        }, {
            key: "commit",
            value: function() {
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "setKey",
            value: function() {
                var e;
                switch (this.props.property.propertyType) {
                case c.default.Type.String:
                    e = "frameStringValue";
                    break;
                case c.default.Type.Integer:
                    e = "frameIntValue";
                    break;
                case c.default.Type.Float:
                    e = "frameFloatValue";
                    break;
                case c.default.Type.Boolean:
                    e = "frameBooleanValue"
                }
                this.context.nima.editingAnimation.toggleKey(this.props.property, e),
                this.context.nima.captureJournalEntry(),
                this.forceUpdate()
            }
        }, {
            key: "changeBooleanValue",
            value: function(e) {
                this.props.property.booleanValue = 0 !== e,
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "render",
            value: function() {
                var e, t, n = this.props.isAnimating, i = this.props.property, r = false, a = 2, s = null;
                switch (this.props.property.propertyType) {
                case c.default.Type.String:
                    e = i.frameStringValueKS,
                    t = i.stringValue,
                    r = true;
                    break;
                case c.default.Type.Integer:
                    e = i.frameIntValueKS,
                    t = i.intValue,
                    a = 0;
                    break;
                case c.default.Type.Float:
                    e = i.frameFloatValueKS,
                    t = i.floatValue;
                    break;
                case c.default.Type.Boolean:
                    e = i.frameBooleanValueKS,
                    t = i.booleanValue ? 1 : 0,
                    s = ["False", "True"]
                }
                return o.default.createElement("div", null, o.default.createElement("div", {
                    className: "MeshBonesHeader"
                }, o.default.createElement("span", null, "PROPERTY"), o.default.createElement("svg", {
                    className: "AddButton",
                    style: {
                        opacity: n ? 0 : null,
                        pointerEvents: n ? "none" : null
                    },
                    onClick: this.deleteProperty
                }, o.default.createElement("use", {
                    xlinkHref: h.default.make("/images/symbol-defs.svg#icon-delete")
                }))), o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Name"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(l.default, {
                    isText: true,
                    value: i.name,
                    keyState: 0,
                    isAnimating: false,
                    onValueChanged: this.changeName,
                    dragScale: .001,
                    readOnly: n
                }))), o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Type"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(u.default, {
                    options: c.default.TypeNames,
                    selectedIndex: i.propertyType,
                    onSelectionChanged: this.changePropertyType,
                    disabled: n
                }))), o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Value"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, null != s ? o.default.createElement(u.default, {
                    options: s,
                    selectedIndex: t,
                    onSelectionChanged: this.changeBooleanValue,
                    isAnimating: n,
                    keyState: e,
                    onSetKey: this.setKey
                }) : o.default.createElement(l.default, {
                    isText: r,
                    value: t,
                    keyState: e,
                    decimals: a,
                    isAnimating: n,
                    onValueChanged: this.changeValue,
                    dragScale: .001,
                    onValueCommit: this.commit,
                    disabled: false,
                    onSetKey: this.setKey
                }))))
            }
        }]),
        t
    }(o.default.Component)).prototype, "propertyUpdate", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "propertyUpdate"), i.prototype),
    p(i.prototype, "deleteProperty", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "deleteProperty"), i.prototype),
    p(i.prototype, "changeName", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeName"), i.prototype),
    p(i.prototype, "changePropertyType", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changePropertyType"), i.prototype),
    p(i.prototype, "changeValue", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeValue"), i.prototype),
    p(i.prototype, "commit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "commit"), i.prototype),
    p(i.prototype, "setKey", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setKey"), i.prototype),
    p(i.prototype, "changeBooleanValue", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeBooleanValue"), i.prototype),
    i);
    t.default = y,
    y.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = k(n(0)), a = k(n(1)), s = k(n(4)), l = k(n(264)), u = k(n(399)), c = k(n(463)), d = k(n(237)), h = k(n(208)), f = k(n(443)), p = k(n(596)), y = k(n(599)), m = k(n(514)), v = k(n(600)), g = k(n(598)), _ = k(n(597)), b = n(469), w = k(n(263)), O = k(n(607)), S = k(n(3));
    function k(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function P(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var E = (0,
    b.SortableElement)((function(e) {
        var t = e.item
          , n = e.deleteConstraint
          , i = e.isAnimating;
        return o.default.createElement(O.default, {
            item: t,
            onDelete: n,
            isAnimating: i
        })
    }
    ))
      , T = (0,
    b.SortableContainer)((function(e) {
        var t = e.items
          , n = e.deleteConstraint
          , i = e.isAnimating;
        return o.default.createElement("ul", null, t.map((function(e, t) {
            return o.default.createElement(E, {
                key: t,
                index: t,
                item: e,
                deleteConstraint: n,
                isAnimating: i
            })
        }
        )))
    }
    ))
      , C = (P((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {},
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "setItems",
            value: function(e) {
                (0,
                w.default)(this.items, e) || (this.component && this.component.removeEventListener("childrenChanged", this.onChildrenChanged),
                this.items = e,
                this.component = e && e[0].node,
                this.component && this.component.addEventListener("childrenChanged", this.onChildrenChanged))
            }
        }, {
            key: "onChildrenChanged",
            value: function(e) {
                this.forceUpdate()
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.stageItems != this.props.stageItems && this.setItems(e.stageItems)
            }
        }, {
            key: "componentWillMount",
            value: function() {
                this.setItems(this.props.stageItems)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setItems(null)
            }
        }, {
            key: "makeConstraint",
            value: function(e) {
                var t = this.context.nima.actor.addNodeType(e, this.component, {});
                t ? (t.onAdded(),
                t.stageItem && t.stageItem.addToStage(this.context.nima.stage),
                this.context.nima.captureJournalEntry()) : console.error("Unable to make constraint.")
            }
        }, {
            key: "addConstraint",
            value: function(e) {
                var t = this
                  , n = this.context.nima
                  , i = [{
                    name: "IK",
                    type: p.default,
                    ownerType: d.default
                }, {
                    name: "Transform",
                    type: y.default,
                    ownerType: h.default
                }, {
                    name: "Distance",
                    type: m.default,
                    ownerType: h.default
                }, {
                    name: "Translation",
                    type: v.default,
                    ownerType: h.default
                }, {
                    name: "Scale",
                    type: g.default,
                    ownerType: h.default
                }, {
                    name: "Rotation",
                    type: _.default,
                    ownerType: h.default
                }]
                  , r = []
                  , o = this.makeConstraint
                  , a = function(e) {
                    if (!(t.component instanceof e.ownerType))
                        return "continue";
                    var n = {
                        name: e.name,
                        select: function() {
                            o(e.type)
                        }
                    };
                    r.push(n)
                }
                  , s = true
                  , l = false
                  , u = void 0;
                try {
                    for (var c, f = i[Symbol.iterator](); !(s = (c = f.next()).done); s = true)
                        a(c.value)
                } catch (e) {
                    l = true,
                    u = e
                } finally {
                    try {
                        !s && f.return && f.return()
                    } finally {
                        if (l)
                            throw u
                    }
                }
                r.length && n.showContextMenu({
                    x: e.clientX,
                    y: e.clientY,
                    items: r
                })
            }
        }, {
            key: "deleteConstraint",
            value: function(e) {
                var t = new c.default(this.context.nima.stage,this.context.nima.actor,[e.stageItem],[]);
                t.start(),
                t.end()
            }
        }, {
            key: "onSortEnd",
            value: function(e) {
                var t = e.oldIndex
                  , n = e.newIndex
                  , i = []
                  , r = []
                  , o = this.component;
                if (o) {
                    var a = true
                      , s = false
                      , l = void 0;
                    try {
                        for (var u, c = o.children[Symbol.iterator](); !(a = (u = c.next()).done); a = true) {
                            var d = u.value;
                            d instanceof f.default ? i.push(d) : r.push(d)
                        }
                    } catch (e) {
                        s = true,
                        l = e
                    } finally {
                        try {
                            !a && c.return && c.return()
                        } finally {
                            if (s)
                                throw l
                        }
                    }
                }
                i = (0,
                b.arrayMove)(i, t, n),
                o.children = r.concat(i),
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "render",
            value: function() {
                var e = this.props.isAnimating
                  , t = []
                  , n = this.component;
                if (n) {
                    var i = true
                      , r = false
                      , a = void 0;
                    try {
                        for (var s, u = n.children[Symbol.iterator](); !(i = (s = u.next()).done); i = true) {
                            var c = s.value;
                            c instanceof f.default && t.push(c)
                        }
                    } catch (e) {
                        r = true,
                        a = e
                    } finally {
                        try {
                            !i && u.return && u.return()
                        } finally {
                            if (r)
                                throw a
                        }
                    }
                }
                return o.default.createElement(l.default, {
                    _key: "_ConstraintOpts",
                    label: "Constraints",
                    className: "EventsContent",
                    action: this.props.isAnimating ? null : o.default.createElement("svg", {
                        className: "AddButton",
                        onClick: this.addConstraint
                    }, o.default.createElement("use", {
                        xlinkHref: S.default.make("/images/symbol-defs.svg#icon-plus")
                    }))
                }, t.length ? o.default.createElement(T, {
                    lockAxis: "y",
                    helperClass: "DragGhost",
                    distance: 10,
                    onSortMove: this.onSortMove,
                    onSortEnd: this.onSortEnd,
                    items: t,
                    deleteConstraint: this.deleteConstraint,
                    isAnimating: e
                }) : o.default.createElement("div", {
                    className: "SelectionPanelEmptyMsg"
                }, "No constraints"))
            }
        }]),
        t
    }(o.default.Component)).prototype, "onChildrenChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onChildrenChanged"), i.prototype),
    P(i.prototype, "makeConstraint", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "makeConstraint"), i.prototype),
    P(i.prototype, "addConstraint", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "addConstraint"), i.prototype),
    P(i.prototype, "deleteConstraint", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "deleteConstraint"), i.prototype),
    P(i.prototype, "onSortEnd", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onSortEnd"), i.prototype),
    i);
    t.default = C,
    C.validate = function(e, t) {
        if (e.state.isAnimationOpen) {
            if (1 === t.length)
                for (var n = t[0].node, i = n.children.length - 1; i >= 0; i--) {
                    if (n.children[i].constructor === u.default)
                        return true
                }
            return false
        }
        return true
    }
    ,
    C.canMultiEdit = false,
    C.panelOrder = 5,
    C.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = v(n(0)), a = v(n(1)), s = v(n(4)), l = v(n(348)), u = v(n(264)), c = v(n(347)), d = v(n(310)), h = v(n(380)), f = v(n(719)), p = v(n(184)), y = v(n(263)), m = v(n(3));
    function v(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function g(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var _ = (g((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {},
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "constraintUpdate",
            value: function() {
                this.forceUpdate()
            }
        }, {
            key: "setConstraintItems",
            value: function(e) {
                if (!(0,
                y.default)(this.stageItems, e)) {
                    if (this.stageItems)
                        for (var t = 0; t < this.stageItems.length; t++) {
                            var n = this.stageItems[t].node;
                            n.removeEventListener("strengthChange", this.constraintUpdate),
                            n.removeEventListener("enabledChange", this.constraintUpdate),
                            n.removeEventListener("targetChange", this.constraintUpdate)
                        }
                    if (this.stageItems = e,
                    this.constraint = null,
                    this.stageItems)
                        for (var i = 0; i < this.stageItems.length; i++) {
                            var r = this.stageItems[i].node;
                            r.addEventListener("strengthChange", this.constraintUpdate),
                            r.addEventListener("enabledChange", this.constraintUpdate),
                            r.addEventListener("targetChange", this.constraintUpdate)
                        }
                }
            }
        }, {
            key: "keyStrength",
            value: function(e) {
                if (this.stageItems) {
                    for (var t = 0; t < this.stageItems.length; t++) {
                        var n = this.stageItems[t].node;
                        this.context.nima.editingAnimation.toggleKey(n, "frameStrength")
                    }
                    this.context.nima.captureJournalEntry(),
                    this.forceUpdate()
                }
            }
        }, {
            key: "changeStrength",
            value: function(e, t) {
                if (this.stageItems) {
                    for (var n = 0; n < this.stageItems.length; n++) {
                        this.stageItems[n].node.strength = e
                    }
                    t || this.context.nima.captureJournalEntry(),
                    this.forceUpdate()
                }
            }
        }, {
            key: "commit",
            value: function() {
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.stageItems != this.props.stageItems && this.setConstraintItems(e.stageItems)
            }
        }, {
            key: "componentWillMount",
            value: function() {
                this.setConstraintItems(this.props.stageItems)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setConstraintItems(null)
            }
        }, {
            key: "toggleEnabled",
            value: function() {
                if (this.stageItems) {
                    for (var e = !(this.stageItems.length && this.stageItems[0].node.isEnabled), t = 0; t < this.stageItems.length; t++) {
                        this.stageItems[t].node.isEnabled = e
                    }
                    this.context.nima.captureJournalEntry()
                }
            }
        }, {
            key: "pickedTarget",
            value: function(e, t) {
                this.pickTargetAlert && (this.pickTargetAlert.hide(),
                this.pickTargetAlert = null);
                var n = this.context.nima
                  , i = n.stage;
                i.clearRerouteSelection(this.rerouteCB),
                n.clearCancelCallback(this.cancelCB),
                i.clearExtraSelectionFilter(),
                delete this.rerouteCB,
                delete this.cancelCB,
                e && e(t)
            }
        }, {
            key: "pickTarget",
            value: function(e) {
                var t = this.context.nima
                  , n = t.stage;
                if (!this.pickTargetAlert && !n.soloItem) {
                    var i = this;
                    this.pickTargetAlert = t.alert({
                        title: "Pick Target",
                        message: "Select the item to use as a target.",
                        type: p.default.Types.State,
                        buttons: [{
                            label: "CLEAR",
                            action: function(t, n) {
                                i.pickedTarget(e, null),
                                e(null)
                            }
                        }, {
                            label: "CANCEL",
                            action: function(t, n) {
                                i.pickedTarget(e)
                            }
                        }]
                    }),
                    this.cancelCB = function(t) {
                        i.pickedTarget(e)
                    }
                    ,
                    this.rerouteCB = function(t) {
                        i.pickedTarget(e, t)
                    }
                    ,
                    t.setCancelCallback(this.cancelCB),
                    n.rerouteSelection(this.rerouteCB),
                    n.setExtraSelectionFilter((function(e) {
                        return !e.drawAfterSelections
                    }
                    ))
                }
            }
        }, {
            key: "pickConstraintTarget",
            value: function() {
                var e = this
                  , t = this.context.nima;
                this.pickTarget((function(n) {
                    if (void 0 !== n) {
                        var i = function(e) {
                            var i = e.node;
                            t.detectDependencyCycles((function() {
                                i.target = n.node,
                                i.onTargetOptionChanged()
                            }
                            ))
                        }
                          , r = true
                          , o = false
                          , a = void 0;
                        try {
                            for (var s, l = e.stageItems[Symbol.iterator](); !(r = (s = l.next()).done); r = true) {
                                i(s.value)
                            }
                        } catch (e) {
                            o = true,
                            a = e
                        } finally {
                            try {
                                !r && l.return && l.return()
                            } finally {
                                if (o)
                                    throw a
                            }
                        }
                        e.context.nima.captureJournalEntry()
                    }
                }
                ))
            }
        }, {
            key: "removeConstraintTarget",
            value: function() {
                if (this.stageItems) {
                    var e = true
                      , t = false
                      , n = void 0;
                    try {
                        for (var i, r = this.stageItems[Symbol.iterator](); !(e = (i = r.next()).done); e = true) {
                            i.value.node.target = null
                        }
                    } catch (e) {
                        t = true,
                        n = e
                    } finally {
                        try {
                            !e && r.return && r.return()
                        } finally {
                            if (t)
                                throw n
                        }
                    }
                    this.context.nima.captureJournalEntry()
                }
            }
        }, {
            key: "render",
            value: function() {
                var e = this.props.isAnimating
                  , n = l.default.validate(t.Validation, this.stageItems);
                return o.default.createElement(u.default, {
                    label: "Constraint",
                    action: e ? null : o.default.createElement(d.default, {
                        isOn: n.isEnabled,
                        onToggle: this.toggleEnabled
                    })
                }, o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Strength"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(c.default, {
                    value: n.strength,
                    keyState: n.frameStrengthKS,
                    isAnimating: e,
                    onValueChanged: this.changeStrength,
                    dragScale: .005,
                    onValueCommit: this.commit,
                    onSetKey: this.keyStrength
                }))), e || false === n.target ? null : o.default.createElement("div", {
                    style: {
                        marginBottom: "10px"
                    }
                }, o.default.createElement("div", {
                    onClick: this.pickConstraintTarget,
                    className: "SelectionPanelButton MeshBonesHeader",
                    style: {
                        borderRadius: n.target ? null : "20px"
                    }
                }, o.default.createElement("span", null, n.targetName || "Target"), o.default.createElement("svg", {
                    className: "AddButton"
                }, o.default.createElement("use", {
                    xlinkHref: m.default.make("/images/symbol-defs.svg#icon-plus")
                }))), n.target ? o.default.createElement(f.default, {
                    key: n.target.refId,
                    node: n.target,
                    onRemove: this.removeConstraintTarget
                }) : null))
            }
        }]),
        t
    }(o.default.Component)).prototype, "constraintUpdate", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "constraintUpdate"), i.prototype),
    g(i.prototype, "keyStrength", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "keyStrength"), i.prototype),
    g(i.prototype, "changeStrength", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeStrength"), i.prototype),
    g(i.prototype, "commit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "commit"), i.prototype),
    g(i.prototype, "toggleEnabled", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleEnabled"), i.prototype),
    g(i.prototype, "pickConstraintTarget", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "pickConstraintTarget"), i.prototype),
    g(i.prototype, "removeConstraintTarget", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "removeConstraintTarget"), i.prototype),
    i);
    t.default = _,
    _.canMultiEdit = true,
    _.panelOrder = 3,
    _.validate = function(e, t) {
        return l.default.validate(_.Validation, t)
    }
    ,
    _.Validation = {
        targetName: {
            validate: function(e) {
                return e.node && e.node.constructor.targetName
            }
        },
        strength: {
            validate: function(e) {
                return e.node && e.node.strength
            },
            equals: function(e, t) {
                return l.default.isValue(e) && l.default.isValue(t) && e.constructor === Number && t.constructor === Number
            }
        },
        isEnabled: {
            validate: function(e) {
                return e.node && e.node.isEnabled
            }
        },
        frameStrengthKS: {
            validate: function(e) {
                return e.node && e.node.frameStrengthKS
            }
        },
        target: {
            validate: function(e) {
                return !!(e.node && e.node instanceof h.default) && e.node.target
            }
        }
    },
    _.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = f(n(0)), a = f(n(1)), s = f(n(4)), l = f(n(348)), u = f(n(264)), c = f(n(316)), d = f(n(344)), h = f(n(263));
    function f(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function p(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var y = (p((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {},
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "itemPropertiesUpdated",
            value: function() {
                var e = this;
                clearTimeout(this.t),
                this.t = setTimeout((function() {
                    e.forceUpdate()
                }
                ), 10)
            }
        }, {
            key: "setItems",
            value: function(e) {
                if (!(0,
                h.default)(this.items, e)) {
                    if (this.items)
                        for (var t = 0; t < this.items.length; t++) {
                            var n = this.items[t];
                            n.node && (n.node.removeEventListener("activeChildChanged", this.itemPropertiesUpdated),
                            n.node.removeEventListener("keyState", this.itemPropertiesUpdated))
                        }
                    if (this.items = e,
                    e)
                        for (var i = 0; i < e.length; i++) {
                            var r = e[i];
                            r.node && (r.node.addEventListener("activeChildChanged", this.itemPropertiesUpdated),
                            r.node.addEventListener("keyState", this.itemPropertiesUpdated))
                        }
                }
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.stageItems != this.props.stageItems && this.setItems(e.stageItems)
            }
        }, {
            key: "componentWillMount",
            value: function() {
                this.setItems(this.props.stageItems)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setItems(null)
            }
        }, {
            key: "changeActiveChild",
            value: function(e) {
                this.items[0].node.activeChildIndex = e - 1,
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "keyFavoriteChild",
            value: function(e) {
                var t = this.items[0];
                this.context.nima.editingAnimation.toggleKey(t.node, "frameActiveChild"),
                this.context.nima.captureJournalEntry(),
                this.forceUpdate()
            }
        }, {
            key: "render",
            value: function() {
                var e = l.default.validate(t.Validation, this.items)
                  , n = this.props.isAnimating
                  , i = this.items[0]
                  , r = [{
                    label: "None"
                }]
                  , a = i.node.activeChildIndex + 1
                  , s = true
                  , d = false
                  , h = void 0;
                try {
                    for (var f, p = i.node.children[Symbol.iterator](); !(s = (f = p.next()).done); s = true) {
                        var y = f.value;
                        r.push({
                            label: y.name,
                            child: y
                        })
                    }
                } catch (e) {
                    d = true,
                    h = e
                } finally {
                    try {
                        !s && p.return && p.return()
                    } finally {
                        if (d)
                            throw h
                    }
                }
                var m = i.node.frameActiveChildKS;
                return o.default.createElement(u.default, {
                    _key: "_SoloSelectionOpts",
                    label: "Solo Options"
                }, e.hasSoloChildren ? o.default.createElement("div", {
                    className: "SelectionPanelProperty"
                }, o.default.createElement("div", {
                    className: "SelectionPanelPropertyTitle"
                }, "Active Child"), o.default.createElement("div", {
                    className: "SelectionPanelProperties"
                }, o.default.createElement(c.default, {
                    options: r,
                    selectedIndex: a,
                    onSelectionChanged: this.changeActiveChild,
                    isAnimating: n,
                    keyState: m,
                    onSetKey: this.keyFavoriteChild
                }))) : null)
            }
        }]),
        t
    }(o.default.Component)).prototype, "itemPropertiesUpdated", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "itemPropertiesUpdated"), i.prototype),
    p(i.prototype, "changeActiveChild", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeActiveChild"), i.prototype),
    p(i.prototype, "keyFavoriteChild", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "keyFavoriteChild"), i.prototype),
    i);
    t.default = y,
    y.validate = function(e, t) {
        var n = l.default.validate(y.Validation, t);
        return !!n.hasSoloChildren && n
    }
    ,
    y.Validation = {
        hasSoloChildren: {
            validate: function(e) {
                return !!(e.node && e.node instanceof d.default)
            }
        }
    },
    y.canMultiEdit = false,
    y.panelOrder = 2,
    y.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = f(n(0)), a = f(n(1)), s = f(n(4)), l = f(n(348)), u = f(n(264)), c = f(n(607)), d = f(n(380)), h = f(n(263));
    function f(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function p(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var y = (p((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                validation: {
                    targetFor: false
                }
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "deleteTarget",
            value: function(e) {
                e.target = null,
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "onDependenciesUpdated",
            value: function() {
                this.setState({
                    validation: l.default.validate(t.Validation, this.items)
                })
            }
        }, {
            key: "setStageItems",
            value: function(e) {
                (0,
                h.default)(this.items, e) || (this.node && this.node.actor.removeEventListener("dependenciesUpdate", this.onDependenciesUpdated),
                this.items = e,
                e && e.length ? this.node = e[0].node : this.node = null,
                this.node && this.node.actor.addEventListener("dependenciesUpdate", this.onDependenciesUpdated),
                this.setState({
                    validation: l.default.validate(t.Validation, e)
                }),
                this.forceUpdate())
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.stageItems != this.props.stageItems && this.setStageItems(e.stageItems)
            }
        }, {
            key: "componentDidMount",
            value: function() {
                this.setStageItems(this.props.stageItems)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setStageItems(null)
            }
        }, {
            key: "render",
            value: function() {
                var e = this
                  , t = this.state.validation.targetFor
                  , n = t ? t.map((function(t) {
                    return o.default.createElement(c.default, {
                        key: t.refId,
                        item: t,
                        isAnimating: false,
                        onDelete: e.deleteTarget
                    })
                }
                )) : [];
                return o.default.createElement(u.default, {
                    label: "Target For",
                    className: "EventsContent"
                }, n.length > 0 ? n : o.default.createElement("div", {
                    className: "SelectionPanelEmptyMsg"
                }, "No constraints"))
            }
        }]),
        t
    }(o.default.Component)).prototype, "deleteTarget", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "deleteTarget"), i.prototype),
    p(i.prototype, "onDependenciesUpdated", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onDependenciesUpdated"), i.prototype),
    i);
    t.default = y,
    y.canMultiEdit = false,
    y.panelOrder = -1,
    y.validate = function(e, t) {
        var n = l.default.validate(y.Validation, t);
        return !!n.targetFor && n
    }
    ,
    y.Validation = {
        targetFor: {
            validate: function(e) {
                var t = e.node;
                if (!t)
                    return false;
                var n = t.actor;
                if (!n)
                    return false;
                var i = []
                  , r = n.dependencyGraph.getDependents(t);
                if (r) {
                    var o = true
                      , a = false
                      , s = void 0;
                    try {
                        for (var l, u = r[Symbol.iterator](); !(o = (l = u.next()).done); o = true) {
                            var c = l.value.constraints;
                            if (c) {
                                var h = true
                                  , f = false
                                  , p = void 0;
                                try {
                                    for (var y, m = c[Symbol.iterator](); !(h = (y = m.next()).done); h = true) {
                                        var v = y.value;
                                        v instanceof d.default && v.target === t && i.push(v)
                                    }
                                } catch (e) {
                                    f = true,
                                    p = e
                                } finally {
                                    try {
                                        !h && m.return && m.return()
                                    } finally {
                                        if (f)
                                            throw p
                                    }
                                }
                            }
                        }
                    } catch (e) {
                        a = true,
                        s = e
                    } finally {
                        try {
                            !o && u.return && u.return()
                        } finally {
                            if (a)
                                throw s
                        }
                    }
                }
                return !!i.length && i
            }
        }
    },
    y.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = h(n(509)), a = h(n(201)), s = h(n(608)), l = n(2), u = h(n(262)), c = h(n(410)), d = h(n(1));
    function h(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function f(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var p = (f((i = function() {
        function e(t, n, i) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e),
            this._Nima = t,
            this._ActorImage = n,
            this._SelectionPanel = i,
            this._StageMesh = null,
            this._IsMeshVisible = true,
            this._WeightWorkers = [],
            this._AllowUndo = false,
            this._LastWeightData = null,
            this._Journal = [],
            this._JournalIndex = -1,
            this._LastEntry = -1,
            this._Stage = n.stageItem.stage,
            this._IsCalculatingWeights = false,
            this._Verts = null,
            this._PaintWeightData = null;
            for (var r = 0; r < 3; r++)
                this._WeightWorkers.push(new y);
            this._ShowDeformed = true
        }
        return r(e, [{
            key: "weightsUpdated",
            value: function() {
                var e = this._ActorImage;
                if (e.weightData = this._PaintWeightData,
                e.updateWeightData(),
                this._PaintWeightData = new Float32Array(e.weightData),
                this._ShowDeformed) {
                    for (var t = this._ActorImage.meshData, n = new Float32Array(t.verts), i = this._ActorImage.computeWorldVertices(), r = i.length / 2, a = 0, s = 0, l = 0; l < r; l++)
                        n[a] = i[s++],
                        n[a + 1] = i[s++],
                        a += 4;
                    this._StageMesh.setMesh(n, t.tris, 4, false),
                    o.default.call("sbv", [n, null], (function() {}
                    )),
                    this._Verts = n
                }
            }
        }, {
            key: "onToolChanged",
            value: function(e) {
                this._LastTool = e.to
            }
        }, {
            key: "activate",
            value: function() {
                this._Stage.addEventListener("toolChanged", this.onToolChanged);
                for (var e = this._ShowDeformed, t = this._ActorImage.connectedBones, n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.node.stageItem && (i.node.stageItem.fillColor = a.default.Colors[n % a.default.Colors.length],
                    i.node.stageItem.parent = this._ActorImage.stageItem,
                    i.node.stageItem.overrideTransform = e ? null : i.bind,
                    i.node.stageItem.overrideLength = e ? null : i.length)
                }
                this._StageMesh = new s.default(this._ActorImage),
                this._StageMesh.isVisible = this._IsMeshVisible,
                this._StageMesh.parent = this._ActorImage.stageItem,
                this._StageMesh.addToStage(this._ActorImage.stageItem.stage);
                var r = this._ActorImage.meshData;
                if (this._AllowUndo = false,
                -1 === this._LastEntry)
                    this.captureJournalEntry();
                else {
                    var l = this;
                    o.default.call("eq", [this._LastWeightData, this._ActorImage.weightData], (function(e) {
                        l._AllowUndo = true,
                        e || (l._Journal.length = 0,
                        l._JournalIndex = -1,
                        l._LastEntry = -1,
                        l.captureJournalEntry())
                    }
                    ))
                }
                var u = this._ActorImage;
                this._PaintWeightData = new Float32Array(this._ActorImage.weightData),
                u.stageItem.updatePaintWeightData(this._PaintWeightData);
                var d = new Float32Array(r.verts);
                if (e)
                    for (var h = u.computeWorldVertices(), f = h.length / 2, p = 0, y = 0, m = 0; m < f; m++)
                        d[p] = h[y++],
                        d[p + 1] = h[y++],
                        p += 4;
                this._StageMesh.setMesh(d, r.tris, 4, !e),
                u.stageItem.drawDeformed = e,
                o.default.call("sbv", [d, e ? null : u.worldTransform], (function() {}
                )),
                this._Verts = d,
                this._Nima.setCancelCallback(this.closeWeightEditor),
                this._LastTool ? this._Stage.toolType = this._LastTool : this._Stage.toolType = c.default
            }
        }, {
            key: "deactivate",
            value: function() {
                this._Stage.removeEventListener("toolChanged", this.onToolChanged);
                for (var e = this._ActorImage.connectedBones, t = 0; t < e.length; t++) {
                    var n = e[t];
                    n.node.stageItem && (n.node.stageItem.fillColor = null,
                    n.node.stageItem.parent = null,
                    n.node.stageItem.overrideTransform = null,
                    n.node.stageItem.overrideLength = null)
                }
                this._StageMesh && (this._StageMesh.removeFromStage(),
                this._StageMesh = null),
                this._PaintWeightData = null
            }
        }, {
            key: "calculateAutoWeights",
            value: function() {
                var e = this;
                if (!this._IsCalculatingWeights) {
                    var t = this._ActorImage.connectedBones;
                    1 == t.length || function() {
                        e._IsCalculatingWeights = true;
                        var n = e._ActorImage.width
                          , i = e._ActorImage.height
                          , r = n / 2
                          , o = i / 2
                          , a = new Array(t.length)
                          , s = t.length
                          , u = m.make(n * i)
                          , c = e._ActorImage.bitmap;
                        if (c)
                            for (var d = n * i, h = 0; h < d; h++) {
                                c.bytes[h * c.channels + 3];
                                m.set(u, h)
                            }
                        for (var f = e._ActorImage.worldTransform, p = l.mat2d.invert(l.mat2d.create(), f), y = function(c) {
                            var d = t[c]
                              , h = d.bind
                              , f = l.vec2.create()
                              , y = l.vec2.set(l.vec2.create(), d.node.length, 0);
                            l.vec2.transformMat2d(f, f, h),
                            l.vec2.transformMat2d(y, y, h),
                            l.vec2.transformMat2d(f, f, p),
                            l.vec2.transformMat2d(y, y, p),
                            f[0] += r,
                            f[1] += o,
                            y[0] += r,
                            y[1] += o;
                            var m, v = e._WeightWorkers[c % e._WeightWorkers.length], g = e;
                            v.makeHeatMap(n, i, u, f, y, (m = c,
                            function(e) {
                                if (a[m] = e,
                                0 == --s) {
                                    for (var l = g._ActorImage.meshData.verts, u = l.length / 4, c = 0, d = 0, h = new Float32Array(8 * u), f = 0; f < u; f++) {
                                        for (var p = Math.max(0, Math.min(n - 1, Math.round(l[c] + r))), y = Math.max(0, Math.min(i - 1, Math.round(l[c + 1] + o))) * n + p, v = Number.MAX_VALUE, _ = 0; _ < t.length; _++) {
                                            var b = a[_][y];
                                            b < v && (v = b,
                                            h[d + 0] = _ + 1)
                                        }
                                        h[d + 4] = 1,
                                        c += 4,
                                        d += 8
                                    }
                                    g.smoothWeights(h, 10),
                                    g._ActorImage.weightData = h,
                                    g._PaintWeightData = new Float32Array(h),
                                    g._IsCalculatingWeights = false,
                                    g._ActorImage.updateWeightData(),
                                    g._Stage.redraw(),
                                    g.captureJournalEntry()
                                }
                            }
                            ))
                        }, v = 0; v < t.length; v++)
                            y(v)
                    }()
                }
            }
        }, {
            key: "smoothWeights",
            value: function(e, t) {
                for (var n = this._ActorImage.meshData.verts.length / 4, i = this._ActorImage.meshData.tris, r = i.length / 3, o = {}, a = 0, s = 0; s < r; s++) {
                    var l = i[a++]
                      , u = i[a++]
                      , c = i[a++]
                      , d = o[l];
                    d || (o[l] = d = {
                        c: []
                    }),
                    -1 === d.c.indexOf(u) && d.c.push(u),
                    -1 === d.c.indexOf(c) && d.c.push(c),
                    (d = o[u]) || (o[u] = d = {
                        c: []
                    }),
                    -1 === d.c.indexOf(l) && d.c.push(l),
                    -1 === d.c.indexOf(c) && d.c.push(c),
                    (d = o[c]) || (o[c] = d = {
                        c: []
                    }),
                    -1 === d.c.indexOf(l) && d.c.push(l),
                    -1 === d.c.indexOf(u) && d.c.push(u)
                }
                t || (t = 1);
                for (var h = 0; h < t; h++)
                    for (var f in o)
                        for (var p = o[f], y = 0; y < p.c.length; y++) {
                            var m = p.c[y]
                              , v = this.heaviestVertexWeight(e, m);
                            0 != v.w && this.addVertexWeight(e, f, v.i, .5 * v.w)
                        }
                for (var g = 0; g < n; g++)
                    this.normalizeVertexWeight(e, g)
            }
        }, {
            key: "getWeight",
            value: function(e, t) {
                e += 1;
                for (var n = this._PaintWeightData, i = 8 * t, r = 0; r < 4; r++) {
                    if (n[i + r] === e)
                        return n[i + r + 4]
                }
                return 0
            }
        }, {
            key: "setWeight",
            value: function(e, t, n, i) {
                t = Math.min(1, Math.max(0, t)),
                e += 1;
                var r = this._ActorImage
                  , o = this._PaintWeightData
                  , a = true
                  , s = false
                  , l = void 0;
                try {
                    for (var u, c = n[Symbol.iterator](); !(a = (u = c.next()).done); a = true) {
                        for (var d = 8 * u.value, h = false, f = 0; f < 4; f++) {
                            if (o[d + f] === e) {
                                h = true,
                                o[d + f + 4] = t;
                                break
                            }
                        }
                        if (!h) {
                            for (var p = Number.MAX_VALUE, y = 0, m = 0; m < 4; m++) {
                                var v = o[d + m + 4];
                                v < p && (p = v,
                                y = m)
                            }
                            o[d + y + 4] = t,
                            o[d + y] = e
                        }
                        var g = 1 - t;
                        if (0 == g)
                            for (var _ = 0; _ < 4; _++) {
                                o[d + _] !== e && (o[d + _ + 4] = 0)
                            }
                        else {
                            for (var b = 0, w = 0; w < 4; w++) {
                                var O = o[d + w];
                                O !== e ? b += o[d + w + 4] : 0 === O && (o[d + w + 4] = 0)
                            }
                            if (b == g) {
                                console.log("PERFECT", b, g);
                                continue
                            }
                            if (0 === b) {
                                for (var S = 0; S < 4; S++) {
                                    if (o[d + S] !== e) {
                                        o[d + S] = 1 !== e ? 1 : e !== r.connectedBones.length ? r.connectedBones.length : 0,
                                        o[d + S + 4] = g;
                                        break
                                    }
                                }
                                continue
                            }
                            for (var k = g / b, P = 0; P < 4; P++) {
                                o[d + P] !== e && (o[d + P + 4] *= k),
                                o[d + P + 4]
                            }
                        }
                    }
                } catch (e) {
                    s = true,
                    l = e
                } finally {
                    try {
                        !a && c.return && c.return()
                    } finally {
                        if (s)
                            throw l
                    }
                }
                i || (r.stageItem.updatePaintWeightData(this._PaintWeightData),
                this.weightsUpdated())
            }
        }, {
            key: "commitSetWeight",
            value: function() {
                this._ActorImage.stageItem.updatePaintWeightData(this._PaintWeightData),
                this.weightsUpdated()
            }
        }, {
            key: "paintInfluence",
            value: function(e, t, n, i) {
                var r = this._ActorImage;
                if (!(r.connectedBones.length <= 1)) {
                    (e > 1 || e < 0) && (e = 0);
                    var o = false;
                    i++;
                    var a = this._PaintWeightData;
                    a || (this._PaintWeightData = a = new Float32Array(r.weightData));
                    for (var s = this._LastWeightData, l = 0; l < t.length; l++) {
                        for (var u = 8 * t[l], c = n[l] * e, d = false, h = 0, f = false, p = 0; p < 4; p++) {
                            if (a[u + p] === i) {
                                f = true;
                                var y = a[u + p + 4];
                                h = y + c;
                                var m = e;
                                s[u + p] === i && (m = Math.min(1, s[u + p + 4] + e)),
                                h > m && (h = m),
                                y !== h && (d = true,
                                a[u + p + 4] = h);
                                break
                            }
                        }
                        if (!f) {
                            for (var v = Number.MAX_VALUE, g = 0, _ = 0; _ < 4; _++) {
                                var b = a[u + _ + 4];
                                b < v && (v = b,
                                g = _)
                            }
                            d = true,
                            a[u + g + 4] = c,
                            h = c,
                            a[u + g] = i
                        }
                        if (d) {
                            o = true;
                            var w = 1 - h
                              , O = 0;
                            if (0 == w)
                                for (var S = 0; S < 4; S++) {
                                    a[u + S] !== i && (a[u + S + 4] = 0)
                                }
                            else {
                                for (var k = 0; k < 4; k++) {
                                    var P = a[u + k];
                                    P !== i ? O += a[u + k + 4] : 0 === P && (a[u + k + 4] = 0)
                                }
                                if (O == w)
                                    continue;
                                for (var E = w / O, T = 0; T < 4; T++) {
                                    a[u + T] !== i && (a[u + T + 4] *= E)
                                }
                            }
                        }
                    }
                    o && r.stageItem.updatePaintWeightData(this._PaintWeightData)
                }
            }
        }, {
            key: "subtractInfluence",
            value: function(e, t, n, i) {
                var r = this._ActorImage;
                if (!(r.connectedBones.length <= 1)) {
                    (e > 1 || e < 0) && (e = 0);
                    var o = false;
                    i++;
                    var a = this._PaintWeightData;
                    a || (this._PaintWeightData = a = new Float32Array(r.weightData));
                    for (var s = this._LastWeightData, l = 0; l < t.length; l++) {
                        for (var u = 8 * t[l], c = n[l] * e, d = false, h = 0, f = 0; f < 4; f++) {
                            if (a[u + f] === i) {
                                true;
                                var p = a[u + f + 4];
                                h = p - c;
                                var y = 0;
                                s[u + f] === i && (y = Math.min(1, Math.max(0, s[u + f + 4] - e))),
                                h < y && (h = y),
                                p !== h && (d = true,
                                a[u + f + 4] = h);
                                break
                            }
                        }
                        if (d) {
                            o = true;
                            var m = 1 - h
                              , v = 0;
                            if (0 == m)
                                for (var g = 0; g < 4; g++) {
                                    a[u + g] !== i && (a[u + g + 4] = 0)
                                }
                            else {
                                for (var _ = 0; _ < 4; _++) {
                                    var b = a[u + _];
                                    b !== i ? v += a[u + _ + 4] : 0 === b && (a[u + _ + 4] = 0)
                                }
                                if (0 === v) {
                                    for (var w = this._ActorImage.meshData.verts, O = w.length / 4, S = 0, k = 4 * t[l], P = w[k], E = w[k + 1], T = -1, C = Number.MAX_VALUE, x = 0; x < O; x++) {
                                        var I = 8 * x;
                                        if (0 !== a[I + 4] && a[I] !== i || 0 !== a[I + 5] && a[I + 1] !== i || 0 !== a[I + 6] && a[I + 2] !== i || 0 !== a[I + 7] && a[I + 3] !== i) {
                                            var D = w[S] - P
                                              , M = w[S + 1] - E
                                              , A = D * D + M * M;
                                            A < C && (T = x,
                                            C = A),
                                            S += 4
                                        } else
                                            S += 4
                                    }
                                    var j = 1;
                                    if (-1 !== T)
                                        for (var L = 8 * T, R = 0, F = 0; F < 4; F++) {
                                            var B = a[L + F + 4]
                                              , V = a[L + F];
                                            V !== i && (B > R && (R = B,
                                            j = V))
                                        }
                                    for (var N = 0; N < 4; N++) {
                                        if (a[u + N] !== i) {
                                            a[u + N] = j,
                                            a[u + N + 4] = m;
                                            break
                                        }
                                    }
                                } else {
                                    if (v == m)
                                        continue;
                                    for (var z = m / v, W = 0; W < 4; W++) {
                                        a[u + W] !== i && (a[u + W + 4] *= z)
                                    }
                                }
                            }
                        }
                    }
                    o && r.stageItem.updatePaintWeightData(this._PaintWeightData)
                }
            }
        }, {
            key: "addVertexWeight",
            value: function(e, t, n, i) {
                for (var r = 8 * t, o = 0; o < 4; o++) {
                    if (e[r + o] === n)
                        return e[r + o + 4] += .1 * i,
                        true
                }
                for (var a = 0; a < 4; a++) {
                    if (e[r + a] <= i)
                        return e[r + a + 4] = i,
                        e[r + a] = n,
                        true
                }
                return false
            }
        }, {
            key: "heaviestVertexWeight",
            value: function(e, t) {
                for (var n = 8 * t, i = 0, r = 0, o = 0; o < 4; o++) {
                    var a = e[n + o + 4];
                    a > i && (i = a,
                    r = e[n + o])
                }
                return {
                    w: i,
                    i: r
                }
            }
        }, {
            key: "normalizeVertexWeight",
            value: function(e, t) {
                for (var n = 8 * t, i = 0, r = 0; r < 4; r++)
                    0 != e[n + r] ? i += e[n + r + 4] : e[n + r + 4] = 0;
                if (1 == i)
                    return false;
                var o = 1 / i;
                return e[n + 4] *= o,
                e[n + 5] *= o,
                e[n + 6] *= o,
                e[n + 7] *= o,
                true
            }
        }, {
            key: "blurMap",
            value: function(e, t, n) {
                for (var i = [.003765, .015019, .023792, .015019, .003765, .015019, .059912, .094907, .059912, .015019, .023792, .094907, .150342, .094907, .023792, .015019, .059912, .094907, .059912, .015019, .003765, .015019, .023792, .015019, .003765], r = [], o = 0; o < i.length; o++) {
                    var a = o % 5
                      , s = Math.floor(o / 5);
                    r.push([a + -2, s + -2, i[o]])
                }
                for (var l = void 0, u = n, c = e * t, d = 0; d < 20; d++) {
                    for (var h = new Float32Array(c), f = 0; f < e; f++)
                        for (var p = 0; p < t; p++) {
                            for (var y = 0, m = 0; m < r.length; m++) {
                                var v = r[m]
                                  , g = f + v[0]
                                  , _ = p + v[1]
                                  , b = v[2];
                                g >= 0 && g < e && _ >= 0 && _ < t && (y += u[_ * e + g] * b)
                            }
                            h[p * e + f] = y
                        }
                    l = h,
                    u = h
                }
                return l
            }
        }, {
            key: "makeHeatMapImage",
            value: function(e, t, n, i) {
                var r = document.createElement("canvas");
                r.width = e,
                r.height = t;
                for (var o = r.getContext("2d"), a = o.getImageData(0, 0, r.width, r.height), s = a.data, l = e * t, u = 0, c = 0; c < l; c++) {
                    var d = n[c];
                    d > u && (u = d)
                }
                for (var h = 0; h < t; h++)
                    for (var f = 0; f < e; f++) {
                        var p = 4 * ((t - h - 1) * e + f)
                          , y = n[h * e + f]
                          , m = Math.round(y / u * 255);
                        s[p] = m,
                        s[p + 1] = m,
                        s[p + 2] = m,
                        s[p + 3] = 255
                    }
                o.putImageData(a, 0, 0);
                var v = r.toDataURL();
                return document.createElement("img").src = v,
                r
            }
        }, {
            key: "clearHistory",
            value: function() {}
        }, {
            key: "captureJournalEntry",
            value: function(e) {
                -1 !== this._LastEntry && this._LastEntry === this._ActorImage.weightDataUndoDelta || (e || (this._JournalIndex != this._Journal.length - 1 && this._Journal.splice(this._JournalIndex + 1, this._Journal.length - (this._JournalIndex + 1)),
                this._Journal.push(this._LastWeightData = new Float32Array(this._ActorImage.weightData)),
                this._JournalIndex = this._Journal.length - 1),
                this._LastEntry = this._ActorImage.weightDataUndoDelta)
            }
        }, {
            key: "undo",
            value: function() {
                if (!(this._JournalIndex < 1)) {
                    var e = this._Journal[this._JournalIndex - 1];
                    if (e) {
                        var t = this._ActorImage;
                        t.weightData = new Float32Array(e),
                        this._PaintWeightData = new Float32Array(e),
                        t.stageItem.updatePaintWeightData(this._PaintWeightData),
                        this._LastWeightData = new Float32Array(e),
                        this._Stage.redraw(),
                        this.weightsUpdated()
                    }
                    this._JournalIndex--,
                    this.captureJournalEntry(true)
                }
            }
        }, {
            key: "redo",
            value: function() {
                if (!(this._JournalIndex + 1 > this._Journal.length - 1)) {
                    this._JournalIndex++;
                    var e = this._Journal[this._JournalIndex];
                    if (e) {
                        var t = this._ActorImage;
                        t.weightData = new Float32Array(e),
                        this._PaintWeightData = new Float32Array(e),
                        t.stageItem.updatePaintWeightData(this._PaintWeightData),
                        this._LastWeightData = new Float32Array(e),
                        this._Stage.redraw(),
                        this.weightsUpdated()
                    }
                    this.captureJournalEntry(true)
                }
            }
        }, {
            key: "closeWeightEditor",
            value: function() {
                this._Stage.tool && this._Stage.tool.cancel() ? this._Nima.setCancelCallback(this.closeWeightEditor) : this._SelectionPanel.editWeightsOff()
            }
        }, {
            key: "paintWeightData",
            get: function() {
                return this._PaintWeightData
            }
        }, {
            key: "verts",
            get: function() {
                return this._Verts
            }
        }, {
            key: "showDeformed",
            set: function(e) {
                this._ShowDeformed !== e && (this._ShowDeformed = e);
                for (var t = this._ActorImage, n = t.connectedBones, i = 0; i < n.length; i++) {
                    var r = n[i];
                    r.node.stageItem && (r.node.stageItem.overrideTransform = e ? null : r.bind,
                    r.node.stageItem.overrideLength = e ? null : r.length)
                }
                var a = t.meshData
                  , s = new Float32Array(a.verts);
                if (e)
                    for (var l = t.computeWorldVertices(), u = l.length / 2, c = 0, d = 0, h = 0; h < u; h++)
                        s[c] = l[d++],
                        s[c + 1] = l[d++],
                        c += 4;
                this._StageMesh.setMesh(s, a.tris, 4, !e),
                t.stageItem.drawDeformed = e,
                o.default.call("sbv", [s, e ? null : t.worldTransform], (function() {}
                )),
                this._Verts = s
            },
            get: function() {
                return this._ShowDeformed
            }
        }, {
            key: "node",
            get: function() {
                return this._ActorImage
            }
        }, {
            key: "stageItem",
            get: function() {
                return this._ActorImage.stageItem
            }
        }, {
            key: "isMeshVisible",
            get: function() {
                return this._IsMeshVisible
            },
            set: function(e) {
                this._IsMeshVisible = e,
                this._StageMesh && (this._StageMesh.isVisible = e,
                this._StageMesh.stage.redraw())
            }
        }]),
        e
    }()).prototype, "onToolChanged", [d.default], Object.getOwnPropertyDescriptor(i.prototype, "onToolChanged"), i.prototype),
    f(i.prototype, "closeWeightEditor", [d.default], Object.getOwnPropertyDescriptor(i.prototype, "closeWeightEditor"), i.prototype),
    i);
    function y() {
        var e = new Worker(u.default.getWorkerScript("AutoWeightWorker.js"))
          , t = 0
          , n = {};
        e.onmessage = function(e) {
            var t = n[e.data.id];
            t && (t(e.data.response),
            delete n[e.data.id])
        }
        ,
        this.makeHeatMap = function(i, r, o, a, s, l) {
            !function(i, r, o) {
                t++,
                n[t] = o,
                r.push(t),
                e.postMessage({
                    call: i,
                    arguments: r
                })
            }("makeHeatMap", [i, r, o, a, s], l)
        }
    }
    t.default = p;
    var m = {
        make: function(e) {
            return new Uint8Array(Math.ceil(e / 8))
        },
        set: function(e, t) {
            var n = t % 8;
            e[Math.floor(t / 8)] |= 1 << n
        },
        clear: function(e, t) {
            var n = t % 8;
            e[Math.floor(t / 8)] &= ~(1 << n)
        },
        get: function(e, t) {
            var n = t % 8;
            return 0 != (e[Math.floor(t / 8)] & 1 << n)
        }
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = v(n(1)), a = n(2), s = v(n(267)), l = v(n(384)), u = v(n(509)), c = v(n(397)), d = v(n(370)), h = v(n(608)), f = v(n(507)), p = v(n(447)), y = v(n(1162)), m = v(n(3));
    function v(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function g(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var _ = (g((i = function() {
        function e(t, n, i) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e),
            this._Nima = t,
            this._StageItem = n,
            this._SelectionPanel = i,
            this._WorldTransform = a.mat2d.create(),
            this._InverseWorldTransform = a.mat2d.create(),
            n.meshEditor = this,
            this._Stage = n.stage,
            this._Node = n.node,
            this._ContourVertices = [],
            this._ContourEdges = [],
            this._InteriorEdges = [],
            this._InteriorVertices = [],
            this._GhostPoint = null,
            this._GhostEdge = null,
            this._TempPoint = a.vec2.create(),
            this._NodeWidth = this._Node.width,
            this._NodeHeight = this._Node.height,
            this._HalfWidth = this._NodeWidth / 2,
            this._HalfHeight = this._NodeHeight / 2,
            this._IsDrawingContour = false,
            this._SuppressClearContour = false,
            this._PreNewContourState = null,
            this._Quality = 0,
            this._MinTriangleWidth = 10,
            this._MaxTriangleWidth = 200,
            this._IsContourClosed = true,
            this._HasBounds = this._Node.constructor === s.default,
            this._ContourOnly = this._Node.constructor !== s.default,
            this._LineOnly = this._Node.constructor === l.default && this._Node.shape == l.default.Shape.Line,
            this._LoFiVerts = null,
            this._LoFiTris = null,
            this._Tris = null,
            this._Verts = null,
            this._AlertsToClose = [],
            this._UpdateActorTimeout = null,
            this._Triangulation = 0,
            this._IsTriangulating = false,
            this._IsTriangulatingLoFi = false,
            this._QueuedTriangulation = false,
            this._IsCheckingPointsOver = false,
            this._QueuedPointCheck = null,
            this._StageMesh = null,
            this._LastSetWeightDataDelta = -1,
            this._Journal = [],
            this._JournalIndex = -1,
            this._LastEntry = null
        }
        return r(e, [{
            key: "isArraySame",
            value: function(e, t) {
                if (!e && t || e && !t)
                    return false;
                if (e.length != t.length)
                    return false;
                for (var n = e.length, i = 0; i < n; i++)
                    if (e[i] !== t[i])
                        return false;
                return true
            }
        }, {
            key: "updateActor",
            value: function() {
                if (this._IsContourClosed) {
                    if (this._IsTriangulating || this._IsTriangulatingLoFi)
                        return clearTimeout(this._UpdateActorTimeout),
                        void (this._UpdateActorTimeout = setTimeout(this.updateActor, 100));
                    var e = this.serialize()
                      , t = this._StageItem.node.meshData;
                    if (t && t.editor) {
                        var n = t.editor;
                        if (n.a === e.a && this.isArraySame(n.c, e.c) && this.isArraySame(n.ie, e.ie))
                            return
                    }
                    var i = {
                        editor: e,
                        verts: this._Verts,
                        tris: this._Tris,
                        loverts: this._LoFiVerts,
                        lotris: this._LoFiTris
                    };
                    this._StageItem.node.meshData = i;
                    var r = this;
                    u.default.call("recalcWeightData", [this._Verts], (function(e) {
                        e && (r._StageItem.node.weightData = e)
                    }
                    ))
                } else
                    this._LineOnly && (this._StageItem.node.lineData = this.serialize())
            }
        }, {
            key: "autoGenerate",
            value: function() {
                var t = this;
                e.autoGenMesh(this._StageItem.node.bitmap, (function(e) {
                    e.length ? (t.deserialize({
                        c: e,
                        cc: e.length / 2,
                        ie: [],
                        cl: true,
                        a: 0
                    }),
                    t.captureJournalEntry()) : t.reset()
                }
                ))
            }
        }, {
            key: "reset",
            value: function() {
                this._LineOnly ? this.deserialize([-50, 50]) : (this.deserialize({
                    c: [-this._HalfWidth, -this._HalfHeight, this._HalfWidth, -this._HalfHeight, this._HalfWidth, this._HalfHeight, -this._HalfWidth, this._HalfHeight],
                    cc: 4,
                    ie: [],
                    cl: true,
                    a: 0
                }),
                this.captureJournalEntry())
            }
        }, {
            key: "serialize",
            value: function() {
                for (var e = new Float32Array(2 * this._ContourVertices.length + 2 * this._InteriorVertices.length), t = 0, n = 0; n < this._ContourVertices.length; n++) {
                    var i = this._ContourVertices[n];
                    i.idx = t;
                    var r = i.position;
                    e[t++] = r[0],
                    e[t++] = r[1]
                }
                if (this._LineOnly)
                    return e;
                for (var o = 0; o < this._InteriorVertices.length; o++) {
                    var a = this._InteriorVertices[o];
                    a.idx = t;
                    var s = a.position;
                    e[t++] = s[0],
                    e[t++] = s[1]
                }
                var l = new Uint16Array(2 * this._InteriorEdges.length);
                t = 0;
                for (var u = 0; u < this._InteriorEdges.length; u++) {
                    var c = this._InteriorEdges[u];
                    l[t++] = c.vtxA.idx / 2,
                    l[t++] = c.vtxB.idx / 2
                }
                return {
                    c: e,
                    cc: this._ContourVertices.length,
                    cl: this._IsContourClosed,
                    ie: l,
                    a: this._Quality
                }
            }
        }, {
            key: "areSerializationsSame",
            value: function(e, t) {
                if (e.constructor === Float32Array || t.constructor === Float32Array) {
                    if (e.length !== t.length)
                        return false;
                    for (var n = 0; n < e.length; n++)
                        if (e[n] !== t[n])
                            return false;
                    return true
                }
                if (e.a != t.a)
                    return false;
                if (e.c.length != t.c.length)
                    return false;
                if (e.ie.length != t.ie.length)
                    return false;
                if (e.cl != t.cl)
                    return false;
                for (var i = e.c.length, r = e.c, o = t.c, a = 0; a < i; a++)
                    if (r[a] != o[a])
                        return false;
                i = e.ie.length,
                r = e.ie,
                o = t.ie;
                for (var s = 0; s < i; s++)
                    if (r[s] != o[s])
                        return false;
                return true
            }
        }, {
            key: "empty",
            value: function() {
                for (var e = 0; e < this._ContourEdges.length; e++) {
                    var t = this._ContourEdges[e];
                    t.cleanup(),
                    t.removeFromStage(),
                    t = null
                }
                this._ContourEdges.length = 0;
                for (var n = 0; n < this._ContourVertices.length; n++) {
                    var i = this._ContourVertices[n];
                    i.cleanup(),
                    i.removeFromStage(),
                    i = null
                }
                this._ContourVertices.length = 0;
                for (var r = 0; r < this._InteriorEdges.length; r++) {
                    var o = this._InteriorEdges[r];
                    o.cleanup(),
                    o.removeFromStage(),
                    o = null
                }
                this._InteriorEdges.length = 0;
                for (var a = 0; a < this._InteriorVertices.length; a++) {
                    var s = this._InteriorVertices[a];
                    s.cleanup(),
                    s.removeFromStage(),
                    s = null
                }
                this._InteriorVertices.length = 0,
                this.hideGhostPoint(),
                this.hideGhostEdge(),
                this.hideMesh()
            }
        }, {
            key: "deserialize",
            value: function(e) {
                if (this.empty(),
                this._LineOnly) {
                    var t = e;
                    this._IsContourClosed = false;
                    for (var n = t.length / 2, i = 0, r = [], o = 0; o < n; o++) {
                        var a = t[i++]
                          , s = t[i++];
                        r.push(this.appendContourPoint([a, s], true))
                    }
                } else {
                    this.setQuality(e.a, true);
                    var l = e.c
                      , u = e.cl;
                    this._IsContourClosed = u;
                    for (var c = e.cc, d = 0, h = [], p = 0; p < c; p++) {
                        var y = l[d++]
                          , m = l[d++];
                        h.push(this.appendContourPoint([y, m], true))
                    }
                    for (var v = l.length; d < v; ) {
                        var g = l[d++]
                          , _ = l[d++];
                        h.push(this.addPoint([g, _], true, true))
                    }
                    for (var b = e.ie, w = b.length, O = 0; O < w; ) {
                        var S = b[O++]
                          , k = b[O++]
                          , P = h[S]
                          , E = h[k];
                        this.addEdge(P, E, true)
                    }
                    u ? this.closeContour() : (this._SuppressClearContour = true,
                    this._Stage.toolType = f.default,
                    this._SuppressClearContour = false)
                }
            }
        }, {
            key: "triangulate",
            value: function() {
                if (this._IsTriangulating || this._IsTriangulatingLoFi)
                    this._QueuedTriangulation = true;
                else {
                    this._Triangulation++;
                    for (var t = new Float32Array(2 * this._ContourVertices.length + 2 * this._InteriorVertices.length), n = new Uint16Array(2 * this._ContourEdges.length + 2 * this._InteriorEdges.length), i = 0, r = 0, o = 0; o < this._ContourVertices.length; o++) {
                        var a = this._ContourVertices[o]
                          , s = a.position;
                        a.idx = i,
                        t[i++] = s[0],
                        t[i++] = s[1],
                        0 != o && (n[r++] = o,
                        n[r++] = o - 1)
                    }
                    this._ContourVertices.length > 2 && (n[r++] = this._ContourVertices.length - 1,
                    n[r++] = 0);
                    for (var l = 0; l < this._InteriorVertices.length; l++) {
                        var u = this._InteriorVertices[l];
                        u.idx = i;
                        var c = u.position;
                        t[i++] = c[0],
                        t[i++] = c[1]
                    }
                    for (var d = 0; d < this._InteriorEdges.length; d++) {
                        var h = this._InteriorEdges[d];
                        n[r++] = h.vtxA.idx / 2,
                        n[r++] = h.vtxB.idx / 2
                    }
                    var f = 0;
                    this._Quality && (f = this._MinTriangleWidth * this._Quality + this._MaxTriangleWidth * (1 - this._Quality)),
                    this._IsTriangulating = true;
                    var p, y = this;
                    e.triangulate(t, n, f, this._NodeWidth, this._NodeHeight, (p = this._Triangulation,
                    function(e) {
                        p === y._Triangulation && (y._IsTriangulating = false,
                        y.setMesh(e.pts, e.tris),
                        y._QueuedTriangulation && (y._QueuedTriangulation = false,
                        y.triangulate()))
                    }
                    )),
                    this._IsTriangulatingLoFi = true,
                    e.triangulateLoFi(t, n, 0, 2 * this._ContourVertices.length, 2 * this._ContourEdges.length, function(e) {
                        return function(t) {
                            e === y._Triangulation && (y._IsTriangulatingLoFi = false,
                            y._LoFiVerts = t.pts,
                            y._LoFiTris = t.tris,
                            y._QueuedTriangulation && (y._QueuedTriangulation = false,
                            y.triangulate()))
                        }
                    }(this._Triangulation))
                }
            }
        }, {
            key: "isPointOverMesh",
            value: function(t, n) {
                if (this._IsCheckingPointsOver)
                    this._QueuedPointCheck = {
                        p: a.vec2.clone(t),
                        cb: n
                    };
                else {
                    this._QueuedPointCheck = null;
                    var i = new Float32Array(2);
                    i[0] = t[0],
                    i[1] = t[1],
                    this._IsCheckingPointsOver = true;
                    var r, o = this;
                    e.arePointsOverLoFi(i, (r = n,
                    function(e) {
                        o._IsCheckingPointsOver = false,
                        o._QueuedPointCheck && o.isPointOverMesh(o._QueuedPointCheck.p, o._QueuedPointCheck.cb),
                        r(1 == e[0])
                    }
                    ))
                }
            }
        }, {
            key: "hideMesh",
            value: function() {
                this._StageMesh && (this._StageMesh.removeFromStage(),
                this._StageMesh = null)
            }
        }, {
            key: "setMesh",
            value: function(e, t) {
                this._Tris = t,
                this._Verts = e,
                this._StageMesh || (this._StageMesh = new h.default(this._StageItem.node),
                this._StageMesh.parent = this._StageItem,
                this._StageMesh.addToStage(this._Stage)),
                this._StageMesh.setMesh(e, t, 4, true)
            }
        }, {
            key: "deactivate",
            value: function() {
                this._Node.constructor !== s.default && (this._StageItem.isEditing = false),
                this._Stage.disableSelectionFilter = false,
                this.captureJournalEntry(),
                this.empty()
            }
        }, {
            key: "activate",
            value: function() {
                if (this._Stage.disableSelectionFilter = true,
                this._Stage.toolType != f.default ? this._PreviousToolType = this._Stage.toolType : this._PreviousToolType = p.default,
                this._Stage.toolType = f.default,
                this._Node.constructor !== s.default && (this._StageItem.isEditing = true),
                this._NodeWidth = this._Node.width,
                this._NodeHeight = this._Node.height,
                this._HalfWidth = this._NodeWidth / 2,
                this._HalfHeight = this._NodeHeight / 2,
                this._StageItem.node.meshData && this._StageItem.node.weightData && this._LastSetWeightDataDelta != this._StageItem.node.weightDataUndoDelta) {
                    var e = this._StageItem.node
                      , t = e.meshData
                      , n = e.weightData;
                    u.default.call("setBaseWeightData", [t.verts, n], (function() {}
                    )),
                    this._LastSetWeightDataDelta = this._StageItem.node.weightDataUndoDelta
                }
                if (a.mat2d.copy(this._WorldTransform, this._StageItem.node.worldTransform),
                a.mat2d.invert(this._InverseWorldTransform, this._WorldTransform),
                this._LineOnly ? this._StageItem.node.lineData ? this.deserialize(this._StageItem.node.lineData) : this.reset() : this._StageItem.node.meshData ? this.deserialize(this._StageItem.node.meshData.editor) : 0 == this._ContourVertices.length && this.reset(),
                this._StageItem.node.meshData && this._StageItem.node.meshData.deform) {
                    var i = this._Nima.alert({
                        title: "Warning!",
                        message: "This mesh has deformation data, changing the mesh will reset the deformation data and any vertex animations."
                    });
                    this._AlertsToClose.push(i)
                }
                this._SelectionPanel.setMeshQuality(this._Quality),
                this.captureJournalEntry(),
                this._Nima.setCancelCallback(this.close)
            }
        }, {
            key: "getLocalPoint",
            value: function(e) {
                return a.vec2.transformMat2d(this._TempPoint, e, this._InverseWorldTransform)
            }
        }, {
            key: "getLocalMove",
            value: function(e) {
                return a.vec2.transformMat2(this._TempPoint, e, this._InverseWorldTransform)
            }
        }, {
            key: "getWorldPoint",
            value: function(e) {
                return a.vec2.transformMat2d(this._TempPoint, e, this._WorldTransform)
            }
        }, {
            key: "constrainWorld",
            value: function(e) {
                var t = this.getLocalPoint(e);
                return this._HasBounds && (t[0] = Math.min(Math.max(t[0], -this._HalfWidth), this._HalfWidth),
                t[1] = Math.min(Math.max(t[1], -this._HalfHeight), this._HalfHeight)),
                this.getWorldPoint(t)
            }
        }, {
            key: "constrainLocal",
            value: function(e) {
                var t = a.vec2.copy(this._TempPoint, e);
                return this._HasBounds && (t[0] = Math.min(Math.max(t[0], -this._HalfWidth), this._HalfWidth),
                t[1] = Math.min(Math.max(t[1], -this._HalfHeight), this._HalfHeight)),
                t
            }
        }, {
            key: "doesEdgeIntersect",
            value: function(e) {
                return false
            }
        }, {
            key: "doesAnyEdgeIntersect",
            value: function() {
                for (var e = this._ContourEdges, t = e.length, n = 0; n < t; n++)
                    for (var i = e[n], r = n + 1; r < t; r++)
                        if (c.default.intersects(i, e[r]))
                            return true;
                return false
            }
        }, {
            key: "validateEdge",
            value: function(e) {
                for (var t = this._ContourEdges, n = Number.MAX_VALUE, i = null, r = null, o = 0; o < t.length; o++) {
                    var s = t[o]
                      , l = c.default.intersection(e, s);
                    if (l) {
                        var u = a.vec2.squaredDistance(e.vtxA.position, l);
                        u < n && (n = u,
                        i = l,
                        r = s)
                    }
                }
                return i && (e.vtxB != this._GhostPoint ? (this.updateGhostPoint(i, true),
                e.vtxB = this._GhostPoint) : e.vtxB.position = i),
                e.collisionEdge = r,
                r && e == this._GhostEdge && this._IsDrawingContour && (this._GhostEdge.isVisible = false),
                r
            }
        }, {
            key: "startNewContour",
            value: function() {
                this._IsContourClosed = false,
                this._Nima.setCancelCallback(this.cancelContour),
                this._SuppressClearContour || (this._IsContourClosed ? this._PreNewContourState = this.serialize() : this._PreNewContourState = null,
                this.empty()),
                this._IsDrawingContour = true,
                this._Stage.toolType = f.default
            }
        }, {
            key: "updateGhostPoint",
            value: function(e, t) {
                var n = t ? e : this.constrainLocal(this.getLocalPoint(e));
                this._GhostPoint ? this._GhostPoint.position = n : (this._GhostPoint = new d.default(this._WorldTransform,this._InverseWorldTransform),
                this._GhostPoint.position = n,
                this._GhostPoint.parent = this._StageItem,
                this._GhostPoint.addToStage(this._Stage),
                this._GhostPoint.isSelectable = false)
            }
        }, {
            key: "updateGhostEdge",
            value: function(e, t) {
                e || (e = this._GhostPoint),
                e && (t || this._IsDrawingContour && 0 !== this._ContourVertices.length) && (t || (t = this._ContourVertices[this._ContourVertices.length - 1]),
                this._GhostEdge ? (this._GhostEdge.vtxA = t,
                this._GhostEdge.vtxB = e) : (this._GhostEdge = new c.default(t,e),
                this._GhostEdge.parent = this._StageItem,
                this._GhostEdge.addToStage(this._Stage),
                this._GhostEdge.isSelectable = false),
                this._GhostEdge.isVisible = true,
                this.validateEdge(this._GhostEdge))
            }
        }, {
            key: "hideGhostPoint",
            value: function() {
                this._GhostPoint && (this._GhostPoint.cleanup(),
                this._GhostPoint.removeFromStage(),
                this._GhostPoint = null)
            }
        }, {
            key: "hideGhostEdge",
            value: function() {
                this._GhostEdge && (this._GhostEdge.cleanup(),
                this._GhostEdge.removeFromStage(),
                this._GhostEdge = null)
            }
        }, {
            key: "makePoint",
            value: function(e, t) {
                var n = t ? e : this.constrainLocal(this.getLocalPoint(e))
                  , i = new d.default(this._WorldTransform,this._InverseWorldTransform);
                return i.position = n,
                i.parent = this._StageItem,
                i.addToStage(this._Stage),
                i
            }
        }, {
            key: "appendContourPoint",
            value: function(e, t) {
                var n = this.makePoint(e, t);
                if (this._ContourVertices.push(n),
                this._ContourVertices.length > 1) {
                    var i = new c.default(this._ContourVertices[this._ContourVertices.length - 2],this._ContourVertices[this._ContourVertices.length - 1]);
                    i.parent = this._StageItem,
                    i.addToStage(this._Stage),
                    this._ContourEdges.push(i)
                }
                return n
            }
        }, {
            key: "addPoint",
            value: function(e, t, n) {
                var i = this.makePoint(e, t);
                return i.isInternal = true,
                this._InteriorVertices.push(i),
                n || this.markMeshDirty(),
                i
            }
        }, {
            key: "edgeExists",
            value: function(e, t) {
                for (var n = this._ContourEdges.concat(this._InteriorEdges), i = 0; i < n.length; i++) {
                    var r = n[i];
                    if (!(r.vtxA != e && r.vtxB != e || r.vtxA != t && r.vtxB != t))
                        return true
                }
                return false
            }
        }, {
            key: "addEdge",
            value: function(e, t, n) {
                var i = new c.default(e,t);
                return i.isInternal = true,
                i.parent = this._StageItem,
                i.addToStage(this._Stage),
                this._InteriorEdges.push(i),
                n || this.markMeshDirty(),
                i
            }
        }, {
            key: "splitEdge",
            value: function(e, t) {
                var n = -1 === this._ContourEdges.indexOf(e) ? this._InteriorEdges : this._ContourEdges
                  , i = n === this._InteriorEdges ? this._InteriorVertices : this._ContourVertices
                  , r = this.makePoint(t);
                n == this._InteriorEdges && (r.isInternal = true);
                var o = i.indexOf(e.vtxA)
                  , a = i.indexOf(e.vtxB)
                  , s = void 0;
                s = n === this._ContourEdges && 0 == a ? o + 1 : o > a ? o : a,
                i.splice(s, 0, r),
                s = n.indexOf(e),
                n.splice(s, 1),
                e.removeFromStage();
                var l = new c.default(e.vtxA,r);
                return l.parent = this._StageItem,
                l.addToStage(this._Stage),
                n.push(l),
                (l = new c.default(r,e.vtxB)).parent = this._StageItem,
                l.addToStage(this._Stage),
                n.push(l),
                this.markMeshDirty(),
                r
            }
        }, {
            key: "insertContourPoint",
            value: function(e, t) {
                var n = this.makePoint(t)
                  , i = this._ContourVertices.indexOf(e.vtxA)
                  , r = this._ContourVertices.indexOf(e.vtxB)
                  , o = r;
                i > r && (o = i),
                this._ContourVertices.splice(o, 0, n),
                o = this._ContourEdges.indexOf(e),
                this._ContourEdges.splice(o, 1),
                e.removeFromStage();
                var a = new c.default(e.vtxA,n);
                a.parent = this._StageItem,
                a.addToStage(this._Stage),
                this._ContourEdges.push(a),
                (a = new c.default(e.vtxB,n)).parent = this._StageItem,
                a.addToStage(this._Stage),
                this._ContourEdges.push(a)
            }
        }, {
            key: "close",
            value: function() {
                if (this._Stage.tool && this._Stage.tool.cancel())
                    this._Nima.setCancelCallback(this.close);
                else {
                    this._SelectionPanel.closeMeshEditor();
                    for (var e = 0; e < this._AlertsToClose.length; e++) {
                        this._AlertsToClose[e].hide()
                    }
                    this._AlertsToClose.length = 0,
                    this._Stage.toolType = this._PreviousToolType
                }
            }
        }, {
            key: "cancelContour",
            value: function() {
                this._PreNewContourState ? (this.deserialize(this._PreNewContourState),
                this._PreNewContourState = null) : this.reset(),
                this._IsContourClosed = true,
                this.hideGhostPoint(),
                this.hideGhostEdge(),
                this._Nima.setCancelCallback(this.close)
            }
        }, {
            key: "closeContour",
            value: function() {
                if (this._ContourVertices.length <= 2)
                    this.cancelContour();
                else {
                    this._IsContourClosed = true;
                    var e = new c.default(this._ContourVertices[this._ContourVertices.length - 1],this._ContourVertices[0]);
                    e.parent = this._StageItem,
                    e.addToStage(this._Stage),
                    this._ContourEdges.push(e),
                    this.triangulate(),
                    this._Nima.setCancelCallback(this.close)
                }
            }
        }, {
            key: "setQuality",
            value: function(e, t) {
                this._Quality !== e && (this._Quality = e,
                this._SelectionPanel.setMeshQuality(e),
                t || this.markMeshDirty())
            }
        }, {
            key: "markMeshDirty",
            value: function() {
                this.triangulate()
            }
        }, {
            key: "getConnectedEdges",
            value: function(e) {
                for (var t = [], n = 0; n < this._ContourEdges.length; n++) {
                    var i = this._ContourEdges[n];
                    if ((i.vtxA === e || i.vtxB === e) && (t.push(i),
                    2 === t.length))
                        break
                }
                for (var r = 0; r < this._InteriorEdges.length; r++) {
                    var o = this._InteriorEdges[r];
                    o.vtxA !== e && o.vtxB !== e || t.push(o)
                }
                return t
            }
        }, {
            key: "delete",
            value: function(e) {
                if (e) {
                    e.constructor !== Array && (e = [e]);
                    for (var t = [], n = 0; n < e.length; n++) {
                        var i = e[n];
                        switch (i.constructor) {
                        case d.default:
                            t.push(i);
                            break;
                        case c.default:
                            var r = this._InteriorEdges.indexOf(i);
                            -1 !== r ? (i.cleanup(),
                            i.removeFromStage(),
                            this._InteriorEdges.splice(r, 1)) : (t.push(i.vtxA),
                            t.push(i.vtxB))
                        }
                    }
                    for (var o = 0; o < t.length; o++) {
                        var a = t[o]
                          , s = this._ContourVertices.indexOf(a);
                        if (-1 !== s) {
                            a.cleanup(),
                            a.removeFromStage(),
                            this._ContourVertices.splice(s, 1);
                            for (var l = [], u = 0; u < this._ContourEdges.length; u++) {
                                var h = this._ContourEdges[u];
                                if ((h.vtxA === a || h.vtxB === a) && (l.push(h),
                                2 === l.length))
                                    break
                            }
                            if (2 === l.length) {
                                var f = l[0]
                                  , p = l[1];
                                f = f.vtxA === a ? f.vtxB : f.vtxA,
                                p = p.vtxA === a ? p.vtxB : p.vtxA;
                                var y = new c.default(f,p);
                                y.parent = this._StageItem,
                                y.addToStage(this._Stage),
                                this._ContourEdges.push(y)
                            }
                            for (var m = 0; m < l.length; m++) {
                                var v = l[m];
                                v.cleanup(),
                                v.removeFromStage();
                                var g = this._ContourEdges.indexOf(v);
                                -1 != g && this._ContourEdges.splice(g, 1)
                            }
                            for (var _ = 0; _ < this._InteriorEdges.length; _++) {
                                var b = this._InteriorEdges[_];
                                b.vtxA !== a && b.vtxB !== a || (b.cleanup(),
                                b.removeFromStage(),
                                this._InteriorEdges.splice(_, 1),
                                _--)
                            }
                        } else if (-1 !== (s = this._InteriorVertices.indexOf(a))) {
                            a.cleanup(),
                            a.removeFromStage(),
                            this._InteriorVertices.splice(s, 1);
                            for (var w = 0; w < this._InteriorEdges.length; w++) {
                                var O = this._InteriorEdges[w];
                                O.vtxA !== a && O.vtxB !== a || (O.cleanup(),
                                O.removeFromStage(),
                                this._InteriorEdges.splice(w, 1),
                                w--)
                            }
                        }
                    }
                    this._ContourVertices.length < 3 ? (this.reset(),
                    this.markMeshDirty()) : e.length && this.markMeshDirty()
                }
            }
        }, {
            key: "deleteSelection",
            value: function() {
                this.delete(this._Stage.selectedItems)
            }
        }, {
            key: "captureJournalEntry",
            value: function(e) {
                var t = this.serialize();
                this._LastEntry && this.areSerializationsSame(this._LastEntry, t) || (t && !e && (this._JournalIndex != this._Journal.length - 1 && this._Journal.splice(this._JournalIndex + 1, this._Journal.length - (this._JournalIndex + 1)),
                this._Journal.push(t),
                this._JournalIndex = this._Journal.length - 1),
                this._LastEntry = t,
                clearTimeout(this._UpdateActorTimeout),
                this._UpdateActorTimeout = setTimeout(this.updateActor, 100))
            }
        }, {
            key: "undo",
            value: function() {
                if (!(this._JournalIndex < 1)) {
                    var e = this._Journal[this._JournalIndex - 1];
                    e && this.deserialize(e),
                    this._JournalIndex--,
                    this.captureJournalEntry(true)
                }
            }
        }, {
            key: "redo",
            value: function() {
                if (!(this._JournalIndex + 1 > this._Journal.length - 1)) {
                    this._JournalIndex++;
                    var e = this._Journal[this._JournalIndex];
                    e && this.deserialize(e),
                    this.captureJournalEntry(true)
                }
            }
        }, {
            key: "canCloseContour",
            get: function() {
                return !this._LineOnly
            }
        }, {
            key: "isContourClosed",
            get: function() {
                return this._IsContourClosed
            }
        }, {
            key: "node",
            get: function() {
                return this._StageItem.node
            }
        }, {
            key: "ghostPoint",
            get: function() {
                return this._GhostPoint
            }
        }, {
            key: "ghostEdge",
            get: function() {
                return this._GhostEdge
            }
        }, {
            key: "stageItem",
            get: function() {
                return this._StageItem
            }
        }, {
            key: "firstContourVertex",
            get: function() {
                return this._ContourVertices.length ? this._ContourVertices[0] : null
            }
        }, {
            key: "contourVerticesCount",
            get: function() {
                return this._ContourVertices.length
            }
        }, {
            key: "hasBounds",
            get: function() {
                return this._HasBounds
            }
        }, {
            key: "contourOnly",
            get: function() {
                return this._ContourOnly
            }
        }]),
        e
    }()).prototype, "updateActor", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "updateActor"), i.prototype),
    g(i.prototype, "close", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "close"), i.prototype),
    g(i.prototype, "cancelContour", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "cancelContour"), i.prototype),
    i);
    t.default = _,
    _.triangulate = function(e, t, n, i, r, o) {
        _.triangleWorker || (_.triangleWorker = new Worker(m.default.make("/lib/Triangle.js")),
        _.callWorkerId = 0,
        _.callWorkerCallbacks = {},
        _.triangleWorker.onmessage = function(e) {
            var t = _.callWorkerCallbacks[e.data.id];
            t && (t(e.data.result),
            delete _.callWorkerCallbacks[e.data.id])
        }
        ),
        _.callWorkerId++,
        _.callWorkerCallbacks[_.callWorkerId] = o,
        _.triangleWorker.postMessage({
            vertices: e,
            edges: t,
            area: n * n,
            width: i,
            height: r,
            id: _.callWorkerId
        })
    }
    ,
    _.triangulateLoFi = function(e, t, n, i, r, o) {
        _.triangleWorkerLoFi || (_.triangleWorkerLoFi = new Worker(m.default.make("/lib/Triangle.js")),
        _.callWorkerIdLoFi = 0,
        _.callWorkerCallbacksLoFi = {},
        _.triangleWorkerLoFi.onmessage = function(e) {
            var t = _.callWorkerCallbacksLoFi[e.data.id];
            t && (t(e.data.result),
            delete _.callWorkerCallbacksLoFi[e.data.id])
        }
        ),
        _.callWorkerIdLoFi++,
        _.callWorkerCallbacksLoFi[_.callWorkerIdLoFi] = o,
        _.triangleWorkerLoFi.postMessage({
            vertices: e,
            edges: t,
            area: n * n,
            vertices_length: i,
            edges_length: r,
            hold: true,
            id: _.callWorkerIdLoFi
        })
    }
    ,
    _.arePointsOverLoFi = function(e, t) {
        _.callWorkerIdLoFi++,
        _.callWorkerCallbacksLoFi[_.callWorkerIdLoFi] = t,
        _.triangleWorkerLoFi.postMessage({
            points: e,
            id: _.callWorkerIdLoFi
        })
    }
    ,
    _.autoGenMesh = function(e, t) {
        y.default.makeMesh(e, t)
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = n(262);
    var a = function(e) {
        function t() {
            return function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t),
            function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, "AutoMeshWorker.js"))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "makeMesh",
            value: function(e, t) {
                this.callCustom({
                    bitmap: e
                }, t)
            }
        }]),
        t
    }(((i = o) && i.__esModule ? i : {
        default: i
    }).default);
    t.default = a,
    a.makeMesh = function(e, t) {
        a.instance || (a.instance = new a),
        a.instance.makeMesh(e, t)
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = l(n(0)), a = l(n(4)), s = l(n(1));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function u(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var c = (u((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {},
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "componentWillMount",
            value: function() {
                this.rootClassName = this.props.isVertical ? "LeftGuideRuler" : "TopGuideRuler",
                this.guides = [],
                this.permanentGuides = []
            }
        }, {
            key: "componentDidMount",
            value: function() {
                var e = this.canvas;
                e && (this.canvas = e,
                this.ctx = e.getContext("2d"),
                this.drawTicks()),
                this.context.nima.addEventListener("stageRectChanged", this.drawTicks)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.context.nima.removeEventListener("stageRectChanged", this.drawTicks)
            }
        }, {
            key: "setCanvas",
            value: function(e) {
                this.canvas = e
            }
        }, {
            key: "serialize",
            value: function() {
                if (this.permanentGuides && this.permanentGuides.length) {
                    for (var e = [], t = 0; t < this.permanentGuides.length; t++) {
                        var n = this.permanentGuides[t];
                        void 0 !== n.world && e.push(n.world)
                    }
                    if (e.length)
                        return e
                }
            }
        }, {
            key: "reset",
            value: function() {
                this.permanentGuides.length = 0,
                this.context.nima.stage.redraw()
            }
        }, {
            key: "deserialize",
            value: function(e) {
                if (e && e.length) {
                    for (var t = 0; t < e.length; t++) {
                        var n = e[t];
                        this.permanentGuides.push({
                            world: n
                        })
                    }
                    this.context.nima.stage.redraw()
                }
            }
        }, {
            key: "formatThousands",
            value: function(e, t) {
                for (var n = e.toFixed(t), i = 0 | n, r = e < 0 ? 1 : 0, o = ("" + Math.abs(n - i).toFixed(t)).substr(2, t), a = "" + i, s = a.length, l = ""; (s -= 3) > r; )
                    l = "," + a.substr(s, 3) + l;
                return a.substr(0, s + 3) + l + (o ? "." + o : "")
            }
        }, {
            key: "mouseMove",
            value: function(e) {
                var t = this.context.nima.stage;
                if (!t.isPanning && !this.dragGuide) {
                    this.hoverGuide || (this.hoverGuide = {}),
                    this.hitGuide = null,
                    this.hoverGuide.screenOffset = this.props.isVertical ? e.clientY : e.clientX;
                    for (var n = t.screenScale, i = 0; i < this.permanentGuides.length; i++) {
                        var r = this.permanentGuides[i];
                        if (Math.abs(r.screenOffset - this.hoverGuide.screenOffset * n) < 5 * n) {
                            this.hitGuide = r,
                            this.hoverGuide = null;
                            break
                        }
                    }
                    this.context.nima.stage.redraw()
                }
            }
        }, {
            key: "mouseLeave",
            value: function(e) {
                this.hoverGuide = null,
                this.context.nima.stage.redraw()
            }
        }, {
            key: "mouseDrag",
            value: function(e) {
                e.stopPropagation(),
                e.preventDefault(),
                this.dragGuide.screenOffset = this.props.isVertical ? e.clientY : e.clientX,
                delete this.dragGuide.world,
                this.context.nima.stage.redraw()
            }
        }, {
            key: "endDrag",
            value: function(e) {
                window.removeEventListener("mousemove", this.mouseDrag, true),
                window.removeEventListener("mouseup", this.endDrag, true);
                (this.props.isVertical ? this.dragGuide.localOffset > this.canvas.height : this.dragGuide.localOffset < 0) && this.permanentGuides.splice(this.permanentGuides.indexOf(this.dragGuide), 1),
                this.dragGuide = null,
                this.context.nima.stage.redraw(),
                this.context.nima.actor.revise()
            }
        }, {
            key: "mouseDown",
            value: function(e) {
                if (this.hitGuide)
                    return this.dragGuide = this.hitGuide,
                    this.hitGuide = null,
                    window.addEventListener("mousemove", this.mouseDrag, true),
                    void window.addEventListener("mouseup", this.endDrag, true);
                this.hoverGuide && void 0 !== this.hoverGuide.world && (this.permanentGuides.push(this.hoverGuide),
                this.hoverGuide = null,
                this.context.nima.actor.revise())
            }
        }, {
            key: "drawTicks",
            value: function() {
                if (this.canvas) {
                    var e = this.canvas
                      , t = this.ctx
                      , n = this.context.nima.stage
                      , i = this.props.isVertical
                      , r = this.context.nima.getStageRect()
                      , o = n.screenScale;
                    1 != o && (r = {
                        width: r.width * o,
                        height: r.height * o,
                        bottom: r.bottom * o,
                        top: r.top * o,
                        left: r.left * o
                    });
                    var a = 20 * o
                      , s = 30 * o;
                    if (r) {
                        var l = i ? s : r.width + 2 * a - s
                          , u = i ? r.height + 2 * a - s : s
                          , c = r.width + 2 * a - s;
                        r.height;
                        e.width == l && e.height == u || (e.width = l,
                        e.height = u);
                        for (var d = r.left - a + s, h = window.innerHeight * o - r.bottom - a, f = 16 * o, p = 64 * o, y = f * n.scale; y < 16 * o; )
                            y *= 2,
                            f *= 2,
                            p *= 2;
                        var m = Math.ceil(i ? r.height / y : r.width / y) + 2
                          , v = n.translation
                          , g = 0
                          , _ = 0;
                        if (i) {
                            var b = (h - v[1]) / n.scale;
                            _ = b - b % f,
                            g = -b % f * n.scale - y,
                            g -= y,
                            _ -= f
                        } else {
                            var w = (d - v[0]) / n.scale;
                            _ = w - w % f,
                            g = -w % f * n.scale - y,
                            g -= y,
                            _ -= f
                        }
                        var O = 10 * o;
                        t.save(),
                        t.clearRect(0, 0, e.width, e.height),
                        t.fillStyle = "rgba(255,255,255,0.1)",
                        t.font = 10 * o + "px Roboto",
                        i ? (t.fillRect(0, 0, s, 1),
                        t.rotate(-Math.PI / 2),
                        t.translate(-u, 0)) : t.fillRect(0, 0, 1, s);
                        for (var S = [], k = 0; k < m; k++) {
                            g += y;
                            var P = Math.round(_)
                              , E = Math.floor(g);
                            P % p == 0 ? (t.fillRect(E, 0, 1, s),
                            S.push(P, E)) : t.fillRect(E, s - O, 1, O),
                            _ += f
                        }
                        t.fillStyle = "rgba(255,255,255,0.6)";
                        for (var T = S.length, C = 0; C < T; C += 2) {
                            var x = S[C]
                              , I = S[C + 1];
                            t.fillText(this.formatThousands(x), Math.floor(I) + 5 * o, 13 * o)
                        }
                        if (t.fillStyle = "rgba(87,165,224,1.0)",
                        this.guides.length = 0,
                        this.hoverGuide) {
                            var D = 0;
                            if (i) {
                                var M = (window.innerHeight * o - this.hoverGuide.screenOffset * o - v[1]) / n.scale
                                  , A = -(M * n.scale + v[1] - window.innerHeight * o)
                                  , j = window.innerHeight * o - A;
                                this.hoverGuide.world = M,
                                D = u - (A - s),
                                this.guides.push({
                                    x: d,
                                    y: j,
                                    w: c,
                                    h: 1,
                                    o: .5
                                })
                            } else {
                                var L = (this.hoverGuide.screenOffset * o - v[0]) / n.scale
                                  , R = L * n.scale + v[0] - d;
                                D = R,
                                this.hoverGuide.world = L,
                                this.guides.push({
                                    x: R + d,
                                    y: 0,
                                    w: 1,
                                    h: window.innerHeight * o - s,
                                    o: .5
                                })
                            }
                            t.fillRect(D, 0, 1, s)
                        }
                        for (var F = 0; F < this.permanentGuides.length; F++) {
                            var B = this.permanentGuides[F]
                              , V = 0;
                            if (i) {
                                var N = B.world;
                                void 0 === N && (N = (window.innerHeight * o - B.screenOffset * o - v[1]) / n.scale,
                                B.world = N);
                                var z = -(N * n.scale + v[1] - window.innerHeight * o)
                                  , W = window.innerHeight * o - z;
                                B.screenOffset = z,
                                V = B.localOffset = u - (z - s),
                                this.guides.push({
                                    x: d,
                                    y: W,
                                    w: c,
                                    h: 1,
                                    o: 1
                                })
                            } else {
                                var H = B.world;
                                void 0 === H && (H = (B.screenOffset * o - v[0]) / n.scale,
                                B.world = H);
                                var U = H * n.scale + v[0]
                                  , K = U - d;
                                B.screenOffset = U,
                                B.localOffset = K,
                                V = K,
                                this.guides.push({
                                    x: U,
                                    y: 0,
                                    w: 1,
                                    h: window.innerHeight * o - s,
                                    o: 1
                                })
                            }
                            t.fillRect(V, 0, 1, s)
                        }
                        t.restore()
                    }
                }
            }
        }, {
            key: "render",
            value: function() {
                return o.default.createElement("div", {
                    style: {
                        display: this.props.isVisible ? null : "none"
                    },
                    className: this.rootClassName
                }, o.default.createElement("div", {
                    className: this.rootClassName + "Ticks"
                }, o.default.createElement("canvas", {
                    onMouseDown: this.mouseDown,
                    onMouseMove: this.mouseMove,
                    onMouseLeave: this.mouseLeave,
                    ref: this.setCanvas,
                    className: "GuideRulerTicks"
                })))
            }
        }]),
        t
    }(o.default.Component)).prototype, "setCanvas", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setCanvas"), i.prototype),
    u(i.prototype, "mouseMove", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseMove"), i.prototype),
    u(i.prototype, "mouseLeave", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseLeave"), i.prototype),
    u(i.prototype, "mouseDrag", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseDrag"), i.prototype),
    u(i.prototype, "endDrag", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "endDrag"), i.prototype),
    u(i.prototype, "mouseDown", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseDown"), i.prototype),
    u(i.prototype, "drawTicks", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "drawTicks"), i.prototype),
    i);
    t.default = c,
    c.contextTypes = {
        nima: a.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = w(n(0)), a = w(n(1)), s = w(n(1165)), l = w(n(605)), u = w(n(1167)), c = w(n(727)), d = w(n(1168)), h = w(n(1169)), f = w(n(1170)), p = w(n(1171)), y = w(n(1174)), m = w(n(1176)), v = w(n(4)), g = w(n(186)), _ = w(n(1177)), b = w(n(3));
    function w(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function O(e, t, n) {
        return t in e ? Object.defineProperty(e, t, {
            value: n,
            enumerable: true,
            configurable: true,
            writable: true
        }) : e[t] = n,
        e
    }
    function S(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var k = (S((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                activeAnimationHover: false,
                animationFilter: null,
                dropdownOpacity: 0,
                duration: 10,
                fps: 60,
                GraphActive: false,
                height: 260,
                input: "",
                isAnimationsOpen: false,
                isOpen: false,
                isPlaying: false,
                isResizing: false,
                keyedNodes: [],
                LoopActive: false,
                scrollOffset: 0,
                SelectionActive: false,
                timelineLeft: null,
                timelineWidth: null,
                WorkAreaActive: false
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "componentWillMount",
            value: function() {
                this.scrollOffset = 0,
                this.timelineCanvas = new p.default(this,this.context.nima),
                this.timelineCanvas.isActive = false
            }
        }, {
            key: "setTimelineHeader",
            value: function(e) {
                this.timelineHeader = e
            }
        }, {
            key: "setAnimationPanel",
            value: function(e) {
                this.animationPanel = e
            }
        }, {
            key: "resize",
            value: function() {
                if (this.virtualList && this.scrollbar.setContentHeight(this.virtualList.sizeAndPositionManager.getTotalSize()),
                this.timelineHeader) {
                    var e = this.timelineHeader.getBoundingClientRect();
                    this.state.timelineWidth == e.width && this.state.timelineLeft == e.left && this.timelineCanvas.top == e.bottom || (this.timelineCanvas.width = e.width,
                    this.timelineCanvas.left = e.left,
                    this.timelineCanvas.top = e.bottom,
                    this.setState({
                        timelineWidth: e.width,
                        timelineLeft: e.left
                    }))
                }
            }
        }, {
            key: "updateResize",
            value: function() {
                this.state.isOpen && this.resize(),
                this.resizeEndTime > Date.now() && window.requestAnimationFrame(this.updateResize)
            }
        }, {
            key: "resizeFor",
            value: function(e) {
                this.resizeEndTime = Date.now() + 1e3 * e,
                window.requestAnimationFrame(this.updateResize)
            }
        }, {
            key: "componentDidUpdate",
            value: function() {
                this.state.isOpen && this.resize()
            }
        }, {
            key: "componentDidMount",
            value: function() {
                this.timelineCanvas.isActive = this.state.isOpen,
                this.setHeight(this.state.height),
                window.addEventListener("resize", this.windowResize)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.context.nima.stage && this.context.nima.stage.removeEventListener("selectionChanged", this.stageSelectionChanged),
                window.removeEventListener("resize", this.windowResize)
            }
        }, {
            key: "windowResize",
            value: function() {
                this.resize()
            }
        }, {
            key: "startResize",
            value: function() {
                this.props.onClickResizeGrabber && this.props.onClickResizeGrabber(),
                window.addEventListener("mouseup", this.endResize, true),
                this.setState({
                    isResizing: true
                })
            }
        }, {
            key: "endResize",
            value: function() {
                this.resize(),
                window.removeEventListener("mouseup", this.endResize, true),
                this.setState({
                    isResizing: false
                })
            }
        }, {
            key: "animationNodesUpdated",
            value: function(e) {
                this.setState({
                    keyedNodes: e
                })
            }
        }, {
            key: "nameChanged",
            value: function(e) {
                this.forceUpdate()
            }
        }, {
            key: "stageSelectionChanged",
            value: function(e, t) {
                if (this.state.SelectionActive)
                    this.animation && this.animation.updateEditableKeyedNodes(),
                    this.forceUpdate();
                else if (this.animation) {
                    var n = this.animation.editableKeyedNodes;
                    if (!t || t.constructor !== s.default)
                        for (var i = n.length + 1, r = 0, o = 0; o < i; o++) {
                            if (o > 0) {
                                var a = n[o - 1].node;
                                if (a.stageItem && a.stageItem.isSelected) {
                                    this.scrollTo(r);
                                    break
                                }
                            }
                            r += this.getRowHeight(o)
                        }
                    var l = []
                      , u = true
                      , c = false
                      , d = void 0;
                    try {
                        for (var h, f = n[Symbol.iterator](); !(u = (h = f.next()).done); u = true) {
                            var p = h.value;
                            p && p.node && p.node.stageItem && p.node.stageItem.isSelected && (l = l.concat(p.baseKeyFrameGroup.propsList))
                        }
                    } catch (e) {
                        c = true,
                        d = e
                    } finally {
                        try {
                            !u && f.return && f.return()
                        } finally {
                            if (c)
                                throw d
                        }
                    }
                    l.length && this.animation.selectItem(l)
                }
                this.timelineCanvas.forceDraw()
            }
        }, {
            key: "recomputeSizes",
            value: function() {
                this.virtualList && (this.virtualList.recomputeSizes(1),
                this.forceUpdate())
            }
        }, {
            key: "updateDuration",
            value: function() {
                this.setState({
                    duration: this.animation.duration
                })
            }
        }, {
            key: "updateFps",
            value: function() {
                this.setState({
                    fps: this.animation.fps
                })
            }
        }, {
            key: "onKeyedPropertyChanged",
            value: function() {
                this.timelineCanvas && this.timelineCanvas.forceDraw()
            }
        }, {
            key: "setAnimation",
            value: function(e) {
                this.context.nima.stage.removeEventListener("selectionChanged", this.stageSelectionChanged),
                this.animation && (this.animation.removeEventListener("nameChanged", this.nameChanged),
                this.animation.removeEventListener("nodesUpdate", this.animationNodesUpdated),
                this.animation.removeEventListener("play", this.playStateChange),
                this.animation.removeEventListener("isEditingCurvesChange", this.isEditingCurvesChange),
                this.animation.removeEventListener("isWorkAreaActiveChange", this.isWorkAreaActiveChange),
                this.animation.removeEventListener("loopChange", this.loopChange),
                this.animation.removeEventListener("showSelectionOnlyChange", this.showSelectionOnlyChange),
                this.animation.removeEventListener("expand", this.recomputeSizes),
                this.animation.removeEventListener("updateEditableRows", this.recomputeSizes),
                this.animation.removeEventListener("fpsChange", this.updateFps),
                this.animation.removeEventListener("durationChange", this.updateDuration),
                this.animation.removeEventListener("keyedPropertyChange", this.onKeyedPropertyChanged),
                this.animation.timelineCanvas = null),
                this.animation = e,
                e && (this.context.nima.stage.addEventListener("selectionChanged", this.stageSelectionChanged),
                e.addEventListener("nameChanged", this.nameChanged),
                e.addEventListener("nodesUpdate", this.animationNodesUpdated),
                e.addEventListener("play", this.playStateChange),
                e.addEventListener("isEditingCurvesChange", this.isEditingCurvesChange),
                e.addEventListener("isWorkAreaActiveChange", this.isWorkAreaActiveChange),
                e.addEventListener("loopChange", this.loopChange),
                e.addEventListener("showSelectionOnlyChange", this.showSelectionOnlyChange),
                e.addEventListener("expand", this.recomputeSizes),
                e.addEventListener("updateEditableRows", this.recomputeSizes),
                e.addEventListener("fpsChange", this.updateFps),
                e.addEventListener("durationChange", this.updateDuration),
                e.addEventListener("keyedPropertyChange", this.onKeyedPropertyChanged),
                e.timelineCanvas = this.timelineCanvas),
                this.timelineCanvas.animation = e,
                e ? this.setState({
                    isPlaying: e.isPlaying,
                    GraphActive: e.isEditingCurves,
                    SelectionActive: e.showSelectionOnly,
                    LoopActive: e.loop,
                    WorkAreaActive: e.isWorkAreaActive,
                    workAreaStart: e.workAreaStart,
                    workAreaEnd: e.workAreaEnd,
                    displayStart: e.displayStart,
                    displayEnd: e.displayEnd,
                    duration: e.duration,
                    fps: e.fps,
                    keyedNodes: e.keyedNodes
                }) : this.forceUpdate()
            }
        }, {
            key: "setActor",
            value: function(e) {
                this.actor && this.actor.removeEventListener("animationListChanged", this.animationListChanged),
                e && e.addEventListener("animationListChanged", this.animationListChanged),
                this.actor = e
            }
        }, {
            key: "setHeight",
            value: function(e) {
                this.height != e && (this.height = e,
                this.timelineCanvas.setHeight(e - 87),
                this.setState({
                    height: e
                }))
            }
        }, {
            key: "setIsOpen",
            value: function(e) {
                if (this.isOpen != e) {
                    this.isOpen = e,
                    this.setState({
                        isOpen: e
                    }),
                    this.timelineCanvas.isActive = e;
                    var t = this;
                    clearTimeout(this.resizeTimeout),
                    this.resizeTimeout = setTimeout((function() {
                        t.resize()
                    }
                    ), 410)
                }
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.actor != this.actor && this.setActor(e.actor)
            }
        }, {
            key: "inputFPS",
            value: function(e) {
                this.animation.fps = e,
                this.setState({
                    fps: e
                })
            }
        }, {
            key: "inputDurationFrames",
            value: function(e) {
                this.animation.duration = e / this.state.fps,
                this.setState({
                    duration: this.animation.duration
                })
            }
        }, {
            key: "maxScroll",
            value: function() {
                return this.virtualList ? this.virtualList.sizeAndPositionManager.getTotalSize() - this.virtualList.props.height : 0
            }
        }, {
            key: "setCanvas",
            value: function(e) {
                this.timelineCanvas.setCanvas(e)
            }
        }, {
            key: "setCanvasBg",
            value: function(e) {
                this.timelineCanvas.setBackground(e)
            }
        }, {
            key: "setPlayheadContainer",
            value: function(e) {
                this.timelineCanvas.setPlayheadContainer(e)
            }
        }, {
            key: "rewind",
            value: function(e) {
                this.animation.position = 0
            }
        }, {
            key: "togglePlay",
            value: function(e) {
                this.animation.isPlaying = !this.animation.isPlaying
            }
        }, {
            key: "playStateChange",
            value: function(e) {
                this.setState({
                    isPlaying: e
                })
            }
        }, {
            key: "toggleWorkArea",
            value: function() {
                this.animation.isWorkAreaActive = !this.animation.isWorkAreaActive
            }
        }, {
            key: "toggleLoop",
            value: function() {
                this.animation.loop = !this.animation.loop
            }
        }, {
            key: "toggleSelection",
            value: function() {
                this.animation.showSelectionOnly = !this.animation.showSelectionOnly
            }
        }, {
            key: "toggleCurves",
            value: function() {
                this.animation.isEditingCurves = !this.animation.isEditingCurves
            }
        }, {
            key: "isEditingCurvesChange",
            value: function(e) {
                this.setState({
                    GraphActive: e
                })
            }
        }, {
            key: "isWorkAreaActiveChange",
            value: function(e) {
                this.setState({
                    WorkAreaActive: e
                })
            }
        }, {
            key: "showSelectionOnlyChange",
            value: function(e) {
                this.setState({
                    SelectionActive: e
                })
            }
        }, {
            key: "loopChange",
            value: function(e) {
                this.setState({
                    LoopActive: e
                })
            }
        }, {
            key: "setLeft",
            value: function(e) {
                this.animationPanel.style.left = e + "px"
            }
        }, {
            key: "setExport",
            value: function(e) {
                if (e)
                    this.animationPanel.style.transition = "left 0.4s cubic-bezier(0.8, 0, 0, 1), right 0.4s cubic-bezier(0.8, 0, 0, 1), height 0.4s cubic-bezier(0.8, 0, 0, 1)",
                    this.animationPanel.style.right = "0px",
                    this.animationPanel.style.left = "0px",
                    clearTimeout(this.animLeftTimeout);
                else {
                    this.animationPanel.style.right = this.props.settingsOpen ? "260px" : null,
                    this.animationPanel.style.left = this.props.filePanelWidth + "px";
                    var t = this;
                    this.animLeftTimeout = setTimeout((function() {
                        t.animationPanel.style.transition = null
                    }
                    ), 400)
                }
            }
        }, {
            key: "mouseWheel",
            value: function(e) {
                e.altKey ? this.timelineCanvas.zoomTime(-e.deltaY) : this.timelineCanvas.panTime(-e.deltaY)
            }
        }, {
            key: "animationListChanged",
            value: function() {
                if (this.animation && this.actor) {
                    var e = this.actor.animations;
                    -1 === e.indexOf(this.animation) && (e.length ? this.context.nima.editingAnimation = e[0] : this.animation = null)
                }
            }
        }, {
            key: "getRowHeight",
            value: function(e) {
                if (0 === e)
                    return 35;
                var t = this.animation.editableKeyedNodes[e - 1];
                return t.isExpanded ? 35 * t.rowCount : 35
            }
        }, {
            key: "onScroll",
            value: function(e, t) {
                this.scrollOffset !== e && (this.scrollOffset = e,
                this.setState({
                    scrollOffset: e
                }),
                this.timelineCanvas.scroll(e))
            }
        }, {
            key: "scrollTo",
            value: function(e) {
                e = Math.max(0, Math.min(this.maxScroll(), e)),
                this.scrollOffset !== e && (this.scrollOffset = e,
                this.setState({
                    scrollOffset: e
                }),
                this.timelineCanvas.scroll(e))
            }
        }, {
            key: "setVirtualList",
            value: function(e) {
                this.virtualList = e
            }
        }, {
            key: "setScrollbar",
            value: function(e) {
                this.scrollbar = e
            }
        }, {
            key: "dragScrollBar",
            value: function(e) {
                this.setState({
                    scrollOffset: e
                })
            }
        }, {
            key: "render",
            value: function() {
                var e = this.animation
                  , t = this.state.fps
                  , n = Math.round(this.state.duration * t);
                if (!e)
                    return o.default.createElement("div", {
                        className: "AnimationPanel",
                        ref: this.setAnimationPanel,
                        style: {
                            height: this.state.isOpen ? this.state.height + "px" : "0px",
                            transition: this.state.isResizing ? "height 0s" : null
                        }
                    });
                var i = e.editableKeyedNodes
                  , r = this.actor
                  , a = this.state.height + "px";
                return o.default.createElement("div", {
                    className: "AnimationPanel",
                    ref: this.setAnimationPanel,
                    style: {
                        height: this.state.isOpen ? a : "0px",
                        transition: this.state.isResizing ? "height 0s" : null,
                        right: this.props.settingsOpen ? "260px" : null
                    }
                }, o.default.createElement(l.default, {
                    isHorizontal: true,
                    onMouseDown: this.startResize
                }), o.default.createElement("div", {
                    className: "ApHeader"
                }, o.default.createElement("div", {
                    className: "ApTransportControls"
                }, this.state.isPlaying ? o.default.createElement("svg", {
                    className: "PauseButton",
                    onMouseDown: this.togglePlay
                }, o.default.createElement("use", {
                    xlinkHref: b.default.make("/images/symbol-defs.svg#icon-pause")
                })) : o.default.createElement("svg", {
                    className: "PlayButton",
                    onMouseDown: this.togglePlay
                }, o.default.createElement("use", {
                    xlinkHref: b.default.make("/images/symbol-defs.svg#icon-play")
                })), o.default.createElement("svg", {
                    className: "RewButton",
                    onMouseDown: this.rewind
                }, o.default.createElement("use", {
                    xlinkHref: b.default.make("/images/symbol-defs.svg#icon-rewind")
                }))), o.default.createElement("div", {
                    className: "ApTransportHeader"
                }, o.default.createElement(u.default, {
                    animation: e
                }), o.default.createElement("div", {
                    className: "FpsInput"
                }, o.default.createElement("div", {
                    className: "FpsLabel"
                }, "FPS"), o.default.createElement(c.default, {
                    className: "TimelineFpsInput",
                    value: t,
                    onValueChanged: this.inputFPS
                })), o.default.createElement(c.default, {
                    className: "TimelineTotalInput",
                    value: n,
                    rate: t,
                    onValueChanged: this.inputDurationFrames
                }))), o.default.createElement("div", {
                    className: "ApTimelineHeaderWrapper"
                }, o.default.createElement("div", {
                    className: "ApTimelineHeaderButtons",
                    style: {
                        marginTop: this.state.isAnimationsOpen ? a : "0px"
                    }
                }, o.default.createElement(h.default, null), o.default.createElement(d.default, {
                    type: "Selection",
                    onSelected: this.toggleSelection,
                    isActive: this.state.SelectionActive,
                    tip: {
                        label: "Show Selected"
                    }
                }), o.default.createElement(d.default, {
                    type: "Loop",
                    onSelected: this.toggleLoop,
                    isActive: this.state.LoopActive,
                    tip: {
                        label: "Loop"
                    }
                }), o.default.createElement(d.default, {
                    type: "WorkArea",
                    onSelected: this.toggleWorkArea,
                    isActive: this.state.WorkAreaActive,
                    tip: {
                        label: "Work Area"
                    }
                }), o.default.createElement(d.default, {
                    type: "Graph",
                    onSelected: this.toggleCurves,
                    isActive: this.state.GraphActive,
                    tip: {
                        label: "Curve Editor"
                    }
                })), o.default.createElement("div", {
                    ref: this.setTimelineHeader,
                    className: "ApTimelineHeader",
                    onWheel: this.mouseWheel
                }, o.default.createElement(f.default, {
                    animation: e
                }), o.default.createElement(y.default, {
                    ref: "Ticks",
                    animation: e,
                    width: this.state.timelineWidth,
                    left: this.state.timelineLeft,
                    workAreaActive: this.state.WorkAreaActive
                }))), o.default.createElement("div", {
                    className: "ApTimelineWrapper",
                    style: {
                        overflow: this.state.isAnimationsOpen ? "hidden" : null
                    }
                }, o.default.createElement("div", {
                    className: "ApTimelineSources",
                    style: {
                        marginTop: this.state.isAnimationsOpen ? a : "0px",
                        opacity: this.state.isAnimationsOpen ? 0 : 1
                    }
                }, o.default.createElement(g.default, {
                    ref: this.setVirtualList,
                    width: "100%",
                    scrollOffset: this.state.scrollOffset,
                    height: this.state.height - 40 - 47,
                    itemCount: i.length + 1,
                    itemSize: this.getRowHeight,
                    onScroll: this.onScroll,
                    renderItem: function(t) {
                        var n, a = t.style, l = t.index;
                        if (0 === l)
                            return o.default.createElement("div", {
                                key: l,
                                className: "ApAnimationName"
                            }, o.default.createElement("span", null, e.name));
                        var u = i[l - 1];
                        return o.default.createElement(s.default, (O(n = {
                            key: l,
                            style: a,
                            idx: l
                        }, "key", u.node.refId),
                        O(n, "keyFrameGroup", u),
                        O(n, "actor", r),
                        n))
                    }
                })), o.default.createElement("div", {
                    className: "ApTimelineScrollWrapper"
                }, o.default.createElement("div", {
                    className: "ApTimelineCanvasMarker"
                }, o.default.createElement("div", {
                    ref: this.setCanvasBg,
                    style: {
                        background: this.state.WorkAreaActive ? "rgba(0,0,0,0.24)" : null
                    }
                }), o.default.createElement("canvas", {
                    ref: this.setCanvas
                })), o.default.createElement("div", {
                    ref: this.setPlayheadContainer
                }, o.default.createElement(m.default, {
                    animation: e,
                    timelineWidth: this.state.timelineWidth
                })), o.default.createElement(_.default, {
                    ref: this.setScrollbar,
                    height: this.state.height - 40 - 47,
                    scrollOffset: this.state.scrollOffset,
                    onScroll: this.dragScrollBar
                }))))
            }
        }]),
        t
    }(o.default.Component)).prototype, "setTimelineHeader", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setTimelineHeader"), i.prototype),
    S(i.prototype, "setAnimationPanel", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setAnimationPanel"), i.prototype),
    S(i.prototype, "updateResize", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "updateResize"), i.prototype),
    S(i.prototype, "windowResize", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "windowResize"), i.prototype),
    S(i.prototype, "startResize", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "startResize"), i.prototype),
    S(i.prototype, "endResize", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "endResize"), i.prototype),
    S(i.prototype, "animationNodesUpdated", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "animationNodesUpdated"), i.prototype),
    S(i.prototype, "nameChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "nameChanged"), i.prototype),
    S(i.prototype, "stageSelectionChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "stageSelectionChanged"), i.prototype),
    S(i.prototype, "recomputeSizes", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "recomputeSizes"), i.prototype),
    S(i.prototype, "updateDuration", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "updateDuration"), i.prototype),
    S(i.prototype, "updateFps", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "updateFps"), i.prototype),
    S(i.prototype, "onKeyedPropertyChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onKeyedPropertyChanged"), i.prototype),
    S(i.prototype, "inputFPS", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "inputFPS"), i.prototype),
    S(i.prototype, "inputDurationFrames", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "inputDurationFrames"), i.prototype),
    S(i.prototype, "setCanvas", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setCanvas"), i.prototype),
    S(i.prototype, "setCanvasBg", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setCanvasBg"), i.prototype),
    S(i.prototype, "setPlayheadContainer", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setPlayheadContainer"), i.prototype),
    S(i.prototype, "rewind", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "rewind"), i.prototype),
    S(i.prototype, "togglePlay", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "togglePlay"), i.prototype),
    S(i.prototype, "playStateChange", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "playStateChange"), i.prototype),
    S(i.prototype, "toggleWorkArea", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleWorkArea"), i.prototype),
    S(i.prototype, "toggleLoop", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleLoop"), i.prototype),
    S(i.prototype, "toggleSelection", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleSelection"), i.prototype),
    S(i.prototype, "toggleCurves", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleCurves"), i.prototype),
    S(i.prototype, "isEditingCurvesChange", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "isEditingCurvesChange"), i.prototype),
    S(i.prototype, "isWorkAreaActiveChange", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "isWorkAreaActiveChange"), i.prototype),
    S(i.prototype, "showSelectionOnlyChange", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "showSelectionOnlyChange"), i.prototype),
    S(i.prototype, "loopChange", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "loopChange"), i.prototype),
    S(i.prototype, "mouseWheel", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseWheel"), i.prototype),
    S(i.prototype, "animationListChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "animationListChanged"), i.prototype),
    S(i.prototype, "getRowHeight", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "getRowHeight"), i.prototype),
    S(i.prototype, "onScroll", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onScroll"), i.prototype),
    S(i.prototype, "setVirtualList", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setVirtualList"), i.prototype),
    S(i.prototype, "setScrollbar", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setScrollbar"), i.prototype),
    S(i.prototype, "dragScrollBar", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "dragScrollBar"), i.prototype),
    i);
    t.default = k,
    k.DoubleClickTime = 200,
    k.contextTypes = {
        nima: v.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = _(n(0)), a = _(n(1)), s = _(n(9)), l = _(n(4)), u = _(n(237)), c = _(n(208)), d = _(n(344)), h = _(n(267)), f = _(n(384)), p = _(n(315)), y = _(n(448)), m = _(n(1166)), v = _(n(443)), g = _(n(3));
    function _(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function b(e) {
        if (Array.isArray(e)) {
            for (var t = 0, n = Array(e.length); t < e.length; t++)
                n[t] = e[t];
            return n
        }
        return Array.from(e)
    }
    function w(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var O = (w((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                keyFrameGroup: null,
                propertyGroups: [],
                numRows: 1,
                expanded: false
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "componentWillMount",
            value: function() {
                this.animationProperties = []
            }
        }, {
            key: "commit",
            value: function() {
                this.context.nima.captureJournalEntry()
            }
        }, {
            key: "expand",
            value: function(e) {
                e && this.frameUpdated(),
                this.setState({
                    expanded: e
                })
            }
        }, {
            key: "toggleExpand",
            value: function(e) {
                e.stopPropagation(),
                this.state.keyFrameGroup.isExpanded = !this.state.keyFrameGroup.isExpanded
            }
        }, {
            key: "selectedChange",
            value: function(e) {
                this.setState({
                    isSelected: e
                })
            }
        }, {
            key: "stageSelectionCleared",
            value: function() {
                this.props.keyFrameGroup.animation.selectItem(null)
            }
        }, {
            key: "setKeyFrameGroup",
            value: function(e) {
                this.state.keyFrameGroup && this.state.keyFrameGroup.removeEventListener && (this.state.keyFrameGroup.removeEventListener("expand", this.expand),
                this.state.keyFrameGroup.removeEventListener("hover", this.hoverChange),
                this.state.keyFrameGroup.node.stageItem && this.state.keyFrameGroup.node.stageItem.removeEventListener("selectedChange", this.selectedChange)),
                e && (this.keyFrameGroup = e,
                e.addEventListener && (e.addEventListener("expand", this.expand),
                e.addEventListener("hover", this.hoverChange),
                e.node.stageItem && e.node.stageItem.addEventListener("selectedChange", this.selectedChange),
                this.expand(e.isExpanded),
                e.node.stageItem && this.selectedChange(e.node.stageItem.isSelected))),
                this.setState({
                    keyFrameGroup: e
                })
            }
        }, {
            key: "setActor",
            value: function(e) {
                var t = this.actor;
                t !== e && (t && t.removeEventListener("frameUpdated", this.frameUpdated),
                e && e.addEventListener("frameUpdated", this.frameUpdated))
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.keyFrameGroup != this.state.keyFrameGroup && this.setKeyFrameGroup(e.keyFrameGroup),
                e.actor != this.state.actor && this.setActor(e.actor)
            }
        }, {
            key: "componentDidMount",
            value: function() {
                this.context.nima.stage.addEventListener("selectionCleared", this.stageSelectionCleared),
                this.props.keyFrameGroup && this.setKeyFrameGroup(this.props.keyFrameGroup),
                this.props.actor && this.setActor(this.props.actor)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.context.nima.stage.removeEventListener("selectionCleared", this.stageSelectionCleared),
                this.setKeyFrameGroup(null),
                this.setActor(null)
            }
        }, {
            key: "addTimelineProperty",
            value: function(e) {
                -1 == this.animationProperties.indexOf(e) && this.animationProperties.push(e)
            }
        }, {
            key: "removeTimelineProperty",
            value: function(e) {
                var t = this.animationProperties.indexOf(e);
                -1 != t && this.animationProperties.splice(t, 1)
            }
        }, {
            key: "frameUpdated",
            value: function() {
                var e = this.state.keyFrameGroup;
                if (e && e.isExpanded)
                    for (var t = 0; t < this.animationProperties.length; t++)
                        this.animationProperties[t].updateProperty()
            }
        }, {
            key: "hoverChange",
            value: function() {
                this.setState({
                    hasHover: this.props.keyFrameGroup.hasHover
                })
            }
        }, {
            key: "hover",
            value: function() {
                this.props.keyFrameGroup && (this.props.keyFrameGroup.hasHover = true)
            }
        }, {
            key: "leave",
            value: function() {
                this.props.keyFrameGroup && (this.props.keyFrameGroup.hasHover = false)
            }
        }, {
            key: "select",
            value: function(e) {
                if (this.props.keyFrameGroup && this.props.keyFrameGroup.node.stageItem) {
                    this.context.nima.stage.selectItem(this.props.keyFrameGroup.node.stageItem, s.default.isMultiSelect(e), false, this);
                    var t = this.state.keyFrameGroup;
                    if (t && t.propertyGroups) {
                        var n = t.propertyGroups
                          , i = []
                          , r = true
                          , o = false
                          , a = void 0;
                        try {
                            for (var l, u = n[Symbol.iterator](); !(r = (l = u.next()).done); r = true) {
                                var c = l.value.props
                                  , d = true
                                  , h = false
                                  , f = void 0;
                                try {
                                    for (var p, y = c[Symbol.iterator](); !(d = (p = y.next()).done); d = true) {
                                        var m = p.value.frameList;
                                        i.push.apply(i, b(m.keyFrames))
                                    }
                                } catch (e) {
                                    h = true,
                                    f = e
                                } finally {
                                    try {
                                        !d && y.return && y.return()
                                    } finally {
                                        if (h)
                                            throw f
                                    }
                                }
                            }
                        } catch (e) {
                            o = true,
                            a = e
                        } finally {
                            try {
                                !r && u.return && u.return()
                            } finally {
                                if (o)
                                    throw a
                            }
                        }
                        t.animation.dispatch("selectKeyFrames", i, s.default.isMultiSelect(e))
                    }
                }
            }
        }, {
            key: "propertySelected",
            value: function() {
                this.props.keyFrameGroup.animation.isEditingCurves && (this.state.keyFrameGroup.isExpanded = true)
            }
        }, {
            key: "setRoot",
            value: function(e) {
                this.root = e
            }
        }, {
            key: "render",
            value: function() {
                var e, t, n = "Unnamed", i = this.state.keyFrameGroup, r = true, a = [];
                if (i) {
                    switch (i.node.blockExpand && (r = false),
                    i.node.constructor) {
                    case u.default:
                        e = "TimelineBoneIcon",
                        t = g.default.make("/images/symbol-defs.svg#icon-bone");
                        break;
                    case c.default:
                        e = "TimelineNodeIcon",
                        t = g.default.make("/images/symbol-defs.svg#icon-node");
                        break;
                    case h.default:
                        e = "TimelineImageIcon",
                        t = g.default.make("/images/symbol-defs.svg#icon-picture");
                        break;
                    case f.default:
                        e = "TimelineBoneIcon",
                        t = g.default.make("/images/symbol-defs.svg#icon-collider");
                        break;
                    case p.default:
                        e = "TimelineRootIcon",
                        t = g.default.make("/images/symbol-defs.svg#icon-root");
                        break;
                    case y.default:
                        e = "TimelineEventIcon",
                        t = g.default.make("/images/symbol-defs.svg#icon-event");
                        break;
                    case d.default:
                        e = "TimelineSoloIcon",
                        t = g.default.make("/images/symbol-defs.svg#icon-solo")
                    }
                    !e && i.node instanceof v.default && (e = "HierarchyEventIcon",
                    t = g.default.make("/images/symbol-defs.svg#icon-constraint")),
                    n = i.node.name,
                    a = i.propertyGroups
                }
                var s = []
                  , l = r && this.state.expanded;
                if (a && l)
                    for (var _ = 0; _ < a.length; _++) {
                        var b = a[_]
                          , w = "Unnamed"
                          , O = [];
                        if (b) {
                            w = b.label;
                            for (var S = 0; S < b.props.length; S++) {
                                var k = b.props[S]
                                  , P = o.default.createElement(m.default, {
                                    onSelected: this.propertySelected,
                                    onValueCommit: this.commit,
                                    ref: k.ref,
                                    key: k.key,
                                    title: 0 == S ? w : null,
                                    node: k.node || i.node,
                                    property: k,
                                    row: this
                                });
                                O.push(P)
                            }
                        }
                        s.push(o.default.createElement("div", {
                            key: _,
                            className: "AnimationProperty"
                        }, O))
                    }
                l && this.state.numRows,
                this.state.hasHover;
                var E = false
                  , T = false;
                return this.state.hasHover && this.state.isSelected ? (E = true,
                T = true) : this.state.hasHover ? E = true : this.state.isSelected && (T = true),
                o.default.createElement("div", {
                    ref: this.setRoot,
                    className: "TimelineRow",
                    style: this.props.style,
                    onMouseDown: this.select
                }, o.default.createElement("div", {
                    className: E && T ? "TimelineRowContentSelected TimelineRowContentHover" : E ? "TimelineRowContent TimelineRowContentHover" : T ? "TimelineRowContentSelected" : "TimelineRowContent",
                    onMouseEnter: this.hover,
                    onMouseLeave: this.leave
                }, r ? o.default.createElement("div", {
                    className: "TimelineExpandBtn",
                    onMouseDown: this.toggleExpand
                }, o.default.createElement("svg", {
                    className: "ExpandArrow",
                    style: {
                        transform: "rotate(" + (l ? 0 : -90) + "deg)"
                    }
                }, o.default.createElement("use", {
                    xlinkHref: g.default.make("/images/symbol-defs.svg#icon-arrow")
                }))) : null, o.default.createElement("svg", {
                    className: "TimelineIcon " + e
                }, o.default.createElement("use", {
                    xlinkHref: t
                })), o.default.createElement("div", {
                    className: "TimelineItemTxt"
                }, n)), o.default.createElement("div", null, s))
            }
        }]),
        t
    }(o.default.Component)).prototype, "commit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "commit"), i.prototype),
    w(i.prototype, "expand", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "expand"), i.prototype),
    w(i.prototype, "toggleExpand", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleExpand"), i.prototype),
    w(i.prototype, "selectedChange", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "selectedChange"), i.prototype),
    w(i.prototype, "stageSelectionCleared", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "stageSelectionCleared"), i.prototype),
    w(i.prototype, "frameUpdated", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "frameUpdated"), i.prototype),
    w(i.prototype, "hoverChange", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "hoverChange"), i.prototype),
    w(i.prototype, "hover", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "hover"), i.prototype),
    w(i.prototype, "leave", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "leave"), i.prototype),
    w(i.prototype, "select", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "select"), i.prototype),
    w(i.prototype, "propertySelected", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "propertySelected"), i.prototype),
    w(i.prototype, "setRoot", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setRoot"), i.prototype),
    i);
    t.default = O,
    O.contextTypes = {
        nima: l.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = c(n(0)), a = c(n(4)), s = c(n(1)), l = c(n(316)), u = c(n(9));
    function c(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function d(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var h = (d((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                isFocused: false,
                input: "",
                propertyValue: 0,
                hasHover: false
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "componentWillMount",
            value: function() {
                this.moveAccum = 0
            }
        }, {
            key: "inputText",
            value: function(e) {
                this.setState({
                    input: e.target.value
                })
            }
        }, {
            key: "keyDown",
            value: function(e) {
                switch (e.keyCode) {
                case 13:
                    this.refs.textInput.blur();
                    break;
                case 27:
                    this.state.input = null,
                    this.refs.textInput.blur()
                }
            }
        }, {
            key: "changeEnumeration",
            value: function(e) {
                var t = this.props.property;
                t.onValueChanged && t.onValueChanged(e, false, t)
            }
        }, {
            key: "inputBlurred",
            value: function() {
                var e = this.props.property;
                if (null !== this.state.input) {
                    var t = this.state.input;
                    if (e.isText)
                        e.onValueChanged && (e.onValueChanged(t, false, e),
                        this.updateProperty());
                    else {
                        var n = parseFloat(t);
                        e.onValueChanged && !isNaN(n) && (e.onValueChanged(n, false, e),
                        this.updateProperty())
                    }
                }
                this.setState({
                    isFocused: false
                })
            }
        }, {
            key: "inputFocused",
            value: function() {
                this.updateProperty();
                var e = this.propertyValue;
                this.props.property.isText || (e = parseFloat(e)),
                this.setState({
                    isFocused: true,
                    input: e
                });
                var t = this.refs.textInput;
                setTimeout((function() {
                    t.setSelectionRange(0, t.value.length)
                }
                ), 0)
            }
        }, {
            key: "setFrameList",
            value: function(e) {
                this.frameList && (this.frameList.removeEventListener("hover", this.hoverChange),
                this.frameList.removeEventListener("selected", this.selectedChange)),
                e && (e.addEventListener("hover", this.hoverChange),
                e.addEventListener("selected", this.selectedChange),
                this.setState({
                    isSelected: e.isSelected,
                    hasHover: e.hasHover
                })),
                this.frameList = e
            }
        }, {
            key: "hoverChange",
            value: function() {
                this.setState({
                    hasHover: this.frameList.hasHover
                })
            }
        }, {
            key: "selectedChange",
            value: function(e) {
                e && this.props.onSelected && this.props.onSelected(),
                this.setState({
                    isSelected: e
                })
            }
        }, {
            key: "hover",
            value: function() {
                this.frameList && (this.frameList.hasHover = true)
            }
        }, {
            key: "leave",
            value: function() {
                this.frameList && (this.frameList.hasHover = false)
            }
        }, {
            key: "updateProperty",
            value: function() {
                if (!this.props.property.onValueChanged)
                    return false;
                var e = this.props.property
                  , t = this.props.node[e.key];
                return e.isAngle && (t = 180 * t / Math.PI),
                this.propertyValue != t && (this.propertyValue = t,
                this.setState({
                    propertyValue: t
                }),
                true)
            }
        }, {
            key: "componentDidMount",
            value: function() {
                this.props.row.addTimelineProperty(this);
                var e = this.props.property
                  , t = this.props.node;
                e.event && (t.addEventListener(e.event, this.updateProperty),
                this.updateProperty()),
                e.keyStateEvent ? t.addEventListener(e.keyStateEvent, this.onKeyStateChanged) : t.addEventListener("keyState", this.onKeyStateChanged),
                this.setFrameList(this.props.property.frameList)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.props.row.removeTimelineProperty(this);
                var e = this.props.property
                  , t = this.props.node;
                e.event && t.removeEventListener(e.event, this.updateProperty),
                e.keyStateEvent ? t.removeEventListener(e.keyStateEvent, this.onKeyStateChanged) : t.removeEventListener("keyState", this.onKeyStateChanged),
                this.setFrameList(null)
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.property && e.property.frameList != this.frameList && this.setFrameList(e.property.frameList)
            }
        }, {
            key: "startDrag",
            value: function(e) {
                this.state.isFocused || (this.refs.textInput ? (this.moved = false,
                e.stopPropagation(),
                this.props.property.isText || (this.valueAtClick = Number.parseFloat(this.refs.textInput.value),
                this.valueMoveAccum = 0,
                this.moveAccum = 0),
                window.addEventListener("mousemove", this.mouseMove, true),
                window.addEventListener("mouseup", this.mouseUp, true)) : this.clickedInput = false)
            }
        }, {
            key: "mouseMove",
            value: function(e) {
                if (e.preventDefault(),
                e.stopPropagation(),
                !this.props.property.isText) {
                    if (!this.moved) {
                        if (this.valueMoveAccum -= e.movementY * (this.props.dragScale || .1),
                        this.moveAccum += Math.abs(e.movementY),
                        !(this.moveAccum > 4))
                            return;
                        this.moved = true
                    }
                    this.moved = true,
                    this.valueMoveAccum -= e.movementY * (this.props.dragScale || .1),
                    this.props.property.onValueChanged && this.props.property.onValueChanged(this.valueAtClick + this.valueMoveAccum, true, this.props.property)
                }
            }
        }, {
            key: "mouseUp",
            value: function(e) {
                if (e.stopPropagation(),
                this.moved)
                    this.props.onValueCommit && this.props.onValueCommit();
                else {
                    var t = this.props.property.frameList
                      , n = t.animation;
                    t.isSelected || n.selectItem(t, e.metaKey),
                    this.clickedInput && this.refs.textInput.focus(),
                    n.dispatch("selectKeyFrames", t.keyFrames, u.default.isMultiSelect(e))
                }
                window.removeEventListener("mousemove", this.mouseMove, true),
                window.removeEventListener("mouseup", this.mouseUp, true)
            }
        }, {
            key: "previousKey",
            value: function(e) {
                e.stopPropagation(),
                this.props.property.frameList.setPositionToPreviousKey()
            }
        }, {
            key: "nextKey",
            value: function(e) {
                e.stopPropagation(),
                this.props.property.frameList.setPositionToNextKey()
            }
        }, {
            key: "setKey",
            value: function(e) {
                var t = this.context.nima;
                e.stopPropagation(),
                this.props.property.frameList.setKey(),
                this.forceUpdate(),
                t.captureJournalEntry()
            }
        }, {
            key: "onKeyStateChanged",
            value: function(e) {
                this.forceUpdate()
            }
        }, {
            key: "clickTextInput",
            value: function(e) {
                this.clickedInput = true,
                e.stopPropagation(),
                e.preventDefault(),
                this.startDrag(e)
            }
        }, {
            key: "render",
            value: function() {
                var e, t = this.props.property;
                if (this.state.isFocused)
                    e = this.state.input;
                else if (t.isText)
                    e = this.state.propertyValue;
                else {
                    var n = t.decimals;
                    null == n && (n = 2);
                    var i = Math.pow(10, n);
                    e = Math.round(this.state.propertyValue * i),
                    e /= i,
                    t.isAngle && (e += " Â°")
                }
                var r, a = this.props.node[this.props.property.key + "KS"], s = {}, u = t.frameList, c = u.animation.isEditingCurves && u.isSelected ? u.cssColor : null;
                switch (a) {
                case 0:
                    r = "KeyNavAdd";
                    break;
                case 1:
                    r = "KeyNavChanged";
                    break;
                case 2:
                    r = "KeyNavKeyed",
                    s = {
                        background: c
                    }
                }
                var d = false
                  , h = false;
                this.state.hasHover && this.state.isSelected ? (d = true,
                h = true) : this.state.hasHover ? d = true : this.state.isSelected && (h = true);
                var f = !t.onValueChanged
                  , p = t.enumeration
                  , y = -1;
                return p && (y = t.enumerationIndex(t)),
                o.default.createElement("div", {
                    className: d && h ? "AnimationPropertyInputFieldSelected AnimationPropertyInputFieldHover" : d ? "AnimationPropertyInputField AnimationPropertyInputFieldHover" : h ? "AnimationPropertyInputFieldSelected" : "AnimationPropertyInputField",
                    onMouseDown: this.startDrag,
                    onMouseEnter: this.hover,
                    onMouseLeave: this.leave
                }, o.default.createElement("div", {
                    className: "AnimationPropertyTitle",
                    style: {
                        flex: f ? 1 : null
                    }
                }, this.props.title || ""), f ? null : o.default.createElement("div", {
                    className: "AnimationPropertyInputLabel"
                }, this.props.property.label), f ? null : p ? o.default.createElement(l.default, {
                    options: p,
                    selectedIndex: y,
                    onSelectionChanged: this.changeEnumeration,
                    isAnimating: false
                }) : o.default.createElement("span", {
                    className: "InputSpan",
                    onMouseDown: this.clickTextInput
                }, o.default.createElement("input", {
                    ref: "textInput",
                    type: "text",
                    style: {
                        borderBottomColor: c,
                        pointerEvents: this.state.isFocused ? null : "none"
                    },
                    value: e,
                    onChange: this.inputText,
                    onFocus: this.inputFocused,
                    onBlur: this.inputBlurred,
                    onKeyDown: this.keyDown
                })), o.default.createElement("div", {
                    className: "KeyNavLeft",
                    onMouseDown: this.previousKey
                }, o.default.createElement("div", null)), o.default.createElement("div", {
                    className: r,
                    onMouseDown: this.setKey
                }, o.default.createElement("div", {
                    style: s
                })), o.default.createElement("div", {
                    className: "KeyNavRight",
                    onMouseDown: this.nextKey
                }, o.default.createElement("div", null)))
            }
        }]),
        t
    }(o.default.Component)).prototype, "inputText", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "inputText"), i.prototype),
    d(i.prototype, "keyDown", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "keyDown"), i.prototype),
    d(i.prototype, "changeEnumeration", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "changeEnumeration"), i.prototype),
    d(i.prototype, "inputBlurred", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "inputBlurred"), i.prototype),
    d(i.prototype, "inputFocused", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "inputFocused"), i.prototype),
    d(i.prototype, "hoverChange", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "hoverChange"), i.prototype),
    d(i.prototype, "selectedChange", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "selectedChange"), i.prototype),
    d(i.prototype, "hover", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "hover"), i.prototype),
    d(i.prototype, "leave", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "leave"), i.prototype),
    d(i.prototype, "updateProperty", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "updateProperty"), i.prototype),
    d(i.prototype, "startDrag", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "startDrag"), i.prototype),
    d(i.prototype, "mouseMove", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseMove"), i.prototype),
    d(i.prototype, "mouseUp", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseUp"), i.prototype),
    d(i.prototype, "previousKey", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "previousKey"), i.prototype),
    d(i.prototype, "nextKey", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "nextKey"), i.prototype),
    d(i.prototype, "setKey", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setKey"), i.prototype),
    d(i.prototype, "onKeyStateChanged", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "onKeyStateChanged"), i.prototype),
    d(i.prototype, "clickTextInput", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "clickTextInput"), i.prototype),
    i);
    t.default = h,
    h.contextTypes = {
        nima: a.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = l(n(0)), a = l(n(1)), s = l(n(727));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function u(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var c = (u((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                fps: 60,
                currentPosition: 0
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "animationPositionChanged",
            value: function() {
                this.animation.isPlaying || this.setState({
                    fps: this.animation.fps,
                    currentPosition: this.animation.position
                })
            }
        }, {
            key: "componentDidMount",
            value: function() {
                this.setAnimation(this.props.animation)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setAnimation(null)
            }
        }, {
            key: "setAnimation",
            value: function(e) {
                this.animation && (this.animation.removeEventListener("position", this.animationPositionChanged),
                this.animation.removeEventListener("fpsChange", this.animationPositionChanged),
                this.animation.removeEventListener("play", this.animationPositionChanged)),
                this.animation = e,
                e && (e.addEventListener("position", this.animationPositionChanged),
                e.addEventListener("fpsChange", this.animationPositionChanged),
                e.addEventListener("play", this.animationPositionChanged),
                this.setState({
                    fps: e.fps,
                    currentPosition: e.position
                }))
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.animation && e.animation != this.animation && this.setAnimation(e.animation)
            }
        }, {
            key: "inputPositionFrames",
            value: function(e) {
                this.animation.position = e / this.state.fps,
                this.setState({
                    currentPosition: this.animation.position
                })
            }
        }, {
            key: "render",
            value: function() {
                var e = this.state.fps
                  , t = Math.floor(this.state.currentPosition * e);
                return o.default.createElement(s.default, {
                    className: "TimelineCurrentInput",
                    value: t,
                    rate: e,
                    onValueChanged: this.inputPositionFrames
                })
            }
        }]),
        t
    }(o.default.Component)).prototype, "animationPositionChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "animationPositionChanged"), i.prototype),
    u(i.prototype, "inputPositionFrames", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "inputPositionFrames"), i.prototype),
    i);
    t.default = c
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = u(n(0)), a = u(n(1)), s = u(n(4)), l = u(n(3));
    function u(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function c(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var d = (c((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {},
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "mouseOver",
            value: function() {
                this.context.tooltip.enter(this)
            }
        }, {
            key: "mouseOut",
            value: function() {
                this.context.tooltip.leave(this)
            }
        }, {
            key: "mouseDown",
            value: function() {
                this.context.tooltip.click(this),
                this.props.onSelected && this.props.onSelected(this.props.type)
            }
        }, {
            key: "render",
            value: function() {
                var e;
                switch (this.props.type) {
                case "Selection":
                    e = l.default.make("/images/symbol-defs.svg#icon-timeline-selected");
                    break;
                case "Loop":
                    e = l.default.make("/images/symbol-defs.svg#icon-loop");
                    break;
                case "WorkArea":
                    e = l.default.make("/images/symbol-defs.svg#icon-work-area");
                    break;
                case "Graph":
                    e = l.default.make("/images/symbol-defs.svg#icon-graph")
                }
                return o.default.createElement("div", {
                    className: this.props.type + "TimelineButton" + (this.props.isActive ? "Active" : ""),
                    onMouseEnter: this.mouseOver,
                    onMouseLeave: this.mouseOut,
                    onMouseDown: this.mouseDown
                }, o.default.createElement("svg", null, o.default.createElement("use", {
                    xlinkHref: e
                })))
            }
        }]),
        t
    }(o.default.Component)).prototype, "mouseOver", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseOver"), i.prototype),
    c(i.prototype, "mouseOut", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseOut"), i.prototype),
    c(i.prototype, "mouseDown", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseDown"), i.prototype),
    i);
    t.default = d,
    d.contextTypes = {
        tooltip: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = u(n(0)), a = u(n(1)), s = u(n(4)), l = u(n(3));
    function u(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var c, d, h, f, p, y, m = (i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                isAutoKeyEnabled: false
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "componentWillMount",
            value: function() {
                this.state.isAutoKeyEnabled = this.context.nima.autoKey
            }
        }, {
            key: "toggle",
            value: function() {
                this.context.nima.autoKey = !this.context.nima.autoKey,
                this.setState({
                    isAutoKeyEnabled: this.context.nima.autoKey
                })
            }
        }, {
            key: "componentDidMount",
            value: function() {
                this.setState({
                    isAutoKeyEnabled: this.context.nima.autoKey
                })
            }
        }, {
            key: "render",
            value: function() {
                return o.default.createElement("div", {
                    className: this.state.isAutoKeyEnabled ? "AutoKeyTimelineButtonActive" : "AutoKeyTimelineButton",
                    onMouseDown: this.toggle
                }, o.default.createElement("svg", {
                    className: "AutoKeyIcon"
                }, o.default.createElement("use", {
                    xlinkHref: l.default.make("/images/symbol-defs.svg#icon-timer")
                })), o.default.createElement("span", null, "AUTOKEY"))
            }
        }]),
        t
    }(o.default.Component),
    c = i.prototype,
    d = "toggle",
    h = [a.default],
    f = Object.getOwnPropertyDescriptor(i.prototype, "toggle"),
    p = i.prototype,
    y = {},
    Object.keys(f).forEach((function(e) {
        y[e] = f[e]
    }
    )),
    y.enumerable = !!y.enumerable,
    y.configurable = !!y.configurable,
    ("value"in y || y.initializer) && (y.writable = true),
    y = h.slice().reverse().reduce((function(e, t) {
        return t(c, d, e) || e
    }
    ), y),
    p && void 0 !== y.initializer && (y.value = y.initializer ? y.initializer.call(p) : void 0,
    y.initializer = void 0),
    void 0 === y.initializer && (Object.defineProperty(c, d, y),
    y = null),
    i);
    t.default = m,
    m.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = s(n(0)), a = s(n(1));
    function s(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function l(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var u = (l((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {},
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "setTrack",
            value: function(e) {
                this.track = e
            }
        }, {
            key: "clickScrollStart",
            value: function(e) {
                e.stopPropagation(),
                e.preventDefault(),
                this.dragLast = e.clientX,
                this.trackWidth = this.track.getBoundingClientRect().width,
                window.addEventListener("mouseup", this.endScrollDrag, true),
                window.addEventListener("mousemove", this.scrollStartDrag, true)
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.animation != this.animation && this.setAnimation(e.animation)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setAnimation(null),
                window.removeEventListener("mouseup", this.endScrollDrag, true),
                window.removeEventListener("mousemove", this.scrollDrag, true),
                window.removeEventListener("mousemove", this.scrollStartDrag, true),
                window.removeEventListener("mousemove", this.scrollEndDrag, true)
            }
        }, {
            key: "updateScroll",
            value: function() {
                this.forceUpdate()
            }
        }, {
            key: "setAnimation",
            value: function(e) {
                this.animation && this.animation.removeEventListener("scrollChange", this.updateScroll),
                e && (this.animation = e,
                this.animation.addEventListener("scrollChange", this.updateScroll))
            }
        }, {
            key: "scrollStartDrag",
            value: function(e) {
                var t = this.props.animation;
                e.stopPropagation(),
                e.preventDefault();
                var n = e.clientX - this.dragLast
                  , i = (t.displayEnd,
                t.displayStart,
                n / this.trackWidth * t.duration)
                  , r = 2 / this.props.animation.fps
                  , o = t.displayStart + i;
                o > t.displayEnd - r && (o = t.displayEnd - r),
                o < 0 && (o = 0);
                var a = (o - t.displayStart) / t.duration * this.trackWidth;
                this.dragLast += a,
                t.displayStart = Math.max(0, Math.min(t.duration - 2 / t.fps, o))
            }
        }, {
            key: "clickScrollEnd",
            value: function(e) {
                e.stopPropagation(),
                e.preventDefault(),
                this.dragLast = e.clientX,
                this.trackWidth = this.track.getBoundingClientRect().width,
                window.addEventListener("mouseup", this.endScrollDrag, true),
                window.addEventListener("mousemove", this.scrollEndDrag, true)
            }
        }, {
            key: "scrollEndDrag",
            value: function(e) {
                var t = this.props.animation
                  , n = e.clientX - this.dragLast
                  , i = (t.displayEnd,
                t.displayStart,
                n / this.trackWidth * t.duration)
                  , r = t.displayEnd + i
                  , o = 2 / this.props.animation.fps;
                r < t.displayStart + o && (r = t.displayStart + o),
                r > t.duration && (r = t.duration);
                var a = (r - t.displayEnd) / t.duration * this.trackWidth;
                this.dragLast += a,
                t.displayEnd = Math.max(0, Math.min(t.duration, r))
            }
        }, {
            key: "clickScrollMiddle",
            value: function(e) {
                e.stopPropagation(),
                e.preventDefault(),
                this.dragLast = e.clientX,
                this.trackWidth = this.track.getBoundingClientRect().width,
                window.addEventListener("mouseup", this.endScrollDrag, true),
                window.addEventListener("mousemove", this.scrollDrag, true)
            }
        }, {
            key: "scrollDrag",
            value: function(e) {
                var t = this.props.animation;
                e.stopPropagation(),
                e.preventDefault();
                var n = e.clientX - this.dragLast
                  , i = t.displayEnd - t.displayStart
                  , r = n / this.trackWidth * t.duration
                  , o = t.displayStart + r
                  , a = t.displayEnd + r;
                o < 0 && (o = 0,
                a = i),
                a > t.duration && (o = (a = t.duration) - i);
                var s = (o - t.displayStart) / t.duration * this.trackWidth;
                this.dragLast += s,
                t.displayEnd = Math.max(0, Math.min(t.duration, a)),
                t.displayStart = Math.max(0, Math.min(t.duration - 2 / t.fps, o))
            }
        }, {
            key: "endScrollDrag",
            value: function(e) {
                window.removeEventListener("mouseup", this.endScrollDrag, true),
                window.removeEventListener("mousemove", this.scrollDrag, true),
                window.removeEventListener("mousemove", this.scrollStartDrag, true),
                window.removeEventListener("mousemove", this.scrollEndDrag, true)
            }
        }, {
            key: "render",
            value: function() {
                var e = this.props.animation
                  , t = (e.displayEnd - e.displayStart) / e.duration
                  , n = e.displayStart / e.duration;
                return o.default.createElement("div", {
                    className: "ApTimelineHorizontalScrollTrack",
                    ref: this.setTrack
                }, o.default.createElement("div", {
                    className: "TimelineScrollGrabber",
                    style: {
                        width: 100 * t + "%",
                        marginLeft: 100 * n + "%"
                    }
                }, o.default.createElement("div", {
                    className: "TimelineScrollLeftHandle",
                    onMouseDown: this.clickScrollStart
                }), o.default.createElement("div", {
                    className: "TimelineScrollMiddle",
                    onMouseDown: this.clickScrollMiddle
                }), o.default.createElement("div", {
                    className: "TimelineScrollRightHandle",
                    onMouseDown: this.clickScrollEnd
                })))
            }
        }]),
        t
    }(o.default.Component)).prototype, "setTrack", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setTrack"), i.prototype),
    l(i.prototype, "clickScrollStart", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "clickScrollStart"), i.prototype),
    l(i.prototype, "updateScroll", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "updateScroll"), i.prototype),
    l(i.prototype, "scrollStartDrag", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "scrollStartDrag"), i.prototype),
    l(i.prototype, "clickScrollEnd", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "clickScrollEnd"), i.prototype),
    l(i.prototype, "scrollEndDrag", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "scrollEndDrag"), i.prototype),
    l(i.prototype, "clickScrollMiddle", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "clickScrollMiddle"), i.prototype),
    l(i.prototype, "scrollDrag", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "scrollDrag"), i.prototype),
    l(i.prototype, "endScrollDrag", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "endScrollDrag"), i.prototype),
    i);
    t.default = u
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = m;
    var i = h(n(9))
      , r = h(n(613))
      , o = n(2)
      , a = h(n(601))
      , s = h(n(704))
      , l = h(n(399))
      , u = h(n(1172))
      , c = h(n(358))
      , d = h(n(520));
    function h(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var f = parseInt(d.default.timelineMarginLeft)
      , p = parseFloat(d.default.timelineMarginRight);
    function y(e, t, n, i, r, o) {
        var a = 0
          , s = e[t];
        void 0 === s && (s = o);
        var l = s;
        e[t + "Anim"] = this,
        this.advance = function(o) {
            var u = false;
            (a += o) >= i && (a = i,
            u = true);
            var c = r(a / i);
            return s = l * (1 - c) + n * c,
            e && (e[t] = s),
            u && delete e[t + "Anim"],
            u
        }
        ,
        Object.defineProperties(this, {
            value: {
                get: function() {
                    return s
                }
            },
            to: {
                get: function() {
                    return n
                }
            }
        })
    }
    function m(e, t) {
        var n = this
          , d = void 0
          , h = void 0
          , v = void 0
          , g = void 0
          , _ = void 0
          , b = false
          , w = performance.now()
          , O = []
          , S = false
          , k = void 0
          , P = void 0
          , E = 0
          , T = 0
          , C = 0
          , x = 0
          , I = false
          , D = 0
          , M = new r.default(.8,0,0,1)
          , A = new r.default(.42,0,.58,1)
          , j = 45 * Math.PI / 180
          , L = "rgba(87,165,224,1.0)"
          , R = void 0
          , F = false
          , B = [0, 0]
          , V = []
          , N = []
          , z = o.vec2.create()
          , W = o.vec2.create()
          , H = false
          , U = []
          , K = null
          , G = void 0
          , X = void 0
          , J = false
          , Y = null
          , q = null;
        function Q(e) {
            K && (K.hasHover = false,
            K = null)
        }
        function Z() {
            for (var e = 0; e < V.length; e++) {
                var t = V[e];
                t.type = a.default.Type.Asymmetric,
                t.inValue = t.value,
                t.outValue = t.value,
                t.inFactor = t.outFactor = .2
            }
            P.editor.captureJournalEntry(),
            Ye()
        }
        function $() {
            for (var e = 0; e < V.length; e++) {
                var t = V[e];
                t.type = a.default.Type.Disconnected,
                t.inValue = t.value,
                t.inFactor = .2,
                t.outFactor = .001
            }
            P.editor.captureJournalEntry(),
            Ye()
        }
        function ee() {
            for (var e = 0; e < V.length; e++) {
                var t = V[e];
                t.type = a.default.Type.Disconnected,
                t.outValue = t.value,
                t.outFactor = .2,
                t.inFactor = .001
            }
            P.editor.captureJournalEntry(),
            Ye()
        }
        function te() {
            if (V.length) {
                P.selectItem(null, false, true);
                for (var e = 0; e < V.length; e++) {
                    var t = V[e];
                    P.selectItem(t._List, true, true)
                }
                Fe()
            }
            P.isEditingCurves = true
        }
        function ne() {
            for (var e = 0; e < V.length; e++)
                V[e].type = a.default.Type.Hold;
            P.editor.captureJournalEntry(),
            Ye()
        }
        function ie() {
            for (var e = 0; e < V.length; e++)
                V[e].type = a.default.Type.Linear;
            P.editor.captureJournalEntry(),
            Ye()
        }
        function re(e) {
            for (var t = (P.displayEnd - P.displayStart) / x, n = X - G, i = D - 40, r = 0; r < V.length; r++) {
                var o = V[r];
                o.type = e,
                o.constrainToIn(t, n / i)
            }
            P.editor.captureJournalEntry(),
            Ye()
        }
        function oe() {
            re(a.default.Type.Mirrored)
        }
        function ae() {
            re(a.default.Type.Asymmetric)
        }
        function se() {
            for (var e = 0; e < V.length; e++)
                V[e].type = a.default.Type.Disconnected;
            P.editor.captureJournalEntry(),
            Ye()
        }
        var le = Date.now();
        function ue() {
            for (var e = -Number.MAX_VALUE, t = Number.MAX_VALUE, n = 0; n < V.length; n++) {
                var i = V[n];
                i.time < t ? t = i.time : i.time >= e && (e = i.time)
            }
            return {
                min: t,
                max: e,
                range: e - t
            }
        }
        function ce(e) {
            18 == e.keyCode && ((ct = ue()).min === ct.max && (ct = null),
            Ye())
        }
        function de(e) {
            18 == e.keyCode && (ct = null,
            Ye())
        }
        var he = false
          , fe = false
          , pe = 0;
        function ye(e) {
            e && (e.stopPropagation(),
            e.preventDefault());
            if (fe = false,
            window.removeEventListener("mouseup", ye, true),
            !he) {
                var n = Ae(e.clientX, e.clientY);
                if (n) {
                    var r = n.isSelected;
                    if (n.constructor === Array) {
                        r = true;
                        for (var o = 0; o < n.length; o++)
                            if (!n[o].isSelected) {
                                r = false;
                                break
                            }
                        n.length > 0 && n[0].time
                    } else
                        n.time;
                    r || Ne(n, i.default.isMultiSelect(e)),
                    2 === e.button && (De(false),
                    me && (me.cancel(),
                    me = null),
                    window.removeEventListener("mousemove", We, true),
                    window.removeEventListener("mousemove", Re, true),
                    P.isEditingCurves ? t.showContextMenu({
                        x: e.clientX,
                        y: e.clientY,
                        items: [{
                            icon: "key-hold",
                            name: "Hold",
                            select: ne,
                            isActive: n.type === a.default.Type.Hold
                        }, {
                            icon: "key-linear",
                            name: "Linear",
                            select: ie,
                            isActive: n.type === a.default.Type.Linear
                        }, {
                            icon: "key-mirrored",
                            name: "Mirrored",
                            select: oe,
                            isActive: n.type === a.default.Type.Mirrored
                        }, {
                            icon: "key-assymetric",
                            name: "Asymmetric",
                            select: ae,
                            isActive: n.type === a.default.Type.Asymmetric
                        }, {
                            icon: "key-disconnected",
                            name: "Disconnected",
                            select: se,
                            isActive: n.type === a.default.Type.Disconnected
                        }, {
                            type: "Divider"
                        }, {
                            type: "SubMenu",
                            name: "Presets",
                            items: [{
                                icon: "key-mirrored",
                                name: "Easy Ease",
                                select: Z
                            }, {
                                icon: "key-ease-in",
                                name: "Easy Ease In",
                                select: $
                            }, {
                                icon: "key-ease-out",
                                name: "Easy Ease Out",
                                select: ee
                            }]
                        }]
                    }) : t.showContextMenu({
                        x: e.clientX,
                        y: e.clientY,
                        items: [{
                            icon: "key-hold",
                            name: "Hold",
                            select: ne,
                            isActive: n.type === a.default.Type.Hold
                        }, {
                            icon: "key-linear",
                            name: "Linear",
                            select: ie,
                            isActive: n.type === a.default.Type.Linear
                        }, {
                            type: "Divider"
                        }, {
                            icon: "key-mirrored",
                            name: "Easy Ease",
                            select: Z
                        }, {
                            icon: "key-ease-in",
                            name: "Easy Ease In",
                            select: $
                        }, {
                            icon: "key-ease-out",
                            name: "Easy Ease Out",
                            select: ee
                        }, {
                            type: "Divider"
                        }, {
                            icon: "key-mirrored",
                            name: "Edit Curves",
                            select: te
                        }]
                    }))
                }
            }
        }
        var me = null;
        function ve(e) {
            pe = 0;
            var n = Date.now()
              , r = n - le;
            le = n;
            var a = r < 222
              , s = -1;
            if (he = false,
            fe = false,
            !e.target || "ScrollbarGrabber" !== e.target.className) {
                if (window.addEventListener("mouseup", ye, true),
                e.clientX > T && e.clientX < T + E)
                    if (e.preventDefault(),
                    e.stopPropagation(),
                    De(true),
                    t.stage.isPanning)
                        t.stage.isGrabbing = true,
                        t.stage.suppressPanning = true,
                        window.addEventListener("mousemove", We, true),
                        window.addEventListener("mouseup", He, true),
                        B[0] = e.clientX,
                        B[1] = e.clientY;
                    else {
                        if (Y = null,
                        P.isEditingCurves) {
                            for (var l = e.clientX - T, c = e.clientY - C, d = o.vec2.set(o.vec2.create(), l, c), h = 0; h < V.length; h++) {
                                var p = V[h];
                                if (p.cin)
                                    if (o.vec2.distance(p.cin.pos, d) <= 6) {
                                        Y = p.cin,
                                        q = p,
                                        s = p.inTime;
                                        break
                                    }
                                if (p.cout)
                                    if (o.vec2.distance(p.cout.pos, d) <= 6) {
                                        Y = p.cout,
                                        q = p,
                                        s = p.outTime;
                                        break
                                    }
                                if (p.prv && !p.prv.isSelected && p.prv.cout)
                                    if (o.vec2.distance(p.prv.cout.pos, d) <= 6) {
                                        Y = p.prv.cout,
                                        q = p.prv,
                                        s = p.prv.outTime;
                                        break
                                    }
                                if (p.nxt && !p.nxt.isSelected && p.nxt.cin)
                                    if (o.vec2.distance(p.nxt.cin.pos, d) <= 6) {
                                        Y = p.nxt.cin,
                                        q = p.nxt,
                                        s = p.nxt.inTime;
                                        break
                                    }
                            }
                            if (Y)
                                return B[0] = e.clientX,
                                B[1] = e.clientY,
                                (me = new u.default(e,o.vec2.set(o.vec2.create(), 1 == Y.factor ? q.inTime : q.outTime, 1 == Y.factor ? q.inGraphValue : q.outGraphValue))).onDrag = Oe,
                                void (me.onRelease = we)
                        }
                        var y = Ae(e.clientX, e.clientY);
                        if (y && 0 === e.button) {
                            var m = y.isSelected;
                            if (y.constructor === Array) {
                                m = true;
                                for (var v = 0; v < y.length; v++)
                                    if (!y[v].isSelected) {
                                        m = false;
                                        break
                                    }
                                y.length > 0 && (s = y[0].time)
                            } else
                                s = y.time;
                            if (m || Ne(y, i.default.isMultiSelect(e)),
                            e.altKey) {
                                var g = ue();
                                if (s == g.min ? (g.at = 0,
                                Ce = g) : s == g.max && (g.at = 1,
                                Ce = g),
                                Ce)
                                    for (var _ = 0; _ < V.length; _++) {
                                        var b = V[_]
                                          , w = b.time;
                                        b.__sf = (w - Ce.min) / Ce.range
                                    }
                            }
                            B[0] = e.clientX,
                            B[1] = e.clientY;
                            for (var O = [], S = 0; S < V.length; S++) {
                                var k = V[S];
                                O.push([k.time, k.graphValue])
                            }
                            (me = new u.default(e,O)).allowLock = P.isEditingCurves,
                            me.onDrag = Ce ? xe : Ie,
                            me.onRelease = Me
                        } else
                            2 === e.button ? fe = true : (i.default.isMultiSelect(e) ? U = V.slice(0) : U.length = 0,
                            z = je(e.clientX, e.clientY),
                            H = false,
                            window.addEventListener("mousemove", Re, true),
                            window.addEventListener("mouseup", ze, true))
                    }
                if (a)
                    if (-1 !== s)
                        P.position = s;
                    else {
                        var I = (P.displayEnd - P.displayStart) / x
                          , D = e.clientX - T - f;
                        P.position = P.displayStart + I * D
                    }
            }
        }
        function ge(e) {
            for (var t = {}, n = Number.MAX_VALUE, i = -Number.MAX_VALUE, r = 0; r < V.length; r++) {
                var o = V[r]
                  , a = t[o._Group.node.refId];
                a || (a = t[o._Group.node.refId] = {});
                var s = a[o._List.property];
                s || (s = a[o._List.property] = []),
                o.time < n && (n = o.time),
                o.time > i && (i = o.time),
                s.push(o._List.serializeFrame(o))
            }
            e.nodes = t,
            e.minTime = n,
            e.maxTime = i
        }
        var _e = null;
        function be() {
            if (V.length) {
                for (var e = 0; e < V.length; e++) {
                    V[e].remove()
                }
                for (var n = 0; n < N.length; n++)
                    N[n].reSort();
                Ne(null)
            } else {
                for (var i = t.selectedItems, r = 0, o = null, a = [], s = 0; s < i.length; s++) {
                    var l = i[s];
                    l.constructor === c.default && (a.push(l),
                    l === P && true,
                    1 == ++r && (o = l.name))
                }
                r && (_e && _e.hide(),
                _e = t.alert({
                    title: "Confirm",
                    message: 1 === r ? 'Are you sure you want to delete the "' + o + '" animation?' : "Are you sure you want to delete " + r + " animations?",
                    buttons: [{
                        label: "Delete",
                        action: function() {
                            t.removeAnimations(a)
                        }
                    }, {
                        label: "Cancel",
                        action: function() {}
                    }]
                }))
            }
        }
        function we(e) {
            me = null,
            De(false),
            P.editor.captureJournalEntry(),
            Ye()
        }
        function Oe(e) {
            var t = (P.displayEnd - P.displayStart) / x
              , n = e.getUnlockedRelativeScaled(t)[0]
              , i = Y.sibling
              , r = 1 == Y.factor ? i : q
              , o = 1 == Y.factor ? q : i;
            n > o.time && (n = o.time),
            n < r.time && (n = r.time);
            var a = o.time - r.time
              , s = (n - r.time) / a
              , l = X - G
              , u = D - 40
              , c = e.axisLock ? q.graphValue : e.getUnlockedRelativeScaled(-l / u)[1];
            1 == Y.factor ? (q.inFactor = 1 - s,
            q.inGraphValue = c,
            q.constrainToIn(t, l / u)) : (q.outGraphValue = c,
            q.outFactor = s,
            q.constrainToOut(t, l / u)),
            Ye()
        }
        var Se = []
          , ke = null
          , Pe = 0
          , Ee = 0;
        function Te() {
            if (ke = null,
            Pe || Ee) {
                var t = false;
                if (P.isEditingCurves) {
                    var n = (X - G) / (D - 40) * -Ee;
                    G += n,
                    X += n
                } else
                    e.scrollTo(Ge + Ee),
                    t = 0 !== Ee;
                var i = P.displayEnd - P.displayStart
                  , r = Pe * (i / x);
                P.displayStart + r < 0 ? r += -(P.displayStart + r) : P.displayEnd + r > P.duration && (r -= P.displayEnd + r - P.duration),
                P.displayStart += r,
                P.displayEnd += r,
                ke = setTimeout(Te, 75),
                H && !t && Le()
            }
        }
        var Ce = null;
        function xe(e) {
            var t = (P.displayEnd - P.displayStart) / x
              , n = e.absolute[0] - T - f
              , i = P.displayStart + t * n
              , r = 0 === Ce.at ? i : Ce.min
              , o = (1 === Ce.at ? i : Ce.max) - r;
            if (P.isEditingCurves)
                for (var a = X - G, s = D - 40, l = 0; l < V.length; l++) {
                    var u = V[l]
                      , c = e.getRelativeScaled(-a / s, l)[1];
                    u.setFullFrameTime(r + u.__sf * o, u.prv && !u.prv.isSelected, u.nxt && !u.nxt.isSelected),
                    u.graphValue = c
                }
            else
                for (var d = 0; d < V.length; d++) {
                    var h = V[d];
                    h.setFullFrameTime(r + h.__sf * o, h.prv && !h.prv.isSelected, h.nxt && !h.nxt.isSelected)
                }
            if (Se.length) {
                for (var p = 0; p < Se.length; p++) {
                    var y = Se[p];
                    delete y._Hidden,
                    y._List.keyFrames.push(y)
                }
                Se.length = 0
            }
            for (var m = 0; m < N.length; m++)
                N[m].reSort();
            for (var v = 0; v < V.length; v++) {
                var g = V[v];
                if (!g._Hidden) {
                    var _ = g._Time;
                    if (g.prv && g.prv._Time === _) {
                        var b = g._List.keyFrames.indexOf(g.prv);
                        -1 != b && g._List.keyFrames.splice(b, 1),
                        Se.push(g.prv),
                        g.prv._Hidden = true,
                        g.prv = g.prv.prv,
                        g.prv && (g.prv.nxt = g)
                    }
                    if (g.nxt && g.nxt._Time === _) {
                        var w = g._List.keyFrames.indexOf(g.nxt);
                        -1 != w && g._List.keyFrames.splice(w, 1),
                        Se.push(g.nxt),
                        g.nxt._Hidden = true,
                        g.nxt = g.nxt.nxt,
                        g.nxt && (g.nxt.prv = g)
                    }
                }
            }
            Ye()
        }
        function Ie(e) {
            var t = (P.displayEnd - P.displayStart) / x
              , n = e.clampAllScale(t, 0, P.duration, 0);
            if (P.isEditingCurves)
                for (var i = X - G, r = D - 40, o = 0; o < V.length; o++) {
                    var a = e.getRelativeScaled(n, o)[0]
                      , s = e.getRelativeScaled(-i / r, o)[1];
                    a = Math.trunc(a * P.fps) / P.fps;
                    var l = V[o];
                    l.setFullFrameTime(a, l.prv && !l.prv.isSelected, l.nxt && !l.nxt.isSelected),
                    l.graphValue = s
                }
            else
                for (var u = 0; u < V.length; u++) {
                    var c = V[u]
                      , d = e.getRelativeScaled(n, u)[0];
                    d = Math.trunc(d * P.fps) / P.fps,
                    c.setFullFrameTime(d, c.prv && !c.prv.isSelected, c.nxt && !c.nxt.isSelected)
                }
            if (Se.length) {
                for (var h = 0; h < Se.length; h++) {
                    var f = Se[h];
                    delete f._Hidden,
                    f._List.keyFrames.push(f)
                }
                Se.length = 0
            }
            for (var p = 0; p < N.length; p++)
                N[p].reSort();
            for (var y = 0; y < V.length; y++) {
                var m = V[y]
                  , v = m._Time;
                if (m.prv && m.prv._Time === v) {
                    var g = m._List.keyFrames.indexOf(m.prv);
                    -1 != g && m._List.keyFrames.splice(g, 1),
                    Se.push(m.prv),
                    m.prv._Hidden = true,
                    m.prv = m.prv.prv,
                    m.prv && (m.prv.nxt = m)
                }
                if (m.nxt && m.nxt._Time === v) {
                    var _ = m._List.keyFrames.indexOf(m.nxt);
                    -1 != _ && m._List.keyFrames.splice(_, 1),
                    Se.push(m.nxt),
                    m.nxt._Hidden = true,
                    m.nxt = m.nxt.nxt,
                    m.nxt && (m.nxt.prv = m)
                }
            }
            Ye()
        }
        function De(e) {
            J = e
        }
        function Me() {
            if (Ce = null,
            Se.length) {
                for (var e = 0; e < Se.length; e++) {
                    var t = Se[e];
                    t._Animation.onKeyFrameDeleted(t)
                }
                Se.length = 0
            }
            De(false),
            P.editor.captureJournalEntry(),
            Ye()
        }
        function Ae(e, t) {
            var n = (P.displayEnd - P.displayStart) / x;
            e = e - T - f;
            var i = P.displayStart + n * e;
            if (P.isEditingCurves) {
                for (var r = t - C, o = P.selectedItems, a = 0; a < o.length; a++) {
                    var l = o[a].getClosestKey(i, 4.5 * n);
                    if (l && Math.abs(l.py - r) < 4.5)
                        return l
                }
                return null
            }
            var u = function(e) {
                var t = ot(e);
                if (it.length > t)
                    return it[t];
                return null
            }(t - C);
            u || -1 === ot(t - C) && (u = ut);
            if (u) {
                if (u == ut || u.constructor === s.default)
                    for (var c = u == ut ? ut.keys : u.allKeys, d = e + f, h = 0; h < c.length; h++) {
                        var p = c[h];
                        if (d >= p.px - 4.5 && d <= p.px + 4.5 && p.list.length)
                            return p.list
                    }
                else {
                    var y = u.getClosestKey(P.displayStart + n * e, 4.5 * n);
                    if (y)
                        return y
                }
                return null
            }
        }
        function je(e, t) {
            var n = (P.displayEnd - P.displayStart) / x
              , i = P.displayStart + n * (e - T - f)
              , r = t - C + Ge;
            P.isEditingCurves && (r = X - (t - C - 20) / (D - 40) * (X - G));
            return o.vec2.set(o.vec2.create(), i, r)
        }
        function Le() {
            var e = je(W[0], W[1])
              , t = z[0] < e[0]
              , n = z[1] < e[1]
              , i = t ? z[0] : e[0]
              , r = n ? z[1] : e[1]
              , o = t ? e[0] : z[0]
              , a = n ? e[1] : z[1]
              , u = (P.displayEnd,
            P.displayStart,
            i)
              , c = o
              , d = [];
            if (P.isEditingCurves)
                for (var h = P.selectedItems, f = 0; f < h.length; f++)
                    for (var p = h[f], y = p.getKeysInRangeIdx(u, c), m = p.keyFrames, v = y.start; v < y.end; v++) {
                        var g = m[v];
                        g.graphValue >= r && g.graphValue <= a && d.push(g)
                    }
            else {
                var _ = Math.floor(r / 35) - 1
                  , b = Math.floor(a / 35) - 1;
                r % 35 > 17.5 && _++,
                a % 35 < 17.5 && b--,
                function(e, t, n) {
                    t <= -1 && n >= -1 && e(-1, ut);
                    for (var i = P.editableKeyedNodes, r = 0, o = 0; o < i.length; o++) {
                        var a = i[o];
                        if ((void 0 === t || r >= t) && (void 0 === n || r <= n) && e(r, a),
                        void 0 !== n && r > n)
                            return;
                        r++;
                        for (var s = a.keyFrameGroups, u = 0; u < s.length; u++) {
                            var c = s[u]
                              , d = c.props;
                            a.isExpanded && (d.framePosX && ((void 0 === t || r >= t) && (void 0 === n || r <= n) && e(r, d.framePosX),
                            r++),
                            d.framePosY && ((void 0 === t || r >= t) && (void 0 === n || r <= n) && e(r, d.framePosY),
                            r++),
                            d.frameRotation && ((void 0 === t || r >= t) && (void 0 === n || r <= n) && e(r, d.frameRotation),
                            r++),
                            d.frameScaleX && ((void 0 === t || r >= t) && (void 0 === n || r <= n) && e(r, d.frameScaleX),
                            r++),
                            d.frameScaleY && ((void 0 === t || r >= t) && (void 0 === n || r <= n) && e(r, d.frameScaleY),
                            r++),
                            d.frameOpacity && ((void 0 === t || r >= t) && (void 0 === n || r <= n) && e(r, d.frameOpacity),
                            r++),
                            d.frameSequence && ((void 0 === t || r >= t) && (void 0 === n || r <= n) && e(r, d.frameSequence),
                            r++),
                            d.frameStrength && ((void 0 === t || r >= t) && (void 0 === n || r <= n) && e(r, d.frameStrength),
                            r++),
                            d.frameLength && ((void 0 === t || r >= t) && (void 0 === n || r <= n) && e(r, d.frameLength),
                            r++),
                            d.frameIsCollisionEnabled && ((void 0 === t || r >= t) && (void 0 === n || r <= n) && e(r, d.frameIsCollisionEnabled),
                            r++),
                            d.frameIntValue && c.node.propertyType === l.default.Type.Integer && ((void 0 === t || r >= t) && (void 0 === n || r <= n) && e(r, d.frameIntValue),
                            r++),
                            d.frameFloatValue && c.node.propertyType === l.default.Type.Float && ((void 0 === t || r >= t) && (void 0 === n || r <= n) && e(r, d.frameFloatValue),
                            r++),
                            d.frameStringValue && c.node.propertyType === l.default.Type.String && ((void 0 === t || r >= t) && (void 0 === n || r <= n) && e(r, d.frameStringValue),
                            r++),
                            d.frameBooleanValue && c.node.propertyType === l.default.Type.Boolean && ((void 0 === t || r >= t) && (void 0 === n || r <= n) && e(r, d.frameBooleanValue),
                            r++),
                            d.frameActiveChild && ((void 0 === t || r >= t) && (void 0 === n || r <= n) && e(r, d.frameActiveChild),
                            r++),
                            d.frameDrawOrder && ((void 0 === t || r >= t) && (void 0 === n || r <= n) && e(r, d.frameDrawOrder),
                            r++),
                            d.frameVertices && ((void 0 === t || r >= t) && (void 0 === n || r <= n) && e(r, d.frameVertices),
                            r++),
                            d.frameTrigger && ((void 0 === t || r >= t) && (void 0 === n || r <= n) && e(r, d.frameTrigger),
                            r++))
                        }
                    }
                }((function(e, t) {
                    if (t === ut || t.constructor === s.default)
                        for (var n = t === ut ? ut.keys : t.allKeys, i = 0; i < n.length; i++) {
                            var r = n[i];
                            if (r.list.length) {
                                var o = r.list[0]._Time;
                                if (o >= u && o <= c)
                                    for (var a = 0; a < r.list.length; a++)
                                        d.push(r.list[a])
                            }
                        }
                    else {
                        var l = t.getKeysInRange(u, c);
                        l.length && d.push.apply(d, l)
                    }
                }
                ), _, b)
            }
            U.length && d.push.apply(d, U),
            Ne(d, false, true)
        }
        function Re(e) {
            e.preventDefault(),
            W = [e.clientX, e.clientY],
            H = true,
            Le();
            var t = e.clientY - C;
            Ee = t < 0 ? -15 : t > D ? 15 : 0;
            var n = e.clientX - T;
            (Pe = n < 0 ? -15 : n > E ? 15 : 0) || Ee ? ke || (ke = setTimeout(Te, 75)) : ke && (clearTimeout(ke),
            ke = null),
            Ye()
        }
        function Fe() {
            for (var e = 0; e < V.length; e++) {
                var t = V[e];
                t._List.isSelected || (t.isSelected = false,
                V.splice(e, 1),
                e--)
            }
        }
        function Be() {
            Fe()
        }
        function Ve(e) {
            Ne(e, false, true)
        }
        function Ne(e, t, n) {
            if (!t) {
                P.isEditingCurves || n || P.selectItem(null);
                for (var i = 0; i < V.length; i++)
                    V[i].isSelected = false;
                V.length = 0,
                N.length = 0
            }
            if (e)
                if (e.constructor === Array)
                    for (var r = 0; r < e.length; r++) {
                        var o = e[r];
                        o.isSelected || (n || P.selectItem(o._List, true),
                        V.push(o),
                        -1 == N.indexOf(o.row) && N.push(o.row),
                        o.isSelected = true)
                    }
                else
                    e.isSelected || (n || P.selectItem(e._List, true),
                    V.push(e),
                    -1 == N.indexOf(e.row) && N.push(e.row),
                    e.isSelected = true);
            Ye()
        }
        function ze(e) {
            if (De(false),
            window.removeEventListener("mousemove", Re, true),
            window.removeEventListener("mouseup", ze, true),
            Ee = 0,
            Pe = 0,
            ke && (clearTimeout(ke),
            ke = null),
            H)
                H = false,
                !P.isEditingCurves && V.length && function() {
                    P.selectItem(null, false, true);
                    for (var e = 0; e < V.length; e++) {
                        var t = V[e];
                        P.selectItem(t._List, true, true)
                    }
                }();
            else {
                var t = Ae(e.clientX, e.clientY);
                t ? Ne(t, i.default.isMultiSelect(e)) : Ne(null)
            }
            Ye()
        }
        function We(n) {
            n.stopPropagation(),
            n.preventDefault(),
            t.stage.updateCustomCursorPosition(n);
            var i = n.clientX - B[0]
              , r = n.clientY - B[1];
            B[0] = n.clientX,
            B[1] = n.clientY,
            e.scrollTo(Ge - r);
            var o = P.displayEnd - P.displayStart
              , a = o / x * -i
              , s = P.displayStart + a
              , l = P.displayEnd + a;
            s < 0 && (s = 0,
            l = o),
            l > P.duration && (s = (l = P.duration) - o),
            P.setRange(s, l)
        }
        function He() {
            De(false),
            t.stage.isGrabbing = false,
            t.stage.suppressPanning = false,
            window.removeEventListener("mousemove", We, true),
            window.removeEventListener("mouseup", He, true),
            Ye()
        }
        this.panTime = function(e) {
            var t = e
              , n = P.displayEnd - P.displayStart
              , i = n / x * -t
              , r = P.displayStart + i
              , o = P.displayEnd + i;
            r < 0 && (r = 0,
            o = n),
            o > P.duration && (r = (o = P.duration) - n),
            P.setRange(r, o)
        }
        ,
        this.zoomTime = function(e) {
            var t = e
              , n = (P.displayEnd - P.displayStart) / x * -t
              , i = P.displayStart - n
              , r = P.displayEnd + n;
            i < 0 && (i = 0),
            r > P.duration && (r = P.duration),
            P.setRange(i, r, true)
        }
        ;
        var Ue = o.vec2.create();
        function Ke(e) {
            e.preventDefault();
            var n = o.vec2.set(o.vec2.create(), e.clientX, e.clientY);
            if (pe += o.vec2.distance(n, Ue),
            Ue = n,
            pe > 4 && (he = true),
            e.clientX > T && e.clientX < T + E) {
                R || (R = true);
                var i = ot(e.clientY - C)
                  , r = it[i];
                r && (r.hasHover = true),
                K && K != r && (K.hasHover = false),
                K = r
            } else
                R && (R = false);
            fe && he && (fe = false,
            t.stage.isGrabbing = true,
            t.stage.suppressPanning = true,
            window.addEventListener("mousemove", We, true),
            window.addEventListener("mouseup", He, true),
            B[0] = e.clientX,
            B[1] = e.clientY)
        }
        var Ge = 0;
        function Xe(t) {
            var n = t.deltaY;
            1 === t.deltaMode && (n *= 35),
            e.scrollTo(Ge + n)
        }
        function Je() {
            clearTimeout(k),
            document.hasFocus() ? window.requestAnimationFrame(tt) : k = setTimeout(tt, 1 / 15 * 1e3)
        }
        function Ye() {
            S = true
        }
        function qe() {
            Ye()
        }
        function Qe(e) {
            Ye()
        }
        this.scroll = function(e) {
            Ge = e,
            H && (Le(),
            F = true),
            Ye()
        }
        ;
        var Ze = 0;
        function $e() {
            if (h) {
                var e = Ze;
                return !(!I && D == e) && (I = false,
                h.width = E,
                h.height = D = e,
                g && (g.style.width = h.width + "px",
                g.style.height = h.height + "px"),
                _ && (_.style.width = h.width + "px",
                _.style.height = h.height + "px"),
                true)
            }
        }
        function et(e, t, n, i, r) {
            var o = e[t + "Anim"];
            if (o) {
                var a = O.indexOf(o);
                -1 != a && O.splice(a, 1)
            }
            !function(e, t, n, i, r) {
                O.push(new y(e,t,n,i,r))
            }(e, t, n, i, r)
        }
        function tt() {
            var e = performance.now();
            if (b) {
                var t = (e - w) / 1e3;
                w = e;
                for (var n = 0 != O.length, i = 0; i < O.length; i++) {
                    O[i].advance(t) && (O.splice(i, 1),
                    i--)
                }
                var r = S || n;
                S = false,
                $e() && (r = true),
                r && (P && P.isEditingCurves ? function() {
                    if (!h || !P)
                        return;
                    ct && (ct = ue());
                    it = [],
                    rt = 0;
                    Date.now();
                    v.clearRect(0, 0, h.width, h.height),
                    v.strokeStyle = "rgba(255,255,255,1.0)",
                    v.fillStyle = L;
                    var e = (P.displayEnd - P.displayStart) / x
                      , t = 1 / e
                      , n = f - P.displayStart / e;
                    lt(e);
                    var i = P.selectedItems
                      , r = []
                      , s = !J || null == G || null == X;
                    s && (G = null,
                    X = null);
                    if (me && me.axisLock) {
                        v.save();
                        var l = D - 20
                          , u = X - G
                          , c = D - 40;
                        v.strokeStyle = "rgba(255,185,0,1.0)";
                        var d = me.origins;
                        if (d && d.length && V.length === d.length)
                            for (var p = 0; p < d.length; p++) {
                                var y = d[p]
                                  , m = V[p]
                                  , g = n + y[0] * t
                                  , _ = l - (y[1] - G) / u * c
                                  , b = n + m.time * t
                                  , w = l - (m.graphValue - G) / u * c;
                                v.moveTo(g, _),
                                v.lineTo(b, w),
                                v.stroke()
                            }
                        v.restore()
                    }
                    for (var O = 0; O < i.length; O++) {
                        for (var S = i[O], k = S.keyFrames, E = S.getKeysInRangeIdx(P.displayStart, P.displayEnd), T = Math.max(0, E.start - 1), C = Math.min(k.length - 1, E.end + 1), I = T; I <= C; I++) {
                            var M = k[I];
                            if (s) {
                                var A = M.graphValueBounds;
                                null === G ? (G = A[0],
                                X = A[1]) : (A[0] < G && (G = A[0]),
                                A[1] > X && (X = A[1]))
                            }
                            if (s && M.isSelected) {
                                M.inGraphValue < G && (G = M.inGraphValue),
                                M.inGraphValue > X && (X = M.inGraphValue),
                                M.outGraphValue < G && (G = M.outGraphValue),
                                M.outGraphValue > X && (X = M.outGraphValue);
                                var j = M.prv;
                                j && !j.isSelected && (j.inGraphValue < G && (G = j.inGraphValue),
                                j.inGraphValue > X && (X = j.inGraphValue),
                                j.outGraphValue < G && (G = j.outGraphValue),
                                j.outGraphValue > X && (X = j.outGraphValue));
                                var R = M.nxt;
                                R && !R.isSelected && (R.inGraphValue < G && (G = R.inGraphValue),
                                R.inGraphValue > X && (X = R.inGraphValue),
                                R.outGraphValue < G && (G = R.outGraphValue),
                                R.outGraphValue > X && (X = R.outGraphValue))
                            }
                        }
                        if (s) {
                            var F = S.getInterpolatedValue(P.displayStart);
                            F = S.getGraphValue(F),
                            null === G ? (G = F,
                            X = F) : (F < G && (G = F),
                            F > X && (X = F)),
                            F = S.getInterpolatedValue(P.displayEnd),
                            F = S.getGraphValue(F),
                            null === G ? (G = F,
                            X = F) : (F < G && (G = F),
                            F > X && (X = F))
                        }
                        r.push({
                            item: S,
                            start: Math.max(0, T - 1),
                            end: Math.min(k.length - 1, C + 1)
                        })
                    }
                    G == X && (G -= 10,
                    X += 10);
                    for (var B = D - 20, N = X - G, z = D - 40, W = [], H = 0; H < r.length; H++) {
                        var U = r[H]
                          , K = U.item
                          , Y = K.keyFrames
                          , q = U.start
                          , Q = U.end
                          , Z = K.cssColor;
                        v.fillStyle = Z;
                        for (var $ = null, ee = q; ee <= Q; ee++) {
                            var te = Y[ee]
                              , ne = te.graphValue
                              , ie = (te.time,
                            n + te.time * t)
                              , re = B - (ne - G) / N * z;
                            if (te.px = ie,
                            te.py = re,
                            te.hasHandles)
                                if ($ ? (te.cin || (te.cin = {
                                    pos: o.vec2.create()
                                }),
                                te.cin.sibling = $,
                                te.cin.factor = 1,
                                te.cin.pos[0] = n + te.inTime * t,
                                te.cin.pos[1] = B - (te.inGraphValue - G) / N * z) : delete te.cin,
                                ee + 1 < Y.length && te.type !== a.default.Type.Hold) {
                                    te.cout || (te.cout = {
                                        pos: o.vec2.create()
                                    });
                                    var oe = Y[ee + 1];
                                    te.cout.sibling = oe,
                                    te.cout.factor = -1,
                                    te.cout.pos[0] = n + te.outTime * t,
                                    te.cout.pos[1] = B - (te.outGraphValue - G) / N * z
                                } else
                                    delete te.cout;
                            else
                                delete te.cin,
                                delete te.cout;
                            if ($) {
                                if (v.save(),
                                v.strokeStyle = $.isSelected && te.isSelected ? "rgba(255,255,255,1.0)" : Z,
                                v.beginPath(),
                                $.type === a.default.Type.Hold)
                                    v.moveTo($.px, $.py),
                                    v.lineTo(ie, $.py),
                                    v.lineTo(ie, re);
                                else {
                                    v.moveTo($.px, $.py);
                                    var ae = $.px
                                      , se = $.py;
                                    $.cout && (ae = $.cout.pos[0],
                                    se = $.cout.pos[1]);
                                    var le = ie
                                      , ce = re;
                                    te.cin && (le = te.cin.pos[0],
                                    ce = te.cin.pos[1]),
                                    v.bezierCurveTo(ae, se, le, ce, ie, re)
                                }
                                v.stroke(),
                                v.restore(),
                                $.isSelected ? W.push($) : ht($, $.px, $.py)
                            }
                            $ = te
                        }
                        $ && ($.isSelected ? W.push($) : ht($, $.px, $.py))
                    }
                    for (var de = 0; de < W.length; de++) {
                        var he = W[de];
                        v.fillStyle = he._List.cssColor,
                        v.save(),
                        v.strokeStyle = he._List.cssColor,
                        he.hasHandles && (he.cin && (v.beginPath(),
                        v.moveTo(he.px, he.py),
                        v.lineTo(he.cin.pos[0], he.cin.pos[1]),
                        v.stroke(),
                        dt(he.cin)),
                        he.cout && (v.beginPath(),
                        v.moveTo(he.px, he.py),
                        v.lineTo(he.cout.pos[0], he.cout.pos[1]),
                        v.stroke(),
                        dt(he.cout))),
                        he.prv && !he.prv.isSel && he.prv.cout && (v.beginPath(),
                        v.moveTo(he.prv.px, he.prv.py),
                        v.lineTo(he.prv.cout.pos[0], he.prv.cout.pos[1]),
                        v.stroke(),
                        dt(he.prv.cout)),
                        he.nxt && !he.nxt.isSel && he.nxt.cout && (v.beginPath(),
                        v.moveTo(he.nxt.px, he.nxt.py),
                        v.lineTo(he.nxt.cin.pos[0], he.nxt.cin.pos[1]),
                        v.stroke(),
                        dt(he.nxt.cin)),
                        v.restore(),
                        ht(he, he.px, he.py)
                    }
                    var fe = (X - G) / (D - 40)
                      , pe = 50 * fe
                      , ye = 1;
                    pe < .01 ? (pe = .01,
                    ye = 100) : pe < .025 ? (pe = .025,
                    ye = 1e3) : pe < .05 ? (pe = .05,
                    ye = 100) : pe < .1 ? (pe = .1,
                    ye = 10) : pe < .25 ? (pe = .25,
                    ye = 100) : pe < .5 ? (pe = .5,
                    ye = 10) : pe = pe < 1 ? 1 : pe < 3 ? 2 : 5 * Math.round(pe / 5);
                    var ve = pe / fe
                      , ge = Math.ceil(D / ve + 1)
                      , _e = G / pe
                      , be = Math.floor(_e) * pe
                      , we = (be - G) / fe;
                    v.save(),
                    v.strokeStyle = "rgba(70,70,70,0.8)",
                    v.fillStyle = "rgba(145,145,145,1.0)",
                    v.font = "11px 'Roboto', sans-serif";
                    for (var Oe = D - 20 - we, Se = 0; Se < ge; Se++) {
                        v.beginPath(),
                        v.moveTo(0, Oe),
                        v.lineTo(10, Oe),
                        v.stroke();
                        var ke = 1 == ye ? be : Math.round(be * ye) / ye;
                        v.fillText(ke.toString(), 15, Oe),
                        be += pe,
                        Oe -= ve
                    }
                    v.restore(),
                    at(e)
                }() : function() {
                    if (!h || !P)
                        return;
                    ct && (ct = ue());
                    it = [],
                    rt = 0,
                    v.clearRect(0, 0, h.width, h.height);
                    var e = Ge
                      , t = (P.displayEnd - P.displayStart) / x
                      , n = 1 / t
                      , i = f - P.displayStart / t;
                    lt(t);
                    var r = P.editableKeyedNodes
                      , o = 35 - e;
                    ut.lut = {},
                    ut.keys.length = 0;
                    for (var a = 0; a < r.length; a++) {
                        var s = o <= D
                          , u = r[a];
                        u.allKeysLut = {},
                        u.allKeys = [];
                        var c = void 0 !== u.renderExpansionAnim
                          , d = 35;
                        if (u.isExpanded) {
                            for (var p = 0, y = 0; y < u.keyFrameGroups.length; y++) {
                                var g = u.keyFrameGroups[y];
                                p += g.propsList.length;
                                var _ = g.props;
                                _.frameIntValue && g.node.propertyType !== l.default.Type.Integer && p--,
                                _.frameFloatValue && g.node.propertyType !== l.default.Type.Float && p--,
                                _.frameStringValue && g.node.propertyType !== l.default.Type.String && p--,
                                _.frameBooleanValue && g.node.propertyType !== l.default.Type.Boolean && p--
                            }
                            d += 35 * p
                        }
                        var b = u.renderExpansion;
                        u.renderExpansion == d || c && u.renderExpansionAnim.to == d || (void 0 === u.renderExpansion && (u.renderExpansion = 35),
                        et(u, "renderExpansion", d, .4, M),
                        c = true),
                        o + b < 0 && (s = false);
                        var w = u.node.stageItem
                          , O = w && w.isSelected;
                        s && (u.hasHover || O) && (u.hasHover && O ? v.fillStyle = m.RowHoverAndSelectedBackground : u.hasHover ? v.fillStyle = m.RowHoverBackground : O && (v.fillStyle = m.RowSelectedBackground),
                        v.fillRect(0, o, E, 35)),
                        0 == it.length && (rt = o),
                        s && it.push(u);
                        var S = o + 35
                          , k = s && (c || u.isExpanded);
                        s && (v.save(),
                        v.beginPath(),
                        v.rect(0, o, E, b),
                        v.clip());
                        for (var T = 0; T < u.keyFrameGroups.length; T++) {
                            var C = u.keyFrameGroups[T]
                              , I = C.props;
                            I.framePosX && (S = nt(u, I.framePosX, i, S, n, k)),
                            I.framePosY && (S = nt(u, I.framePosY, i, S, n, k)),
                            I.frameRotation && (S = nt(u, I.frameRotation, i, S, n, k)),
                            I.frameScaleX && (S = nt(u, I.frameScaleX, i, S, n, k)),
                            I.frameScaleY && (S = nt(u, I.frameScaleY, i, S, n, k)),
                            I.frameOpacity && (S = nt(u, I.frameOpacity, i, S, n, k)),
                            I.frameSequence && (S = nt(u, I.frameSequence, i, S, n, k)),
                            I.frameStrength && (S = nt(u, I.frameStrength, i, S, n, k)),
                            I.frameLength && (S = nt(u, I.frameLength, i, S, n, k)),
                            I.frameIsCollisionEnabled && (S = nt(u, I.frameIsCollisionEnabled, i, S, n, k)),
                            I.frameIntValue && C.node.propertyType === l.default.Type.Integer && (S = nt(u, I.frameIntValue, i, S, n, k)),
                            I.frameFloatValue && C.node.propertyType === l.default.Type.Float && (S = nt(u, I.frameFloatValue, i, S, n, k)),
                            I.frameStringValue && C.node.propertyType === l.default.Type.String && (S = nt(u, I.frameStringValue, i, S, n, k)),
                            I.frameBooleanValue && C.node.propertyType === l.default.Type.Boolean && (S = nt(u, I.frameBooleanValue, i, S, n, k)),
                            I.frameActiveChild && (S = nt(u, I.frameActiveChild, i, S, n, k)),
                            I.frameDrawOrder && (S = nt(u, I.frameDrawOrder, i, S, n, k)),
                            I.frameVertices && (S = nt(u, I.frameVertices, i, S, n, k)),
                            I.frameTrigger && (S = nt(u, I.frameTrigger, i, S, n, k))
                        }
                        if (s) {
                            v.strokeStyle = "rgba(255,255,255,1.0)",
                            v.fillStyle = "rgba(255,255,255,0.5)";
                            for (var A = o + 17.5, R = 0; R < u.allKeys.length; R++) {
                                var F = u.allKeys[R]
                                  , B = F.isSelected;
                                v.save(),
                                B && (v.fillStyle = L),
                                v.translate(F.px, A),
                                v.rotate(j);
                                var V = B && ct && (ct.min === F.list[0]._Time || ct.max === F.list[0]._Time);
                                V && (v.fillStyle = "rgba(255,185,0,1.0)",
                                v.translate(-3, 3),
                                v.fillRect(-3.5, -3.5, 7, 7),
                                v.translate(6, -6),
                                v.fillRect(-3.5, -3.5, 7, 7),
                                v.translate(-3, 3)),
                                v.fillRect(-3.5, -3.5, 7, 7),
                                B && (v.strokeRect(-3.5, -3.5, 7, 7),
                                V && (v.strokeStyle = "rgba(0,0,0,1.0)",
                                v.strokeRect(-4.5, -4.5, 9, 9))),
                                v.restore()
                            }
                            v.restore(),
                            v.fillStyle = "rgba(70,70,70,0.8)",
                            v.fillRect(0, o + b, E, 1)
                        }
                        o += b
                    }
                    o = -e,
                    v.save(),
                    v.strokeStyle = "rgba(255,255,255,1.0)",
                    v.fillStyle = "rgba(255,255,255,0.85)";
                    for (var N = o + 17.5, z = 0; z < ut.keys.length; z++) {
                        var W = ut.keys[z]
                          , H = W.isSelected;
                        v.save(),
                        H && (v.fillStyle = L),
                        v.translate(W.px, N),
                        v.rotate(j);
                        var U = H && ct && (ct.min === W.list[0]._Time || ct.max === W.list[0]._Time);
                        U && (v.fillStyle = "rgba(255,185,0,1.0)",
                        v.translate(-3, 3),
                        v.fillRect(-3.5, -3.5, 7, 7),
                        v.translate(6, -6),
                        v.fillRect(-3.5, -3.5, 7, 7),
                        v.translate(-3, 3)),
                        v.fillRect(-3.5, -3.5, 7, 7),
                        H && (v.strokeRect(-3.5, -3.5, 7, 7),
                        U && (v.strokeStyle = "rgba(0,0,0,1.0)",
                        v.strokeRect(-4.5, -4.5, 9, 9))),
                        v.restore()
                    }
                    v.restore(),
                    v.fillStyle = "rgba(70,70,70,0.8)",
                    v.fillRect(0, o + 35, E, 1),
                    at(t)
                }(),
                F && (Le(),
                F = false)),
                Je()
            }
        }
        function nt(e, t, n, i, r, o) {
            t._Y = i - d,
            o && (it.push(t),
            (t.hasHover || t.isSelected) && (t.hasHover && t.isSelected ? v.fillStyle = m.RowHoverAndSelectedBackground : t.hasHover ? v.fillStyle = m.RowHoverBackground : t.isSelected && (v.fillStyle = m.RowSelectedBackground),
            v.fillRect(0, i, E, 35)));
            var s = t.keyFrames
              , l = i + 17.5;
            o && (v.fillStyle = L,
            v.strokeStyle = "rgba(255,255,255,1.0)");
            for (var u = null, c = false, h = 0; h < s.length; h++) {
                var f = s[h]
                  , p = f.prv && f.prv.isSelected
                  , y = Math.round(n + f.time * r) + .5
                  , g = false;
                if (y > -3.5) {
                    var _ = f.isSelected
                      , b = y < E + 3.5;
                    if (b) {
                        var w = ut.lut[y];
                        if (w || (w = {
                            px: y,
                            list: [],
                            isSelected: _
                        },
                        ut.lut[y] = w,
                        ut.keys.push(w)),
                        _ || (w.isSelected = false),
                        w.list.push(f),
                        (w = e.allKeysLut[y]) || (w = {
                            px: y,
                            list: [],
                            isSelected: _
                        },
                        e.allKeysLut[y] = w,
                        e.allKeys.push(w)),
                        _ || (w.isSelected = false),
                        w.list.push(f),
                        o) {
                            v.save(),
                            v.translate(y, l),
                            f.type !== a.default.Type.Hold && v.rotate(j);
                            var O = _ && ct && (ct.min === f._Time || ct.max === f._Time);
                            O && (v.fillStyle = "rgba(255,185,0,1.0)",
                            v.translate(-3, 3),
                            v.fillRect(-3.5, -3.5, 7, 7),
                            v.translate(6, -6),
                            v.fillRect(-3.5, -3.5, 7, 7),
                            v.translate(-3, 3),
                            g = true),
                            v.fillRect(-3.5, -3.5, 7, 7),
                            _ && (v.strokeRect(-3.5, -3.5, 7, 7),
                            O && (v.strokeStyle = "rgba(0,0,0,1.0)",
                            v.strokeRect(-4.5, -4.5, 9, 9))),
                            v.restore()
                        }
                    }
                    if (o && null !== u && (b || u < E + 3.5)) {
                        var S = c ? 5 : 0
                          , k = g ? 5 : 0;
                        v.fillStyle = p && _ ? "rgba(255,255,255,1.0)" : "rgba(87,165,224,0.3)",
                        v.fillRect(u + 3.5 + S, l - .5, y - u - 7 - S - k, 1),
                        v.fillStyle = L
                    }
                    c = g
                }
                u = y
            }
            return i + 35
        }
        this.setHeight = function(e) {
            Ze = e
        }
        ,
        Object.defineProperties(this, {
            isMouseOver: {
                get: function() {
                    return R
                }
            },
            isPanning: {
                get: function() {
                    return t.stage.isPanning
                },
                set: function(e) {
                    t.stage.isPanning = e
                }
            },
            isActive: {
                get: function() {
                    return b
                },
                set: function(e) {
                    b != e && (b = e) && Je()
                }
            },
            animation: {
                get: function() {
                    return P
                },
                set: function(e) {
                    if (P != e) {
                        P && (P.removeEventListener("update", qe),
                        P.removeEventListener("expand", Qe),
                        P.removeEventListener("delete", be),
                        P.removeEventListener("copy", ge),
                        P.removeEventListener("itemSelected", Be),
                        P.removeEventListener("selectKeyFrames", Ve)),
                        P = e;
                        for (var t = 0; t < V.length; t++)
                            V[t].isSelected = false;
                        V.length = 0,
                        N.length = 0,
                        P && (P.addEventListener("update", qe),
                        P.addEventListener("expand", Qe),
                        P.addEventListener("delete", be),
                        P.addEventListener("copy", ge),
                        P.addEventListener("itemSelected", Be),
                        P.addEventListener("selectKeyFrames", Ve)),
                        Ye()
                    }
                }
            },
            left: {
                get: function() {
                    return T
                },
                set: function(e) {
                    T = e
                }
            },
            top: {
                get: function() {
                    return C
                },
                set: function(e) {
                    C = e
                }
            },
            width: {
                get: function() {
                    return E
                },
                set: function(e) {
                    E != e && (x = (E = e) - f - p,
                    I = true)
                }
            },
            selectedKeyFrames: {
                get: function() {
                    return V
                }
            }
        });
        var it = []
          , rt = 0;
        function ot(e) {
            return Math.floor((e - rt) / 35)
        }
        function at(e) {
            if (H) {
                var t = je(W[0], W[1])
                  , n = z[0] < t[0]
                  , i = z[1] < t[1]
                  , r = (n ? z[0] : t[0]) / e
                  , o = i ? z[1] : t[1]
                  , a = (n ? t[0] : z[0]) / e
                  , s = i ? t[1] : z[1]
                  , l = Math.round(a - r)
                  , u = Math.round(r + f - P.displayStart / e) + .5
                  , c = void 0
                  , d = void 0;
                if (P.isEditingCurves) {
                    var h = X - G
                      , p = D - 40;
                    o = D - 20 - (o - G) / h * p,
                    s = D - 20 - (s - G) / h * p,
                    d = Math.round(s - o),
                    c = o
                } else
                    d = Math.round(s - o),
                    c = Math.round(o - Ge) + .5;
                v.fillStyle = "rgba(87,165,224,0.3)",
                v.strokeStyle = "rgba(87,165,224,1.0)",
                v.lineWidth = 1,
                v.fillRect(u, c, l, d),
                v.strokeRect(u, c, l, d)
            }
        }
        var st = false;
        function lt(e) {
            if (st != P.isWorkAreaActive && (et(n, "workAreaAlpha", P.isWorkAreaActive ? 1 : 0, .1, A),
            st = P.isWorkAreaActive),
            0 != n.workAreaAlpha) {
                var t = n.workAreaAlpha
                  , i = Math.round(f + (P.workAreaStart - P.displayStart) / e)
                  , r = Math.round(f + (P.workAreaEnd - P.displayStart) / e) - 2;
                v.save(),
                v.fillStyle = "rgba(0,0,0," + t + ")",
                v.fillRect(i, 0, 2, D),
                v.fillRect(r, 0, 2, D),
                v.fillStyle = "rgba(255,255,255," + .04 * t + ")",
                v.fillRect(i + 2, 0, r - i - 2, D),
                v.restore()
            }
        }
        n.workAreaAlpha = 0;
        var ut = {
            lut: {},
            keys: []
        }
          , ct = null;
        function dt(e) {
            v.beginPath(),
            v.arc(e.pos[0], e.pos[1], 3.5, 0, 2 * Math.PI, false),
            v.fill()
        }
        function ht(e, t, n) {
            v.save(),
            v.translate(t, n),
            e.type !== a.default.Type.Hold && v.rotate(j);
            var i = ct && e.isSelected && (ct.min === e._Time || ct.max === e._Time);
            i && (v.fillStyle = "rgba(255,185,0,1.0)",
            v.translate(-3, 3),
            v.fillRect(-3.5, -3.5, 7, 7),
            v.translate(6, -6),
            v.fillRect(-3.5, -3.5, 7, 7),
            v.translate(-3, 3)),
            ct && e.isSelected && (ct.min === e._Time || ct.max === e._Time) && (v.fillStyle = "rgba(255,185,0,1.0)"),
            v.fillRect(-3.5, -3.5, 7, 7),
            e.isSelected && (v.strokeRect(-3.5, -3.5, 7, 7),
            i && (v.strokeStyle = "rgba(0,0,0,1.0)",
            v.strokeRect(-4.5, -4.5, 9, 9))),
            v.restore()
        }
        this.forceDraw = Ye,
        this.setCanvas = function(e) {
            d && (d.removeEventListener("wheel", Xe),
            d.removeEventListener("mousedown", ve),
            d.removeEventListener("mousemove", Ke),
            d.removeEventListener("mouseleave", Q),
            document.removeEventListener("keydown", ce),
            document.removeEventListener("keyup", de),
            window.removeEventListener("focus", Je)),
            E = D = 0,
            (h = e) ? (v = h.getContext("2d"),
            (d = h.parentNode.parentNode.parentNode).addEventListener("wheel", Xe),
            d.addEventListener("mousedown", ve),
            d.addEventListener("mousemove", Ke),
            d.addEventListener("mouseleave", Q),
            document.addEventListener("keydown", ce),
            document.addEventListener("keyup", de),
            window.addEventListener("focus", Je),
            $e() && Ye()) : (d && (d.removeEventListener("mousedown", ve),
            d.removeEventListener("mousemove", Ke),
            d.removeEventListener("wheel", Xe),
            d.removeEventListener("mouseleave", Q)),
            d = null,
            window.removeEventListener("focus", Je)),
            Je()
        }
        ,
        this.setBackground = function(e) {
            g = e,
            I = true,
            h && $e() && Ye()
        }
        ,
        this.setPlayheadContainer = function(e) {
            _ = e,
            I = true,
            h && $e() && Ye()
        }
    }
    m.RowHoverBackground = "rgba(150,150,150,0.1)",
    m.RowSelectedBackground = "rgba(150,150,150,0.07)",
    m.RowHoverAndSelectedBackground = "rgba(150,150,150,0.1)"
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r, o = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), a = n(2), s = n(1), l = (r = s) && r.__esModule ? r : {
        default: r
    };
    function u(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var c = (u((i = function() {
        function e(t, n) {
            if (function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e),
            window.addEventListener("mouseup", this.onMouseUp, true),
            window.addEventListener("mousemove", this.onMouseMove, true),
            window.addEventListener("keydown", this.onKeyDown, true),
            window.addEventListener("keyup", this.onKeyUp, true),
            this._StartPoint = a.vec2.set(a.vec2.create(), t.clientX, t.clientY),
            this._Absolute = a.vec2.clone(this._StartPoint),
            this._Relative = a.vec2.create(),
            this._Origin = a.vec2.create(),
            this._LockedRelative = a.vec2.create(),
            this._LockedAbsolute = a.vec2.create(),
            n)
                if (n.constructor === Array) {
                    this._Origins = [];
                    for (var i = 0; i < n.length; i++) {
                        var r = n[i];
                        this._Origins.push(a.vec2.set(a.vec2.create(), r[0], r[1]))
                    }
                } else
                    this._Origin[0] = n[0],
                    this._Origin[1] = n[1];
            this._AllowLock = true,
            this.axisLock = t.shiftKey
        }
        return o(e, [{
            key: "onMouseUp",
            value: function(e) {
                window.removeEventListener("mouseup", this.onMouseUp, true),
                window.removeEventListener("mousemove", this.onMouseMove, true),
                window.removeEventListener("keydown", this.onKeyDown, true),
                window.removeEventListener("keyup", this.onKeyUp, true),
                this.onRelease && this.onRelease(e, this)
            }
        }, {
            key: "cancel",
            value: function() {
                window.removeEventListener("mouseup", this.onMouseUp, true),
                window.removeEventListener("mousemove", this.onMouseMove, true),
                window.removeEventListener("keydown", this.onKeyDown, true),
                window.removeEventListener("keyup", this.onKeyUp, true)
            }
        }, {
            key: "onKeyDown",
            value: function(e) {
                16 == e.keyCode && (this.axisLock = true)
            }
        }, {
            key: "onKeyUp",
            value: function(e) {
                16 == e.keyCode && (this.axisLock = false)
            }
        }, {
            key: "onMouseMove",
            value: function(e) {
                e.preventDefault(),
                e.stopPropagation(),
                this._Absolute = a.vec2.set(a.vec2.create(), e.clientX, e.clientY),
                this.updateDrag()
            }
        }, {
            key: "updateDrag",
            value: function() {
                a.vec2.subtract(this._Relative, this._Absolute, this._StartPoint),
                this._AxisLock && (Math.abs(this._Relative[0]) > Math.abs(this._Relative[1]) ? a.vec2.set(this._LockedRelative, this._Relative[0], 0) : a.vec2.set(this._LockedRelative, 0, this._Relative[1]),
                a.vec2.add(this._LockedAbsolute, this._StartPoint, this._LockedRelative)),
                this.onDrag && this.onDrag(this)
            }
        }, {
            key: "clampAllScale",
            value: function(e, t, n, i) {
                var r = this._AxisLock ? this._LockedRelative[i] : this._Relative[i]
                  , o = r * e
                  , a = true
                  , s = false
                  , l = void 0;
                try {
                    for (var u, c = this._Origins[Symbol.iterator](); !(a = (u = c.next()).done); a = true) {
                        var d = u.value[i]
                          , h = d + o
                          , f = Math.min(n, Math.max(t, h));
                        if (f !== h) {
                            var p = (f - d) / r;
                            p < e && (e = p)
                        }
                    }
                } catch (e) {
                    s = true,
                    l = e
                } finally {
                    try {
                        !a && c.return && c.return()
                    } finally {
                        if (s)
                            throw l
                    }
                }
                return e
            }
        }, {
            key: "getRelativeScaled",
            value: function(e, t) {
                return void 0 !== t ? a.vec2.add(a.vec2.create(), this._Origins[t], a.vec2.scale(a.vec2.create(), this._AxisLock ? this._LockedRelative : this._Relative, e)) : a.vec2.add(a.vec2.create(), this._Origin, a.vec2.scale(a.vec2.create(), this._AxisLock ? this._LockedRelative : this._Relative, e))
            }
        }, {
            key: "getUnlockedRelativeScaled",
            value: function(e, t) {
                return void 0 !== t ? a.vec2.add(a.vec2.create(), this._Origins[t], a.vec2.scale(a.vec2.create(), this._Relative, e)) : a.vec2.add(a.vec2.create(), this._Origin, a.vec2.scale(a.vec2.create(), this._Relative, e))
            }
        }, {
            key: "relative",
            get: function() {
                return a.vec2.add(a.vec2.create(), this._Origin, this._AxisLock ? this._LockedRelative : this._Relative)
            }
        }, {
            key: "absolute",
            get: function() {
                return this._AxisLock ? this._LockedAbsolute : this._Absolute
            }
        }, {
            key: "axisLock",
            set: function(e) {
                this._AllowLock || (e = false),
                this._AxisLock != e && (this._AxisLock = e,
                this.updateDrag())
            },
            get: function() {
                return this._AxisLock
            }
        }, {
            key: "allowLock",
            get: function() {
                return this._AllowLock
            },
            set: function(e) {
                this._AllowLock = e,
                e || (this.axisLock = false)
            }
        }, {
            key: "origin",
            get: function() {
                return this._Origin
            }
        }, {
            key: "origins",
            get: function() {
                return this._Origins
            }
        }]),
        e
    }()).prototype, "onMouseUp", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "onMouseUp"), i.prototype),
    u(i.prototype, "onKeyDown", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "onKeyDown"), i.prototype),
    u(i.prototype, "onKeyUp", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "onKeyUp"), i.prototype),
    u(i.prototype, "onMouseMove", [l.default], Object.getOwnPropertyDescriptor(i.prototype, "onMouseMove"), i.prototype),
    i);
    t.default = c
}
, function(e, t, n) {
    (t = e.exports = n(7)(false)).push([e.i, "\n", ""]),
    t.locals = {
        timelineMarginLeft: "10px",
        timelineMarginRight: "15px"
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = d(n(1175)), a = d(n(0)), s = d(n(1)), l = d(n(4)), u = d(n(603)), c = d(n(520));
    function d(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function h(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var f = parseInt(c.default.timelineMarginLeft)
      , p = parseFloat(c.default.timelineMarginRight)
      , y = (h((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                start: 0,
                end: 0,
                waStart: 0,
                waEnd: 0,
                rate: 60
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "getMouseTime",
            value: function(e) {
                var t = (this.state.end - this.state.start) / (this.props.width - f - p);
                return (e.clientX - this.props.left - f) * t + this.state.start
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setAnimation(null)
            }
        }, {
            key: "setAnimation",
            value: function(e) {
                this.animation && this.animation.removeEventListener("scrollChange", this.updateAnimation),
                this.animation = e,
                e && e.addEventListener("scrollChange", this.updateAnimation),
                this.updateAnimation()
            }
        }, {
            key: "updateAnimation",
            value: function() {
                if (this.animation) {
                    var e = this.animation;
                    this.setState({
                        start: e.displayStart,
                        end: e.displayEnd,
                        waStart: e.workAreaStart,
                        waEnd: e.workAreaEnd,
                        rate: e.fps
                    })
                }
            }
        }, {
            key: "updatePlayhead",
            value: function(e) {
                if (this.animation) {
                    var t = this.getMouseTime(e)
                      , n = Math.min(this.animation.duration, Math.max(0, t));
                    this.animation.position = Math.round(n * this.animation.fps) / this.animation.fps
                }
            }
        }, {
            key: "dragWaStart",
            value: function(e) {
                this.context.nima.isDragging = true,
                e.preventDefault(),
                this.animation && (this.animation.workAreaStart = this.getMouseTime(e))
            }
        }, {
            key: "dragWaEnd",
            value: function(e) {
                this.context.nima.isDragging = true,
                e.preventDefault(),
                this.animation && (this.animation.workAreaEnd = this.getMouseTime(e))
            }
        }, {
            key: "endWaDrag",
            value: function(e) {
                this.context.nima.isDragging = false,
                window.removeEventListener("mousemove", this.dragWaStart, true),
                window.removeEventListener("mousemove", this.dragWaEnd, true),
                window.removeEventListener("mouseup", this.endWaDrag, true)
            }
        }, {
            key: "componentDidMount",
            value: function() {
                this.setAnimation(this.props.animation)
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.animation && e.animation != this.animation && this.setAnimation(e.animation)
            }
        }, {
            key: "mouseDown",
            value: function(e) {
                if (this.props.width && this.props.workAreaActive) {
                    var t = (this.state.end - this.state.start) / (this.props.width - f - p)
                      , n = (this.state.waStart - this.state.start) / t + f
                      , i = (this.state.waEnd - this.state.start) / t + f
                      , r = e.clientX - this.props.left;
                    Math.abs(r - n) < 5 ? (window.addEventListener("mousemove", this.dragWaStart, true),
                    window.addEventListener("mouseup", this.endWaDrag, true)) : Math.abs(r - i) < 5 && (window.addEventListener("mousemove", this.dragWaEnd, true),
                    window.addEventListener("mouseup", this.endWaDrag, true))
                }
                window.addEventListener("mousemove", this.drag, true),
                window.addEventListener("mouseup", this.endDrag, true),
                this.updatePlayhead(e)
            }
        }, {
            key: "drag",
            value: function(e) {
                this.context.nima.isDragging = true,
                e.preventDefault(),
                e.stopPropagation(),
                this.context.nima.editingAnimation.isPlaying = false,
                this.updatePlayhead(e)
            }
        }, {
            key: "endDrag",
            value: function(e) {
                this.context.nima.isDragging = false,
                window.removeEventListener("mousemove", this.drag, true),
                window.removeEventListener("mouseup", this.endDrag, true)
            }
        }, {
            key: "shouldComponentUpdate",
            value: function(e, t) {
                return e.workAreaActive != this.props.workAreaActive || e.width != this.props.width || t.start != this.state.start || t.end != this.state.end || t.waStart != this.state.waStart || t.waEnd != this.state.waEnd || t.rate != this.state.rate || e.animation != this.props.animation
            }
        }, {
            key: "mouseLeave",
            value: function(e) {
                u.default.remove(this)
            }
        }, {
            key: "mouseMove",
            value: function(e) {
                if (e.preventDefault(),
                this.props.width && this.props.workAreaActive) {
                    var t = (this.state.end - this.state.start) / (this.props.width - 20)
                      , n = (this.state.waStart - this.state.start) / t + f
                      , i = (this.state.waEnd - this.state.start) / t + f
                      , r = e.clientX - this.props.left;
                    Math.abs(r - n) < 5 || Math.abs(r - i) < 5 ? u.default.set(this, "ew-resize") : u.default.remove(this)
                } else
                    u.default.remove(this)
            }
        }, {
            key: "mouseWheel",
            value: function(e) {
                console.log(e.wheelDeltaY)
            }
        }, {
            key: "render",
            value: function() {
                var e = []
                  , t = 0
                  , n = 0;
                if (this.props.width) {
                    var i = (this.state.end - this.state.start) / (this.props.width - f - p)
                      , r = 100 * i
                      , s = r
                      , l = i
                      , u = "s"
                      , c = this.state.start
                      , d = 60;
                    s < 1 && (s = r * this.state.rate,
                    l = i * this.state.rate,
                    c *= this.state.rate,
                    u = "f",
                    d = this.state.rate),
                    s < 1 ? s = 1 : s < 3 ? s = 2 : (s = 5 * Math.round(s / 5),
                    s = d / Math.round(d / s));
                    for (var h = s / l, y = Math.ceil(this.props.width / h + 1), m = c / s, v = Math.floor(m) * s, g = -m % 1 * h, _ = 0; _ < y; _++) {
                        var b = Math.floor(v % d);
                        0 == b && (b = Math.floor(v / d),
                        b = ((b %= 60) < 10 ? "0" + b : b) + ":00"),
                        e.push(a.default.createElement("div", {
                            className: "ApTimelineHeaderTickUnit",
                            key: "t" + _,
                            style: {
                                width: h + "px"
                            }
                        }, a.default.createElement("div", {
                            className: "ApTimelineHeaderTick"
                        }), a.default.createElement("div", {
                            className: "ApTimelineHeaderUnit"
                        }, b, u))),
                        v += s
                    }
                    t = (this.state.waStart - this.state.start) / i + f,
                    n = (this.state.waEnd - this.state.start) / i + f
                }
                return a.default.createElement("div", {
                    onWheel: this.mouseWheel,
                    className: "ApTimelineHeaderTicks",
                    onMouseDown: this.mouseDown,
                    style: {
                        paddingLeft: f + "px",
                        background: this.props.workAreaActive ? "rgba(0,0,0,0.12)" : "rgba(0,0,0,0)"
                    },
                    onMouseMove: this.mouseMove,
                    onMouseLeave: this.mouseLeave
                }, a.default.createElement("div", {
                    className: "WorkArea",
                    style: {
                        opacity: this.props.workAreaActive ? 1 : 0,
                        left: t + "px",
                        width: n - t + "px"
                    }
                }, a.default.createElement("div", {
                    className: "WorkAreaLeftHandle"
                }), a.default.createElement("div", {
                    className: "WorkAreaRightHandle"
                })), a.default.createElement(o.default, {
                    animation: this.animation,
                    width: this.props.width
                }), a.default.createElement("div", {
                    style: {
                        marginLeft: g + "px",
                        pointerEvents: "none"
                    }
                }, e), a.default.createElement("div", {
                    className: "HeaderTicksBottomBorder"
                }))
            }
        }]),
        t
    }(a.default.Component)).prototype, "updateAnimation", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "updateAnimation"), i.prototype),
    h(i.prototype, "updatePlayhead", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "updatePlayhead"), i.prototype),
    h(i.prototype, "dragWaStart", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "dragWaStart"), i.prototype),
    h(i.prototype, "dragWaEnd", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "dragWaEnd"), i.prototype),
    h(i.prototype, "endWaDrag", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "endWaDrag"), i.prototype),
    h(i.prototype, "mouseDown", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseDown"), i.prototype),
    h(i.prototype, "drag", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "drag"), i.prototype),
    h(i.prototype, "endDrag", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "endDrag"), i.prototype),
    h(i.prototype, "mouseLeave", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseLeave"), i.prototype),
    h(i.prototype, "mouseMove", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseMove"), i.prototype),
    h(i.prototype, "mouseWheel", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseWheel"), i.prototype),
    i);
    t.default = y,
    y.contextTypes = {
        nima: l.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = l(n(0)), a = l(n(1)), s = l(n(520));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function u(e, t) {
        if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function")
    }
    function c(e, t) {
        if (!e)
            throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    function d(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var h = parseInt(s.default.timelineMarginLeft)
      , f = parseFloat(s.default.timelineMarginRight)
      , p = (d((i = function(e) {
        function t() {
            return u(this, t),
            c(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "updatePosition",
            value: function() {
                if (this.animation) {
                    var e = (this.animation.displayEnd - this.animation.displayStart) / (this.props.width - h - f)
                      , t = (this.animation.position - this.animation.displayStart) / e + h;
                    this.playbarHead.style.transform = "scaleX(0.65) translate3D(" + t / .65 + "px, 0px, 0px)"
                }
            }
        }, {
            key: "setPlaybarHead",
            value: function(e) {
                this.playbarHead = e
            }
        }, {
            key: "componentDidUpdate",
            value: function() {
                this.updatePosition()
            }
        }, {
            key: "componentDidMount",
            value: function() {
                this.setAnimation(this.props.animation)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.setAnimation(null)
            }
        }, {
            key: "setAnimation",
            value: function(e) {
                this.animation && (this.animation.removeEventListener("position", this.updatePosition),
                this.animation.removeEventListener("scrollChange", this.updatePosition)),
                this.animation = e,
                e && (e.addEventListener("position", this.updatePosition),
                e.addEventListener("scrollChange", this.updatePosition))
            }
        }, {
            key: "shouldComponentUpdate",
            value: function(e, t) {
                return e.animation != this.props.animation || this.props.width != e.width
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.animation && e.animation != this.animation && this.setAnimation(e.animation)
            }
        }, {
            key: "render",
            value: function() {
                return o.default.createElement("div", {
                    className: "PlaybarHead",
                    ref: this.setPlaybarHead
                }, o.default.createElement("div", null))
            }
        }]),
        t
    }(o.default.Component)).prototype, "updatePosition", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "updatePosition"), i.prototype),
    d(i.prototype, "setPlaybarHead", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setPlaybarHead"), i.prototype),
    i);
    t.default = p
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = l(n(0)), a = l(n(1)), s = l(n(520));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function u(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var c = parseInt(s.default.timelineMarginLeft)
      , d = parseFloat(s.default.timelineMarginRight)
      , h = (u((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                position: 0
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "updatePosition",
            value: function() {
                if (this.playbar) {
                    var e = (this.animation.displayEnd - this.animation.displayStart) / (this.props.timelineWidth - c - d)
                      , t = this.animation.displayStart - c * e
                      , n = this.animation.displayEnd + d * e;
                    if (this.animation.position < t || this.animation.position > n)
                        this.playbar.style.opacity = 0;
                    else {
                        var i = c + (this.animation.position - this.animation.displayStart) / e;
                        this.playbar.style.transform = "translate3D(" + i + "px, 0px, 0px)",
                        this.playbar.style.opacity = 1
                    }
                }
            }
        }, {
            key: "setPlaybar",
            value: function(e) {
                this.playbar = e
            }
        }, {
            key: "componentDidUpdate",
            value: function() {
                this.updatePosition()
            }
        }, {
            key: "componentDidMount",
            value: function() {
                this.setAnimation(this.props.animation)
            }
        }, {
            key: "setAnimation",
            value: function(e) {
                this.animation && (this.animation.removeEventListener("position", this.updatePosition),
                this.animation.removeEventListener("scrollChange", this.updatePosition)),
                this.animation = e,
                e && (e.addEventListener("position", this.updatePosition),
                e.addEventListener("scrollChange", this.updatePosition)),
                this.updatePosition()
            }
        }, {
            key: "shouldComponentUpdate",
            value: function(e, t) {
                return e.animation != this.props.animation || this.props.timelineWidth != e.timelineWidth
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.animation && e.animation != this.animation && this.setAnimation(e.animation)
            }
        }, {
            key: "render",
            value: function() {
                return o.default.createElement("div", {
                    className: "Playbar",
                    ref: this.setPlaybar
                })
            }
        }]),
        t
    }(o.default.Component)).prototype, "updatePosition", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "updatePosition"), i.prototype),
    u(i.prototype, "setPlaybar", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setPlaybar"), i.prototype),
    i);
    t.default = h
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = s(n(0)), a = s(n(1));
    s(n(4));
    function s(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function l(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var u = (l((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.contentHeight = 0,
            n.state = {},
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "setContentHeight",
            value: function(e) {
                this.contentHeight !== e && (this.contentHeight = e,
                this.setState({
                    contentHeight: e
                }))
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                window.removeEventListener("mousemove", this.drag, true),
                window.removeEventListener("mouseup", this.stopDrag, true)
            }
        }, {
            key: "grab",
            value: function(e) {
                e.preventDefault(),
                e.stopPropagation();
                var t = this.grabber;
                if (t) {
                    var n = t.getBoundingClientRect();
                    this.grabOffset = e.clientY - n.top,
                    window.addEventListener("mousemove", this.drag, true),
                    window.addEventListener("mouseup", this.stopDrag, true)
                }
            }
        }, {
            key: "drag",
            value: function(e) {
                var t = this.grabber
                  , n = this.bar;
                if (t) {
                    var i = t.getBoundingClientRect()
                      , r = n.getBoundingClientRect()
                      , o = this.state.contentHeight;
                    o || (o = this.props.contentHeight);
                    var a = this.props.height
                      , s = i.height
                      , l = o - a
                      , u = r.top - e.clientY + this.grabOffset
                      , c = Math.max(0, Math.min(1, -u / (a - s)));
                    this.props.onScroll && this.props.onScroll(c * l)
                }
            }
        }, {
            key: "stopDrag",
            value: function(e) {
                window.removeEventListener("mousemove", this.drag, true),
                window.removeEventListener("mouseup", this.stopDrag, true)
            }
        }, {
            key: "setBar",
            value: function(e) {
                this.bar = e
            }
        }, {
            key: "setGrabber",
            value: function(e) {
                this.grabber = e
            }
        }, {
            key: "render",
            value: function() {
                var e = this.props
                  , t = e.height
                  , n = e.contentHeight
                  , i = e.scrollOffset
                  , r = this.state.contentHeight;
                r || (r = n);
                var a = t / r * t
                  , s = i / (r - t) * (t - a)
                  , l = a < t;
                return o.default.createElement("div", {
                    ref: this.setBar,
                    className: "Scrollbar",
                    style: {
                        height: t + "px"
                    }
                }, l ? o.default.createElement("div", {
                    ref: this.setGrabber,
                    className: "ScrollbarGrabber",
                    onMouseDown: this.grab,
                    style: {
                        height: a + "px",
                        top: s + "px"
                    }
                }, o.default.createElement("div", null)) : null)
            }
        }]),
        t
    }(o.default.Component)).prototype, "grab", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "grab"), i.prototype),
    l(i.prototype, "drag", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "drag"), i.prototype),
    l(i.prototype, "stopDrag", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "stopDrag"), i.prototype),
    l(i.prototype, "setBar", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setBar"), i.prototype),
    l(i.prototype, "setGrabber", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setGrabber"), i.prototype),
    i);
    t.default = u
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = R(n(0)), a = R(n(1)), s = R(n(4)), l = R(n(1179)), u = R(n(1180)), c = R(n(1181)), d = R(n(1183)), h = R(n(692)), f = R(n(1184)), p = R(n(261)), y = R(n(243)), m = R(n(201)), v = R(n(372)), g = R(n(381)), _ = R(n(371)), b = R(n(410)), w = R(n(612)), O = R(n(588)), S = R(n(447)), k = R(n(507)), P = R(n(586)), E = R(n(587)), T = R(n(590)), C = R(n(592)), x = R(n(591)), I = R(n(593)), D = R(n(473)), M = R(n(1185)), A = R(n(1186)), j = R(n(1187)), L = R(n(3));
    function R(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function F(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var B = [D.default, M.default, A.default, j.default]
      , V = [y.default, m.default, v.default, g.default]
      , N = (F((i = function(e) {
        function t(e) {
            return function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t),
            function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "componentWillMount",
            value: function() {
                var e = this.context.nima;
                e.addEventListener("fileLoaded", this.onFileLoaded);
                var t = e.stage
                  , n = this.boneLayerOptions = []
                  , i = true
                  , r = false
                  , a = void 0;
                try {
                    for (var s, l = V[Symbol.iterator](); !(i = (s = l.next()).done); i = true) {
                        var u = s.value;
                        n.push(t.getLayerOptions(u))
                    }
                } catch (e) {
                    r = true,
                    a = e
                } finally {
                    try {
                        !i && l.return && l.return()
                    } finally {
                        if (r)
                            throw a
                    }
                }
                var c = t.getLayerOptions(p.default)
                  , d = t.getLayerOptions(_.default);
                this.imageLayerOptions = c,
                this.colliderLayerOptions = d;
                var f = t.settings;
                this.setState({
                    canCopy: e.hasCopyAccess,
                    selectedTool: t.toolType,
                    selectedFilter: t.selectedFilter,
                    zoom: t.zoom,
                    imageSelectionState: 1,
                    imageVisibilityState: 1,
                    boneSelectionState: 1,
                    boneVisibilityState: 1,
                    gridAxisState: 1,
                    gridSubdivideState: 1,
                    selectionPopup: {
                        icon: L.default.make("/images/symbol-defs.svg#icon-cursor"),
                        showLegend: true,
                        options: [{
                            icon: L.default.make("/images/symbol-defs.svg#icon-picture"),
                            className: "ImageToggle",
                            activeState: function() {
                                return c.disableSelection ? 0 : 1
                            },
                            toggle: function() {
                                c.disableSelection = !c.disableSelection
                            }
                        }, {
                            icon: L.default.make("/images/symbol-defs.svg#icon-bone"),
                            className: "BoneToggle",
                            activeState: function() {
                                return n[0].disableSelection ? 0 : 1
                            },
                            toggle: function() {
                                var e = !n[0].disableSelection
                                  , t = true
                                  , i = false
                                  , r = void 0;
                                try {
                                    for (var o, a = n[Symbol.iterator](); !(t = (o = a.next()).done); t = true) {
                                        o.value.disableSelection = e
                                    }
                                } catch (e) {
                                    i = true,
                                    r = e
                                } finally {
                                    try {
                                        !t && a.return && a.return()
                                    } finally {
                                        if (i)
                                            throw r
                                    }
                                }
                            }
                        }]
                    },
                    visibilityPopup: {
                        icon: L.default.make("/images/symbol-defs.svg#icon-eye"),
                        showLegend: true,
                        options: [{
                            icon: L.default.make("/images/symbol-defs.svg#icon-picture"),
                            className: "ImageToggle",
                            activeState: function() {
                                return c.disableDraw ? 0 : c.mode == p.default.RenderModes.Regular ? 1 : 2
                            },
                            toggle: function() {
                                var e = c.disableDraw ? 0 : c.mode == p.default.RenderModes.Regular ? 1 : 2;
                                switch (e = (e + 1) % 3) {
                                case 0:
                                    c.disableDraw = true,
                                    c.mode = p.default.RenderModes.Regular;
                                    break;
                                case 1:
                                    c.disableDraw = false,
                                    c.mode = p.default.RenderModes.Regular;
                                    break;
                                case 2:
                                    c.disableDraw = false,
                                    c.mode = p.default.RenderModes.Dim
                                }
                            },
                            tip: {
                                label: "Show Images"
                            }
                        }, {
                            icon: L.default.make("/images/symbol-defs.svg#icon-bone"),
                            className: "BoneToggle",
                            activeState: function() {
                                return n[0].disableDraw ? 0 : 1
                            },
                            toggle: function() {
                                var e = !n[0].disableDraw
                                  , t = true
                                  , i = false
                                  , r = void 0;
                                try {
                                    for (var o, a = n[Symbol.iterator](); !(t = (o = a.next()).done); t = true) {
                                        o.value.disableDraw = e
                                    }
                                } catch (e) {
                                    i = true,
                                    r = e
                                } finally {
                                    try {
                                        !t && a.return && a.return()
                                    } finally {
                                        if (i)
                                            throw r
                                    }
                                }
                            },
                            tip: {
                                label: "Show Bones"
                            }
                        }, {
                            icon: L.default.make("/images/symbol-defs.svg#icon-collider"),
                            className: "BoneToggle",
                            activeState: function() {
                                return d.disableDraw ? 0 : 1
                            },
                            toggle: function() {
                                d.disableDraw = !d.disableDraw
                            },
                            tip: {
                                label: "Show Colliders"
                            }
                        }]
                    },
                    axisPopup: {
                        icon: L.default.make("/images/symbol-defs.svg#icon-axis"),
                        showLegend: false,
                        isRadio: true,
                        closeOnSelect: true,
                        get extraIcon() {
                            switch (t.transformSpace) {
                            case 0:
                                return o.default.createElement("div", {
                                    className: "AxisSpace"
                                }, "L");
                            case 1:
                                return o.default.createElement("div", {
                                    className: "AxisSpace"
                                }, "P");
                            case 2:
                                return o.default.createElement("div", {
                                    className: "AxisSpace"
                                }, "W")
                            }
                            return null
                        },
                        options: [{
                            icon: null,
                            useTxtLabel: true,
                            txtLabel: "Local",
                            get className() {
                                return 0 === t.transformSpace ? "TextToggleActive" : "TextToggle"
                            },
                            activeState: function() {
                                return 0 === t.transformSpace ? 1 : 0
                            },
                            toggle: function() {
                                t.transformSpace = 0
                            }
                        }, {
                            icon: null,
                            useTxtLabel: true,
                            txtLabel: "Parent",
                            get className() {
                                return 1 === t.transformSpace ? "TextToggleActive" : "TextToggle"
                            },
                            activeState: function() {
                                return 1 === t.transformSpace ? 1 : 0
                            },
                            toggle: function() {
                                t.transformSpace = 1
                            }
                        }, {
                            icon: null,
                            useTxtLabel: true,
                            txtLabel: "World",
                            get className() {
                                return 2 === t.transformSpace ? "TextToggleActive" : "TextToggle"
                            },
                            activeState: function() {
                                return 2 === t.transformSpace ? 1 : 0
                            },
                            toggle: function() {
                                t.transformSpace = 2
                            }
                        }]
                    },
                    gridPopup: {
                        icon: function() {
                            return f.showGridAxis || f.showGridSubdivisions ? f.showGridAxis ? f.showGridSubdivisions ? L.default.make("/images/symbol-defs.svg#icon-grid-sub-axis") : L.default.make("/images/symbol-defs.svg#icon-grid-axis") : L.default.make("/images/symbol-defs.svg#icon-grid-sub") : L.default.make("/images/symbol-defs.svg#icon-grid-none")
                        },
                        showLegend: false,
                        options: [{
                            icon: L.default.make("/images/symbol-defs.svg#icon-grid-axis"),
                            className: "GridAxisToggle",
                            activeState: function() {
                                return f.showGridAxis ? 1 : 0
                            },
                            toggle: function() {
                                f.showGridAxis = !f.showGridAxis
                            },
                            tip: {
                                label: "Show Grid Axis"
                            }
                        }, {
                            icon: L.default.make("/images/symbol-defs.svg#icon-grid-sub"),
                            className: "GridSubToggle",
                            activeState: function() {
                                return f.showGridSubdivisions ? 1 : 0
                            },
                            toggle: function() {
                                f.showGridSubdivisions = !f.showGridSubdivisions
                            },
                            tip: {
                                label: "Show Grid"
                            }
                        }, {
                            icon: L.default.make("/images/symbol-defs.svg#icon-rulers"),
                            className: "GridSubToggle",
                            activeState: function() {
                                return e.getPreference("showGuides") ? 1 : 0
                            },
                            toggle: function() {
                                e.setProjectPreference("showGuides", !e.getPreference("showGuides"))
                            },
                            tip: {
                                label: "Rulers",
                                actions: [{
                                    label: "Show/Hide",
                                    action: h.default.Actions.ToggleRulers
                                }, {
                                    label: "Reset",
                                    action: h.default.Actions.ResetRulers
                                }]
                            }
                        }]
                    }
                })
            }
        }, {
            key: "onFileLoaded",
            value: function() {
                this.setState({
                    canCopy: this.context.nima.hasCopyAccess
                })
            }
        }, {
            key: "componentDidMount",
            value: function() {
                this.updateToggles();
                var e = this.context.nima;
                e.stage.addEventListener("toolChanged", this.onToolChanged),
                e.stage.addEventListener("selectionFilterChanged", this.onFilterChanged),
                e.stage.addEventListener("zoomChanged", this.onZoomChanged),
                e.stage.addEventListener("updateLayerOptions", this.onLayerOptionsChanged)
            }
        }, {
            key: "setAnimationMode",
            value: function(e) {
                var t = !!e;
                this.createGroup && (this.createGroup.flyout.style.display = t ? "none" : "")
            }
        }, {
            key: "setCreateGroup",
            value: function(e) {
                this.createGroup = e
            }
        }, {
            key: "onLayerOptionsChanged",
            value: function() {
                this.updateToggles()
            }
        }, {
            key: "updateToggles",
            value: function() {
                var e = {};
                this.imageLayerOptions.disableDraw ? e.imageVisibilityState = 0 : this.imageLayerOptions.mode == p.default.RenderModes.Regular ? e.imageVisibilityState = 1 : this.imageLayerOptions.mode == p.default.RenderModes.Dim && (e.imageVisibilityState = 2),
                this.imageLayerOptions.disableSelection ? e.imageSelectionState = 0 : e.imageSelectionState = 1;
                var t = this.boneLayerOptions[0];
                e.boneSelectionState = t.disableSelection ? 0 : 1,
                e.boneVisibilityState = t.disableDraw ? 0 : 1;
                var n = this.context.nima.stage;
                n.settings.showGridAxis ? e.gridAxisState = 1 : e.gridAxisState = 0,
                n.settings.showGridSubdivisions ? e.gridSubdivideState = 1 : e.gridSubdivideState = 0,
                this.setState(e),
                this.context.nima.stage.redraw()
            }
        }, {
            key: "onToolChanged",
            value: function(e) {
                this.setState({
                    selectedTool: this.context.nima.stage.toolType
                })
            }
        }, {
            key: "onFilterChanged",
            value: function(e) {
                this.setState({
                    selectedFilter: e
                })
            }
        }, {
            key: "onZoomChanged",
            value: function(e) {
                this.setState({
                    zoom: e
                })
            }
        }, {
            key: "toolSelected",
            value: function(e) {
                this.context.nima.stage.toolType = e
            }
        }, {
            key: "filterSelected",
            value: function(e) {
                this.context.nima.stage.selectionFilter = new e
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                var e = this.context.nima;
                e.removeEventListener("fileLoaded", this.onFileLoaded),
                e.stage.removeEventListener("toolChanged", this.toolChanged),
                e.stage.removeEventListener("zoomChanged", this.onZoomChanged),
                e.stage.removeEventListener("selectionFilterChanged", this.onFilterChanged),
                e.stage.removeEventListener("updateLayerOptions", this.onLayerOptionsChanged)
            }
        }, {
            key: "zoomInputChanged",
            value: function(e) {
                this.context.nima.stage.zoom = e
            }
        }, {
            key: "selectionOptionsChanged",
            value: function(e, t) {
                e %= 2,
                t %= 2,
                this.imageLayerOptions.disableSelection = 0 == e;
                var n = true
                  , i = false
                  , r = void 0;
                try {
                    for (var o, a = this.boneLayerOptions[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                        o.value.disableSelection = 0 == t
                    }
                } catch (e) {
                    i = true,
                    r = e
                } finally {
                    try {
                        !n && a.return && a.return()
                    } finally {
                        if (i)
                            throw r
                    }
                }
                this.updateToggles()
            }
        }, {
            key: "visibilityOptionsChanged",
            value: function(e, t) {
                switch (t %= 2,
                e %= 3) {
                case 0:
                    this.imageLayerOptions.disableDraw = true,
                    this.imageLayerOptions.mode = p.default.RenderModes.Regular;
                    break;
                case 1:
                    this.imageLayerOptions.disableDraw = false,
                    this.imageLayerOptions.mode = p.default.RenderModes.Regular;
                    break;
                case 2:
                    this.imageLayerOptions.disableDraw = false,
                    this.imageLayerOptions.mode = p.default.RenderModes.Dim
                }
                var n = true
                  , i = false
                  , r = void 0;
                try {
                    for (var o, a = this.boneLayerOptions[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                        o.value.disableDraw = 0 === t
                    }
                } catch (e) {
                    i = true,
                    r = e
                } finally {
                    try {
                        !n && a.return && a.return()
                    } finally {
                        if (i)
                            throw r
                    }
                }
                this.updateToggles()
            }
        }, {
            key: "gridOptionsChanged",
            value: function(e, t) {
                e %= 2,
                t %= 2;
                var n = this.context.nima.stage;
                n.settings.showGridAxis = 1 == e,
                n.settings.showGridSubdivisions = 1 == t,
                this.updateToggles()
            }
        }, {
            key: "setMeshMode",
            value: function(e) {
                if (this.setState({
                    meshMode: e
                }),
                clearTimeout(this.myTimeout),
                e)
                    this.setState({
                        meshVisibility: true
                    });
                else {
                    var t = this;
                    this.myTimeout = setTimeout((function() {
                        t.setState({
                            meshVisibility: false
                        })
                    }
                    ), 400)
                }
            }
        }, {
            key: "setWeightsMode",
            value: function(e) {
                if (this.setState({
                    weightsMode: e
                }),
                clearTimeout(this.myTimeout),
                e)
                    this.setState({
                        weightVisibility: true
                    }),
                    this.meshVisibilityRef && this.meshVisibilityRef.setToggleValue(this.context.nima.editingWeights.isMeshVisible);
                else {
                    var t = this;
                    this.myTimeout = setTimeout((function() {
                        t.setState({
                            weightVisibility: false
                        })
                    }
                    ), 400)
                }
            }
        }, {
            key: "toggleMeshVisibility",
            value: function(e) {
                var t = this.context.nima.editingWeights;
                t && (t.isMeshVisible = e)
            }
        }, {
            key: "translatePanelOut",
            value: function(e, t) {
                if (e) {
                    var n = this;
                    this.translateTimeout = setTimeout((function() {
                        n.toolbar.style.display = "none"
                    }
                    ), 400)
                } else
                    this.toolbar.style.display = null,
                    clearTimeout(this.translateTimeout);
                var i = this.toolbar.getBoundingClientRect();
                this.toolbar.style.transform = e ? "translate3D(" + (i.width + (t ? 200 : 0)) + "px, 0, 0)" : "translate3D(0px, 0, 0)"
            }
        }, {
            key: "setToolbar",
            value: function(e) {
                this.toolbar = e
            }
        }, {
            key: "setMeshVisibilityRef",
            value: function(e) {
                this.meshVisibilityRef = e
            }
        }, {
            key: "incSelectionFilter",
            value: function(e) {
                var t = this.context.nima.stage.selectionFilter && B.indexOf(this.context.nima.stage.selectionFilter.constructor) || 0;
                -1 === t ? t = 0 : (t = (t + e) % B.length) < 0 && (t += B.length);
                var n = B[t];
                this.context.nima.stage.selectionFilter = new n
            }
        }, {
            key: "render",
            value: function() {
                return o.default.createElement("div", {
                    id: "Toolbar",
                    ref: this.setToolbar,
                    style: {
                        right: this.props.settingsOpen ? "200px" : "0px"
                    }
                }, o.default.createElement("div", {
                    className: "WeightsToolbar",
                    style: {
                        opacity: this.state.weightsMode ? "1" : "0",
                        visibility: this.state.weightVisibility ? "visible" : "hidden"
                    }
                }, o.default.createElement("div", {
                    className: "ToolGroup"
                }, o.default.createElement(u.default, {
                    type: b.default,
                    cssID: "PaintWeightTool",
                    icon: L.default.make("/images/symbol-defs.svg#icon-brush"),
                    onSelected: this.toolSelected,
                    isSelected: this.state.selectedTool == b.default,
                    tip: {
                        label: "Paint Weights",
                        action: null
                    }
                }), o.default.createElement(u.default, {
                    type: w.default,
                    cssID: "VertexWeightTool",
                    icon: L.default.make("/images/symbol-defs.svg#icon-select-vertices"),
                    onSelected: this.toolSelected,
                    isSelected: this.state.selectedTool == w.default,
                    tip: {
                        label: "Set Vertex Weight",
                        action: null
                    }
                })), o.default.createElement("div", {
                    className: "ToolGroup"
                }, o.default.createElement(f.default, {
                    name: "MeshVisibility",
                    ref: this.setMeshVisibilityRef,
                    onToggle: this.toggleMeshVisibility
                })), o.default.createElement(c.default, {
                    cssID: "VisibilityOptions",
                    data: this.state.visibilityPopup,
                    onChange: this.visibilityOptionsChanged,
                    tip: {
                        label: "Visibility Options"
                    }
                }), o.default.createElement("div", {
                    className: "ToolGroup"
                }, o.default.createElement(d.default, {
                    value: this.state.zoom,
                    valueChanged: this.zoomInputChanged,
                    tip: {
                        label: "Zoom",
                        actions: [{
                            label: "In",
                            action: h.default.Actions.ZoomIn
                        }, {
                            label: "Out",
                            action: h.default.Actions.ZoomOut
                        }, {
                            label: "Actual Size",
                            action: h.default.Actions.Zoom100
                        }, {
                            label: "Fit",
                            action: h.default.Actions.ZoomFit
                        }]
                    }
                }))), o.default.createElement("div", {
                    className: "MeshToolbar",
                    style: {
                        opacity: this.state.meshMode ? "1" : "0",
                        visibility: this.state.meshVisibility ? "visible" : "hidden"
                    }
                }, o.default.createElement("div", {
                    className: "ToolGroup"
                }, o.default.createElement(u.default, {
                    type: k.default,
                    cssID: "DrawMeshTool",
                    icon: L.default.make("/images/symbol-defs.svg#icon-pen"),
                    onSelected: this.toolSelected,
                    isSelected: this.state.selectedTool == k.default,
                    tip: {
                        label: "Draw Mesh",
                        action: null
                    }
                })), o.default.createElement("div", {
                    className: "ToolGroup"
                }, o.default.createElement(d.default, {
                    value: this.state.zoom,
                    valueChanged: this.zoomInputChanged,
                    tip: {
                        label: "Zoom",
                        actions: [{
                            label: "In",
                            action: h.default.Actions.ZoomIn
                        }, {
                            label: "Out",
                            action: h.default.Actions.ZoomOut
                        }, {
                            label: "Actual Size",
                            action: h.default.Actions.Zoom100
                        }, {
                            label: "Fit",
                            action: h.default.Actions.ZoomFit
                        }]
                    }
                }))), o.default.createElement("div", {
                    className: "DefaultToolbar",
                    style: {
                        transform: this.state.meshMode || this.state.weightsMode ? "translate3D(100%, 0, 0)" : null
                    }
                }, o.default.createElement("div", {
                    className: "ToolGroup"
                }, o.default.createElement(u.default, {
                    type: S.default,
                    cssID: "TranslateTool",
                    icon: L.default.make("/images/symbol-defs.svg#icon-move"),
                    onSelected: this.toolSelected,
                    isSelected: this.state.selectedTool == S.default,
                    tip: {
                        label: "Translate",
                        action: h.default.Actions.TranslateTool
                    }
                }), o.default.createElement(u.default, {
                    type: P.default,
                    cssID: "RotateTool",
                    icon: L.default.make("/images/symbol-defs.svg#icon-rotate"),
                    onSelected: this.toolSelected,
                    isSelected: this.state.selectedTool == P.default,
                    tip: {
                        label: "Rotate",
                        action: h.default.Actions.RotateTool
                    }
                }), o.default.createElement(u.default, {
                    type: E.default,
                    cssID: "ScaleTool",
                    icon: L.default.make("/images/symbol-defs.svg#icon-scale"),
                    onSelected: this.toolSelected,
                    isSelected: this.state.selectedTool == E.default,
                    tip: {
                        label: "Scale",
                        action: h.default.Actions.ScaleTool
                    }
                }), o.default.createElement(u.default, {
                    type: O.default,
                    cssID: "IKTool",
                    icon: L.default.make("/images/symbol-defs.svg#icon-arrow-divert"),
                    onSelected: this.toolSelected,
                    isSelected: this.state.selectedTool == O.default,
                    tip: {
                        label: "IK Pose",
                        action: h.default.Actions.IKTool
                    }
                })), o.default.createElement(l.default, {
                    isStageTool: true,
                    ref: this.setCreateGroup,
                    addClass: "CreateTools",
                    iconHref: L.default.make("/images/symbol-defs.svg#icon-plus"),
                    selectedType: this.context.nima.stage.toolType,
                    tip: {
                        label: "Create Tools"
                    }
                }, o.default.createElement(u.default, {
                    type: T.default,
                    cssID: "CreateBoneTool",
                    icon: L.default.make("/images/symbol-defs.svg#icon-bone-add"),
                    onSelected: this.toolSelected,
                    isSelected: this.state.selectedTool == T.default,
                    tip: {
                        label: "Create Bone",
                        action: h.default.Actions.BoneTool
                    }
                }), o.default.createElement(u.default, {
                    type: x.default,
                    cssID: "CreateNodeTool",
                    icon: L.default.make("/images/symbol-defs.svg#icon-node-add"),
                    onSelected: this.toolSelected,
                    isSelected: this.state.selectedTool == x.default,
                    tip: {
                        label: "Create Node",
                        action: h.default.Actions.NodeTool
                    }
                }), o.default.createElement(u.default, {
                    type: I.default,
                    cssID: "CreateColliderTool",
                    icon: L.default.make("/images/symbol-defs.svg#icon-collider-add"),
                    onSelected: this.toolSelected,
                    isSelected: this.state.selectedTool == I.default,
                    tip: {
                        label: "Create Collider",
                        action: h.default.Actions.ColliderTool
                    }
                }), o.default.createElement(u.default, {
                    type: C.default,
                    icon: L.default.make("/images/symbol-defs.svg#icon-solo-add"),
                    onSelected: this.toolSelected,
                    isSelected: this.state.selectedTool == C.default,
                    tip: {
                        label: "Create Solo Node",
                        action: h.default.Actions.SoloTool
                    }
                })), o.default.createElement(l.default, {
                    addClass: "SelectionFilters",
                    showActive: true,
                    iconHref: L.default.make("/images/symbol-defs.svg#icon-select-all"),
                    selectedType: this.state.selectedFilter && this.state.selectedFilter.constructor,
                    tip: {
                        label: "Selection Modes",
                        actions: [{
                            label: "Next",
                            action: h.default.Actions.NextSelectionFilter
                        }, {
                            label: "Prev",
                            action: h.default.Actions.PreviousSelectionFilter
                        }]
                    }
                }, o.default.createElement(u.default, {
                    type: D.default,
                    cssID: "SelectionFilter",
                    icon: L.default.make("/images/symbol-defs.svg#icon-select-all"),
                    onSelected: this.filterSelected,
                    isSelected: this.state.selectedFilter && this.state.selectedFilter.constructor == D.default,
                    tip: {
                        label: "Select Anything",
                        action: h.default.Actions.AllSelectionFilter
                    }
                }), o.default.createElement(u.default, {
                    type: M.default,
                    cssID: "BoneSelectionFilter",
                    icon: L.default.make("/images/symbol-defs.svg#icon-select-bones"),
                    onSelected: this.filterSelected,
                    isSelected: this.state.selectedFilter && this.state.selectedFilter.constructor == M.default,
                    tip: {
                        label: "Select Bones",
                        action: h.default.Actions.BoneSelectionFilter
                    }
                }), o.default.createElement(u.default, {
                    type: A.default,
                    cssID: "ImageSelectionFilter",
                    icon: L.default.make("/images/symbol-defs.svg#icon-select-images"),
                    onSelected: this.filterSelected,
                    isSelected: this.state.selectedFilter && this.state.selectedFilter.constructor == A.default,
                    tip: {
                        label: "Select Images",
                        action: h.default.Actions.ImageSelectionFilter
                    }
                }), o.default.createElement(u.default, {
                    type: j.default,
                    cssID: "VertexSelectionFilter",
                    icon: L.default.make("/images/symbol-defs.svg#icon-select-vertices"),
                    onSelected: this.filterSelected,
                    isSelected: this.state.selectedFilter && this.state.selectedFilter.constructor == j.default,
                    tip: {
                        label: "Select Vertices",
                        action: h.default.Actions.VertexSelectionFilter
                    }
                })), o.default.createElement(c.default, {
                    cssID: "VisibilityOptions",
                    data: this.state.visibilityPopup,
                    onChange: this.visibilityOptionsChanged,
                    tip: {
                        label: "Visibility Options"
                    }
                }), o.default.createElement(c.default, {
                    cssID: "AxisOptions",
                    data: this.state.axisPopup,
                    onChange: this.visibilityOptionsChanged,
                    tip: {
                        label: "Axis Options"
                    }
                }), o.default.createElement(c.default, {
                    cssID: "GridOptions",
                    data: this.state.gridPopup,
                    tip: {
                        label: "Grid Options"
                    },
                    onChange: this.gridOptionsChanged
                }), o.default.createElement("div", {
                    className: "ToolGroup"
                }, o.default.createElement(d.default, {
                    value: this.state.zoom,
                    valueChanged: this.zoomInputChanged,
                    tip: {
                        label: "Zoom",
                        actions: [{
                            label: "In",
                            action: h.default.Actions.ZoomIn
                        }, {
                            label: "Out",
                            action: h.default.Actions.ZoomOut
                        }, {
                            label: "Actual Size",
                            action: h.default.Actions.Zoom100
                        }, {
                            label: "Fit",
                            action: h.default.Actions.ZoomFit
                        }]
                    }
                })), o.default.createElement("div", {
                    className: "ToolGroup"
                }, this.state.canCopy ? o.default.createElement(u.default, {
                    cssID: "ExportButton",
                    icon: L.default.make("/images/symbol-defs.svg#icon-export"),
                    onSelected: this.props.onGotoExport,
                    tip: {
                        label: "Export"
                    }
                }) : null, o.default.createElement(u.default, {
                    cssID: "SettingsButton",
                    isActive: this.props.settingsOpen,
                    onSelected: this.props.onSettingsToggled,
                    icon: this.props.settingsOpen ? L.default.make("/images/symbol-defs.svg#icon-cog-selected") : L.default.make("/images/symbol-defs.svg#icon-cog"),
                    tip: {
                        label: "Settings"
                    }
                }))))
            }
        }]),
        t
    }(o.default.Component)).prototype, "onFileLoaded", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onFileLoaded"), i.prototype),
    F(i.prototype, "setCreateGroup", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setCreateGroup"), i.prototype),
    F(i.prototype, "onLayerOptionsChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onLayerOptionsChanged"), i.prototype),
    F(i.prototype, "updateToggles", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "updateToggles"), i.prototype),
    F(i.prototype, "onToolChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onToolChanged"), i.prototype),
    F(i.prototype, "onFilterChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onFilterChanged"), i.prototype),
    F(i.prototype, "onZoomChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onZoomChanged"), i.prototype),
    F(i.prototype, "toolSelected", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toolSelected"), i.prototype),
    F(i.prototype, "filterSelected", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "filterSelected"), i.prototype),
    F(i.prototype, "zoomInputChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "zoomInputChanged"), i.prototype),
    F(i.prototype, "selectionOptionsChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "selectionOptionsChanged"), i.prototype),
    F(i.prototype, "visibilityOptionsChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "visibilityOptionsChanged"), i.prototype),
    F(i.prototype, "gridOptionsChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "gridOptionsChanged"), i.prototype),
    F(i.prototype, "toggleMeshVisibility", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleMeshVisibility"), i.prototype),
    F(i.prototype, "setToolbar", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setToolbar"), i.prototype),
    F(i.prototype, "setMeshVisibilityRef", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setMeshVisibilityRef"), i.prototype),
    i);
    t.default = N,
    N.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = l(n(0)), a = l(n(1)), s = l(n(4));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function u(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var c = (u((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                hover: false,
                isOpen: false,
                popupOpacity: 0,
                isActive: false
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "mouseOver",
            value: function() {
                this.state.isOpen || this.context.tooltip.enter(this),
                this.setState({
                    hover: true
                })
            }
        }, {
            key: "mouseOut",
            value: function() {
                this.context.tooltip.leave(this),
                this.setState({
                    hover: false
                })
            }
        }, {
            key: "mouseDown",
            value: function(e) {
                this.context.tooltip.click(this),
                this.open()
            }
        }, {
            key: "open",
            value: function() {
                window.addEventListener("mousedown", this.close, true),
                clearTimeout(this.timeout),
                this.setState({
                    popupOpacity: 1,
                    isOpen: true
                })
            }
        }, {
            key: "close",
            value: function() {
                var e;
                window.removeEventListener("mousedown", this.close, true),
                this.setState({
                    isOpen: false
                }),
                this.timeout = setTimeout((e = this,
                function() {
                    e.setState({
                        popupOpacity: 0
                    })
                }
                ), 125)
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.selectedType != this.props.selectedType && this.checkActive(e.selectedType)
            }
        }, {
            key: "checkActive",
            value: function(e) {
                var t = this.props.children;
                if (t) {
                    this.childToolActive = false,
                    this.activeIcon = null;
                    for (var n = 0; n < t.length; n++) {
                        var i = t[n];
                        if (i && i.props.type == e) {
                            this.childToolActive = true,
                            this.activeIcon = i.props.icon;
                            break
                        }
                    }
                    this.childToolActive ? this.setState({
                        isActive: true
                    }) : this.setState({
                        isActive: false
                    })
                }
            }
        }, {
            key: "componentDidUpdate",
            value: function() {
                this.togglesSizeCalc && (this.togglesWidth = this.togglesSizeCalc.getBoundingClientRect().width)
            }
        }, {
            key: "setTogglesSizeCalc",
            value: function(e) {
                this.togglesSizeCalc = e
            }
        }, {
            key: "setFlyout",
            value: function(e) {
                this.flyout = e
            }
        }, {
            key: "render",
            value: function() {
                var e = this.props.isStageTool && this.state.isActive;
                return o.default.createElement("div", {
                    ref: this.setFlyout,
                    className: this.props.addClass ? "Flyout " + this.props.addClass : "Flyout",
                    onMouseDown: this.mouseDown,
                    onMouseEnter: this.mouseOver,
                    onMouseLeave: this.mouseOut,
                    id: this.props.type
                }, o.default.createElement("div", {
                    className: this.state.isOpen ? "ToolSelectedPopup ToolSelectedPopupOpen" : "ToolSelectedPopup",
                    style: {
                        opacity: this.state.popupOpacity,
                        width: this.state.isOpen ? this.togglesWidth + 60 + "px" : null,
                        left: this.state.isOpen ? -this.togglesWidth + "px" : null
                    }
                }, o.default.createElement("div", {
                    className: "ToggleWrapper",
                    style: {
                        width: this.state.isOpen ? this.togglesWidth + "px" : ""
                    }
                }, o.default.createElement("div", {
                    ref: this.setTogglesSizeCalc,
                    className: "TogglesSizeCalc"
                }, this.props.children))), o.default.createElement("div", {
                    className: this.state.isOpen ? "ToolPopupArrow ToolPopupArrowOpen" : "ToolPopupArrow"
                }), o.default.createElement("div", {
                    className: "FlyoutIcon"
                }, o.default.createElement("svg", {
                    className: "ToolIcon",
                    style: {
                        fill: e && !this.state.isOpen ? "#fff" : this.state.hover || this.state.isOpen ? "#333" : null
                    }
                }, o.default.createElement("use", {
                    xlinkHref: this.props.showActive ? this.activeIcon || this.props.iconHref : this.state.isActive && !this.state.isOpen ? this.activeIcon : this.props.iconHref
                })), o.default.createElement("div", {
                    className: "ToolSelected",
                    style: {
                        opacity: e && !this.state.isOpen ? 1 : 0
                    }
                })))
            }
        }]),
        t
    }(o.default.Component)).prototype, "mouseOver", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseOver"), i.prototype),
    u(i.prototype, "mouseOut", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseOut"), i.prototype),
    u(i.prototype, "mouseDown", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseDown"), i.prototype),
    u(i.prototype, "open", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "open"), i.prototype),
    u(i.prototype, "close", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "close"), i.prototype),
    u(i.prototype, "setTogglesSizeCalc", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setTogglesSizeCalc"), i.prototype),
    u(i.prototype, "setFlyout", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setFlyout"), i.prototype),
    i);
    t.default = c,
    c.contextTypes = {
        nima: s.default.object,
        tooltip: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = l(n(0)), a = l(n(1)), s = l(n(4));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function u(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var c = (u((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                hover: false
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "mouseOver",
            value: function() {
                this.context.tooltip.enter(this),
                this.setState({
                    hover: true
                })
            }
        }, {
            key: "mouseOut",
            value: function() {
                this.context.tooltip.leave(this),
                this.setState({
                    hover: false
                })
            }
        }, {
            key: "click",
            value: function(e) {
                e.stopPropagation(),
                this.context.tooltip.click(this),
                this.props.onSelected && this.props.onSelected(this.props.type, e)
            }
        }, {
            key: "render",
            value: function() {
                var e;
                this.props.icon && (e = this.props.icon);
                var t = void 0 !== this.props.isSelected;
                return o.default.createElement("div", {
                    className: "ToolButton",
                    onClick: this.click,
                    onMouseEnter: this.mouseOver,
                    onMouseLeave: this.mouseOut,
                    id: this.props.cssID
                }, t ? o.default.createElement("div", {
                    className: "ToolSelected",
                    style: {
                        opacity: this.props.isSelected ? 1 : 0
                    }
                }) : null, o.default.createElement("svg", {
                    className: this.props.isSelected ? "ToolIcon ToolIconActive" : "ToolIcon",
                    style: {
                        fill: this.props.isActive ? "#000" : null
                    }
                }, o.default.createElement("use", {
                    xlinkHref: e
                })))
            }
        }]),
        t
    }(o.default.Component)).prototype, "mouseOver", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseOver"), i.prototype),
    u(i.prototype, "mouseOut", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseOut"), i.prototype),
    u(i.prototype, "click", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "click"), i.prototype),
    i);
    t.default = c,
    c.contextTypes = {
        tooltip: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = c(n(0)), a = c(n(1)), s = c(n(4)), l = c(n(1182)), u = c(n(3));
    function c(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function d(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var h = (d((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                hover: false,
                isOpen: false,
                popupOpacity: 0
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "mouseOver",
            value: function() {
                this.state.isOpen || this.context.tooltip.enter(this),
                this.setState({
                    hover: true
                })
            }
        }, {
            key: "mouseOut",
            value: function() {
                this.context.tooltip.leave(this),
                this.setState({
                    hover: false
                })
            }
        }, {
            key: "mouseDown",
            value: function(e) {
                this.context.tooltip.click(this),
                this.open()
            }
        }, {
            key: "open",
            value: function() {
                window.addEventListener("mousedown", this.close, true),
                clearTimeout(this.timeout),
                this.setState({
                    popupOpacity: 1,
                    isOpen: true
                })
            }
        }, {
            key: "close",
            value: function() {
                var e;
                window.removeEventListener("mousedown", this.close, true),
                this.setState({
                    isOpen: false
                }),
                this.timeout = setTimeout((e = this,
                function() {
                    e.setState({
                        popupOpacity: 0
                    })
                }
                ), 125)
            }
        }, {
            key: "setTogglesSizeCalc",
            value: function(e) {
                this.togglesSizeCalc = e
            }
        }, {
            key: "componentDidUpdate",
            value: function() {
                this.togglesWidth = this.togglesSizeCalc.getBoundingClientRect().width
            }
        }, {
            key: "render",
            value: function() {
                var e, t = ["OptionHighlightNone", "OptionHighlightAll", "OptionHighlightSome"], n = ["OptionStatusOff", "OptionStatus", "OptionStatusHalf"], i = this.props.data, r = [], a = this, s = [0, 0, 0], c = false;
                if (i) {
                    e = i.icon && i.icon.constructor === Function ? i.icon() : i.icon,
                    c = i.showLegend;
                    for (var d = 0; d < i.options.length; d++) {
                        var h = i.options[d]
                          , f = function(e) {
                            return function(t) {
                                if (a.props.data.radio)
                                    for (var n = 0; n < i.options.length; n++) {
                                        var r = i.options[n];
                                        r !== e && r.activeState() && r.toggle()
                                    }
                                e.toggle(),
                                a.forceUpdate(),
                                a.context.nima.stage.redraw(),
                                i.closeOnSelect && a.close()
                            }
                        }(h)
                          , p = function(e) {
                            return function(t) {
                                e.isMouseOver = true,
                                a.forceUpdate()
                            }
                        }(h)
                          , y = function(e) {
                            return function(t) {
                                e.isMouseOver = false,
                                a.forceUpdate()
                            }
                        }(h)
                          , m = h.activeState();
                        d < 3 && (s[d] = m),
                        r.push(o.default.createElement(l.default, {
                            key: d,
                            className: h.className,
                            onClick: f,
                            onMouseEnter: p,
                            onMouseLeave: y,
                            tip: h.tip
                        }, h.useTxtLabel ? o.default.createElement("div", {
                            className: "ToolIcon"
                        }, h.txtLabel) : o.default.createElement("svg", {
                            className: "ToolIcon" + (h.isMouseOver ? " ToolIconHover" : "")
                        }, o.default.createElement("use", {
                            xlinkHref: h.icon
                        })), h.useTxtLabel ? null : o.default.createElement("div", {
                            className: "OptionHighlight " + t[m]
                        })))
                    }
                    45 * i.options.length,
                    45 * i.options.length
                }
                return o.default.createElement("div", {
                    className: "ToolButton",
                    onMouseDown: this.mouseDown,
                    onMouseEnter: this.mouseOver,
                    onMouseLeave: this.mouseOut,
                    id: this.props.cssID
                }, o.default.createElement("div", {
                    className: this.state.isOpen ? "ToolSelectedPopup ToolSelectedPopupOpen" : "ToolSelectedPopup",
                    style: {
                        opacity: this.state.popupOpacity,
                        width: this.state.isOpen ? this.togglesWidth + 60 + "px" : null,
                        left: this.state.isOpen ? -this.togglesWidth + "px" : null
                    }
                }, o.default.createElement("div", {
                    className: "ToggleWrapper",
                    style: {
                        width: this.state.isOpen ? this.togglesWidth + "px" : ""
                    }
                }, o.default.createElement("div", {
                    ref: this.setTogglesSizeCalc,
                    className: "TogglesSizeCalc"
                }, r))), o.default.createElement("svg", {
                    className: this.state.isOpen ? "ToolPopupArrow ToolPopupArrowOpen" : "ToolPopupArrow"
                }, o.default.createElement("use", {
                    xlinkHref: u.default.make("/images/symbol-defs.svg#icon-popup-arrow")
                })), c ? o.default.createElement("div", {
                    className: "OptionStatuses"
                }, o.default.createElement("div", {
                    className: n[s[0]]
                }), o.default.createElement("div", {
                    className: n[s[1]]
                }), r.length > 2 ? o.default.createElement("div", {
                    className: n[s[2]]
                }) : null) : null, i.extraIcon || null, o.default.createElement("svg", {
                    className: "ToolIcon" + (this.state.hover || this.state.isOpen ? " ToolIconFlyActive" : "")
                }, o.default.createElement("use", {
                    xlinkHref: e
                })))
            }
        }]),
        t
    }(o.default.Component)).prototype, "mouseOver", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseOver"), i.prototype),
    d(i.prototype, "mouseOut", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseOut"), i.prototype),
    d(i.prototype, "mouseDown", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseDown"), i.prototype),
    d(i.prototype, "open", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "open"), i.prototype),
    d(i.prototype, "close", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "close"), i.prototype),
    d(i.prototype, "setTogglesSizeCalc", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setTogglesSizeCalc"), i.prototype),
    i);
    t.default = h,
    h.contextTypes = {
        nima: s.default.object,
        tooltip: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = l(n(0)), a = l(n(1)), s = l(n(4));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function u(e, t) {
        if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function")
    }
    function c(e, t) {
        if (!e)
            throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    function d(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var h = (d((i = function(e) {
        function t() {
            return u(this, t),
            c(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "click",
            value: function(e) {
                this.context.tooltip.click(this),
                this.props.onClick && this.props.onClick(e)
            }
        }, {
            key: "mouseEnter",
            value: function(e) {
                this.context.tooltip.enter(this),
                this.props.onMouseEnter && this.props.onMouseEnter(e)
            }
        }, {
            key: "mouseLeave",
            value: function(e) {
                this.context.tooltip.leave(this),
                this.props.onMouseLeave && this.props.onMouseLeave(e)
            }
        }, {
            key: "render",
            value: function() {
                return o.default.createElement("div", {
                    className: this.props.className,
                    onClick: this.click,
                    onMouseEnter: this.mouseEnter,
                    onMouseLeave: this.mouseLeave
                }, this.props.children)
            }
        }]),
        t
    }(o.default.Component)).prototype, "click", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "click"), i.prototype),
    d(i.prototype, "mouseEnter", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseEnter"), i.prototype),
    d(i.prototype, "mouseLeave", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseLeave"), i.prototype),
    i);
    t.default = h,
    h.contextTypes = {
        tooltip: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = u(n(0)), a = u(n(1)), s = u(n(4)), l = u(n(595));
    function u(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function c(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var d = (c((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                isFocused: false,
                input: ""
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "inputFocused",
            value: function(e) {
                e.preventDefault(),
                e.stopPropagation();
                var t = e.target;
                this.setState((function() {
                    return {
                        isFocused: true,
                        input: l.default.toInputValue(this.props.value)
                    }
                }
                ), (function() {
                    t && t.select && t.select()
                }
                ))
            }
        }, {
            key: "inputBlurred",
            value: function() {
                if (null !== this.state.input) {
                    var e, t = this.state.input;
                    try {
                        e = l.default.fromInputValue(t)
                    } catch (t) {
                        e = this.props.value
                    }
                    this.props.valueChanged && !isNaN(e) && this.props.valueChanged(e)
                }
                this.setState({
                    isFocused: false
                })
            }
        }, {
            key: "inputText",
            value: function(e) {
                this.setState({
                    input: e.target.value
                })
            }
        }, {
            key: "keyDown",
            value: function(e) {
                switch (e.keyCode) {
                case 13:
                    this.textInput.blur();
                    break;
                case 27:
                    this.state.input = null,
                    this.textInput.blur()
                }
            }
        }, {
            key: "mouseOver",
            value: function() {
                this.context.tooltip.enter(this)
            }
        }, {
            key: "mouseOut",
            value: function() {
                this.context.tooltip.leave(this)
            }
        }, {
            key: "mouseDown",
            value: function(e) {
                this.context.tooltip.click(this),
                this.state.isFocused || (e.preventDefault(),
                this.lastY = e.clientY,
                this.moved = false,
                this.valueAtClick = this.props.value,
                this.valueMoveAccum = 0,
                this.moveAccum = 0,
                window.addEventListener("mouseup", this.mouseUp, true),
                window.addEventListener("mousemove", this.mouseMove, true))
            }
        }, {
            key: "mouseUp",
            value: function(e) {
                this.moved ? this.setState({
                    isFocused: false,
                    input: l.default.toInputValue(this.props.value)
                }) : this.inputFocused(e),
                window.removeEventListener("mousemove", this.mouseMove, true),
                window.removeEventListener("mouseup", this.mouseUp, true)
            }
        }, {
            key: "mouseMove",
            value: function(e) {
                var t = e.clientY - this.lastY;
                if (this.lastY = e.clientY,
                this.valueMoveAccum -= t * l.default.dragScale,
                !this.moved) {
                    if (this.moveAccum += Math.abs(t),
                    !(this.moveAccum > 4))
                        return;
                    this.moved = true
                }
                if (this.props.valueChanged) {
                    var n = l.default.dragMin
                      , i = l.default.dragMax
                      , r = this.valueAtClick + this.valueMoveAccum;
                    this.valueAtClick > i ? r = this.valueMoveAccum > 0 ? this.valueAtClick : r : r < n ? r = n : r > i && (r = i),
                    this.props.valueChanged(r)
                }
            }
        }, {
            key: "setTextInput",
            value: function(e) {
                this.textInput = e
            }
        }, {
            key: "render",
            value: function() {
                var e = this.state.isFocused ? this.state.input : l.default.toDisplayValue(this.props.value);
                return o.default.createElement("input", {
                    id: "zoomInput",
                    type: "text",
                    value: e,
                    ref: this.setTextInput,
                    onKeyDown: this.keyDown,
                    onChange: this.inputText,
                    onBlur: this.inputBlurred,
                    onMouseDown: this.mouseDown,
                    onMouseEnter: this.mouseOver,
                    onMouseLeave: this.mouseOut
                })
            }
        }]),
        t
    }(o.default.Component)).prototype, "inputFocused", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "inputFocused"), i.prototype),
    c(i.prototype, "inputBlurred", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "inputBlurred"), i.prototype),
    c(i.prototype, "inputText", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "inputText"), i.prototype),
    c(i.prototype, "keyDown", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "keyDown"), i.prototype),
    c(i.prototype, "mouseOver", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseOver"), i.prototype),
    c(i.prototype, "mouseOut", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseOut"), i.prototype),
    c(i.prototype, "mouseDown", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseDown"), i.prototype),
    c(i.prototype, "mouseUp", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseUp"), i.prototype),
    c(i.prototype, "mouseMove", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseMove"), i.prototype),
    c(i.prototype, "setTextInput", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setTextInput"), i.prototype),
    i);
    t.default = d,
    d.contextTypes = {
        tooltip: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = l(n(0)), a = l(n(1)), s = l(n(3));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function u(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var c = (u((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                hover: false,
                toggleOn: false
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "mouseOver",
            value: function() {
                this.setState({
                    hover: true
                })
            }
        }, {
            key: "mouseOut",
            value: function() {
                this.setState({
                    hover: false
                })
            }
        }, {
            key: "mouseDown",
            value: function() {
                this.props.onToggle && this.props.onToggle(!this.state.toggleOn),
                this.setState({
                    toggleOn: !this.state.toggleOn
                })
            }
        }, {
            key: "setToggleValue",
            value: function(e) {
                this.setState({
                    toggleOn: e
                })
            }
        }, {
            key: "render",
            value: function() {
                var e;
                switch (this.props.name) {
                case "MeshVisibility":
                    e = s.default.make("/images/symbol-defs.svg#icon-mesh")
                }
                return o.default.createElement("div", {
                    className: "VisibilityToggle",
                    onMouseDown: this.mouseDown,
                    onMouseEnter: this.mouseOver,
                    onMouseLeave: this.mouseOut,
                    id: this.props.name
                }, o.default.createElement("svg", {
                    className: this.state.toggleOn ? "ToggleIcon ToggleIconActive" : "ToggleIcon"
                }, o.default.createElement("use", {
                    xlinkHref: e
                })), o.default.createElement("div", {
                    className: "ToggleHighlight" + (this.state.toggleOn ? " ToggleVisible" : " ToggleHidden")
                }))
            }
        }]),
        t
    }(o.default.Component)).prototype, "mouseOver", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseOver"), i.prototype),
    u(i.prototype, "mouseOut", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseOut"), i.prototype),
    u(i.prototype, "mouseDown", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "mouseDown"), i.prototype),
    i);
    t.default = c
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = u(n(473))
      , o = u(n(201))
      , a = u(n(243))
      , s = u(n(372))
      , l = u(n(381));
    function u(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function c(e, t) {
        if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function")
    }
    function d(e, t) {
        if (!e)
            throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    var h = function(e) {
        function t() {
            return c(this, t),
            d(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "canSelectType",
            value: function(e) {
                switch (e) {
                case o.default:
                case a.default:
                case s.default:
                case l.default:
                    return true
                }
                return false
            }
        }]),
        t
    }(r.default);
    t.default = h
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = a(n(473))
      , o = a(n(261));
    function a(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function s(e, t) {
        if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function")
    }
    function l(e, t) {
        if (!e)
            throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    var u = function(e) {
        function t() {
            return s(this, t),
            l(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "canSelectType",
            value: function(e) {
                return e === o.default
            }
        }]),
        t
    }(r.default);
    t.default = u
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = a(n(473))
      , o = a(n(370));
    function a(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function s(e, t) {
        if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function")
    }
    function l(e, t) {
        if (!e)
            throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    var u = function(e) {
        function t() {
            return s(this, t),
            l(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "canSelectType",
            value: function(e) {
                return e === o.default
            }
        }]),
        t
    }(r.default);
    t.default = u
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = y(n(0)), a = y(n(4)), s = y(n(1)), l = y(n(1189)), u = y(n(474)), c = y(n(1190)), d = y(n(1191)), h = y(n(1192)), f = y(n(1193)), p = y(n(3));
    function y(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function m(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var v = (m((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                currPageLeft: "0px"
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "componentWillMount",
            value: function() {
                this.currPage = 1
            }
        }, {
            key: "updatePreferences",
            value: function() {
                this.preferences && this.preferences.updatePreferences()
            }
        }, {
            key: "componentWillReceiveProps",
            value: function(e) {
                e.isOpen ? this.revisionHistory.getRevisionList() : false === e.isOpen && this.revisionHistory.cancelPreview()
            }
        }, {
            key: "goForward",
            value: function(e) {
                this.currPage++,
                this.gotoSettingsPage(e)
            }
        }, {
            key: "goBack",
            value: function() {
                this.currPage--,
                this.gotoSettingsPage()
            }
        }, {
            key: "gotoSettingsPage",
            value: function(e) {
                switch (this.currPage) {
                case 1:
                    this.setState({
                        currPageLeft: "0px",
                        showBack: false
                    });
                    break;
                case 2:
                    this.setState({
                        currPageLeft: "-200px",
                        showBack: true,
                        showPage: e
                    })
                }
            }
        }, {
            key: "translatePanelOut",
            value: function(e, t) {
                t ? this.root.style.transform = e ? "translate3D(200px, 0, 0)" : "translate3D(0px, 0, 0)" : this.root.style.display = e ? "none" : null
            }
        }, {
            key: "setRoot",
            value: function(e) {
                this.root = e
            }
        }, {
            key: "setPreferencesRef",
            value: function(e) {
                this.preferences = e
            }
        }, {
            key: "setRevisionHistory",
            value: function(e) {
                this.revisionHistory = e
            }
        }, {
            key: "render",
            value: function() {
                var e = f.default.major + "." + f.default.minor + "." + f.default.patch + " (" + (f.default.build || "DEV") + ")";
                return o.default.createElement("div", {
                    id: "SettingsPanel",
                    ref: this.setRoot,
                    style: {
                        width: this.props.isOpen ? "200px" : "0px"
                    }
                }, o.default.createElement("div", {
                    className: "SettingsHeader"
                }, o.default.createElement("svg", {
                    className: "BackButton",
                    onMouseDown: this.state.showBack ? this.goBack : null,
                    style: {
                        opacity: this.state.showBack ? null : 0
                    }
                }, o.default.createElement("use", {
                    xlinkHref: p.default.make("/images/symbol-defs.svg#icon-back")
                })), o.default.createElement("svg", {
                    className: "CloseButton",
                    onMouseDown: this.props.onSettingsToggled
                }, o.default.createElement("use", {
                    xlinkHref: p.default.make("/images/symbol-defs.svg#icon-close3")
                }))), o.default.createElement("div", {
                    className: "SettingsPages",
                    style: {
                        left: this.state.currPageLeft
                    }
                }, o.default.createElement("div", {
                    className: "SettingsPage1"
                }, o.default.createElement(l.default, {
                    label: "Preferences",
                    type: t.PageTypes.Preferences,
                    onSelect: this.goForward
                }), this.context.nima.hasWriteAccess ? o.default.createElement(l.default, {
                    label: "Revision History",
                    type: t.PageTypes.RevisionHistory,
                    onSelect: this.goForward
                }) : null, o.default.createElement("div", {
                    className: "SettingsListDivider"
                }), o.default.createElement("a", {
                    className: "SettingsListRow",
                    href: "https://docs.rive.app/nima/core-concepts",
                    target: "_blank"
                }, "Nima Manual"), o.default.createElement(l.default, {
                    label: "Keyboard Shortcuts",
                    type: t.PageTypes.KeyboardShortcuts,
                    onSelect: this.goForward
                })), o.default.createElement("div", {
                    className: "SettingsPage2"
                }, o.default.createElement(u.default, {
                    ref: this.setRevisionHistory,
                    isVisible: this.state.showPage === t.PageTypes.RevisionHistory
                }), o.default.createElement(c.default, {
                    isVisible: this.state.showPage === t.PageTypes.GettingStarted
                }), o.default.createElement(d.default, {
                    isVisible: this.state.showPage === t.PageTypes.KeyboardShortcuts
                }), o.default.createElement(h.default, {
                    ref: this.setPreferencesRef,
                    isVisible: this.state.showPage === t.PageTypes.Preferences
                })), o.default.createElement("div", {
                    className: "SettingsFooter"
                }, o.default.createElement("div", {
                    className: "NimaText"
                }, "NIMA"), o.default.createElement("div", {
                    className: "NimaVersion"
                }, e))))
            }
        }]),
        t
    }(o.default.Component)).prototype, "goForward", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "goForward"), i.prototype),
    m(i.prototype, "goBack", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "goBack"), i.prototype),
    m(i.prototype, "setRoot", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setRoot"), i.prototype),
    m(i.prototype, "setPreferencesRef", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setPreferencesRef"), i.prototype),
    m(i.prototype, "setRevisionHistory", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setRevisionHistory"), i.prototype),
    i);
    t.default = v,
    v.contextTypes = {
        nima: a.default.object
    },
    v.PageTypes = {
        GettingStarted: 0,
        RevisionHistory: 1,
        KeyboardShortcuts: 2,
        Preferences: 3
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = s(n(0)), a = s(n(1));
    function s(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function l(e, t) {
        if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function")
    }
    function u(e, t) {
        if (!e)
            throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    var c, d, h, f, p, y, m = (i = function(e) {
        function t() {
            return l(this, t),
            u(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "select",
            value: function() {
                this.props.onSelect && this.props.onSelect(this.props.type)
            }
        }, {
            key: "render",
            value: function() {
                return o.default.createElement("div", {
                    className: "SettingsListRow",
                    onMouseDown: this.select
                }, this.props.label)
            }
        }]),
        t
    }(o.default.Component),
    c = i.prototype,
    d = "select",
    h = [a.default],
    f = Object.getOwnPropertyDescriptor(i.prototype, "select"),
    p = i.prototype,
    y = {},
    Object.keys(f).forEach((function(e) {
        y[e] = f[e]
    }
    )),
    y.enumerable = !!y.enumerable,
    y.configurable = !!y.configurable,
    ("value"in y || y.initializer) && (y.writable = true),
    y = h.slice().reverse().reduce((function(e, t) {
        return t(c, d, e) || e
    }
    ), y),
    p && void 0 !== y.initializer && (y.value = y.initializer ? y.initializer.call(p) : void 0,
    y.initializer = void 0),
    void 0 === y.initializer && (Object.defineProperty(c, d, y),
    y = null),
    i);
    t.default = m
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = a(n(0))
      , o = a(n(3));
    function a(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function s(e, t) {
        if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function")
    }
    function l(e, t) {
        if (!e)
            throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    var u = function(e) {
        function t() {
            return s(this, t),
            l(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "render",
            value: function() {
                return r.default.createElement("div", {
                    className: "GettingStartedContent",
                    style: {
                        display: this.props.isVisible ? "block" : "none"
                    }
                }, r.default.createElement("svg", {
                    className: "GettingStartedIcon"
                }, r.default.createElement("use", {
                    xlinkHref: o.default.make("/images/symbol-defs.svg#icon-lightbulb")
                })), r.default.createElement("div", {
                    className: "SettingsHeadline"
                }, "Getting Started"), r.default.createElement("p", null, "Welcome to Nima! To get started, drag and drop some images to the stage. Flatten your layers if you're dragging a PSD, so everything loads correctly."), r.default.createElement("p", null, "You're going to be doing most of your work on the stage. The rest of the interface is divided into a few main panels."), r.default.createElement("div", {
                    className: "SettingsListDivider"
                }), r.default.createElement("div", {
                    className: "HierarchyPanelIcon"
                }, r.default.createElement("div", {
                    className: "HierarchyPanelIcon1"
                }), r.default.createElement("div", {
                    className: "HierarchyPanelIcon2"
                }), r.default.createElement("div", {
                    className: "HierarchyPanelIcon3"
                }), r.default.createElement("div", {
                    className: "HierarchyPanelIcon4"
                })), r.default.createElement("div", {
                    className: "SettingsHeadline"
                }, "Hierarchy Panel"), r.default.createElement("p", null, "On the far left, you have the Hierarchy panel. Here you can toggle between Setup and Animate modes.  All the items that make up your character appear below. These are divided by Stage, Assets, and Draw Order. Stage reflects everything that's currently on the stage, and the hierarchical structure of your skeleton. Assets is a list of all the files that are available to be used on this project. Not all of them might be on the stage. When you delete an image from the Stage, it does not get removed from your Assets. Draw Order reflects the order that images are rendered on the screen, which you may want to be different from the hierarchical order of your character's skeleton."), r.default.createElement("div", {
                    className: "SettingsListDivider"
                }), r.default.createElement("div", {
                    className: "SelectionPanelIcon"
                }, r.default.createElement("div", {
                    className: "SelectionPanelIcon1"
                }), r.default.createElement("div", {
                    className: "SelectionPanelIcon2"
                }), r.default.createElement("div", {
                    className: "SelectionPanelIcon3"
                }), r.default.createElement("div", {
                    className: "SelectionPanelIcon4"
                })), r.default.createElement("div", {
                    className: "SettingsHeadline"
                }, "Selection Panel"), r.default.createElement("p", null, "The Selection panel is to the right of the Hierarchy panel. All the properties of the item you have selected are available here. Most of these can be animated when you toggle to Animate mode."), r.default.createElement("div", {
                    className: "SettingsListDivider"
                }), r.default.createElement("div", {
                    className: "ToolbarIcon"
                }, r.default.createElement("div", {
                    className: "ToolbarIcon1"
                }), r.default.createElement("div", {
                    className: "ToolbarIcon2"
                }), r.default.createElement("div", {
                    className: "ToolbarIcon3"
                }), r.default.createElement("div", {
                    className: "ToolbarIcon4"
                })), r.default.createElement("div", {
                    className: "SettingsHeadline"
                }, "Toolbar"), r.default.createElement("p", null, "The Toolbar is on the far right. It displays the tools you have available to manipulate and create objects on the stage. Note that these change based on whether you are in Setup or Animate mode."))
            }
        }]),
        t
    }(r.default.Component);
    t.default = u
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = a(n(0))
      , o = a(n(3));
    function a(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function s(e, t) {
        if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function")
    }
    function l(e, t) {
        if (!e)
            throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    var u = function(e) {
        function t() {
            return s(this, t),
            l(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "render",
            value: function() {
                return r.default.createElement("div", {
                    className: "KeyboardShortcutsContent",
                    style: {
                        display: this.props.isVisible ? "block" : "none"
                    }
                }, r.default.createElement("svg", {
                    className: "GettingStartedIcon"
                }, r.default.createElement("use", {
                    xlinkHref: o.default.make("/images/symbol-defs.svg#icon-keyboard")
                })), r.default.createElement("div", {
                    className: "SettingsHeadline"
                }, "Keyboard Shortcuts"), r.default.createElement("div", {
                    className: "KeyboardShortcutRow"
                }, r.default.createElement("div", {
                    className: "KeyboardShortcutDesc"
                }, "Translate"), r.default.createElement("div", {
                    className: "KeyboardShortcutKey"
                }, "T")), r.default.createElement("div", {
                    className: "KeyboardShortcutRow"
                }, r.default.createElement("div", {
                    className: "KeyboardShortcutDesc"
                }, "Rotate"), r.default.createElement("div", {
                    className: "KeyboardShortcutKey"
                }, "R")), r.default.createElement("div", {
                    className: "KeyboardShortcutRow"
                }, r.default.createElement("div", {
                    className: "KeyboardShortcutDesc"
                }, "Scale"), r.default.createElement("div", {
                    className: "KeyboardShortcutKey"
                }, "S")), r.default.createElement("div", {
                    className: "KeyboardShortcutRow"
                }, r.default.createElement("div", {
                    className: "KeyboardShortcutDesc"
                }, "IK"), r.default.createElement("div", {
                    className: "KeyboardShortcutKey"
                }, "W")), r.default.createElement("div", {
                    className: "KeyboardShortcutRow"
                }, r.default.createElement("div", {
                    className: "KeyboardShortcutDesc"
                }, "Create Bone"), r.default.createElement("div", {
                    className: "KeyboardShortcutKey"
                }, "B")), r.default.createElement("div", {
                    className: "KeyboardShortcutRow"
                }, r.default.createElement("div", {
                    className: "KeyboardShortcutDesc"
                }, "Create Node"), r.default.createElement("div", {
                    className: "KeyboardShortcutKey"
                }, "G")), r.default.createElement("div", {
                    className: "KeyboardShortcutRow"
                }, r.default.createElement("div", {
                    className: "KeyboardShortcutDesc"
                }, "Pan Stage & Timeline"), r.default.createElement("div", {
                    className: "KeyboardShortcutKey"
                }, "Spacebar")), r.default.createElement("div", {
                    className: "KeyboardShortcutRow"
                }, r.default.createElement("div", {
                    className: "KeyboardShortcutDesc"
                }, "Zoom In"), r.default.createElement("div", {
                    className: "KeyboardShortcutKey"
                }, "âŒ˜ +")), r.default.createElement("div", {
                    className: "KeyboardShortcutRow"
                }, r.default.createElement("div", {
                    className: "KeyboardShortcutDesc"
                }, "Zoom Out"), r.default.createElement("div", {
                    className: "KeyboardShortcutKey"
                }, "âŒ˜ â€“")), r.default.createElement("div", {
                    className: "KeyboardShortcutRow"
                }, r.default.createElement("div", {
                    className: "KeyboardShortcutDesc"
                }, "Actual Size"), r.default.createElement("div", {
                    className: "KeyboardShortcutKey"
                }, "âŒ˜ 0")), r.default.createElement("div", {
                    className: "KeyboardShortcutRow"
                }, r.default.createElement("div", {
                    className: "KeyboardShortcutDesc"
                }, "Zoom to Fit"), r.default.createElement("div", {
                    className: "KeyboardShortcutKey"
                }, "F")), r.default.createElement("div", {
                    className: "KeyboardShortcutRow"
                }, r.default.createElement("div", {
                    className: "KeyboardShortcutDesc"
                }, "Deselect"), r.default.createElement("div", {
                    className: "KeyboardShortcutKey"
                }, "âŒ˜ D")), r.default.createElement("div", {
                    className: "KeyboardShortcutRow"
                }, r.default.createElement("div", {
                    className: "KeyboardShortcutDesc",
                    style: {
                        width: "90px",
                        flex: "initial"
                    }
                }, "Move Playhead 1 Frame"), r.default.createElement("div", {
                    className: "KeyboardShortcutKey"
                }, "âŒ˜ ", r.default.createElement("span", {
                    style: {
                        fontSize: "65%",
                        position: "relative",
                        top: "-1px"
                    }
                }, "â—€ â–¶"))), r.default.createElement("div", {
                    className: "KeyboardShortcutRow"
                }, r.default.createElement("div", {
                    className: "KeyboardShortcutDesc",
                    style: {
                        width: "70px",
                        flex: "initial"
                    }
                }, "Move Playhead 10 Frames"), r.default.createElement("div", {
                    className: "KeyboardShortcutKey"
                }, "âŒ˜ Shift ", r.default.createElement("span", {
                    style: {
                        fontSize: "65%",
                        position: "relative",
                        top: "-1px"
                    }
                }, "â—€ â–¶"))), r.default.createElement("div", {
                    className: "KeyboardShortcutRow"
                }, r.default.createElement("div", {
                    className: "KeyboardShortcutDesc",
                    style: {
                        width: "90px",
                        flex: "initial"
                    }
                }, "Pick Children"), r.default.createElement("div", {
                    className: "KeyboardShortcutKey"
                }, "C")))
            }
        }]),
        t
    }(r.default.Component);
    t.default = u
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = c(n(0)), a = c(n(1)), s = c(n(4)), l = c(n(310)), u = c(n(3));
    function c(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function d(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var h = (d((i = function(e) {
        function t(e) {
            return function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t),
            function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "componentWillMount",
            value: function() {
                this.setState(this.getPreferencesState())
            }
        }, {
            key: "toggleRetina",
            value: function(e) {
                this.context.nima.setLocalPreference("scaleRetina", e),
                this.setState({
                    scaleRetina: e
                })
            }
        }, {
            key: "toggleGuides",
            value: function(e) {
                this.context.nima.setProjectPreference("showGuides", e),
                this.setState({
                    showGuides: e
                })
            }
        }, {
            key: "toggleImageContour",
            value: function(e) {
                this.context.nima.setProjectPreference("disableImageContour", !e),
                this.setState({
                    disableImageContour: !e
                })
            }
        }, {
            key: "getPreferencesState",
            value: function() {
                return {
                    scaleRetina: this.context.nima.getPreference("scaleRetina"),
                    showGuides: this.context.nima.getPreference("showGuides"),
                    disableImageContour: this.context.nima.getPreference("disableImageContour")
                }
            }
        }, {
            key: "updatePreferences",
            value: function() {
                this.setState(this.getPreferencesState())
            }
        }, {
            key: "render",
            value: function() {
                return o.default.createElement("div", {
                    className: "KeyboardShortcutsContent",
                    style: {
                        display: this.props.isVisible ? "block" : "none"
                    }
                }, o.default.createElement("svg", {
                    className: "GettingStartedIcon"
                }, o.default.createElement("use", {
                    xlinkHref: u.default.make("/images/symbol-defs.svg#icon-adjustments")
                })), o.default.createElement("div", {
                    className: "SettingsHeadline"
                }, "Preferences"), o.default.createElement("div", {
                    className: "KeyboardShortcutRow"
                }, o.default.createElement("div", {
                    className: "KeyboardShortcutDesc",
                    style: {
                        flex: 2
                    }
                }, "Show Guides"), o.default.createElement("div", {
                    className: "KeyboardShortcutKey"
                }, o.default.createElement(l.default, {
                    addClass: "ContrastToggle",
                    isOn: this.state.showGuides,
                    onToggle: this.toggleGuides
                }))), o.default.createElement("div", {
                    className: "KeyboardShortcutRow"
                }, o.default.createElement("div", {
                    className: "KeyboardShortcutDesc",
                    style: {
                        flex: 2
                    }
                }, "Scale for Retina"), o.default.createElement("div", {
                    className: "KeyboardShortcutKey"
                }, o.default.createElement(l.default, {
                    addClass: "ContrastToggle",
                    isOn: this.state.scaleRetina,
                    onToggle: this.toggleRetina
                }))), o.default.createElement("div", {
                    className: "KeyboardShortcutRow"
                }, o.default.createElement("div", {
                    className: "KeyboardShortcutDesc",
                    style: {
                        flex: 2
                    }
                }, "Show Image Contour"), o.default.createElement("div", {
                    className: "KeyboardShortcutKey"
                }, o.default.createElement(l.default, {
                    addClass: "ContrastToggle",
                    isOn: !this.state.disableImageContour,
                    onToggle: this.toggleImageContour
                }))))
            }
        }]),
        t
    }(o.default.Component)).prototype, "toggleRetina", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleRetina"), i.prototype),
    d(i.prototype, "toggleGuides", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleGuides"), i.prototype),
    d(i.prototype, "toggleImageContour", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleImageContour"), i.prototype),
    i);
    t.default = h,
    h.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    e.exports = {
        major: 1,
        minor: 0,
        patch: 1,
        build: "3049"
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = d(n(0)), a = d(n(23)), s = d(n(1)), l = d(n(9)), u = d(n(4)), c = d(n(417));
    function d(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function h(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var f = (h((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                opacity: 0,
                isMeasuring: true
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "componentDidMount",
            value: function() {
                document.addEventListener("mouseleave", this.onWindowMouseLeave)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                document.removeEventListener("mouseleave", this.onWindowMouseLeave)
            }
        }, {
            key: "onWindowMouseLeave",
            value: function() {
                clearTimeout(this.showTimeout)
            }
        }, {
            key: "showFor",
            value: function(e) {
                var t, n;
                e.props.tip && (this.next = e,
                clearTimeout(this.showTimeout),
                this.showTimeout = setTimeout((t = this,
                n = e,
                function() {
                    t.build.call(t, n)
                }
                ), 800))
            }
        }, {
            key: "tooltipHeight",
            value: function() {
                var e = void 0;
                if (this.item.props.tip.actions) {
                    e = 21 + 30 * this.item.props.tip.actions.length
                } else
                    e = 51;
                return e
            }
        }, {
            key: "build",
            value: function(e) {
                this.item = e;
                a.default.findDOMNode(e);
                clearTimeout(this.hideTimeout);
                var t = window.innerWidth / 2
                  , n = window.innerHeight / 2;
                function i(e) {
                    var t = l.default.isOSX
                      , n = "";
                    return e.command && (n += t ? "âŒ˜" : "win"),
                    e.shift && (0 != n.length && (n += " "),
                    n += "shift"),
                    e.ctrl && (0 != n.length && (n += " "),
                    n += "ctrl"),
                    e.alt && (0 != n.length && (n += " "),
                    n += "alt"),
                    0 != n.length && (n += " "),
                    (n += c.default.index.getName(e.code)).toUpperCase()
                }
                var r = e.props.tip
                  , o = null;
                if (r.action) {
                    var s = this.context.keyMap.getKeyBinding(r.action);
                    s && (o = i(s))
                } else if (r.actions) {
                    o = [];
                    for (var u = 0; u < r.actions.length; u++) {
                        var d = r.actions[u]
                          , h = this.context.keyMap.getKeyBinding(d.action);
                        h && o.push({
                            label: d.label,
                            shortcut: i(h)
                        })
                    }
                }
                this.setState({
                    opacity: 1,
                    tipLeft: void 0,
                    tipRight: t,
                    tipTop: n,
                    label: r.label,
                    shortcut: o
                })
            }
        }, {
            key: "hideImmediatelyFor",
            value: function(e) {
                e != this.item && e != this.next || (clearTimeout(this.showTimeout),
                clearTimeout(this.hideTimeout),
                this.item = null,
                this.setState({
                    opacity: 0
                }))
            }
        }, {
            key: "hideFor",
            value: function(e) {
                var t;
                e != this.item && e != this.next || (clearTimeout(this.showTimeout),
                clearTimeout(this.hideTimeout),
                this.hideTimeout = setTimeout((t = this,
                function() {
                    t.item = null,
                    t.setState({
                        opacity: 0,
                        isMeasuring: true
                    })
                }
                ), 200))
            }
        }, {
            key: "setTooltipRoot",
            value: function(e) {
                this.tooltipRoot = e
            }
        }, {
            key: "componentDidUpdate",
            value: function(e, t) {
                if (this.state.isMeasuring && 1 === this.state.opacity) {
                    var n = a.default.findDOMNode(this.next)
                      , i = n.getBoundingClientRect()
                      , r = n.parentElement.getBoundingClientRect()
                      , o = this.tooltipRoot.getBoundingClientRect()
                      , s = void 0
                      , l = void 0
                      , u = i.top;
                    if (i.left <= r.left)
                        i.right > window.innerWidth / 2 ? s = window.innerWidth - i.left + 10 : l = i.right + 10;
                    else {
                        var c = o.height;
                        u = r.top - c - 10,
                        i.left + i.width / 2 + o.width / 2 < window.innerWidth - 70 ? l = i.left + i.width / 2 - o.width / 2 : s = 70
                    }
                    this.setState({
                        isMeasuring: false,
                        tipLeft: l,
                        tipRight: s,
                        tipTop: u
                    })
                }
            }
        }, {
            key: "render",
            value: function() {
                var e = null
                  , t = "Tooltip";
                if (this.state.shortcut)
                    if (this.state.shortcut.constructor === Array) {
                        t = "TooltipMulti";
                        for (var n = [], i = [], r = 0; r < this.state.shortcut.length; r++) {
                            var a = this.state.shortcut[r];
                            n.push(o.default.createElement("div", {
                                key: "l" + r,
                                className: "TooltipLabel"
                            }, a.label)),
                            i.push(o.default.createElement("div", {
                                key: "s" + r,
                                className: "TooltipShortcut"
                            }, a.shortcut))
                        }
                        e = [o.default.createElement("div", {
                            key: "1",
                            className: "TooltipLabelsList"
                        }, n), o.default.createElement("div", {
                            key: "2",
                            className: "TooltipShortcutsList"
                        }, i)]
                    } else
                        e = o.default.createElement("div", {
                            className: "TooltipShortcut"
                        }, this.state.shortcut);
                return o.default.createElement("div", {
                    ref: this.setTooltipRoot,
                    className: t,
                    style: {
                        opacity: this.state.isMeasuring ? 0 : this.state.opacity,
                        left: null == this.state.tipLeft ? "" : this.state.tipLeft + "px",
                        right: null == this.state.tipRight ? "" : this.state.tipRight + "px",
                        top: null == this.state.tipTop ? "" : this.state.tipTop + "px"
                    }
                }, o.default.createElement("div", {
                    className: "TooltipTitle"
                }, this.state.label), e)
            }
        }]),
        t
    }(o.default.Component)).prototype, "onWindowMouseLeave", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "onWindowMouseLeave"), i.prototype),
    h(i.prototype, "setTooltipRoot", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setTooltipRoot"), i.prototype),
    i);
    t.default = f,
    f.contextTypes = {
        keyMap: u.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = f(n(0)), a = f(n(1)), s = f(n(4)), l = f(n(310)), u = f(n(369)), c = f(n(171)), d = f(n(3)), h = f(n(400));
    function f(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function p(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var y = (p((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                isModalOpen: false,
                isModalClosing: false,
                downloadURL: null,
                isExporting: false,
                exportAnimations: true,
                includeAllAssets: true,
                downloadFilename: null,
                includeProjectSettings: true
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "toggleExportAnimations",
            value: function(e) {
                this.setState({
                    exportAnimations: e
                })
            }
        }, {
            key: "toggleIncludeAllAssets",
            value: function(e) {
                this.setState({
                    includeAllAssets: e
                })
            }
        }, {
            key: "toggleIncludeProjectSettings",
            value: function(e) {
                this.setState({
                    includeProjectSettings: e
                })
            }
        }, {
            key: "componentDidMount",
            value: function() {
                this.openModal(),
                this.context.nima.setCancelCallback(this.closeModal)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.context.nima.clearCancelCallback(this.closeModal)
            }
        }, {
            key: "export",
            value: function() {
                var e = this.context.nima;
                if (e.hasCopyAccess) {
                    this.setState({
                        isExporting: true
                    });
                    var t = this
                      , n = e.actor
                      , i = e.file.name
                      , r = n.serialize(false);
                    this.state.includeProjectSettings && (r.settings = e.serializeSettings()),
                    this.state.exportAnimations || delete r.animations;
                    var o = r.assets
                      , a = []
                      , s = [];
                    if (o) {
                        !function e(i) {
                            for (var r = 0; r < i.length; r++) {
                                var o = i[r]
                                  , s = n.getAsset(o.id);
                                (s && t.state.includeAllAssets || n.isAssetUsed(s)) && a.push(o),
                                o.children && e(o.children)
                            }
                        }(o);
                        var l = true
                          , c = false
                          , d = void 0;
                        try {
                            for (var f, p = o[Symbol.iterator](); !(l = (f = p.next()).done); l = true) {
                                var y = f.value
                                  , m = n.getAsset(y.id);
                                (m && t.state.includeAllAssets || n.isAssetUsed(m)) && s.push(y)
                            }
                        } catch (e) {
                            c = true,
                            d = e
                        } finally {
                            try {
                                !l && p.return && p.return()
                            } finally {
                                if (c)
                                    throw d
                            }
                        }
                    }
                    r.assets = s,
                    h.default.createWriter(new h.default.BlobWriter("application/octet-stream"), (function(e) {
                        e.add(i + ".nma2d", new h.default.TextReader(JSON.stringify(r)), (function() {
                            var r = 0;
                            function o() {
                                ++r >= a.length ? e.close((function(e) {
                                    console.log("BLOB", e);
                                    var n = URL.createObjectURL(e);
                                    console.log(n),
                                    t.setState({
                                        isExporting: false,
                                        downloadURL: n,
                                        downloadFilename: i + ".nma2d"
                                    })
                                }
                                )) : s()
                            }
                            function s() {
                                var t = a[r]
                                  , i = n.getAsset(t.id);
                                i.bitmap ? u.default.toBlob(i.bitmap, function(t) {
                                    return function(n) {
                                        e.add(t, new h.default.BlobReader(new Blob([n],{
                                            type: "image/png"
                                        })), o)
                                    }
                                }(t.id)) : o()
                            }
                            r == a.length ? o() : s()
                        }
                        ), (function(e, t) {}
                        ))
                    }
                    ), (function(e) {}
                    )),
                    this.setState({
                        downloadURL: null
                    })
                }
            }
        }, {
            key: "exit",
            value: function() {
                clearTimeout(this.buildTimeout),
                this.setState({
                    isOpen: false,
                    isClosing: true
                }),
                this.props.onExportComplete()
            }
        }, {
            key: "openModal",
            value: function() {
                this.setState({
                    isModalOpen: true,
                    isModalClosing: false
                })
            }
        }, {
            key: "closeModal",
            value: function() {
                this.setState({
                    isModalOpen: false,
                    isModalClosing: true
                }),
                this.props.onExportComplete()
            }
        }, {
            key: "render",
            value: function() {
                return o.default.createElement(c.default, {
                    addClass: "ExportModal",
                    isOpen: this.state.isModalOpen,
                    isClosing: this.state.isModalClosing,
                    onClose: this.closeModal
                }, o.default.createElement("div", {
                    className: "ModalHeader"
                }, o.default.createElement("svg", {
                    className: "ModalIcon ExportNimaFileIcon"
                }, o.default.createElement("use", {
                    xlinkHref: d.default.make("/images/symbol-defs.svg#icon-nima-file-header")
                })), o.default.createElement("div", {
                    className: "ModalHeadline"
                }, "Download File"), o.default.createElement("div", {
                    className: "ModalSubHeadline"
                }, "Export a shareable version of this project file in its current form. You can share this file with other Nima users, but please note that revision history is not saved with your backup.")), o.default.createElement("div", {
                    className: "ModalContent"
                }, o.default.createElement("div", {
                    className: "ExportGroup"
                }, o.default.createElement("div", {
                    className: "ExportGroupTitle"
                }, "Export Options"), o.default.createElement("div", {
                    className: "ExportGroupProperty"
                }, o.default.createElement("div", {
                    className: "ExportGroupPropertyTitle"
                }, "Include Animations"), o.default.createElement(l.default, {
                    addClass: "ContrastToggle",
                    isOn: this.state.exportAnimations,
                    onToggle: this.toggleExportAnimations
                })), o.default.createElement("div", {
                    className: "ExportGroupProperty"
                }, o.default.createElement("div", {
                    className: "ExportGroupPropertyTitle"
                }, "Include Unused Assets"), o.default.createElement(l.default, {
                    addClass: "ContrastToggle",
                    isOn: this.state.includeAllAssets,
                    onToggle: this.toggleIncludeAllAssets
                })), o.default.createElement("div", {
                    className: "ExportGroupProperty"
                }, o.default.createElement("div", {
                    className: "ExportGroupPropertyTitle"
                }, "Include Project Settings"), o.default.createElement(l.default, {
                    addClass: "ContrastToggle",
                    isOn: this.state.includeProjectSettings,
                    onToggle: this.toggleIncludeProjectSettings
                }))), this.state.downloadURL ? o.default.createElement("div", {
                    className: "ExportGroup"
                }, o.default.createElement("div", {
                    className: "ExportGroupProperty"
                }, o.default.createElement("div", {
                    className: "SingleLabel"
                }, "Download Link"), o.default.createElement("a", {
                    href: this.state.downloadURL,
                    download: this.state.downloadFilename
                }, this.state.downloadFilename))) : null), o.default.createElement("div", {
                    className: "ModalFooter"
                }, o.default.createElement("div", {
                    className: this.state.isExporting ? "ModalFooterBtn ModalFooterBtnDisabled" : "ModalFooterBtn",
                    onClick: this.export
                }, "Export")))
            }
        }]),
        t
    }(o.default.Component)).prototype, "toggleExportAnimations", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleExportAnimations"), i.prototype),
    p(i.prototype, "toggleIncludeAllAssets", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleIncludeAllAssets"), i.prototype),
    p(i.prototype, "toggleIncludeProjectSettings", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleIncludeProjectSettings"), i.prototype),
    p(i.prototype, "export", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "export"), i.prototype),
    p(i.prototype, "exit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "exit"), i.prototype),
    p(i.prototype, "openModal", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "openModal"), i.prototype),
    p(i.prototype, "closeModal", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "closeModal"), i.prototype),
    i);
    t.default = y,
    y.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = g(n(0)), a = g(n(1)), s = g(n(4)), l = g(n(1197)), u = g(n(1198)), c = g(n(316)), d = g(n(310)), h = g(n(1199)), f = n(703), p = g(f), y = g(n(171)), m = g(n(3)), v = g(n(1200));
    function g(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function _(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var b = (_((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                isExporting: false,
                maxImageWidth: null,
                maxImageHeight: null,
                linkImageSize: true,
                linkAtlasSize: true,
                maxAtlasWidth: 2048,
                maxAtlasHeight: 2048,
                atlasPowerOfTwo: true,
                atlasSquare: false,
                cropImages: true,
                maxKeyFrameTimeIsDuration: false,
                padding: 1,
                isModalOpen: false,
                isModalClosing: false,
                engines: [{
                    label: "Unity",
                    extension: ".nma.bytes",
                    tutorial: "https://www.2dimensions.com/b/56-quick-tips-to-get-you-started",
                    multiplyAlpha: true
                }, {
                    label: "Generic",
                    tutorial: "https://www.2dimensions.com/b/56-quick-tips-to-get-you-started"
                }, {
                    label: "WebGL",
                    extension: ".nma",
                    isZip: false,
                    tutorial: "https://www.2dimensions.com/b/56-quick-tips-to-get-you-started"
                }],
                selectedEngineIndex: 0,
                selectedExportFormat: f.WRITER_FORMATS.BINARY
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "componentDidMount",
            value: function() {
                this.openModal(),
                this.context.nima.setCancelCallback(this.closeModal)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                this.context.nima.clearCancelCallback(this.closeModal)
            }
        }, {
            key: "export",
            value: function() {
                var e = this.context.nima;
                if (e.hasCopyAccess) {
                    var t = e.file.name || "character"
                      , n = this.state.engines[this.state.selectedEngineIndex]
                      , i = this.state.selectedExportFormat
                      , r = new p.default({
                        animations: e.actor.animations,
                        characterName: t,
                        multiplyAlpha: true === n.multiplyAlpha,
                        isZipExport: false !== n.isZip,
                        maxImageWidth: this.state.maxImageWidth,
                        maxImageHeight: this.state.maxImageHeight,
                        maxAtlasWidth: this.state.maxAtlasWidth,
                        maxAtlasHeight: this.state.maxAtlasHeight,
                        atlasPowerOfTwo: this.state.atlasPowerOfTwo,
                        atlasSquare: this.state.atlasSquare,
                        cropImages: this.state.cropImages,
                        atlasPadding: this.state.padding,
                        cropAnimationsToWorkArea: true,
                        maxKeyFrameTimeIsDuration: this.state.maxKeyFrameTimeIsDuration,
                        extension: n.extension || ".nma",
                        writerFormat: i
                    })
                      , o = this;
                    r.export(this.context.nima.actor, (function(e) {
                        e ? ((0,
                        u.default)(t + (r.options.isZipExport ? ".zip" : r.options.extension), e),
                        o.setState({
                            isExporting: false
                        }),
                        o.closeModal()) : o.context.nima.alert("Export Error", "The export failed, please try again with different options.")
                    }
                    )),
                    this.setState({
                        isExporting: true
                    })
                }
            }
        }, {
            key: "changePadding",
            value: function(e) {
                isNaN(e) || this.setState({
                    padding: e
                })
            }
        }, {
            key: "changeMaxAtlasWidth",
            value: function(e) {
                var t = {};
                t.maxAtlasWidth = e,
                this.state.linkAtlasSize && (t.maxAtlasHeight = e),
                this.setState(t)
            }
        }, {
            key: "changeMaxAtlasHeight",
            value: function(e) {
                var t = {};
                t.maxAtlasHeight = e,
                this.state.linkAtlasSize && (t.maxAtlasWidth = e),
                this.setState(t)
            }
        }, {
            key: "changeMaxImageWidth",
            value: function(e) {
                var t = {};
                t.maxImageWidth = e,
                this.state.linkImageSize && (t.maxImageHeight = e),
                this.setState(t)
            }
        }, {
            key: "changeMaxImageHeight",
            value: function(e) {
                var t = {};
                t.maxImageHeight = e,
                this.state.linkImageSize && (t.maxImageWidth = e),
                this.setState(t)
            }
        }, {
            key: "toggleLinkAtlasSize",
            value: function() {
                var e = {
                    linkAtlasSize: !this.state.linkAtlasSize
                };
                e.linkAtlasSize && (e.maxAtlasHeight = e.maxAtlasWidth = Math.max(this.state.maxAtlasWidth, this.state.maxAtlasHeight)),
                this.setState(e)
            }
        }, {
            key: "toggleLinkImageSize",
            value: function() {
                var e = {
                    linkImageSize: !this.state.linkImageSize
                };
                e.linkImageSize && (e.maxImageHeight = e.maxImageWidth = Math.max(this.state.maxImageWidth, this.state.maxImageHeight)),
                this.setState(e)
            }
        }, {
            key: "toggleAtlasPowerOfTwo",
            value: function(e) {
                this.setState({
                    atlasPowerOfTwo: e
                })
            }
        }, {
            key: "toggleAtlasSquare",
            value: function(e) {
                this.setState({
                    atlasSquare: e
                })
            }
        }, {
            key: "toggleCropImages",
            value: function(e) {
                this.setState({
                    cropImages: e
                })
            }
        }, {
            key: "toggleMaxKeyFrameTimeIsDuration",
            value: function(e) {
                this.setState({
                    maxKeyFrameTimeIsDuration: e
                })
            }
        }, {
            key: "changeEngine",
            value: function(e) {
                this.setState({
                    selectedEngineIndex: e
                })
            }
        }, {
            key: "onFormatSelected",
            value: function(e) {
                this.setState({
                    selectedExportFormat: e
                })
            }
        }, {
            key: "exit",
            value: function() {
                clearTimeout(this.buildTimeout),
                this.setState({
                    isOpen: false,
                    isClosing: true
                }),
                this.props.onExportComplete()
            }
        }, {
            key: "openModal",
            value: function() {
                this.setState({
                    isModalOpen: true,
                    isModalClosing: false
                })
            }
        }, {
            key: "closeModal",
            value: function() {
                this.setState({
                    isModalOpen: false,
                    isModalClosing: true
                }),
                this.props.onExportComplete()
            }
        }, {
            key: "render",
            value: function() {
                return o.default.createElement(y.default, {
                    addClass: "ExportModal",
                    isOpen: this.state.isModalOpen,
                    isClosing: this.state.isModalClosing,
                    onClose: this.closeModal
                }, o.default.createElement("div", {
                    className: "ModalHeader"
                }, o.default.createElement("svg", {
                    className: "ModalIcon ExportEngineModalIcon"
                }, o.default.createElement("use", {
                    xlinkHref: m.default.make("/images/symbol-defs.svg#icon-game-engine")
                })), o.default.createElement("div", {
                    className: "ModalHeadline"
                }, "Export to Engine"), o.default.createElement("div", {
                    className: "ModalSubHeadline"
                }, "Make sure you download the latest ", o.default.createElement("a", {
                    href: "/runtimes",
                    target: "_blank"
                }, "runtime"), " for your engine.")), o.default.createElement("div", {
                    className: "ModalContent"
                }, o.default.createElement("div", {
                    className: "ExportGroup"
                }, o.default.createElement("div", {
                    className: "ExportGroupProperty"
                }, o.default.createElement("div", {
                    className: "LockedSizeLabel"
                }, "Engine:"), o.default.createElement(c.default, {
                    options: this.state.engines,
                    selectedIndex: this.state.selectedEngineIndex,
                    onSelectionChanged: this.changeEngine,
                    addClass: "ExportOptionsDropdown"
                })), o.default.createElement("div", {
                    className: "ExportGroupProperty"
                }, o.default.createElement("div", {
                    className: "LockedSizeLabel"
                }, "Format:"), o.default.createElement(v.default, {
                    options: [f.WRITER_FORMATS.BINARY, f.WRITER_FORMATS.JSON],
                    onSwitched: this.onFormatSelected
                }))), o.default.createElement("div", {
                    className: "ExportGroup"
                }, o.default.createElement("div", {
                    className: "ExportGroupTitle"
                }, "Max Atlas Size"), o.default.createElement("div", {
                    className: "ExportGroupProperty"
                }, o.default.createElement("div", {
                    className: "LockedSizeLabel"
                }, "Width"), o.default.createElement(l.default, {
                    value: this.state.maxAtlasWidth,
                    valueChanged: this.changeMaxAtlasWidth
                }), o.default.createElement(h.default, {
                    linked: this.state.linkAtlasSize,
                    onToggle: this.toggleLinkAtlasSize
                }), o.default.createElement("div", {
                    className: "LockedSizeLabel"
                }, "Height"), o.default.createElement(l.default, {
                    value: this.state.maxAtlasHeight,
                    valueChanged: this.changeMaxAtlasHeight
                }))), o.default.createElement("div", {
                    className: "ExportGroup"
                }, o.default.createElement("div", {
                    className: "ExportGroupTitle"
                }, "Max Individual Image Size"), o.default.createElement("div", {
                    className: "ExportGroupSubTitle"
                }, "(Optional)"), o.default.createElement("div", {
                    className: "ExportGroupProperty"
                }, o.default.createElement("div", {
                    className: "LockedSizeLabel"
                }, "Width"), o.default.createElement(l.default, {
                    optional: true,
                    value: this.state.maxImageWidth,
                    valueChanged: this.changeMaxImageWidth
                }), o.default.createElement(h.default, {
                    linked: this.state.linkImageSize,
                    onToggle: this.toggleLinkImageSize
                }), o.default.createElement("div", {
                    className: "LockedSizeLabel"
                }, "Height"), o.default.createElement(l.default, {
                    optional: true,
                    value: this.state.maxImageHeight,
                    valueChanged: this.changeMaxImageHeight
                }))), o.default.createElement("div", {
                    className: "ExportGroup"
                }, o.default.createElement("div", {
                    className: "ExportGroupTitle"
                }, "Atlas Options"), o.default.createElement("div", {
                    className: "ExportGroupProperty"
                }, o.default.createElement("div", {
                    className: "ExportGroupPropertyTitle"
                }, "Power of Two"), o.default.createElement(d.default, {
                    addClass: "ContrastToggle",
                    isOn: this.state.atlasPowerOfTwo,
                    onToggle: this.toggleAtlasPowerOfTwo
                })), o.default.createElement("div", {
                    className: "ExportGroupProperty"
                }, o.default.createElement("div", {
                    className: "ExportGroupPropertyTitle"
                }, "Square"), o.default.createElement(d.default, {
                    addClass: "ContrastToggle",
                    isOn: this.state.atlasSquare,
                    onToggle: this.toggleAtlasSquare
                })), o.default.createElement("div", {
                    className: "ExportGroupProperty"
                }, o.default.createElement("div", {
                    className: "ExportGroupPropertyTitle"
                }, "Crop Images (remove unused pixels)"), o.default.createElement(d.default, {
                    addClass: "ContrastToggle",
                    isOn: this.state.cropImages,
                    onToggle: this.toggleCropImages
                })), o.default.createElement("div", {
                    className: "ExportGroupProperty"
                }, o.default.createElement("div", {
                    className: "ExportGroupPropertyTitle"
                }, "Duration from Last Keyframe"), o.default.createElement(d.default, {
                    addClass: "ContrastToggle",
                    isOn: this.state.maxKeyFrameTimeIsDuration,
                    onToggle: this.toggleMaxKeyFrameTimeIsDuration
                })), o.default.createElement("div", {
                    className: "ExportGroupProperty"
                }, o.default.createElement("div", {
                    className: "SingleLabel"
                }, "Padding"), o.default.createElement(l.default, {
                    className: "SingleInput",
                    value: this.state.padding,
                    valueChanged: this.changePadding
                })))), o.default.createElement("div", {
                    className: "ModalFooter"
                }, o.default.createElement("div", {
                    className: this.state.isExporting ? "ModalFooterBtn ModalFooterBtnDisabled" : "ModalFooterBtn",
                    onClick: this.export
                }, "Export")))
            }
        }]),
        t
    }(o.default.Component)).prototype, "export", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "export"), i.prototype),
    _(i.prototype, "changePadding", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changePadding"), i.prototype),
    _(i.prototype, "changeMaxAtlasWidth", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeMaxAtlasWidth"), i.prototype),
    _(i.prototype, "changeMaxAtlasHeight", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeMaxAtlasHeight"), i.prototype),
    _(i.prototype, "changeMaxImageWidth", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeMaxImageWidth"), i.prototype),
    _(i.prototype, "changeMaxImageHeight", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeMaxImageHeight"), i.prototype),
    _(i.prototype, "toggleLinkAtlasSize", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleLinkAtlasSize"), i.prototype),
    _(i.prototype, "toggleLinkImageSize", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleLinkImageSize"), i.prototype),
    _(i.prototype, "toggleAtlasPowerOfTwo", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleAtlasPowerOfTwo"), i.prototype),
    _(i.prototype, "toggleAtlasSquare", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleAtlasSquare"), i.prototype),
    _(i.prototype, "toggleCropImages", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleCropImages"), i.prototype),
    _(i.prototype, "toggleMaxKeyFrameTimeIsDuration", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleMaxKeyFrameTimeIsDuration"), i.prototype),
    _(i.prototype, "changeEngine", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeEngine"), i.prototype),
    _(i.prototype, "onFormatSelected", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onFormatSelected"), i.prototype),
    _(i.prototype, "exit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "exit"), i.prototype),
    _(i.prototype, "openModal", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "openModal"), i.prototype),
    _(i.prototype, "closeModal", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "closeModal"), i.prototype),
    i);
    t.default = b,
    b.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = s(n(0)), a = s(n(1));
    function s(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function l(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var u = (l((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                isFocused: false,
                input: ""
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "inputFocused",
            value: function() {
                var e = Math.round(this.props.value);
                this.props.optional && (e || (e = "")),
                this.setState({
                    isFocused: true,
                    input: e
                });
                var t = this.textInput;
                setTimeout((function() {
                    t.select()
                }
                ), 0)
            }
        }, {
            key: "inputBlurred",
            value: function() {
                var e = this.state.input;
                if (null != e) {
                    var t = parseFloat(e);
                    this.props.valueChanged && (this.props.optional && !t ? t = "" : t || (t = this.props.value),
                    this.props.valueChanged(t))
                }
                this.setState({
                    isFocused: false
                })
            }
        }, {
            key: "inputText",
            value: function(e) {
                this.setState({
                    input: e.target.value
                })
            }
        }, {
            key: "keyDown",
            value: function(e) {
                switch (e.keyCode) {
                case 13:
                    this.textInput.blur();
                    break;
                case 27:
                    this.state.input = null,
                    this.textInput.blur()
                }
            }
        }, {
            key: "setTextInput",
            value: function(e) {
                this.textInput = e
            }
        }, {
            key: "render",
            value: function() {
                var e = this.state.isFocused ? this.state.input : this.props.value;
                return null === e && (e = ""),
                o.default.createElement("input", {
                    ref: this.setTextInput,
                    type: "number",
                    className: this.props.className || "LockedSizeInput",
                    value: e,
                    onKeyDown: this.keyDown,
                    onChange: this.inputText,
                    onFocus: this.inputFocused,
                    onBlur: this.inputBlurred
                })
            }
        }]),
        t
    }(o.default.Component)).prototype, "inputFocused", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "inputFocused"), i.prototype),
    l(i.prototype, "inputBlurred", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "inputBlurred"), i.prototype),
    l(i.prototype, "inputText", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "inputText"), i.prototype),
    l(i.prototype, "keyDown", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "keyDown"), i.prototype),
    l(i.prototype, "setTextInput", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setTextInput"), i.prototype),
    i);
    t.default = u
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = function(e, t) {
        if (/Safari/.test(navigator.userAgent) && /Apple Computer/.test(navigator.vendor)) {
            var n = new window.FileReader;
            n.readAsDataURL(t),
            n.onloadend = function() {
                var t = n.result;
                t = t.substr(t.indexOf(",") + 1);
                var i = document.createElement("form");
                i.setAttribute("action", "/nima/flip"),
                i.setAttribute("method", "post");
                var r = document.createElement("textarea");
                r.setAttribute("name", "body"),
                r.innerText = t,
                i.appendChild(r),
                (r = document.createElement("input")).setAttribute("name", "name"),
                r.setAttribute("value", e),
                i.appendChild(r),
                i.submit()
            }
        } else {
            var i = URL.createObjectURL(t)
              , r = document.createElement("a");
            r.setAttribute("href", i),
            r.setAttribute("download", e),
            r.dispatchEvent(new MouseEvent("click")),
            URL.revokeObjectURL(i)
        }
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = l(n(0)), a = l(n(1)), s = l(n(3));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function u(e, t) {
        if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function")
    }
    function c(e, t) {
        if (!e)
            throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    var d, h, f, p, y, m, v = (i = function(e) {
        function t() {
            return u(this, t),
            c(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "mouseDown",
            value: function() {
                this.props.onToggle && this.props.onToggle()
            }
        }, {
            key: "render",
            value: function() {
                return o.default.createElement("div", null, o.default.createElement("svg", {
                    className: this.props.linked ? "LinkToggleIcon" : "UnlinkToggleIcon",
                    onMouseDown: this.mouseDown
                }, o.default.createElement("use", {
                    xlinkHref: this.props.linked ? s.default.make("/images/symbol-defs.svg#icon-link") : s.default.make("/images/symbol-defs.svg#icon-unlink")
                })))
            }
        }]),
        t
    }(o.default.Component),
    d = i.prototype,
    h = "mouseDown",
    f = [a.default],
    p = Object.getOwnPropertyDescriptor(i.prototype, "mouseDown"),
    y = i.prototype,
    m = {},
    Object.keys(p).forEach((function(e) {
        m[e] = p[e]
    }
    )),
    m.enumerable = !!m.enumerable,
    m.configurable = !!m.configurable,
    ("value"in m || m.initializer) && (m.writable = true),
    m = f.slice().reverse().reduce((function(e, t) {
        return t(d, h, e) || e
    }
    ), m),
    y && void 0 !== m.initializer && (m.value = m.initializer ? m.initializer.call(y) : void 0,
    m.initializer = void 0),
    void 0 === m.initializer && (Object.defineProperty(d, h, m),
    m = null),
    i);
    t.default = v
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = s(n(0)), a = s(n(1));
    function s(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var l, u, c, d, h, f, p = (i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                options: e.options,
                selectedToggle: e.options[0]
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "toggleChanged",
            value: function(e) {
                var t = e.target.id;
                this.selectedToggle !== t && (this.selectedToggle = t,
                this.setState({
                    selectedToggle: t
                }),
                this.props.onSwitched && this.props.onSwitched(t))
            }
        }, {
            key: "render",
            value: function() {
                var e = []
                  , t = true
                  , n = false
                  , i = void 0;
                try {
                    for (var r, a = this.state.options[Symbol.iterator](); !(t = (r = a.next()).done); t = true) {
                        var s = r.value;
                        e.push(o.default.createElement("div", {
                            className: "textToggleButton",
                            key: s
                        }, o.default.createElement("input", {
                            type: "radio",
                            name: "optionToggle",
                            id: s,
                            checked: s === this.state.selectedToggle,
                            onChange: this.toggleChanged
                        }), o.default.createElement("label", {
                            htmlFor: s,
                            unselectable: "true"
                        }, s)))
                    }
                } catch (e) {
                    n = true,
                    i = e
                } finally {
                    try {
                        !t && a.return && a.return()
                    } finally {
                        if (n)
                            throw i
                    }
                }
                return o.default.createElement("div", {
                    className: "TextToggleButtons"
                }, e)
            }
        }]),
        t
    }(o.default.Component),
    l = i.prototype,
    u = "toggleChanged",
    c = [a.default],
    d = Object.getOwnPropertyDescriptor(i.prototype, "toggleChanged"),
    h = i.prototype,
    f = {},
    Object.keys(d).forEach((function(e) {
        f[e] = d[e]
    }
    )),
    f.enumerable = !!f.enumerable,
    f.configurable = !!f.configurable,
    ("value"in f || f.initializer) && (f.writable = true),
    f = c.slice().reverse().reduce((function(e, t) {
        return t(l, u, e) || e
    }
    ), f),
    h && void 0 !== f.initializer && (f.value = f.initializer ? f.initializer.call(h) : void 0,
    f.initializer = void 0),
    void 0 === f.initializer && (Object.defineProperty(l, u, f),
    f = null),
    i);
    t.default = p
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = O(n(0)), a = O(n(1)), s = O(n(4)), l = O(n(316)), u = O(n(310)), c = O(n(347)), d = O(n(595)), h = O(n(1202)), f = O(n(201)), p = O(n(243)), y = O(n(589)), m = O(n(372)), v = O(n(381)), g = O(n(261)), _ = n(2), b = O(n(171)), w = O(n(3));
    function O(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function S(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var k = (S((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                isExporting: false,
                capturedFrames: 0,
                exportProgress: 0,
                archiveProgress: 0,
                maxImageHeight: null,
                linkImageSize: true,
                linkAtlasSize: true,
                maxAtlasWidth: 2048,
                maxAtlasHeight: 2048,
                atlasPowerOfTwo: true,
                atlasSquare: false,
                cropImages: true,
                padding: 1,
                isModalOpen: false,
                isModalClosing: false,
                engines: [{
                    label: "PNG",
                    format: "png"
                }, {
                    label: "TGA",
                    format: "tga"
                }, {
                    label: "GIF",
                    format: "gif"
                }],
                selectedEngineIndex: 0,
                selectedAnimationIndex: 0,
                matteColor: [255, 255, 255],
                scale: 1,
                highQualityScale: false,
                conserveMemory: false
            },
            n._OldAnimation = null,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "componentWillMount",
            value: function() {
                this.exporter = new h.default;
                for (var e = this.context.nima.animations, t = [{
                    label: "All",
                    animations: e
                }], n = 0; n < e.length; n++) {
                    var i = e[n];
                    t.push({
                        label: i.name,
                        animations: [i]
                    })
                }
                this.state.animationOptions = t
            }
        }, {
            key: "getFrameRateDivisor",
            value: function() {
                return "gif" === this.state.engines[this.state.selectedEngineIndex].format ? 100 : 1e7
            }
        }, {
            key: "componentDidMount",
            value: function() {
                this.openModal(),
                this.context.nima.setCancelCallback(this.closeModal)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                clearTimeout(this.buildTimeout),
                this.context.nima.clearCancelCallback(this.closeModal)
            }
        }, {
            key: "setScale",
            value: function(e) {
                e < .1 && (e = .1),
                this.setState({
                    scale: e
                })
            }
        }, {
            key: "export",
            value: function() {
                this.state.downloadURL && URL.revokeObjectURL(this.state.downloadURL);
                var e = this.state
                  , t = e.scale
                  , n = e.highQualityScale
                  , i = this.exporter
                  , r = this.context.nima.stage
                  , o = this.context.nima.actor
                  , a = this.context.nima
                  , s = a.file.name;
                a.revisionManager.blockSaving(true);
                var l = this.state.animationOptions[this.state.selectedAnimationIndex]
                  , u = l.animations[0]
                  , c = 0
                  , d = 0
                  , h = 0;
                this.context.nima.editingAnimation = u;
                for (var b = [f.default, p.default, y.default, m.default, v.default], w = 0; w < b.length; w++) {
                    var O = r.getLayerOptions(b[w]);
                    b[w] = {
                        options: O,
                        hidden: O.disableDraw
                    },
                    O.disableDraw = true
                }
                for (var S = 0, k = 0; k < l.animations.length; k++) {
                    var P = l.animations[k];
                    P._pp = P.position;
                    var E = Math.floor(P.duration * P.getFpsWithDivisor(this.getFrameRateDivisor()));
                    E > S && (S = E)
                }
                var T = S.toString().length;
                var C = this
                  , x = {
                    setup: function() {
                        var e = {};
                        u.setPosition(d / u.getFpsWithDivisor(C.getFrameRateDivisor()), true),
                        o.advance(0, u, false);
                        var i = r.getCombinedAABB(r.filterItems((function(e) {
                            return e instanceof g.default
                        }
                        )))
                          , f = n ? 1 : t;
                        e.renderWidth = Math.ceil(f * i.boxWidth),
                        e.renderHeight = Math.ceil(f * i.boxHeight),
                        e.renderView = _.mat2d.create();
                        var p = i.min;
                        return e.renderView[0] = f,
                        e.renderView[3] = f,
                        e.renderView[4] = -Math.floor(f * p[0]),
                        e.renderView[5] = -Math.floor(f * p[1]),
                        e.aabb = i,
                        e.min = [Math.floor(f * p[0]), Math.floor(f * p[1])],
                        e.name = s + "-" + u.name + "-" + function(e, t) {
                            return (1e15 + e + "").slice(-t)
                        }(d, T),
                        d++,
                        h++,
                        d / u.getFpsWithDivisor(C.getFrameRateDivisor()) > u.duration && (d = 0,
                        ++c < l.animations.length ? (u = l.animations[c],
                        a.editingAnimation = u) : u = null),
                        u ? h % 10 == 0 && (C.setState({
                            capturedFrames: h
                        }),
                        I()) : (C.setState({
                            capturedFrames: h
                        }),
                        r.clearRenderCapture()),
                        e
                    },
                    complete: function(e, r, o) {
                        i.addFrame(this.context.name, e, r, o, this.context.min, n ? t : 1)
                    },
                    cleanup: function(e) {
                        u || function() {
                            var e = C.state.engines[C.state.selectedEngineIndex];
                            C.context.nima.editingAnimation = C._OldAnimation;
                            var t = e.format;
                            "gif" === t && (t += "-" + l.animations[0].getFpsWithDivisor(C.getFrameRateDivisor()),
                            t += "-" + C.state.matteColor[0] + "-" + C.state.matteColor[1] + "-" + C.state.matteColor[2]);
                            i.getZip(t, (function(e) {
                                var t = e;
                                C.progress != t && (C.progress = t,
                                C.setState({
                                    archiveProgress: t
                                }))
                            }
                            ), (function(t) {
                                console.log("GOT ZIP", t),
                                "gif" === e.format ? C.setState({
                                    isExporting: false,
                                    downloadURL: t,
                                    downloadFilename: D + ".gif"
                                }) : C.setState({
                                    isExporting: false,
                                    downloadURL: t,
                                    downloadFilename: D + ".zip"
                                })
                            }
                            ));
                            for (var n = 0; n < l.animations.length; n++) {
                                var r = l.animations[n];
                                r.setPosition(r._pp, true)
                            }
                            var o = true
                              , s = false
                              , u = void 0;
                            try {
                                for (var c, d = b[Symbol.iterator](); !(o = (c = d.next()).done); o = true) {
                                    var h = c.value;
                                    h.options.disableDraw = h.hidden
                                }
                            } catch (e) {
                                s = true,
                                u = e
                            } finally {
                                try {
                                    !o && d.return && d.return()
                                } finally {
                                    if (s)
                                        throw u
                                }
                            }
                            a.revisionManager.blockSaving(false)
                        }()
                    }
                };
                function I() {
                    for (var e = 0; e < 10; e++)
                        r.addRenderCapture(x)
                }
                var D = this.context.nima.file.name || "character";
                i.reset({
                    optimizeMemory: this.state.conserveMemory
                }, (function() {
                    I()
                }
                )),
                this.setState({
                    isExporting: true,
                    capturedFrames: 0,
                    exportProgress: 0,
                    archiveProgress: 0,
                    downloadURL: null
                })
            }
        }, {
            key: "changeEngine",
            value: function(e) {
                this.setState({
                    selectedEngineIndex: e
                })
            }
        }, {
            key: "changeAnimation",
            value: function(e) {
                this.setState({
                    selectedAnimationIndex: e
                })
            }
        }, {
            key: "exit",
            value: function() {
                clearTimeout(this.buildTimeout),
                this._OldAnimation ? (this.context.nima.editingAnimation !== this._OldAnimation && (this.context.nima.editingAnimation = this._OldAnimation),
                this._OldAnimation = null) : this.context.nima.editingAnimation = null,
                this.context.nima.stage.clearRenderCapture(),
                this.context.nima.revisionManager.blockSaving(false),
                this.setState({
                    isOpen: false,
                    isClosing: true
                }),
                this.props.onExportComplete()
            }
        }, {
            key: "toggleHighQualityScale",
            value: function(e) {
                this.setState({
                    highQualityScale: e
                })
            }
        }, {
            key: "toggleConserveMemory",
            value: function(e) {
                this.setState({
                    conserveMemory: e
                })
            }
        }, {
            key: "changeMatteColor",
            value: function(e) {
                this.setState({
                    matteColor: 0 === e ? [0, 0, 0] : [255, 255, 255]
                })
            }
        }, {
            key: "openModal",
            value: function() {
                this._OldAnimation = this.context.nima.editingAnimation,
                this.setState({
                    isModalOpen: true,
                    isModalClosing: false
                })
            }
        }, {
            key: "closeModal",
            value: function() {
                this._OldAnimation ? (this.context.nima.editingAnimation !== this._OldAnimation && (this.context.nima.editingAnimation = this._OldAnimation),
                this._OldAnimation = null) : this.context.nima.editingAnimation = null,
                this.context.nima.stage.clearRenderCapture(),
                this.context.nima.revisionManager.blockSaving(false),
                this.setState({
                    isModalOpen: false,
                    isModalClosing: true
                }),
                this.props.onExportComplete()
            }
        }, {
            key: "render",
            value: function() {
                for (var e = this.state.animationOptions[this.state.selectedAnimationIndex], t = this.state.engines[this.state.selectedEngineIndex], n = 0, i = 0; i < e.animations.length; i++) {
                    var r = e.animations[i];
                    n += Math.floor(r.duration * r.getFpsWithDivisor(this.getFrameRateDivisor()))
                }
                var a = null;
                return "gif" === t.format && (a = ["Black", "White"]),
                o.default.createElement(b.default, {
                    addClass: "ExportModal",
                    isOpen: this.state.isModalOpen,
                    isClosing: this.state.isModalClosing,
                    onClose: this.closeModal
                }, o.default.createElement("div", {
                    className: "ModalHeader"
                }, o.default.createElement("svg", {
                    className: "ModalIcon ExportShotModalIcon"
                }, o.default.createElement("use", {
                    xlinkHref: w.default.make("/images/symbol-defs.svg#icon-image-sequence")
                })), o.default.createElement("div", {
                    className: "ModalHeadline"
                }, "Export Image Sequence"), o.default.createElement("div", {
                    className: "ModalSubHeadline"
                }, "Image sequences are rendered at your FPS setting. Bounds and dimensions are automatically calculated.")), o.default.createElement("div", {
                    className: "ModalContent"
                }, o.default.createElement("div", {
                    className: "ExportGroup"
                }, o.default.createElement("div", {
                    className: "ExportGroupProperty"
                }, o.default.createElement("div", {
                    className: "LockedSizeLabel"
                }, "Type:"), o.default.createElement(l.default, {
                    options: this.state.engines,
                    selectedIndex: this.state.selectedEngineIndex,
                    onSelectionChanged: this.changeEngine,
                    addClass: "ExportOptionsDropdown",
                    disabled: this.state.isExporting
                }))), o.default.createElement("div", {
                    className: "ExportGroup"
                }, o.default.createElement("div", {
                    className: "ExportGroupProperty"
                }, o.default.createElement("div", {
                    className: "SingleLabel"
                }, "Animation"), o.default.createElement(l.default, {
                    options: this.state.animationOptions,
                    selectedIndex: this.state.selectedAnimationIndex,
                    onSelectionChanged: this.changeAnimation,
                    addClass: "ExportOptionsDropdown"
                })), o.default.createElement("div", {
                    className: "ExportGroupProperty"
                }, o.default.createElement("div", {
                    className: "SingleLabel"
                }, "Frames"), n), o.default.createElement("div", {
                    className: "ExportGroupProperty"
                }, o.default.createElement("div", {
                    className: "SingleLabel"
                }, "Scale"), o.default.createElement(c.default, {
                    value: this.state.scale,
                    converter: d.default,
                    onValueChanged: this.setScale,
                    addClass: "ContrastInput"
                })), o.default.createElement("div", {
                    className: "ExportGroupProperty"
                }, o.default.createElement("div", {
                    className: "SingleLabel"
                }, "High Quality Scale"), o.default.createElement(u.default, {
                    addClass: "ContrastToggle",
                    isOn: this.state.highQualityScale,
                    onToggle: this.toggleHighQualityScale
                })), a ? o.default.createElement("div", {
                    className: "ExportGroupProperty"
                }, o.default.createElement("div", {
                    className: "SingleLabel"
                }, "Matte"), o.default.createElement(l.default, {
                    options: a,
                    selectedIndex: 255 === this.state.matteColor[0] ? 1 : 0,
                    onSelectionChanged: this.changeMatteColor,
                    addClass: "ExportOptionsDropdown"
                })) : null), o.default.createElement("div", {
                    className: "ExportGroup"
                }, o.default.createElement("div", {
                    className: "ExportGroupTitle"
                }, "Memory"), o.default.createElement("div", {
                    className: "ExportGroupProperty"
                }, o.default.createElement("div", {
                    className: "LockedSizeLabel"
                }, "Conserve Memory (slower)"), o.default.createElement(u.default, {
                    addClass: "ContrastToggle",
                    isOn: this.state.conserveMemory,
                    onToggle: this.toggleConserveMemory
                }))), this.state.isExporting ? o.default.createElement("div", {
                    className: "ExportGroup"
                }, o.default.createElement("div", {
                    className: "ExportGroupTitle"
                }, "Export Progress"), o.default.createElement("div", {
                    className: "ExportGroupProperty"
                }, o.default.createElement("div", {
                    className: "SingleLabel"
                }, "Rendering"), Math.min(n, this.state.capturedFrames) + "/" + n), o.default.createElement("div", {
                    className: "ExportGroupProperty"
                }, o.default.createElement("div", {
                    className: "SingleLabel"
                }, "Archiving"), this.state.archiveProgress + "%"), this.state.downloadURL ? o.default.createElement("div", {
                    className: "ExportGroupProperty"
                }, o.default.createElement("div", {
                    className: "SingleLabel"
                }, "Download Link"), o.default.createElement("a", {
                    href: this.state.downloadURL,
                    download: this.state.downloadFilename
                }, this.state.downloadFilename)) : null) : null, this.state.downloadURL ? o.default.createElement("div", {
                    className: "ExportGroup"
                }, o.default.createElement("div", {
                    className: "ExportGroupProperty"
                }, o.default.createElement("div", {
                    className: "SingleLabel"
                }, "Download Link"), o.default.createElement("a", {
                    href: this.state.downloadURL,
                    download: this.state.downloadFilename
                }, this.state.downloadFilename))) : null, null), o.default.createElement("div", {
                    className: "ModalFooter"
                }, o.default.createElement("div", {
                    className: this.state.isExporting ? "ModalFooterBtn ModalFooterBtnDisabled" : "ModalFooterBtn",
                    onClick: this.export
                }, "Export")))
            }
        }]),
        t
    }(o.default.Component)).prototype, "setScale", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setScale"), i.prototype),
    S(i.prototype, "export", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "export"), i.prototype),
    S(i.prototype, "changeEngine", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeEngine"), i.prototype),
    S(i.prototype, "changeAnimation", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeAnimation"), i.prototype),
    S(i.prototype, "exit", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "exit"), i.prototype),
    S(i.prototype, "toggleHighQualityScale", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleHighQualityScale"), i.prototype),
    S(i.prototype, "toggleConserveMemory", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "toggleConserveMemory"), i.prototype),
    S(i.prototype, "changeMatteColor", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "changeMatteColor"), i.prototype),
    S(i.prototype, "openModal", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "openModal"), i.prototype),
    S(i.prototype, "closeModal", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "closeModal"), i.prototype),
    i);
    t.default = k,
    k.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = n(1203), a = (i = o) && i.__esModule ? i : {
        default: i
    };
    var s = function() {
        function e() {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e),
            this._Worker = new a.default
        }
        return r(e, [{
            key: "reset",
            value: function(e, t) {
                this._Worker.reset(e, t)
            }
        }, {
            key: "addFrame",
            value: function(e, t, n, i, r, o) {
                this._Worker.addFrame(e, t, n, i, r, o)
            }
        }, {
            key: "getZip",
            value: function(e, t, n) {
                this._Worker.zipFrames(e, (function(e) {
                    return e.constructor === Number ? (t(e),
                    true) : (n(e),
                    false)
                }
                ))
            }
        }]),
        e
    }();
    t.default = s
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = function() {
        var e = new Worker(o.default.getWorkerScript("ImageSequenceWorker.js"))
          , t = 0
          , n = {};
        function i(i, r, o) {
            t++,
            o && (n[t] = o),
            r.push(t),
            e.postMessage({
                call: i,
                arguments: r
            })
        }
        var r = document.createElement("canvas");
        e.onmessage = function(e) {
            if ("PNG" === e.data.id) {
                var t = e.data.width
                  , o = e.data.height
                  , a = e.data.pixels;
                r.width = t,
                r.height = o;
                for (var s = r.getContext("2d"), l = new Uint8ClampedArray(a.length), u = 0; u < o; u++)
                    for (var c = 0; c < t; c++)
                        for (var d = 4 * (u * t + c), h = 4 * ((o - u - 1) * t + c), f = 0; f < 4; f++)
                            l[h + f] = a[d + f];
                var p = new ImageData(l,t,o);
                return s.putImageData(p, 0, 0),
                void r.toBlob((function(e) {
                    i("PNG", [e])
                }
                ))
            }
            var y = n[e.data.id];
            if (y) {
                if (y(e.data.response))
                    return;
                delete n[e.data.id]
            }
        }
        ,
        this.reset = function(e, t) {
            i("reset", [e], t)
        }
        ,
        this.addFrame = function(e, t, n, r, o, a) {
            i("addFrame", [e, t, n, r, o, a])
        }
        ,
        this.zipFrames = function(e, t) {
            i("zipFrames", [e], t)
        }
        ,
        this.call = i
    }
    ;
    var i, r = n(262), o = (i = r) && i.__esModule ? i : {
        default: i
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = d(n(0)), a = d(n(1)), s = d(n(4)), l = d(n(1205)), u = d(n(1206)), c = d(n(1207));
    function d(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function h(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var f = (h((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                dimensions: null
            },
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "componentWillMount",
            value: function() {
                this.direction = 1
            }
        }, {
            key: "componentWillUnmount",
            value: function() {}
        }, {
            key: "componentDidMount",
            value: function() {
                var e = this.root.getBoundingClientRect();
                this.setState({
                    dimensions: e
                })
            }
        }, {
            key: "hideRecursiveSubMenu",
            value: function(e) {
                e.showingMenu && (this.hideRecursiveSubMenu(e.showingMenu),
                this.props.onHide(e.showingMenu),
                e.showingMenu = null)
            }
        }, {
            key: "enterItem",
            value: function(e) {
                this.props.data.showingMenu !== e.props.data && this.hideRecursiveSubMenu(this.props.data)
            }
        }, {
            key: "enter",
            value: function(e) {}
        }, {
            key: "buildItemList",
            value: function(e, n) {
                var i = [];
                if (!e)
                    return i;
                for (var r = 2 * t.Margin, a = 0; a < e.items.length; a++) {
                    var s = e.items[a];
                    "Divider" == s.type ? (i.push(o.default.createElement(l.default, {
                        key: a,
                        onMouseEnter: this.enterItem
                    })),
                    r += t.DividerHeight) : "SubMenu" == s.type ? (r += t.ItemHeight,
                    i.push(o.default.createElement(u.default, {
                        parent: e,
                        parentComponent: n,
                        key: s.name,
                        data: s,
                        onMouseEnter: this.enterItem
                    }))) : (r += t.ItemHeight,
                    i.push(o.default.createElement(c.default, {
                        key: a,
                        data: s,
                        onMouseEnter: this.enterItem
                    })))
                }
                return e.height = r,
                i
            }
        }, {
            key: "setRoot",
            value: function(e) {
                this.root = e
            }
        }, {
            key: "queueRemove",
            value: function(e) {
                2 === e.button ? this.willRemove = true : this.willRemove = false
            }
        }, {
            key: "removeIfQueued",
            value: function(e) {
                if (2 === e.button && this.willRemove) {
                    var t = this;
                    setTimeout((function() {
                        t.context.nima.removeContextMenus()
                    }
                    ), 10)
                }
            }
        }, {
            key: "render",
            value: function() {
                var e = this.props.data || {
                    x: 0,
                    y: 0,
                    items: []
                }
                  , t = this.buildItemList(e, this)
                  , n = e.parentComponent ? e.x : e.x + 2
                  , i = Math.min(window.innerHeight - e.height - 20, e.y);
                e.parentComponent && (i -= 10);
                var r = this.state.dimensions;
                return r && (r.right > window.innerWidth - 20 ? e.parentComponent ? (n -= e.parentComponent.state.dimensions.width + r.width,
                this.direction = -1) : n = e.x - (r.width + 2) : e.parentComponent && -1 == e.parentComponent.direction && (n -= e.parentComponent.state.dimensions.width + r.width)),
                o.default.createElement("div", {
                    ref: this.setRoot,
                    onMouseDown: this.queueRemove,
                    onMouseUp: this.removeIfQueued,
                    className: "RightClickMenu",
                    style: {
                        opacity: null == r ? 0 : null,
                        left: n + "px",
                        top: i + "px"
                    },
                    onMouseEnter: this.enter
                }, t)
            }
        }]),
        t
    }(o.default.Component)).prototype, "enterItem", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "enterItem"), i.prototype),
    h(i.prototype, "enter", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "enter"), i.prototype),
    h(i.prototype, "setRoot", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setRoot"), i.prototype),
    h(i.prototype, "queueRemove", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "queueRemove"), i.prototype),
    h(i.prototype, "removeIfQueued", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "removeIfQueued"), i.prototype),
    i);
    t.default = f,
    f.MaxWidth = 200,
    f.Margin = 10,
    f.ItemHeight = 35,
    f.DividerHeight = 21,
    f.contextTypes = {
        nima: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = l(n(0)), a = l(n(1)), s = l(n(4));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function u(e, t) {
        if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function")
    }
    function c(e, t) {
        if (!e)
            throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    function d(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var h = (d((i = function(e) {
        function t() {
            return u(this, t),
            c(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "enter",
            value: function(e) {
                this.context.editor.setContextMenuItemData(this),
                this.props.onMouseEnter && this.props.onMouseEnter(this)
            }
        }, {
            key: "leave",
            value: function(e) {
                this.context.editor.clearContextMenuItemData(this)
            }
        }, {
            key: "render",
            value: function() {
                return o.default.createElement("div", {
                    className: "RightClickDivider",
                    onMouseEnter: this.enter,
                    onMouseLeave: this.leave
                })
            }
        }]),
        t
    }(o.default.Component)).prototype, "enter", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "enter"), i.prototype),
    d(i.prototype, "leave", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "leave"), i.prototype),
    i);
    t.default = h,
    h.contextTypes = {
        editor: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = l(n(0)), a = l(n(1)), s = l(n(4));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function u(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var c = (u((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {},
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "enter",
            value: function(e) {
                if (this.props.onMouseEnter && this.props.onMouseEnter(this),
                this.props.parent.showingMenu !== this.props.data) {
                    var t = this.root.getBoundingClientRect();
                    this.props.data.x = t.right,
                    this.props.data.y = t.top,
                    this.props.data.parent = this.props.parent,
                    this.props.data.parentComponent = this.props.parentComponent,
                    this.props.parent.showingMenu = this.props.data,
                    this.context.editor.addContextMenu(this.props.data),
                    this.context.editor.setContextMenuItemData(this.props.data)
                }
            }
        }, {
            key: "leave",
            value: function(e) {
                this.context.editor.clearContextMenuItemData(this.props.data)
            }
        }, {
            key: "setRoot",
            value: function(e) {
                this.root = e
            }
        }, {
            key: "render",
            value: function() {
                var e = this.props.data;
                return o.default.createElement("div", {
                    ref: this.setRoot,
                    key: e.name,
                    className: "RightClickListItem ListItemSubMenu",
                    onMouseEnter: this.enter,
                    onMouseLeave: this.leave
                }, e.name, o.default.createElement("div", {
                    className: "SubMenuArrow"
                }, o.default.createElement("div", null)))
            }
        }]),
        t
    }(o.default.Component)).prototype, "enter", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "enter"), i.prototype),
    u(i.prototype, "leave", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "leave"), i.prototype),
    u(i.prototype, "setRoot", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "setRoot"), i.prototype),
    i);
    t.default = c,
    c.contextTypes = {
        editor: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = u(n(0)), a = u(n(1)), s = u(n(4)), l = u(n(3));
    function u(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function c(e, t) {
        if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function")
    }
    function d(e, t) {
        if (!e)
            throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    function h(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var f = (h((i = function(e) {
        function t() {
            return c(this, t),
            d(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "enter",
            value: function(e) {
                this.context.editor.setContextMenuItemData(this.props.data),
                this.props.onMouseEnter && this.props.onMouseEnter(this)
            }
        }, {
            key: "leave",
            value: function(e) {
                this.context.editor.clearContextMenuItemData(this.props.data)
            }
        }, {
            key: "render",
            value: function() {
                var e = this.props.data;
                return o.default.createElement("div", {
                    className: e.isActive ? "RightClickListItemActive" : "RightClickListItem",
                    onMouseEnter: this.enter,
                    onMouseLeave: this.leave
                }, e.icon ? o.default.createElement("svg", {
                    className: "RightClickListIcon"
                }, o.default.createElement("use", {
                    xlinkHref: l.default.make("/images/symbol-defs.svg#icon-" + e.icon)
                })) : null, e.name)
            }
        }]),
        t
    }(o.default.Component)).prototype, "enter", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "enter"), i.prototype),
    h(i.prototype, "leave", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "leave"), i.prototype),
    i);
    t.default = f,
    f.contextTypes = {
        editor: s.default.object
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r, o = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), a = l(n(0)), s = l(n(1));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function u(e, t) {
        if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function")
    }
    function c(e, t) {
        if (!e)
            throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    function d(e, t) {
        if ("function" != typeof t && null !== t)
            throw new TypeError("Super expression must either be null or a function, not " + typeof t);
        e.prototype = Object.create(t && t.prototype, {
            constructor: {
                value: e,
                enumerable: false,
                writable: true,
                configurable: true
            }
        }),
        t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
    }
    function h(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var f = (h((i = function(e) {
        function t(e) {
            u(this, t);
            var n = c(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.state = {
                isOpen: false,
                hasHover: false
            },
            n
        }
        return d(t, e),
        o(t, [{
            key: "componentWillMount",
            value: function() {
                window.addEventListener("click", this.close, true)
            }
        }, {
            key: "close",
            value: function() {
                this.setState({
                    isOpen: false
                });
                var e = this;
                clearTimeout(this.closeTimeout),
                this.props.onHiding(this.props.data),
                this.closeTimeout = setTimeout((function() {
                    e.props.onHide(e.props.data)
                }
                ), 200)
            }
        }, {
            key: "componentDidMount",
            value: function() {
                var e = this.dropdownPanel.getBoundingClientRect().height;
                this.setState({
                    height: e,
                    isOpen: true
                })
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                window.removeEventListener("click", this.close, true)
            }
        }, {
            key: "select",
            value: function(e) {
                this.props.data.onSelectionChanged && this.props.data.onSelectionChanged(e),
                this.close()
            }
        }, {
            key: "setDropdownPanel",
            value: function(e) {
                this.dropdownPanel = e
            }
        }, {
            key: "hoverOn",
            value: function(e) {
                this.setState({
                    hasHover: true,
                    descTitle: e.hoverTitle,
                    descBody: e.hoverDesc,
                    descIcon: e.hoverIcon
                })
            }
        }, {
            key: "hoverDescOn",
            value: function(e) {
                this.setState({
                    hasHover: true
                }),
                window.removeEventListener("click", this.close, true)
            }
        }, {
            key: "hoverDescOff",
            value: function(e) {
                this.setState({
                    hasHover: false
                }),
                window.addEventListener("click", this.close, true)
            }
        }, {
            key: "hoverOff",
            value: function(e) {
                this.setState({
                    hasHover: false
                })
            }
        }, {
            key: "selectOption",
            value: function(e) {
                var t = this.props.data.options.indexOf(e);
                this.select(t)
            }
        }, {
            key: "render",
            value: function() {
                var e = this
                  , t = this.props.data.options
                  , n = this.props.data.dropdownClass
                  , i = this.props.data.rect.y + 25 * t.length
                  , r = i > window.innerHeight ? window.innerHeight - this.props.data.rect.y - 50 : i;
                return a.default.createElement("div", {
                    className: n ? n + " DropdownPanel" : "DropdownPanel",
                    style: {
                        opacity: this.state.isOpen ? "1" : "0",
                        marginTop: this.state.isOpen ? "-14px" : "-24px",
                        height: this.state.isOpen ? this.state.height : "0px",
                        maxHeight: r,
                        left: this.props.data.rect.left + "px",
                        top: this.props.data.rect.top + "px",
                        minWidth: this.props.data.rect.width + 30 + "px"
                    }
                }, a.default.createElement("div", {
                    className: "DropdownPanelDesc",
                    onMouseOver: this.hoverDescOn,
                    onMouseLeave: this.hoverDescOff,
                    style: {
                        width: this.state.hasHover ? null : "0px"
                    }
                }, a.default.createElement("div", {
                    className: "DropdownPanelDescContent"
                }, this.state.descIcon ? a.default.createElement("div", {
                    className: "DropdownPanelDescIcon",
                    dangerouslySetInnerHTML: {
                        __html: this.state.descIcon
                    }
                }) : null, a.default.createElement("div", {
                    className: "DropdownPanelDescTitle"
                }, this.state.descTitle), a.default.createElement("div", {
                    className: "DropdownPanelDescBody",
                    dangerouslySetInnerHTML: {
                        __html: this.state.descBody
                    }
                }))), a.default.createElement("div", {
                    className: "DropdownPanelScroll",
                    style: {
                        overflowY: r < this.state.height ? "scroll" : null
                    }
                }, a.default.createElement("div", {
                    className: "DropdownPanelCalcHeight",
                    ref: this.setDropdownPanel
                }, t.map((function(t) {
                    return a.default.createElement(p, {
                        key: t.label,
                        hoverTitle: t.hoverTitle,
                        label: t.label,
                        active: t.active,
                        option: t,
                        hoverOn: e.hoverOn,
                        hoverOff: e.hoverOff,
                        select: e.selectOption
                    })
                }
                )))))
            }
        }]),
        t
    }(a.default.Component)).prototype, "close", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "close"), i.prototype),
    h(i.prototype, "select", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "select"), i.prototype),
    h(i.prototype, "setDropdownPanel", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "setDropdownPanel"), i.prototype),
    h(i.prototype, "hoverOn", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "hoverOn"), i.prototype),
    h(i.prototype, "hoverDescOn", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "hoverDescOn"), i.prototype),
    h(i.prototype, "hoverDescOff", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "hoverDescOff"), i.prototype),
    h(i.prototype, "hoverOff", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "hoverOff"), i.prototype),
    h(i.prototype, "selectOption", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "selectOption"), i.prototype),
    i);
    t.default = f;
    var p = (h((r = function(e) {
        function t() {
            return u(this, t),
            c(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments))
        }
        return d(t, e),
        o(t, [{
            key: "hoverOn",
            value: function(e) {
                e.preventDefault(),
                e.stopPropagation(),
                this.props.hoverOn && this.props.hoverOn(this.props.option)
            }
        }, {
            key: "hoverOff",
            value: function(e) {
                e.preventDefault(),
                e.stopPropagation(),
                this.props.hoverOff && this.props.hoverOff(this.props.option)
            }
        }, {
            key: "mouseDown",
            value: function() {
                this.props.select && this.props.select(this.props.option)
            }
        }, {
            key: "render",
            value: function() {
                var e = this.props.option
                  , t = e.hoverTitle
                  , n = e.label
                  , i = e.active;
                return a.default.createElement("div", {
                    className: i ? "DropdownOptionActive" : "DropdownOption",
                    onMouseEnter: t ? this.hoverOn : null,
                    onMouseLeave: t ? this.hoverOff : null,
                    onClick: this.mouseDown
                }, n)
            }
        }]),
        t
    }(a.default.Component)).prototype, "hoverOn", [s.default], Object.getOwnPropertyDescriptor(r.prototype, "hoverOn"), r.prototype),
    h(r.prototype, "hoverOff", [s.default], Object.getOwnPropertyDescriptor(r.prototype, "hoverOff"), r.prototype),
    h(r.prototype, "mouseDown", [s.default], Object.getOwnPropertyDescriptor(r.prototype, "mouseDown"), r.prototype),
    r)
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = B(n(1)), a = B(n(12)), s = B(n(184)), l = B(n(1210)), u = B(n(1215)), c = B(n(361)), d = B(n(1219)), h = B(n(1221)), f = B(n(1222)), p = B(n(463)), y = B(n(698)), m = B(n(358)), v = B(n(237)), g = B(n(398)), _ = B(n(267)), b = B(n(447)), w = B(n(464)), O = B(n(729)), S = B(n(1223)), k = B(n(9)), P = B(n(261)), E = B(n(383)), T = B(n(371)), C = B(n(410)), x = B(n(343)), I = B(n(11)), D = B(n(208)), M = B(n(344)), A = B(n(580)), j = B(n(13)), L = B(n(342)), R = B(n(0)), F = B(n(165));
    function B(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function V(e) {
        if (Array.isArray(e)) {
            for (var t = 0, n = Array(e.length); t < e.length; t++)
                n[t] = e[t];
            return n
        }
        return Array.from(e)
    }
    function N(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var z = (N((i = function(e) {
        function t(e, n, i, r, o, a) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var s = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this));
            s._BuildNumber = o,
            s._Graphics = new l.default(e),
            s._Canvas = e,
            s._EditorUI = n,
            s._UserPreferences = r || {},
            s._User = i,
            s._Author = a.owner,
            s._Actor = null,
            s._LastAdvanceTime,
            s._AdvanceTimeout,
            s._IsDrawing = false,
            s._LowFrequencyAdvanceTime = 1 / 15 * 1e3,
            s._StartedDrawingTime = performance.now(),
            s._EditingAnimation,
            s._EditingMesh,
            s._EditingWeights,
            s._IsAnimationEnabled = false,
            s._AutoKey = true,
            s._ErrorKey = null,
            s._File = a || null,
            s._ProjectPreferences = {},
            s._LocalPreferences = {},
            s._FilePreferences = {},
            s._RevisionManager = new u.default(s),
            s._RevisionManager.addEventListener("fileLoaded", s.onFileLoaded),
            s._RevisionManager.addEventListener("fileRenamed", s.onFileRenamed),
            s._RevisionManager.addEventListener("stateChanged", s.onRMStateChanged),
            s._RMSaveAlert,
            s._ExpiredAlert,
            s._LastMouseX = 0,
            s._LastMouseY = 0,
            s._IncBrushSizeCallback = null,
            s._IncBrushFeatherCallback = null,
            s._IncBrushStrengthCallback = null,
            s._SelectIndexItemCallback = null,
            s._SelectIndexItemNextCallback = null,
            s._SelectIndexItemPreviousCallback = null,
            s._CleanupEvents = [],
            s._IsDragging = false,
            s._IsExporting = false,
            s._LastReportTime = 0,
            s._FileAccess = x.default.Unknown,
            s._Journal = [],
            s._JournalIndex = -1,
            s._CancelCallback = null,
            s._SelectedItems = [],
            s._SaveLocalPreferencesTimeout = null,
            s._SaveUserPreferencesTimeout = null,
            s._SaveProjectPreferencesTimeout = null,
            s._SaveCharacterPreferencesTimeout = null,
            s._ReplaceTargets = null,
            s._WasCompensating = {
                compensateBones: false,
                compensateImages: false
            },
            s._ExpandedHierarchyItems = new Set;
            var c, f = localStorage.getItem("preferences-" + s._User.id);
            if (f)
                try {
                    f = JSON.parse(f)
                } catch (e) {
                    console.warn("Failed to parse local preferences.")
                }
            for (var p in c = a.preferences || {},
            f = f || {},
            s._FilePreferences = c || {},
            f)
                s._LocalPreferences[p] = f[p];
            "dev-build" !== s._BuildNumber && (s._OldErrorHandler = window.onerror,
            window.onerror = s.onError),
            s._Stage = new d.default(s,e,s._Graphics),
            s._Stage.addEventListener("itemVisibilityChanged", s.onStageItemVisibilityChanged),
            s._AnimationEditor = new h.default(s),
            s._Graphics.isLoading ? s._Graphics.advanceProgress = s.checkGraphicsProgress : s.onAppReady();
            var y = document.body;
            return y.addEventListener("dragover", s.dragOver),
            y.addEventListener("dragleave", s.dragLeave),
            y.addEventListener("drop", s.dragDrop),
            s
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [
            {
            key: "cleanup",
            value: function() {
                this.editingAnimation = null,
                this._RevisionManager.removeEventListener("fileLoaded", this.onFileLoaded),
                this._RevisionManager.removeEventListener("fileRenamed", this.onFileRenamed),
                this._RevisionManager.removeEventListener("stateChanged", this.onRMStateChanged),
                this._RevisionManager.cleanup(),
                window.removeEventListener("contextmenu", this.onContextMenu, false),
                window.removeEventListener("focus", this.onFocus),
                this._Canvas.removeEventListener("mousedown", this.onMouseDown),
                window.removeEventListener("mouseup", this.onMouseUp),
                window.removeEventListener("mousemove", this.onMouseMove),
                document.body.removeEventListener("drag", this.onDrag),
                this._Canvas.removeEventListener("mouseenter", this.onMouseEnterCanvas),
                this._Canvas.removeEventListener("mouseleave", this.onMouseLeaveCanvas),
                this._Canvas.removeEventListener("wheel", this.onMouseWheel),
                window.removeEventListener("mouseenter", this.onMouseEnterWindow),
                window.removeEventListener("mouseleave", this.onMouseLeaveWindow),
                window.removeEventListener("blur", this.onBlur),
                document.removeEventListener("keydown", this.onKeyDown),
                document.removeEventListener("keyup", this.onKeyUp)
            }
        }, {
            key: "onStageItemVisibilityChanged",
            value: function() {
                !this._EditingAnimation || this._Actor.hasPlayingAnimations || this._IsDragging || this._EditingAnimation.updateNodes()
            }
        }, {
            key: "onRMStateChanged",
            value: function(e) {
                e.state == c.default.Idle ? this._RMSaveAlert && (this._RMSaveAlert.hide(),
                this._RMSaveAlert = null) : e.state == c.default.Save && (this._RMSaveAlert = this.alert({
                    title: "Saving is taking a bit longer than usual.",
                    message: "Please don't close your browser until this message has disappeared.",
                    type: s.default.Types.Saving,
                    buttons: [],
                    delaySeconds: 10,
                    minimumDisplaySeconds: 2
                }))
            }
        }, {
            key: "onFileLoaded",
            value: function(e) {
                this.setActor(e.actor),
                e.settings && this.deserializeSettings(e.settings),
                this.dispatch("fileLoaded", e.actor),
                this._Stage.updateSettings()
            }
        }, {
            key: "onFileRenamed",
            value: function(e) {
                document.title = e.name,
                this.dispatch("fileRenamed", e)
            }
        }, {
            key: "checkGraphicsProgress",
            value: function(e, t) {
                this._Graphics.isLoading ? console.log("Graphics loading", Math.round(100 * e) + "%. (" + t + ")") : this._Graphics.loadError ? console.log("Graphics load error", this._Graphics.loadError + ". (" + t + ")") : (console.log("Graphics ready. (" + t + ")"),
                this.onAppReady())
            }
        }, {
            key: "advance",
            value: function() {
                var e = performance.now()
                  , t = (e - this._LastAdvanceTime) / 1e3;
                this._LastAdvanceTime = e;
                var n = this._Stage
                  , i = this._Actor
                  , r = i && i.advance(t, this._EditingAnimation, this._IsExporting, this)
                  , o = n.advance(t)
                  , a = this._LocalPreferences.scaleRetina && window.devicePixelRatio || 1
                  , s = n.setSize(window.innerWidth * a, window.innerHeight * a, a);
                s || r || o ? (this._IsDrawing || (this._IsDrawing = true,
                this._StartedDrawingTime = performance.now()),
                this.draw(),
                s && this._EditorUI.resizePanels()) : this._IsDrawing && (this._IsDrawing = false),
                this.scheduleAdvance()
            }
        }, {
            key: "draw",
            value: function() {
                this._Stage.draw(),
                this._EditorUI.drawRulers();
                var e = this._EditorUI.getGuides();
                e && e.length && this._Stage.drawGuides(e)
            }
        }, {
            key: "updateWindowSize",
            value: function() {
                this._Stage.setSize(window.innerWidth, window.innerHeight)
            }
        }, {
            key: "scheduleAdvance",
            value: function() {
                clearTimeout(this._AdvanceTimeout),
                document.hasFocus() ? window.requestAnimationFrame(this.advance) : this._AdvanceTimeout = setTimeout(this.advance, this._LowFrequencyAdvanceTime)
            }
        }, {
            key: "onContextMenu",
            value: function(e) {
                e.preventDefault()
            }
        }, {
            key: "onFocus",
            value: function(e) {
                this.scheduleAdvance()
            }
        }, {
            key: "onMouseDown",
            value: function(e) {
                this._Stage.onMouseDown(e)
            }
        }, {
            key: "onMouseUp",
            value: function(e) {
                this._Stage.onMouseUp(e)
            }
        }, {
            key: "onMouseMove",
            value: function(e) {
                var t = e.clientX - this._LastMouseX
                  , n = e.clientY - this._LastMouseY;
                this._LastMouseX = e.clientX,
                this._LastMouseY = e.clientY,
                this._Stage.onMouseMove(e, t, n)
            }
        }, {
            key: "onDrag",
            value: function(e) {
                var t = e.clientX - this._LastMouseX
                  , n = e.clientY - this._LastMouseY;
                this._LastMouseX = e.clientX,
                this._LastMouseY = e.clientY,
                this._Stage.onMouseMove(e, t, n)
            }
        }, {
            key: "onMouseEnterCanvas",
            value: function(e) {
                this._Stage.onMouseEnterStage(e)
            }
        }, {
            key: "onMouseLeaveCanvas",
            value: function(e) {
                this._Stage.onMouseLeaveStage(e)
            }
        }, {
            key: "onMouseEnterWindow",
            value: function(e) {
                this._Stage.onMouseEnter(e)
            }
        }, {
            key: "onMouseLeaveWindow",
            value: function(e) {
                this._Stage.onMouseLeave(e)
            }
        }, {
            key: "onMouseWheel",
            value: function(e) {
                this._Stage.onMouseWheel(e)
            }
        }, {
            key: "onBlur",
            value: function(e) {
                this.dispatch("blur")
            }
        }, {
            key: "onKeyDown",
            value: function(e) {
                if (k.default.isSearchAction(e) && e.preventDefault(),
                (this._EditorUI.state.showCrashError || !(116 === e.keyCode || k.default.isOSX && 82 === e.keyCode && e.metaKey || !k.default.isOSX && 82 === e.keyCode && e.ctrlKey) || !this.preventBrowserRefresh(e)) && e.target.constructor === HTMLBodyElement) {
                    if (this._Stage.onKeyDown(e))
                        return;
                    this.dispatch("keyDown", e)
                }
            }
        }, {
            key: "onKeyUp",
            value: function(e) {
                if (e.target.constructor === HTMLBodyElement) {
                    if (this._Stage.onKeyUp(e))
                        return;
                    this.dispatch("keyUp", e)
                }
            }
        }, {
            key: "onAppReady",
            value: function() {
                window.stage = this._Stage,
                window.addEventListener("contextmenu", this.onContextMenu, false),
                window.addEventListener("focus", this.onFocus),
                this._Canvas.addEventListener("mousedown", this.onMouseDown),
                window.addEventListener("mouseup", this.onMouseUp),
                window.addEventListener("mousemove", this.onMouseMove),
                document.body.addEventListener("drag", this.onDrag),
                this._Canvas.addEventListener("mouseenter", this.onMouseEnterCanvas),
                this._Canvas.addEventListener("mouseleave", this.onMouseLeaveCanvas),
                this._Canvas.addEventListener("wheel", this.onMouseWheel),
                window.addEventListener("mouseenter", this.onMouseEnterWindow),
                window.addEventListener("mouseleave", this.onMouseLeaveWindow),
                window.addEventListener("blur", this.onBlur),
                document.addEventListener("keydown", this.onKeyDown),
                document.addEventListener("keyup", this.onKeyUp),
                this._LastAdvanceTime = performance.now(),
                this._Canvas.style.display = "",
                this.updateWindowSize(),
                this.scheduleAdvance(),
                this.dispatch("ready")
            }
        }, {
            key: "showFork",
            value: function() {
                var e = this
                  , t = {
                    label: "Fork",
                    action: function(t, i) {
                        n.hide(),
                        e._EditorUI.showFilesModal(null, (function(t, n, i) {
                            if (t) {
                                var r = e.alert({
                                    title: "Forking.",
                                    message: "Copying to your files, this may take a minute...",
                                    type: s.default.Types.Saving,
                                    buttons: []
                                });
                                e._RevisionManager.fork(t, n, (function(t, n) {
                                    t ? window.location = "/a/" + e._User.username + "/files/" + n.product + "/" + n.slug : (r.hide(),
                                    e.alert({
                                        title: "Fork Failed.",
                                        message: "Unnable to fork file, please try again in a few moments.",
                                        type: s.default.Types.Default,
                                        buttons: []
                                    }),
                                    i(false))
                                }
                                ))
                            } else
                                e.showFork()
                        }
                        ))
                    }
                }
                  , n = this.alert({
                    type: s.default.Types.Avatar,
                    blockClose: true,
                    avatar: this._Author.avatar,
                    link: "/a/" + this._Author.username,
                    customTitleRenderer: function() {
                        return R.default.createElement("span", null, R.default.createElement("a", {
                            href: "/a/" + e._Author.username
                        }, e._Author.name), "'s file.")
                    },
                    title: this._Author.name + "'s file.",
                    message: this._FileAccess === x.default.Fork ? "To make changes, fork it to Your Files." : "This file is read only.",
                    buttons: this._FileAccess === x.default.Fork ? [t] : null
                })
            }
        }, {
            key: "loadFile",
            value: function() {
                var e = this
                  , t = this._File;
                if (this._FileAccess = x.default.fromString(t.access),
                this._RevisionManager.load(t.owner.id, t.id, t.revision, t.updated, this._FileAccess),
                !t.isPublic && !F.default.isPaid && (this._ExpiredAlert = this.alert({
                    type: s.default.Types.Default,
                    blockClose: true,
                    customTitleRenderer: function() {
                        return R.default.createElement("span", {
                            onClick: e._EditorUI.showPropertiesModal
                        }, R.default.createElement("a", {
                            style: {
                                color: "#fff"
                            }
                        }, "Changes will not be saved. Convert this File to Public or Re-Activate your account."))
                    },
                    title: "",
                    message: "",
                    buttons: []
                })),
                this._FileAccess !== x.default.ReadWrite && (this.showFork(),
                t.license)) {
                    var n = L.default.get(t.license);
                    this.alert({
                        type: s.default.Types.License,
                        blockClose: true,
                        avatar: this._Author.avatar,
                        title: "Artwork License:",
                        message: n.label + " " + n.title,
                        license: n,
                        buttons: [{
                            label: "View License",
                            action: function(e, t) {
                                window.open(n.link, "_blank")
                            }
                        }]
                    })
                }
            }
        }, {
            key: "changeFileName",
            value: function(e) {
                this._RevisionManager.rename(e)
            }
        }, {
            key: "deserializeSettings",
            value: function(e) {
                for (var t in e.guides && this._EditorUI.deserializeGuides(e.guides),
                delete e.guides,
                e)
                    this._ProjectPreferences[t] = e[t];
                this._EditorUI.preferencesUpdated()
            }
        }, {
            key: "serializeSettings",
            value: function() {
                var e = this._ProjectPreferences
                  , t = this._EditorUI.serializeGuides();
                return t ? e.guides = t : delete e.guides,
                e
            }
        }, {
            key: "setActor",
            value: function(e) {
                this.resetJournal(),
                this._Actor && (this._Actor.removeEventListener("play", this.animationPlayStateChanged),
                this._Actor.removeEventListener("assetListChanged", this.actorAssetListChanged)),
                this._Actor = e,
                this._Actor && (this._Actor.addEventListener("play", this.animationPlayStateChanged),
                this._Actor.addEventListener("assetListChanged", this.actorAssetListChanged)),
                window.actor = this._Actor,
                this._Stage.clear();
                var t = this;
                this._Actor.root.all((function(e) {
                    e.parent && e.stageItem && e.stageItem.addToStage(t._Stage)
                }
                )),
                this.dispatch("actorLoaded", this._Actor),
                this.advance(),
                this._Stage.zoomFit(1)
            }
        }, {
            key: "zoomFit",
            value: function() {
                this._EditorUI.zoomFit()
            }
        }, {
            key: "changeParent",
            value: function(e) {
                var t = null;
                if (this.pickParentAlert && (t = this.pickParentAlert.items,
                this.pickParentAlert.hide(),
                this.pickParentAlert = null,
                this.dispatch("pickParent", false)),
                e && !e.node) {
                    var n = e && e.constructor.name.toString() || "unknown";
                    return I.default.debug("Attempting to change parent with an invalid parent (maybe a handle?) - " + n),
                    void this.alert({
                        type: s.default.Types.Default,
                        title: "Invalid",
                        message: "Bad parent selected.",
                        buttons: []
                    })
                }
                if (this._Stage.clearRerouteSelection(this.rerouteCB),
                this.clearCancelCallback(this.rerouteCB),
                this._Stage.clearExtraSelectionFilter(),
                e && t) {
                    var i = true
                      , r = false
                      , o = void 0;
                    try {
                        for (var a, l = t[Symbol.iterator](); !(i = (a = l.next()).done); i = true) {
                            var u = a.value;
                            if (u.node.isValidParent(e.node)) {
                                var c = new y.default(this._Stage,this._Actor,[u.node],e.node);
                                c.silent = true,
                                c.start(),
                                c.end()
                            }
                        }
                    } catch (e) {
                        r = true,
                        o = e
                    } finally {
                        try {
                            !i && l.return && l.return()
                        } finally {
                            if (r)
                                throw o
                        }
                    }
                    this.captureJournalEntry();
                    var d = this;
                    setTimeout((function() {
                        d.stage.selectItems(t)
                    }
                    ), 0)
                }
            }
        }, {
            key: "pickParent",
            value: function() {
                if (!(this.pickParentAlert || this._Stage.soloItem || this._EditingAnimation)) {
                    for (var e = this.stage.selectedItems, t = [], n = 0; n < e.length; n++) {
                        var i = e[n];
                        switch (i.constructor) {
                        case P.default:
                        case E.default:
                        case T.default:
                            t.push(i)
                        }
                    }
                    if (t.length) {
                        var r = this;
                        this.pickParentAlert = this.alert({
                            title: "Pick Parent",
                            message: "Select the item to parent to.",
                            type: s.default.Types.State,
                            buttons: [{
                                label: "CLEAR",
                                action: function(e, t) {
                                    r.changeParent(r._Actor.root.stageItem)
                                }
                            }, {
                                label: "CANCEL",
                                action: function(e, t) {
                                    r.changeParent(null)
                                }
                            }]
                        }),
                        this.pickParentAlert.items = t,
                        this.dispatch("pickParent", true),
                        this.setCancelCallback(this.changeParent),
                        this._Stage.rerouteSelection(this.changeParent),
                        this._Stage.setExtraSelectionFilter((function(e) {
                            return !e.drawAfterSelections
                        }
                        ))
                    }
                }
            }
        }, {
            key: "captureJournalEntry",
            value: function() {
                if (this._EditingWeights)
                    this._EditingWeights.captureJournalEntry();
                else if (this._EditingMesh)
                    this._EditingMesh.captureJournalEntry();
                else if (this._EditingAnimation)
                    this._AnimationEditor.captureJournalEntry();
                else if (this._Actor) {
                    var e = this._Actor.getJournalEntry();
                    e.length && (this._JournalIndex != this._Journal.length - 1 && this._Journal.splice(this._JournalIndex + 1, this._Journal.length - (this._JournalIndex + 1)),
                    this._Journal.push(e),
                    this._JournalIndex = this._Journal.length - 1)
                }
            }
        }, {
            key: "removeRestOfJournal",
            value: function() {
                this._JournalIndex != this._Journal.length - 1 && this._Journal.splice(this._JournalIndex + 1, this._Journal.length - (this._JournalIndex + 1)),
                this._JournalIndex = this._Journal.length - 1
            }
        }, {
            key: "undo",
            value: function() {
                if (this.captureJournalEntry(),
                this._EditingWeights)
                    return this._EditingWeights.undo(),
                    false;
                if (this._EditingMesh)
                    return this._EditingMesh.undo(),
                    false;
                if (this._EditingAnimation)
                    return this._AnimationEditor.undo(),
                    false;
                if (-1 == this._JournalIndex)
                    return false;
                var e = this._Journal[this._JournalIndex];
                this._Actor.isTimeTraveling = true,
                this._Stage.resetQueuedAddRemove();
                for (var t = 0; t < e.length; t++) {
                    e[t].undo(this._Stage)
                }
                return this._Stage.processQueuedAddRemove(),
                this._Actor.isTimeTraveling = false,
                this._JournalIndex--,
                this._Actor.getJournalEntry(),
                this._EditorUI.debounceUpdateSelectionPanelItem(),
                true
            }
        }, {
            key: "redo",
            value: function() {
                if (this.captureJournalEntry(),
                this._EditingWeights)
                    this._EditingWeights.redo();
                else if (this._EditingMesh)
                    this._EditingMesh.redo();
                else if (this._EditingAnimation)
                    this._AnimationEditor.redo();
                else if (!(this._JournalIndex + 1 > this._Journal.length - 1)) {
                    this._JournalIndex++;
                    var e = this._Journal[this._JournalIndex];
                    this._Actor.isTimeTraveling = true,
                    this._Stage.resetQueuedAddRemove();
                    for (var t = 0; t < e.length; t++) {
                        e[t].redo(this._Stage)
                    }
                    this._Stage.processQueuedAddRemove(),
                    this._Actor.isTimeTraveling = false,
                    this._Actor.getJournalEntry(),
                    this._EditorUI.debounceUpdateSelectionPanelItem()
                }
            }
        }, {
            key: "setCancelCallback",
            value: function(e) {
                this._CancelCallback = e
            }
        }, {
            key: "clearCancelCallback",
            value: function(e) {
                this._CancelCallback == e && (this._CancelCallback = null)
            }
        }, {
            key: "find",
            value: function() {
                this._EditorUI.find()
            }
        }, {
            key: "cancel",
            value: function() {
                if (this._CancelCallback) {
                    var e = this._CancelCallback;
                    return this._CancelCallback = null,
                    void e()
                }
                this._EditorUI.hasModalOpen ? this._EditorUI.closeModal() : this._Stage.cancel()
            }
        }, {
            key: "contextMenuSendBehind",
            value: function(e) {
                for (var t = this._Actor.drawOrder.images.slice(0), n = e.node.drawOrder - .5, i = 0; i < t.length; i++) {
                    var r = t[i];
                    r.__o = i + 1,
                    r.stageItem && r.stageItem.isSelected && (r.__o = n)
                }
                t.sort((function(e, t) {
                    return e.__o - t.__o
                }
                ));
                for (var o = 0; o < t.length; o++) {
                    var a = t[o];
                    delete a.__o,
                    a.drawOrder = o + 1
                }
                this.captureJournalEntry()
            }
        }, {
            key: "contextMenuBringOver",
            value: function(e) {
                for (var t = this._Actor.drawOrder.images.slice(0), n = e.node.drawOrder + .5, i = 0; i < t.length; i++) {
                    var r = t[i];
                    r.__o = i + 1,
                    r.stageItem && r.stageItem.isSelected && (r.__o = n)
                }
                t.sort((function(e, t) {
                    return e.__o - t.__o
                }
                ));
                for (var o = 0; o < t.length; o++) {
                    var a = t[o];
                    delete a.__o,
                    a.drawOrder = o + 1
                }
                this.captureJournalEntry()
            }
        }, {
            key: "bumpSelectionDrawOrder",
            value: function(e) {
                if (this._Actor && this._Stage.toolType !== C.default && !this._IncBrushSizeCallback) {
                    e *= this._Actor.drawOrder.images.length + 1;
                    for (var t = this._Actor.drawOrder.images.slice(0), n = 0; n < t.length; n++) {
                        var i = t[n];
                        i.__o = n + 1,
                        i.stageItem && i.stageItem.isSelected && (i.__o += e)
                    }
                    t.sort((function(e, t) {
                        return e.__o - t.__o
                    }
                    ));
                    for (var r = 0; r < t.length; r++) {
                        var o = t[r];
                        delete o.__o,
                        o.drawOrder = r + 1
                    }
                    this.captureJournalEntry()
                }
            }
        }, {
            key: "incrementSelectionDrawOrder",
            value: function(e) {
                if (this._Actor && this._Stage.toolType !== C.default && !this._IncBrushSizeCallback) {
                    for (var t = this._Actor.drawOrder.images.slice(0), n = e < 0 ? 0 : t.length - 1, i = e < 0 ? t.length : -1, r = n; r != i; r -= e) {
                        var o = t[r];
                        if (o.stageItem && o.stageItem.isSelected) {
                            var a = Math.max(0, Math.min(t.length - 1, r + e));
                            if (a === r)
                                return;
                            var s = t[a];
                            t[a] = o,
                            t[r] = s
                        }
                    }
                    for (var l = 0; l < t.length; l++) {
                        t[l].drawOrder = l + 1
                    }
                    this.captureJournalEntry()
                }
            }
        }, {
            key: "deselect",
            value: function() {
                this._Stage.clearSelections(),
                this.clearSelections()
            }
        }, {
            key: "clearSelections",
            value: function(e) {
                for (var t = 0; t < this._SelectedItems.length; t++)
                    this._SelectedItems[t].isSelected = false;
                this._SelectedItems.length = 0,
                e || this.dispatch("selectionChanged", this.selectedItems)
            }
        }, {
            key: "certainSelections",
            value: function(e) {
                for (var t = [], n = 0; n < this._SelectedItems.length; n++) {
                    var i = this._SelectedItems[n];
                    e(i) && t.push(i)
                }
                return t
            }
        }, {
            key: "clearCertainSelections",
            value: function(e, t) {
                for (var n = false, i = 0; i < this._SelectedItems.length; i++) {
                    var r = this._SelectedItems[i];
                    e(r) && (r.isSelected = false,
                    n = true,
                    this._SelectedItems.splice(i, 1),
                    i--)
                }
                !t && n && this.dispatch("selectionChanged", this.selectedItems)
            }
        }, {
            key: "selectItems",
            value: function(e, t, n) {
                !t && this._SelectedItems.length && this.clearSelections(true);
                for (var i = 0; i < e.length; i++) {
                    var r = e[i];
                    r.isSelected || (this._SelectedItems.push(r),
                    r.isSelected = true)
                }
                this.dispatch("selectionChanged", this.selectedItems, n)
            }
        }, {
            key: "selectItem",
            value: function(e, t, n) {
                if (!e)
                    throw new Error("Cannot select a non object");
                e.isSelected && 1 === this._SelectedItems.length || (!t && this._SelectedItems.length && this.clearSelections(true),
                this._SelectedItems.push(e),
                e.isSelected = true,
                this.dispatch("selectionChanged", this.selectedItems, n))
            }
        }, {
            key: "deselectItem",
            value: function(e, t) {
                var n = this._SelectedItems.indexOf(e);
                return -1 != n && (this._SelectedItems.splice(n, 1),
                e.isSelected = false,
                t || this.dispatch("selectionChanged", this.selectedItems),
                true)
            }
        }, {
            key: "removeAnimations",
            value: function(e) {
                var t = this._Actor
                  , n = false
                  , i = true
                  , r = false
                  , o = void 0;
                try {
                    for (var a, s = e[Symbol.iterator](); !(i = (a = s.next()).done); i = true) {
                        var l = a.value;
                        l.isPlaying = false,
                        l === this._EditingAnimation && (n = true),
                        t.removeAnimation(l)
                    }
                } catch (e) {
                    r = true,
                    o = e
                } finally {
                    try {
                        !i && s.return && s.return()
                    } finally {
                        if (r)
                            throw o
                    }
                }
                this.deselectItems(e),
                n && (t.animations.length ? this.editingAnimation = t.animations[0] : this.editingAnimation = null)
            }
        }, {
            key: "deselectItems",
            value: function(e) {
                for (var t = false, n = 0; n < e.length; n++) {
                    var i = this.deselectItem(e[n], true);
                    t || (t = i)
                }
                t && this.dispatch("selectionChanged", this.selectedItems)
            }
        }, {
            key: "animationEventTriggered",
            value: function(e) {
                e.alert || (e.alert = this.alert({
                    title: e.name,
                    message: " (" + e.parent.name + ")",
                    type: s.default.Types.Event
                }),
                this._CleanupEvents.push(e)),
                e.alert.highlight()
            }
        }, {
            key: "detectDependencyCycles",
            value: function(e, t) {
                this._DependencyCycles || (this._DependencyCycles = []);
                try {
                    e()
                } catch (e) {
                    e instanceof A.default ? (t && t(),
                    this._DependencyCycles.push(e),
                    (0,
                    j.default)(this.reportDependencyCycles)) : I.default.debug("Got an unhandled exception while detecting dependency cycles - " + e)
                }
            }
        }, {
            key: "reportDependencyCycles",
            value: function() {
                var e = this._DependencyCycles;
                if (this._DependencyCycles = null,
                e.length) {
                    var t = void 0
                      , n = 1 === e.length ? "it" : "they";
                    t = 1 === e.length ? '"' + e[0].name + '"' : e.length > 4 ? e.slice(0, 3).map((function(e) {
                        return '"' + e.name + '"'
                    }
                    )).join(", ") + ", ..." : e.slice(0, -1).map((function(e) {
                        return '"' + e.name + '"'
                    }
                    )).join(", ") + ' and "' + e.slice(-1)[0].name + '"',
                    this.alert({
                        title: "Cyclic Dependency.",
                        message: t + " could not be used as " + n + " would create a cyclic dependency.",
                        type: s.default.Types.Default,
                        buttons: []
                    })
                }
            }
        }, {
            key: "actorAssetListChanged",
            value: function() {}
        }, {
            key: "animationPlayStateChanged",
            value: function() {
                this._EditorUI.updateSelectionPanel(),
                this.updateStageState();
                for (var e = 0; e < this._CleanupEvents.length; e++) {
                    var t = this._CleanupEvents[e];
                    t.alert && t.alert.hide(),
                    delete t.alert
                }
                this._CleanupEvents.length = 0
            }
        }, {
            key: "updateStageState",
            value: function() {
                this._Stage.isSelectionDisabled = this._IsDragging || this._IsExporting || this._EditingAnimation && this._EditingAnimation.isPlaying || this._Actor && this._Actor.hasPlayingAnimations
            }
        }, {
            key: "group",
            value: function() {
                if (!this._EditingAnimation) {
                    var e = new f.default(this._Stage,this._Actor,D.default,"Group");
                    e.start(),
                    e.end()
                }
            }
        }, {
            key: "groupSolo",
            value: function() {
                if (!this._EditingAnimation) {
                    var e = new f.default(this._Stage,this._Actor,M.default,"Solo Group");
                    e.start(),
                    e.end()
                }
            }
        }, {
            key: "keyNodes",
            value: function(e, t, n, i, r) {
                if (this._EditingAnimation)
                    for (var o = 0; o < e.length; o++) {
                        var a = e[o]
                          , s = t
                          , l = n
                          , u = i
                          , c = r && a.constructor == v.default;
                        switch (a.constructor) {
                        case v.default:
                            s = false;
                            break;
                        case _.default:
                            a.isConnectedToBones && (s = false,
                            l = false,
                            u = false)
                        }
                        s && (this._EditingAnimation.setKey(a, "framePosX"),
                        this._EditingAnimation.setKey(a, "framePosY")),
                        u && (this._EditingAnimation.setKey(a, "frameScaleX"),
                        this._EditingAnimation.setKey(a, "frameScaleY")),
                        l && this._EditingAnimation.setKey(a, "frameRotation"),
                        c && this._EditingAnimation.setKey(a, "frameLength")
                    }
            }
        }, {
            key: "keySelected",
            value: function(e, t, n, i) {
                for (var r = this._Stage.selectedItems, o = [], a = 0; a < r.length; a++) {
                    var s = r[a].node;
                    s && -1 === o.indexOf(s) && o.push(s)
                }
                this.keyNodes(o, e, t, n, i),
                this.captureJournalEntry()
            }
        }, {
            key: "selectAll",
            value: function() {
                this._Stage.selectAll()
            }
        }, {
            key: "delete",
            value: function() {
                if (this._EditingMesh)
                    this._EditingMesh.deleteSelection(),
                    this.captureJournalEntry();
                else if (this._EditingAnimation)
                    this._EditingAnimation.deleteSelection(),
                    this.captureJournalEntry();
                else {
                    var e = new p.default(this._Stage,this._Actor,this._Stage.selectedItems,this._SelectedItems);
                    e.start(),
                    e.end(),
                    this._EditorUI.debounceUpdateSelectionPanelItem()
                }
            }
        }, {
            key: "selectIndexItem",
            value: function(e) {
                this._SelectIndexItemCallback && this._SelectIndexItemCallback(e)
            }
        }, {
            key: "selectIndexItemNext",
            value: function() {
                this.selectIndexItemNextCallback && this.selectIndexItemNextCallback()
            }
        }, {
            key: "selectIndexItemPrevious",
            value: function() {
                this._SelectIndexItemPreviousCallback && this._SelectIndexItemPreviousCallback()
            }
        }, {
            key: "incBrushSize",
            value: function(e) {
                this._IncBrushSizeCallback && this._IncBrushSizeCallback(e)
            }
        }, {
            key: "incBrushFeather",
            value: function(e) {
                this._IncBrushFeatherCallback && this._IncBrushFeatherCallback(e)
            }
        }, {
            key: "incBrushStrength",
            value: function(e) {
                this._IncBrushStrengthCallback && this._IncBrushStrengthCallback(e)
            }
        }, {
            key: "setBrushCallbacks",
            value: function(e, t, n) {
                this._IncBrushSizeCallback = e,
                this._IncBrushFeatherCallback = t,
                this._IncBrushStrengthCallback = n
            }
        }, {
            key: "setSelectionCallbacks",
            value: function(e, t, n) {
                this._SelectIndexItemCallback = e,
                this._SelectIndexItemNextCallback = t,
                this._SelectIndexItemPreviousCallback = n
            }
        }, {
            key: "cut",
            value: function() {
                this.copy() && this.delete()
            }
        }, {
            key: "copy",
            value: function() {
                if (!this.hasCopyAccess)
                    return this.alert({
                        title: "Cannot Copy.",
                        message: "This file is read only.",
                        type: s.default.Types.Default,
                        autoHideSeconds: 3,
                        buttons: []
                    }),
                    false;
                var e = void 0;
                if (this._EditingAnimation)
                    e = this._EditingAnimation.copy();
                else {
                    var t = function(t) {
                        if (t.parent && (t = t.parent),
                        !r.has(t)) {
                            r.add(t);
                            var n = t.serialize();
                            e.assets.push(n)
                        }
                    }
                      , n = function e(n) {
                        if (n.asset && t(n.asset),
                        n.children)
                            for (var i = 0; i < n.children.length; i++)
                                e(n.children[i])
                    }
                      , i = []
                      , r = new Set;
                    e = {
                        ownerId: this._File.owner.id,
                        fileId: this._File.id,
                        revisionKey: this._RevisionManager.revisionKey,
                        assets: [],
                        nodes: []
                    };
                    for (var o = 0; o < this._SelectedItems.length; o++) {
                        var a = this._SelectedItems[o].serialize();
                        a instanceof w.default && t(a)
                    }
                    for (var l = this._Stage.selectedItems, u = 0; u < l.length; u++) {
                        var c = l[u];
                        if (c.node && -1 == i.indexOf(c.node) && c.node.constructor !== g.default) {
                            for (var d = false, h = 0; h < l.length; h++)
                                if (h != u) {
                                    var f = l[h].node;
                                    c.node.isChildOf(f) && (d = true)
                                }
                            if (!d) {
                                var p = c.node.serialize();
                                e.nodes.push(p),
                                i.push(c.node),
                                c.node.worldTransform && (p.worldTransform = Array.prototype.slice.call(c.node.worldTransform)),
                                n(c.node)
                            }
                        }
                    }
                }
                return e && localStorage.setItem("clipboard", JSON.stringify(e)),
                true
            }
        }, {
            key: "paste",
            value: function() {
                var e = this;
                if (!this._BlockPaste) {
                    var t = localStorage.getItem("clipboard");
                    if (t) {
                        var n = null;
                        try {
                            n = JSON.parse(t)
                        } catch (e) {
                            console.warn("Failed to parse data from clipboard.")
                        }
                        if (n) {
                            if (this._EditingAnimation)
                                return void this._EditingAnimation.paste(n);
                            !function() {
                                e._BlockPaste = true;
                                var t = e._RevisionManager
                                  , i = n.assets || []
                                  , r = []
                                  , o = true
                                  , a = false
                                  , l = void 0;
                                try {
                                    for (var u, c = i[Symbol.iterator](); !(o = (u = c.next()).done); o = true) {
                                        W(u.value, (function(e) {
                                            r.push(e.id)
                                        }
                                        ))
                                    }
                                } catch (e) {
                                    a = true,
                                    l = e
                                } finally {
                                    try {
                                        !o && c.return && c.return()
                                    } finally {
                                        if (a)
                                            throw l
                                    }
                                }
                                var d = e
                                  , h = null;
                                r.length && (h = e.alert({
                                    type: s.default.Types.Default,
                                    title: "Pasting",
                                    message: "Assets are being pasted from another character file...",
                                    buttons: []
                                })),
                                t.shareAssets(n.ownerId, n.fileId, r, (function() {
                                    if (d._BlockPaste = false,
                                    h && h.hide(),
                                    n.assets)
                                        for (var e = 0; e < n.assets.length; e++) {
                                            W(n.assets[e], (function(e) {
                                                t.prepAssetForLoad(e)
                                            }
                                            ))
                                        }
                                    d._Actor.import(n, d._Stage),
                                    n.settings && d.deserializeSettings(n.settings),
                                    d.captureJournalEntry()
                                }
                                ))
                            }()
                        }
                    }
                }
            }
        }, {
            key: "enableAnimation",
            value: function(e) {
                this._IsAnimationEnabled != e && (this._IsAnimationEnabled = e,
                this._Actor.useAnimationValues = e)
            }
        }, {
            key: "startPan",
            value: function() {
                this._Stage.isMouseOver ? this._Stage.isPanning = true : this._EditingAnimation && this._EditingAnimation.timelineCanvas && this._EditingAnimation.timelineCanvas.isMouseOver && (this._EditingAnimation.timelineCanvas.isPanning = true)
            }
        }, {
            key: "removeContextMenus",
            value: function() {
                this._EditorUI.removeContextMenus()
            }
        }, {
            key: "showContextMenu",
            value: function(e) {
                this._EditorUI.showContextMenu(e)
            }
        }, {
            key: "removeDropdownMenu",
            value: function(e) {
                this._EditorUI.removeDropDownPopup(e)
            }
        }, {
            key: "showDropDownMenu",
            value: function(e) {
                return this._EditorUI.addDropDownPopup(e)
            }
        }, {
            key: "getStageRect",
            value: function() {
                return this._EditorUI.getStageRect()
            }
        }, {
            key: "getAccurateStageRect",
            value: function() {
                return this._EditorUI.getAccurateStageRect()
            }
        }, {
            key: "alert",
            value: function(e) {
                var t = new s.default(e);
                if (e.delaySeconds) {
                    var n = this._EditorUI;
                    t.displayTimeout = setTimeout((function() {
                        n.showAlert(t)
                    }
                    ), 1e3 * e.delaySeconds)
                } else
                    this._EditorUI.showAlert(t);
                return t
            }
        }, {
            key: "onError",
            value: function(e, t, n, i, r) {
                this._OldErrorHandler && this._OldErrorHandler(e, t, n, i, r);
                var o = Date.now();
                if (!(o - this._LastReportTime < 5e3)) {
                    this._LastReportTime = o;
                    var a = {
                        error: {
                            message: e,
                            url: t,
                            lineNumber: n
                        },
                        stack: r && r.stack,
                        build: this._BuildNumber,
                        character: this._File,
                        revisionManagerState: this._RevisionManager.state,
                        editorState: this._EditorUI.getStateForLog(),
                        screenshot: this._Canvas.toDataURL("image/jpeg", .67),
                        userAgent: navigator.userAgent
                    };
                    console.log("ERROR HERE", a),
                    this._EditorUI.showCrash();
                    var s = new XMLHttpRequest;
                    s.open("POST", "/api/report_error/" + this._BuildNumber, true);
                    var l = this;
                    return s.onload = function() {
                        var e;
                        try {
                            e = JSON.parse(this.responseText),
                            l._ErrorKey = e.key
                        } catch (e) {
                            console.warn("Failed to parse response text from report_error.")
                        }
                    }
                    ,
                    s.send(JSON.stringify(a)),
                    false
                }
            }
        }, {
            key: "errorFeedback",
            value: function(e) {
                if (this._ErrorKey) {
                    var t = {
                        key: this._ErrorKey,
                        message: e
                    }
                      , n = new XMLHttpRequest;
                    return n.open("POST", "/api/report_error_feedback/" + (window.__NimaBuildNumber || "DEV"), true),
                    n.send(JSON.stringify(t)),
                    false
                }
                console.log("NO ERROR KEY")
            }
        }, {
            key: "getPreference",
            value: function(e) {
                var t = this._FilePreferences[e];
                if (void 0 !== t)
                    return t;
                var n = this._ProjectPreferences[e];
                if (void 0 !== n)
                    return n;
                var i = this._LocalPreferences[e];
                return void 0 !== i ? i : this._UserPreferences[e]
            }
        }, {
            key: "setLocalPreference",
            value: function(e, t) {
                this._LocalPreferences[e] = t,
                clearTimeout(this._SaveLocalPreferencesTimeout);
                var n = this;
                this._SaveLocalPreferencesTimeout = setTimeout((function() {
                    localStorage.setItem("preferences-" + n._User.id, JSON.stringify(n._LocalPreferences))
                }
                ), 100),
                this._Stage.updateSettings()
            }
        }, {
            key: "setUserPreference",
            value: function(e, t) {
                this._UserPreferences[e] = t,
                clearTimeout(this._SaveUserPreferencesTimeout),
                this._SaveUserPreferencesTimeout = setTimeout((function() {}
                ), 100),
                this._Stage.updateSettings()
            }
        }, {
            key: "setCharacterPreference",
            value: function(e, t) {
                if (this.hasWriteAccess) {
                    this._FilePreferences[e] = t;
                    var n = this;
                    clearTimeout(this._SaveCharacterPreferencesTimeout),
                    this._SaveCharacterPreferencesTimeout = setTimeout((function() {
                        var e = new XMLHttpRequest;
                        e.open("POST", "/api/files/" + n._File.owner.id + "/" + n._File.id + "/preferences", true),
                        e.onload = function() {
                            200 !== this.status && I.default.warn("Couldn't save Character Preferences", n._File)
                        }
                        ,
                        e.send(JSON.stringify(n._FilePreferences))
                    }
                    ), 300),
                    this._Stage.updateSettings()
                }
            }
        }, {
            key: "setProjectPreference",
            value: function(e, t) {
                this._ProjectPreferences[e] = t,
                this._EditorUI.preferencesUpdated(),
                clearTimeout(this._SaveProjectPreferencesTimeout);
                var n = this;
                this._SaveProjectPreferencesTimeout = setTimeout((function() {
                    n._Actor && n._Actor.revise()
                }
                ), 100),
                this._Stage.updateSettings()
            }
        }, {
            key: "withSelected",
            value: function(e, t) {
                var n = e.constructor === Array ? e : t;
                t = e.constructor === Function ? e : t;
                for (var i = [], r = 0; r < this._Stage.selectedItems.length; r++) {
                    var o = this._Stage.selectedItems[r];
                    o.node && -1 !== n.indexOf(o.node.constructor) && -1 === i.indexOf(o.node) && (i.push(o.node),
                    t(o.node))
                }
            }
        }, {
            key: "setReplaceTarget",
            value: function(e) {
                var t = [];
                if (e)
                    for (var n = 0; n < e.length; n++) {
                        var i = e[n];
                        i instanceof w.default ? t.push(i) : i.node && t.push(i.node)
                    }
                this._ReplaceTargets = t.length && t || null
            }
        }, {
            key: "dragOver",
            value: function(e) {
                return e.stopPropagation(),
                e.preventDefault(),
                e.dataTransfer.dropEffect = "copy",
                false
            }
        }, {
            key: "dragLeave",
            value: function(e) {
                e.stopPropagation(),
                e.preventDefault()
            }
        }, {
            key: "dragDrop",
            value: function(e) {
                e.stopPropagation(),
                e.preventDefault();
                var t = e.dataTransfer.files;
                this.addAssetsFromFiles(t)
            }
        }, {
            key: "confirmGroupImageSequence",
            value: function(e) {
                var t = this;
                return new Promise((function(n, i) {
                    t.alert({
                        type: s.default.Types.Question,
                        title: "Import Sequence?",
                        message: "Do you want to import " + e.name + " as an image sequence?",
                        buttons: [{
                            label: "Yes",
                            action: function(e, t) {
                                n(true)
                            }
                        }, {
                            label: "No",
                            action: function(e, t) {
                                n(false)
                            }
                        }]
                    })
                }
                ))
            }
        }, {
            key: "getGroupedFiles",
            value: function(e) {
                this._Stage,
                this._Actor;
                var t = this;
                return new Promise((function(n, i) {
                    for (var r = [], o = (0,
                    S.default)(e, O.default.getImageExtensions(), (function(e) {
                        return e.name
                    }
                    )), a = 0; a < o.length; a++) {
                        var s = o[a];
                        s.items.length > 1 && r.push(t.confirmGroupImageSequence(s))
                    }
                    Promise.all(r).then((function(e) {
                        for (var t = [], i = 0, r = 0; r < o.length; r++) {
                            var a = o[r];
                            if (a.items.length > 1) {
                                if (e[i])
                                    t.push(a);
                                else
                                    for (var s = 0; s < a.items.length; s++) {
                                        var l = a.items[s];
                                        t.push({
                                            name: l.name,
                                            items: [l]
                                        })
                                    }
                                i++
                            } else
                                t.push(a)
                        }
                        n(t)
                    }
                    ))
                }
                ))
            }
        }, {
            key: "replaceAssets",
            value: function(e, t) {
                if (this._EditingAnimation)
                    console.log("Trying to add files while in animation mode.");
                else {
                    var n = this.actor
                      , i = this;
                    this.getGroupedFiles(t).then((function(e) {
                        return n.makeAssets(e)
                    }
                    )).then((function(t) {
                        var r = t.assets;
                        if (0 != r.length) {
                            for (var o = r[0], a = false, s = 0; s < e.length; s++) {
                                var l = e[s];
                                l instanceof w.default && l.canBeReplacedBy(o) ? (a = true,
                                l.replaceWith(o, n)) : l.asset && l.asset instanceof w.default && l.asset.canBeReplacedBy(o) && (a = true,
                                l.asset.replaceWith(o, n))
                            }
                            a && (n.addAsset(o),
                            i.captureJournalEntry())
                        }
                    }
                    ))
                }
            }
        }, {
            key: "addAssetsFromFiles",
            value: function(e) {
                if (this._EditingAnimation)
                    console.log("Trying to add files while in animation mode.");
                else {
                    console.log("GOING IN", e, this._Actor);
                    var t = this._ReplaceTargets
                      , n = this._Stage
                      , i = this._Actor
                      , r = this
                      , o = null;
                    this.getGroupedFiles(e).then((function(e) {
                        return o = r.alert({
                            title: "Importing Assets.",
                            message: "This can take a minute if your file is large.",
                            type: s.default.Types.Saving,
                            buttons: [],
                            delaySeconds: 5,
                            minimumDisplaySeconds: 2
                        }),
                        i.makeAssets(e)
                    }
                    )).then((function(e) {
                        var a = e.assets
                          , l = e.unprocessed;
                        l.length ? i.importFiles(l, n, (function(e) {
                            o.hide(),
                            e && r.captureJournalEntry()
                        }
                        )) : o.hide();
                        var u = false;
                        if (t && t.length && 1 === a.length && 0 === l.length) {
                            for (var c = a[0], d = [], h = 0; h < t.length; h++) {
                                var f = t[h];
                                (f instanceof w.default && f.canBeReplacedBy(c) || f.asset && f.asset instanceof w.default && f.asset.canBeReplacedBy(c)) && d.push(f)
                            }
                            if (d.length) {
                                var p = void 0;
                                p = 1 === d.length ? '"' + d[0].name + '"' : d.length > 4 ? d.slice(0, 3).map((function(e) {
                                    return '"' + e.name + '"'
                                }
                                )).join(", ") + ", ..." : d.slice(0, -1).map((function(e) {
                                    return '"' + e.name + '"'
                                }
                                )).join(", ") + ' and "' + d.slice(-1)[0].name + '"',
                                u = true,
                                r.alert({
                                    type: s.default.Types.Question,
                                    title: "Replace Asset or Import New?",
                                    message: "Replace " + p + " with " + c.name + "?",
                                    buttons: [{
                                        label: "Replace",
                                        action: function(e, t) {
                                            for (var n = 0; n < d.length; n++) {
                                                var o = d[n];
                                                o instanceof w.default ? o.replaceWith(c, i) : o.asset = c
                                            }
                                            i.addAsset(c),
                                            r.captureJournalEntry()
                                        }
                                    }, {
                                        label: "Import",
                                        action: function(e, t) {
                                            a.length && (i.addAssets(a),
                                            r.captureJournalEntry())
                                        }
                                    }, {
                                        label: "x",
                                        action: function(e, t) {
                                            a.length
                                        }
                                    }]
                                })
                            }
                        }
                        if (!u) {
                            for (var y = i.assets, m = [], v = [], g = 0; g < a.length; g++) {
                                for (var _ = a[g], b = false, O = 0; O < y.length; O++) {
                                    var S = y[O];
                                    if (S.canBeReplacedBy(_) && _.name == S.name) {
                                        b = true,
                                        m.push({
                                            from: S,
                                            to: _
                                        });
                                        break
                                    }
                                }
                                b || v.push(_)
                            }
                            if (m.length) {
                                var k = void 0;
                                k = 1 === m.length ? '"' + m[0].from.name + '"' : m.length > 4 ? m.slice(0, 3).map((function(e) {
                                    return '"' + e.from.name + '"'
                                }
                                )).join(", ") + ", ..." : m.slice(0, -1).map((function(e) {
                                    return '"' + e.from.name + '"'
                                }
                                )).join(", ") + ' and "' + m.slice(-1)[0].from.name + '"',
                                r.alert({
                                    type: s.default.Types.Question,
                                    title: "Replace Asset or Import New?",
                                    message: "Replace " + k + "?",
                                    buttons: [{
                                        label: "Replace",
                                        action: function(e, t) {
                                            for (var n = 0; n < m.length; n++) {
                                                var o = m[n];
                                                o.from.replaceWith(o.to, i)
                                            }
                                            i.addAssets(a),
                                            r.captureJournalEntry()
                                        }
                                    }, {
                                        label: "Import",
                                        action: function(e, t) {
                                            a.length && (i.addAssets(a),
                                            r.captureJournalEntry())
                                        }
                                    }, {
                                        label: "x",
                                        action: function(e, t) {
                                            a.length
                                        }
                                    }]
                                })
                            } else
                                a.length && (i.addAssets(a),
                                r.captureJournalEntry())
                        }
                    }
                    ))
                }
            }
        }, {
            key: "resetJournal",
            value: function() {
                this._Journal = [],
                this._JournalIndex = -1
            }
        }, {
            key: "incSelectionFilter",
            value: function(e) {
                this._EditorUI.incSelectionFilter(e)
            }
        }, {
            key: "translateSelection",
            value: function(e) {
                var t = new b.default(this._Stage)
                  , n = this._Stage.selectedItems;
                t.startDrag(null, n),
                t.advanceDrag(e, e, e, [0, 0]),
                t.endDrag(),
                this.captureJournalEntry()
            }
        }, {
            key: "resetGuides",
            value: function() {
                this._EditorUI.resetGuides(),
                this._Actor.revise()
            }
        }, {
            key: "preventBrowserRefresh",
            value: function(e) {
                if (this._RefreshAlert && !this._RefreshAlert._hide)
                    return false;
                e.preventDefault();
                var t = this;
                return this._RefreshAlert = this.alert({
                    title: "Sure you want to refresh?",
                    message: "Press reload shortcut again to refresh.",
                    type: s.default.Types.Question,
                    buttons: [{
                        label: "Cancel",
                        action: function() {
                            t._RefreshAlert = null
                        }
                    }]
                }),
                true
            }
        }, {
            key: "forceRevision",
            value: function() {
                var e = !this.file.isPublic && !F.default.isPaid;
                if (this.hasWriteAccess && !e)
                    if (this._UserSaveAlert)
                        console.log("Wait for next save before queueing another one.");
                    else {
                        var t = this;
                        this._RevisionManager.userSave("Manual Save", (function() {
                            setTimeout((function() {
                                t._UserSaveAlert.hide(),
                                t._UserSaveAlert = null
                            }
                            ), 2e3)
                        }
                        )) ? this._UserSaveAlert = this.alert({
                            title: "Saving Revision.",
                            message: "Your revision is being manually saved.",
                            type: s.default.Types.Saving,
                            buttons: []
                        }) : this.alert({
                            title: "Cannot Save.",
                            message: "You cannot save while previewing revisions.",
                            type: s.default.Types.Default,
                            autoHideSeconds: 3,
                            buttons: []
                        })
                    }
                else
                    this.alert({
                        title: "Cannot Save.",
                        message: "This file is read only.",
                        type: s.default.Types.Default,
                        autoHideSeconds: 3,
                        buttons: []
                    })
            }
        }, {
            key: "sortAnimations",
            value: function(e) {
                this.editor.filePanel.animationFolder.sort(e)
            }
        }, {
            key: "duplicate",
            value: function() {
                if (!this.hasCopyAccess)
                    return false;
                var e = {
                    ownerId: this._File.owner.id,
                    filedId: this._File.id,
                    revisionKey: this._RevisionManager.revisionKey,
                    assets: [],
                    nodes: [],
                    selection: []
                }
                  , t = this._EditingAnimation
                  , n = this._SelectedItems.filter((function(e) {
                    return e.constructor === m.default
                }
                ));
                if ((t ? t.timelineCanvas.selectedKeyFrames : []).length) {
                    var i = t.copy();
                    t.paste(i),
                    this.captureJournalEntry()
                } else if (n.length) {
                    var r = this._Actor.duplicateAnimations(n);
                    this.selectItems(r),
                    this.captureJournalEntry()
                } else if (t)
                    this.alert({
                        title: "Cannot Duplicate.",
                        message: "Switch to Design mode to modify the Hierarchy",
                        type: s.default.Types.Default,
                        autoHideSeconds: 5,
                        buttons: []
                    });
                else {
                    for (var o = function e(t) {
                        if (t.asset && u(t.asset),
                        t.children)
                            for (var n = 0; n < t.children.length; n++)
                                e(t.children[n])
                    }, a = [], l = new Set, u = function(t) {
                        if (t.parent && (t = t.parent),
                        !l.has(t)) {
                            l.add(t);
                            var n = t.serialize();
                            e.assets.push(n)
                        }
                    }, c = this._Stage.selectedItems, d = 0; d < c.length; d++) {
                        var h = c[d];
                        if (h.node && -1 == a.indexOf(h.node) && h.node.constructor !== g.default) {
                            for (var f = false, p = 0; p < c.length; p++)
                                if (p != d) {
                                    var y = c[p].node;
                                    h.node.isChildOf(y) && (f = true)
                                }
                            if (!f) {
                                var v = h.node.serialize();
                                e.nodes.push(v),
                                e.selection.push(h),
                                a.push(h.node),
                                h.node.worldTransform && (v.worldTransform = Array.prototype.slice.call(h.node.worldTransform)),
                                o(h.node)
                            }
                        }
                    }
                    if (e.nodes.length) {
                        var _ = [];
                        this._Stage.clearSelections();
                        for (var b = 0; b < e.nodes.length; b++) {
                            var w = e.nodes[b]
                              , O = e.selection[b];
                            this._Stage.selectItem(O, false, true);
                            var S = {
                                nodes: [w]
                            };
                            this._Actor.import(S, this._Stage);
                            var k = this._Stage.selectedItems;
                            _.push.apply(_, V(k))
                        }
                        this._Stage.selectItems(_),
                        this.captureJournalEntry()
                    }
                }
            }
        }, {
            key: "expandedItems",
            get: function() {
                return this._ExpandedHierarchyItems
            }
        }, {
            key: "hasWriteAccess",
            get: function() {
                return this._FileAccess === x.default.ReadWrite
            }
        }, {
            key: "hasCopyAccess",
            get: function() {
                switch (this._FileAccess) {
                case x.default.Fork:
                case x.default.ReadWrite:
                    return true;
                default:
                    return false
                }
            }
        }, {
            key: "buildNumber",
            get: function() {
                return this._BuildNumber
            }
        }, {
            key: "stage",
            get: function() {
                return this._Stage
            }
        }, {
            key: "editor",
            get: function() {
                return this._EditorUI
            }
        }, {
            key: "isDragging",
            get: function() {
                return this._IsDragging
            },
            set: function(e) {
                this._IsDragging != e && (this._IsDragging = e,
                this.updateStageState())
            }
        }, {
            key: "isExporting",
            get: function() {
                return this._IsExporting
            },
            set: function(e) {
                this._IsExporting != e && (this._IsExporting = e,
                this.updateStageState())
            }
        }, {
            key: "file",
            get: function() {
                return this._File
            }
        }, {
            key: "actor",
            get: function() {
                return this._Actor
            }
        }, {
            key: "selectedItems",
            get: function() {
                return this._SelectedItems.slice(0)
            }
        }, {
            key: "autoKey",
            get: function() {
                return this._AutoKey
            },
            set: function(e) {
                this._AutoKey = e,
                this._EditingAnimation && (this._EditingAnimation.autoKey = e)
            }
        }, {
            key: "editingMesh",
            get: function() {
                return this._EditingMesh
            },
            set: function(e) {
                e && (this.editingAnimation = null,
                this.editingWeights = null),
                this._EditingMesh = e
            }
        }, {
            key: "user",
            get: function() {
                return this._User
            }
        }, {
            key: "revisionManager",
            get: function() {
                return this._RevisionManager
            }
        }, {
            key: "editingWeights",
            get: function() {
                return this._EditingWeights
            },
            set: function(e) {
                e && (this.editingAnimation = null,
                this.editingMesh = null),
                this._EditingWeights = e
            }
        }, {
            key: "editingAnimation",
            get: function() {
                return this._EditingAnimation
            },
            set: function(e) {
                if (this._EditingAnimation != e) {
                    if (this._EditingAnimation ? (this._EditingAnimation.removeEventListener("play", this.animationPlayStateChanged),
                    this._EditingAnimation.removeEventListener("triggerEvent", this.animationEventTriggered),
                    this._EditingAnimation.setActor(null, this._AnimationEditor)) : (this._WasCompensating = {
                        compensateBones: this._Stage.settings.compensateBones,
                        compensateImages: this._Stage.settings.compensateImages
                    },
                    this._Stage.settings.compensateBones = false,
                    this._Stage.settings.compensateImages = false,
                    this._AnimationEditor.activate()),
                    this._EditingAnimation = e,
                    this._EditingAnimation) {
                        this._EditingAnimation.addEventListener("play", this.animationPlayStateChanged),
                        this._EditingAnimation.addEventListener("triggerEvent", this.animationEventTriggered),
                        this.enableAnimation(false),
                        this._EditingAnimation.setActor(this._Actor, this._AnimationEditor),
                        this._EditingAnimation.autoKey = this._AutoKey;
                        for (var t = 0; t < this._Actor.animations.length; t++) {
                            var n = this._Actor.animations[t];
                            n.isVisible = n === this._EditingAnimation
                        }
                    } else {
                        var i = []
                          , r = true
                          , o = false
                          , a = void 0;
                        try {
                            for (var s, l = this._SelectedItems[Symbol.iterator](); !(r = (s = l.next()).done); r = true) {
                                var u = s.value;
                                u instanceof m.default && i.push(u)
                            }
                        } catch (e) {
                            o = true,
                            a = e
                        } finally {
                            try {
                                !r && l.return && l.return()
                            } finally {
                                if (o)
                                    throw a
                            }
                        }
                        i.length && this.deselectItems(i),
                        this._Stage.settings.compensateBones = this._WasCompensating.compensateBones,
                        this._Stage.settings.compensateImages = this._WasCompensating.compensateImages,
                        this._AnimationEditor.deactivate(),
                        this._Actor.stopAnimations()
                    }
                    this.enableAnimation(null != e),
                    this.animationPlayStateChanged(),
                    this.dispatch("editingAnimationChanged");
                    var c = this._Stage;
                    c.tool && !c.tool.validate() && (c.toolType = b.default),
                    c.updateToolSelection()
                }
            }
        }, {
            key: "animations",
            get: function() {
                return this.editor.filePanel.animationFolder.hierarchyChildren
            }
        }]),
        t
    }(a.default)
    ).prototype, "onStageItemVisibilityChanged", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "onStageItemVisibilityChanged"), i.prototype),
    N(i.prototype, "onRMStateChanged", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "onRMStateChanged"), i.prototype),
    N(i.prototype, "onFileLoaded", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "onFileLoaded"), i.prototype),
    N(i.prototype, "onFileRenamed", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "onFileRenamed"), i.prototype),
    N(i.prototype, "checkGraphicsProgress", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "checkGraphicsProgress"), i.prototype),
    N(i.prototype, "advance", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "advance"), i.prototype),
    N(i.prototype, "updateWindowSize", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "updateWindowSize"), i.prototype),
    N(i.prototype, "onContextMenu", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "onContextMenu"), i.prototype),
    N(i.prototype, "onFocus", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "onFocus"), i.prototype),
    N(i.prototype, "onMouseDown", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "onMouseDown"), i.prototype),
    N(i.prototype, "onMouseUp", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "onMouseUp"), i.prototype),
    N(i.prototype, "onMouseMove", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "onMouseMove"), i.prototype),
    N(i.prototype, "onDrag", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "onDrag"), i.prototype),
    N(i.prototype, "onMouseEnterCanvas", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "onMouseEnterCanvas"), i.prototype),
    N(i.prototype, "onMouseLeaveCanvas", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "onMouseLeaveCanvas"), i.prototype),
    N(i.prototype, "onMouseEnterWindow", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "onMouseEnterWindow"), i.prototype),
    N(i.prototype, "onMouseLeaveWindow", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "onMouseLeaveWindow"), i.prototype),
    N(i.prototype, "onMouseWheel", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "onMouseWheel"), i.prototype),
    N(i.prototype, "onBlur", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "onBlur"), i.prototype),
    N(i.prototype, "onKeyDown", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "onKeyDown"), i.prototype),
    N(i.prototype, "onKeyUp", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "onKeyUp"), i.prototype),
    N(i.prototype, "changeParent", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "changeParent"), i.prototype),
    N(i.prototype, "pickParent", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "pickParent"), i.prototype),
    N(i.prototype, "contextMenuSendBehind", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "contextMenuSendBehind"), i.prototype),
    N(i.prototype, "contextMenuBringOver", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "contextMenuBringOver"), i.prototype),
    N(i.prototype, "animationEventTriggered", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "animationEventTriggered"), i.prototype),
    N(i.prototype, "reportDependencyCycles", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "reportDependencyCycles"), i.prototype),
    N(i.prototype, "actorAssetListChanged", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "actorAssetListChanged"), i.prototype),
    N(i.prototype, "animationPlayStateChanged", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "animationPlayStateChanged"), i.prototype),
    N(i.prototype, "onError", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "onError"), i.prototype),
    N(i.prototype, "dragOver", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "dragOver"), i.prototype),
    N(i.prototype, "dragLeave", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "dragLeave"), i.prototype),
    N(i.prototype, "dragDrop", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "dragDrop"), i.prototype),
    N(i.prototype, "addAssetsFromFiles", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "addAssetsFromFiles"), i.prototype),
    i);
    function W(e, t) {
        if (t(e),
        e.children) {
            var n = true
              , i = false
              , r = void 0;
            try {
                for (var o, a = e.children[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                    W(o.value, t)
                }
            } catch (e) {
                i = true,
                r = e
            } finally {
                try {
                    !n && a.return && a.return()
                } finally {
                    if (i)
                        throw r
                }
            }
        }
    }
    t.default = z
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = function(e) {
        i.default.call(this, e),
        r.default.call(this)
    }
    ;
    var i = o(n(1211))
      , r = o(n(1214));
    function o(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = function(e) {
        var t = this
          , n = {}
          , u = {}
          , c = -1
          , d = {
            premultipliedAlpha: false,
            preserveDrawingBuffer: true
        }
          , h = e.getContext("webgl", d) || e.getContext("experimental-webgl", d);
        if (!h)
            throw new i.default;
        h.getExtension("OES_standard_derivatives");
        var f = new o.default(h)
          , p = new a.default(h)
          , y = 0
          , m = 0
          , v = null
          , g = Date.now()
          , _ = r.mat4.create()
          , b = 0
          , w = 0
          , O = [1, 1, 1, 1]
          , S = new Float32Array(O)
          , k = r.mat4.create()
          , P = r.mat4.create()
          , E = h.createBuffer();
        function T() {
            y++
        }
        function C(e) {
            var n = Date.now()
              , i = n - g;
            g = n,
            v = e,
            t.advanceProgress && t.advanceProgress.call(t, m / y, i)
        }
        function x() {
            var e = Date.now()
              , n = e - g;
            g = e,
            m++,
            t.advanceProgress && t.advanceProgress.call(t, m / y, n)
        }
        function I(e) {
            if (h.attachShader(e.program, e.vertex),
            h.attachShader(e.program, e.fragment),
            h.linkProgram(e.program),
            h.getProgramParameter(e.program, h.LINK_STATUS)) {
                for (var t in h.useProgram(e.program),
                e.attributes)
                    -1 == (e.attributes[t].index = h.getAttribLocation(e.program, e.attributes[t].name)) && console.log("Could not find attribute", e.attributes[t].name, "for shader", e.name);
                if (e.attributes2)
                    for (var n in e.attributes2)
                        -1 == (e.attributes2[n].index = h.getAttribLocation(e.program, e.attributes2[n].name)) && console.log("Could not find attribute", e.attributes2[n].name, "for shader", e.name);
                if (e.attributes3)
                    for (var i in e.attributes3)
                        -1 == (e.attributes3[i].index = h.getAttribLocation(e.program, e.attributes3[i].name)) && console.log("Could not find attribute", e.attributes3[i].name, "for shader", e.name);
                for (var r in e.uniforms) {
                    var o = e.uniforms[r];
                    null == (e.uniforms[r] = h.getUniformLocation(e.program, o)) && console.log("Could not find uniform", o, "for shader", e.name)
                }
            } else
                console.log("Could not link shader", e.name, h.getProgramInfoLog(e.program)),
                C(e.name + " failed to link");
            x()
        }
        function D(e) {
            return function() {
                e.fragment.__isReady && e.vertex.__isReady && (delete e.fragment.__isReady,
                delete e.vertex.__isReady,
                I(e))
            }
        }
        function M(e) {
            return T(),
            (e.fragment = A(e.fragment)) && (e.vertex = A(e.vertex)) ? (e.program = h.createProgram(),
            e.fragment.__isReady || (e.fragment.__onLoaded = D(e)),
            e.vertex.__isReady || (e.vertex.__onLoaded = D(e)),
            e.fragment.__isReady && e.vertex.__isReady && I(e),
            e) : null
        }
        function A(e) {
            var t = n[e];
            if (t)
                return t;
            var i, r, o, a, s = null, u = document.getElementById(e);
            if (u) {
                for (var c = "", d = u.firstChild; d; )
                    3 == d.nodeType && (c += d.textContent),
                    d = d.nextSibling;
                var f = c.indexOf("<![CDATA[")
                  , p = c.lastIndexOf("]]>");
                if (-1 != f && -1 != p && (c = c.substring(f + "<![CDATA[".length, p)),
                "x-shader/x-fragment" == u.type)
                    s = h.createShader(h.FRAGMENT_SHADER);
                else {
                    if ("x-shader/x-vertex" != u.type)
                        return C(e + " failed to detect type"),
                        null;
                    s = h.createShader(h.VERTEX_SHADER)
                }
                if (h.shaderSource(s, c),
                h.compileShader(s),
                !h.getShaderParameter(s, h.COMPILE_STATUS))
                    return C(e + " failed to compile"),
                    null;
                s.__isReady = true,
                n[e] = s
            } else
                e.indexOf(".fs") == e.length - 3 ? s = h.createShader(h.FRAGMENT_SHADER) : e.indexOf(".vs") == e.length - 3 && (s = h.createShader(h.VERTEX_SHADER)),
                s.__isReady = false,
                s ? (s.__isLoading = true,
                i = l.default.make("/shaders/" + e),
                o = e,
                a = s,
                L(i, (r = function(e) {
                    e ? (h.shaderSource(a, e),
                    h.compileShader(a),
                    h.getShaderParameter(a, h.COMPILE_STATUS) ? (a.__isReady = true,
                    n[o] = a,
                    a.__onLoaded && a.__onLoaded.call(this, true)) : (console.log(o, h.getShaderInfoLog(a)),
                    C(o + " failed to compile"),
                    a.__onLoaded && a.__onLoaded.call(this, false))) : (C(o + " failed to load"),
                    a.__onLoaded && a.__onLoaded.call(this, false))
                }
                ,
                function(e) {
                    r(e ? this.responseText : null, this.url)
                }
                )).send(null)) : C(e + " is not a valid shader program");
            return s
        }
        function j(e, t, n) {
            var i = e.constructor === ArrayBuffer;
            if (!i) {
                var r = u[e];
                if (r)
                    return r
            }
            (r = n || h.createTexture()).flags = t || 0,
            i || (u[e] = r),
            h.bindTexture(h.TEXTURE_2D, r),
            h.texImage2D(h.TEXTURE_2D, 0, h.RGBA, 1, 1, 0, h.RGBA, h.UNSIGNED_BYTE, null),
            h.texParameteri(h.TEXTURE_2D, h.TEXTURE_MAG_FILTER, h.LINEAR),
            h.texParameteri(h.TEXTURE_2D, h.TEXTURE_MIN_FILTER, h.LINEAR),
            h.texParameteri(h.TEXTURE_2D, h.TEXTURE_WRAP_S, h.CLAMP_TO_EDGE),
            h.texParameteri(h.TEXTURE_2D, h.TEXTURE_WRAP_T, h.CLAMP_TO_EDGE),
            h.bindTexture(h.TEXTURE_2D, null),
            r.isLoaded = false,
            r.width = 0,
            r.height = 0;
            var o, a = new Image;
            if (i) {
                var l = new Blob([e],{
                    type: "image/jpeg"
                });
                e = (window.URL || window.webkitURL).createObjectURL(l)
            }
            return a.src = e,
            T(),
            a.onload = (o = r,
            function() {
                var e = 0 != (o.flags & s.default.ClampToEdge)
                  , t = 0 != (o.flags & s.default.MipMapped);
                x(),
                o.width = a.width,
                o.height = a.height;
                var n = !(0 == a.width || a.width & a.width - 1 || 0 == a.height || a.height & a.height - 1);
                h.bindTexture(h.TEXTURE_2D, o),
                0 != (o.flags & s.default.MultiplyAlpha) ? h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true) : h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false),
                h.texImage2D(h.TEXTURE_2D, 0, h.RGBA, h.RGBA, h.UNSIGNED_BYTE, this),
                h.texParameteri(h.TEXTURE_2D, h.TEXTURE_MAG_FILTER, h.LINEAR),
                h.texParameteri(h.TEXTURE_2D, h.TEXTURE_MIN_FILTER, n && t ? h.LINEAR_MIPMAP_LINEAR : h.LINEAR),
                h.texParameteri(h.TEXTURE_2D, h.TEXTURE_WRAP_S, n && !e ? h.REPEAT : h.CLAMP_TO_EDGE),
                h.texParameteri(h.TEXTURE_2D, h.TEXTURE_WRAP_T, n && !e ? h.REPEAT : h.CLAMP_TO_EDGE),
                n && t && h.generateMipmap(h.TEXTURE_2D),
                h.bindTexture(h.TEXTURE_2D, null)
            }
            ),
            a.onerror = function(e) {
                return function() {
                    e.isLoaded = false
                }
            }(r),
            r
        }
        function L(e, t) {
            var n = new XMLHttpRequest;
            return n.url = e,
            n.cb = t,
            n.open("GET", e, true),
            n.onload = function(e) {
                x(),
                this.cb.call(this, true)
            }
            ,
            n.onerror = function(e) {
                x(),
                this.cb.call(this, false)
            }
            ,
            T(),
            n
        }
        function R(e, t, n, i) {
            var r = h.getParameter(h.ARRAY_BUFFER_BINDING)
              , o = h.getParameter(h.CURRENT_PROGRAM);
            if (o !== e || r !== t) {
                if (o)
                    for (var a = h.getProgramParameter(o, h.ACTIVE_ATTRIBUTES), s = 1; s < a; s++)
                        h.disableVertexAttribArray(s);
                if (null != e) {
                    if (h.useProgram(e.program),
                    n) {
                        h.bindBuffer(h.ARRAY_BUFFER, n);
                        var l = e.attributes2;
                        for (var u in l) {
                            var c = l[u];
                            -1 != c.index && (h.enableVertexAttribArray(c.index),
                            h.vertexAttribPointer(c.index, c.size, h.FLOAT, false, c.stride, c.offset))
                        }
                    }
                    if (i) {
                        h.bindBuffer(h.ARRAY_BUFFER, i);
                        var d = e.attributes3;
                        for (var f in d) {
                            var p = d[f];
                            -1 != p.index && (h.enableVertexAttribArray(p.index),
                            h.vertexAttribPointer(p.index, p.size, h.FLOAT, false, p.stride, p.offset))
                        }
                    }
                    h.bindBuffer(h.ARRAY_BUFFER, t);
                    var y = e.attributes;
                    for (var m in y) {
                        var v = y[m];
                        -1 != v.index && (h.enableVertexAttribArray(v.index),
                        h.vertexAttribPointer(v.index, v.size, h.FLOAT, false, v.stride, v.offset))
                    }
                } else
                    h.useProgram(null)
            }
        }
        function F(e) {
            var t = 0;
            this.update = function(n) {
                h.bindBuffer(h.ARRAY_BUFFER, e),
                h.bufferData(h.ARRAY_BUFFER, n instanceof Float32Array ? n : new Float32Array(n), h.DYNAMIC_DRAW),
                t = n.length
            }
            ,
            this.__defineGetter__("id", (function() {
                return e
            }
            )),
            this.__defineGetter__("size", (function() {
                return t
            }
            )),
            this.dispose = function() {
                h.deleteBuffer(e)
            }
        }
        function B(e) {
            var t = 0;
            this.update = function(n) {
                h.bindBuffer(h.ELEMENT_ARRAY_BUFFER, e),
                h.bufferData(h.ELEMENT_ARRAY_BUFFER, n instanceof Uint16Array ? n : new Uint16Array(n), h.DYNAMIC_DRAW),
                t = n.length
            }
            ,
            this.__defineGetter__("id", (function() {
                return e
            }
            )),
            this.__defineGetter__("size", (function() {
                return t
            }
            )),
            this.dispose = function() {
                h.deleteBuffer(e)
            }
        }
        this.__defineGetter__("gl", (function() {
            return h
        }
        )),
        this.__defineGetter__("projection", (function() {
            return _
        }
        )),
        this.__defineGetter__("viewportWidth", (function() {
            return b
        }
        )),
        this.__defineGetter__("viewportHeight", (function() {
            return w
        }
        )),
        this.__defineGetter__("isLoading", (function() {
            return y != m
        }
        )),
        this.__defineGetter__("loadProgress", (function() {
            return m / y
        }
        )),
        this.__defineGetter__("loadError", (function() {
            return v
        }
        )),
        this.initializeShader = M,
        this.loadTexture = j,
        this.downloadTexture = function(e, t) {
            var n, i, r = u[e];
            return r || (r = h.createTexture(),
            function(e, t) {
                var n = L(e, (i = t,
                function(e) {
                    i(e ? this.response : null, this.url)
                }
                ));
                var i;
                n.responseType = "arraybuffer",
                n.send(null)
            }(e, (n = r,
            i = t,
            function(e) {
                e && j(this.response, i, n)
            }
            )),
            r)
        }
        ,
        this.setSize = function(t, n) {
            return (e.width !== t || e.height !== n) && (e.width = t,
            e.height = n,
            b = t,
            w = n,
            r.mat4.ortho(_, 0, b, 0, w, 0, 1),
            h.viewport(0, 0, b, w),
            true)
        }
        ,
        this.setViewport = function(e, t) {
            b = e,
            w = t,
            r.mat4.ortho(_, 0, b, 0, w, 0, 1),
            h.viewport(0, 0, b, w)
        }
        ,
        this.disableBlending = function() {
            0 !== c && (c = 0,
            h.disable(h.BLEND))
        }
        ,
        this.enableBlending = function() {
            1 !== c && (c = 1,
            h.enable(h.BLEND),
            h.blendFuncSeparate(h.SRC_ALPHA, h.ONE_MINUS_SRC_ALPHA, h.SRC_ALPHA, h.ONE))
        }
        ,
        this.enableNormalBlending = function() {
            6 !== c && (c = 6,
            h.enable(h.BLEND),
            h.blendFunc(h.ONE, h.ONE_MINUS_SRC_ALPHA))
        }
        ,
        this.enablePremultipliedBlending = function() {
            4 !== c && (c = 4,
            h.enable(h.BLEND),
            h.blendFuncSeparate(h.ONE, h.ONE_MINUS_SRC_ALPHA, h.ONE, h.ONE_MINUS_SRC_ALPHA))
        }
        ,
        this.enableAdditiveBlending = function() {
            5 !== c && (c = 5,
            h.enable(h.BLEND),
            h.blendFuncSeparate(h.ONE, h.ONE, h.ONE, h.ONE))
        }
        ,
        this.enableScreenBlending = function() {
            2 !== c && (c = 2,
            h.enable(h.BLEND),
            h.blendFuncSeparate(h.ONE, h.ONE_MINUS_SRC_COLOR, h.ONE, h.ONE_MINUS_SRC_ALPHA))
        }
        ,
        this.enableMultiplyBlending = function() {
            3 !== c && (c = 3,
            h.enable(h.BLEND),
            h.blendFuncSeparate(h.DST_COLOR, h.ONE_MINUS_SRC_ALPHA, h.DST_ALPHA, h.ONE_MINUS_SRC_ALPHA))
        }
        ,
        this.bind = R,
        this.makeVertexBuffer = function(e) {
            var t = new F(h.createBuffer());
            return e && t.update(e),
            t
        }
        ,
        this.makeIndexBuffer = function(e) {
            var t = new B(h.createBuffer());
            return e && t.update(e),
            t
        }
        ,
        this.drawLine = function(e, t, n, i) {
            var r;
            k[0] = e[0],
            k[1] = e[1],
            k[4] = e[2],
            k[5] = e[3],
            k[12] = e[4],
            k[13] = e[5],
            i || (i = O),
            t.constructor === F ? (r = t.size / 2,
            R(V, t.id)) : (r = t.length / 2,
            h.bindBuffer(h.ARRAY_BUFFER, E),
            h.bufferData(h.ARRAY_BUFFER, new Float32Array(t), h.DYNAMIC_DRAW),
            R(V, E)),
            S[0] = i[0],
            S[1] = i[1],
            S[2] = i[2],
            S[3] = i[3];
            var o = V.uniforms;
            h.uniform2f(o.Viewport, b, w),
            h.uniform1f(o.Opacity, n),
            h.uniform4fv(o.Color, S),
            h.uniformMatrix4fv(o.WorldMatrix, false, k),
            h.uniformMatrix4fv(o.ProjectionMatrix, false, _),
            h.drawArrays(h.LINES, 0, r)
        }
        ,
        this.drawColor = function(e, t, n, i, r, o) {
            P[0] = e[0],
            P[1] = e[1],
            P[4] = e[2],
            P[5] = e[3],
            P[12] = e[4],
            P[13] = e[5],
            r || (r = O),
            void 0 === i && (i = 1);
            var a = o ? z : N;
            R(a, t.id),
            S[0] = r[0],
            S[1] = r[1],
            S[2] = r[2],
            S[3] = r[3];
            var s = a.uniforms;
            h.uniform1f(s.Opacity, i),
            h.uniform4fv(s.Color, S),
            h.uniformMatrix4fv(s.WorldMatrix, false, P),
            h.uniformMatrix4fv(s.ProjectionMatrix, false, _),
            h.bindBuffer(h.ELEMENT_ARRAY_BUFFER, n.id),
            h.drawElements(h.TRIANGLES, n.size, h.UNSIGNED_SHORT, 0)
        }
        ,
        this.makeThickLine = f.make,
        this.makeWireframe = function(e, t, n, i, r) {
            for (var o = [], a = 0; a < t.length; a++)
                for (var s = t[a] * i, l = 0; l < i; l++)
                    o.push(e[s + l]);
            return p.make(o, n, i, r)
        }
        ,
        this.drawThickLine = function(e, t, n, i, r) {
            k[0] = e[0],
            k[1] = e[1],
            k[4] = e[2],
            k[5] = e[3],
            k[12] = e[4],
            k[13] = e[5],
            void 0 === i && (i = 1),
            r || (r = O),
            r = [r[0], r[1], r[2], r[3] * i],
            f.draw(t, n, r, k, _)
        }
        ,
        this.drawWireframe = function(e, t, n, i, r) {
            k[0] = e[0],
            k[1] = e[1],
            k[4] = e[2],
            k[5] = e[3],
            k[12] = e[4],
            k[13] = e[5],
            p.draw(t, n, i, r, k, _)
        }
        ;
        var V = M({
            name: "LineShader",
            vertex: "Line.vs",
            fragment: "Color.fs",
            attributes: {
                VertexPosition: {
                    name: "VertexPosition",
                    size: 2,
                    stride: 8,
                    offset: 0
                }
            },
            uniforms: {
                ProjectionMatrix: "ProjectionMatrix",
                WorldMatrix: "WorldMatrix",
                Opacity: "Opacity",
                Color: "Color",
                Viewport: "Viewport"
            }
        })
          , N = M({
            name: "ColorShader",
            vertex: "Color.vs",
            fragment: "Color.fs",
            attributes: {
                VertexPosition: {
                    name: "VertexPosition",
                    size: 2,
                    stride: 8,
                    offset: 0
                }
            },
            uniforms: {
                ProjectionMatrix: "ProjectionMatrix",
                WorldMatrix: "WorldMatrix",
                Opacity: "Opacity",
                Color: "Color"
            }
        })
          , z = M({
            name: "ColorUVShader",
            vertex: "Color.vs",
            fragment: "Color.fs",
            attributes: {
                VertexPosition: {
                    name: "VertexPosition",
                    size: 2,
                    stride: 16,
                    offset: 0
                }
            },
            uniforms: {
                ProjectionMatrix: "ProjectionMatrix",
                WorldMatrix: "WorldMatrix",
                Opacity: "Opacity",
                Color: "Color"
            }
        })
    }
    ;
    var i = u(n(728))
      , r = n(2)
      , o = u(n(1212))
      , a = u(n(1213))
      , s = u(n(444))
      , l = u(n(3));
    function u(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = function(e) {
        var t = i.vec2.create()
          , n = i.vec2.create()
          , r = i.vec2.create()
          , o = i.vec2.create()
          , a = i.vec2.create();
        function s(e, t) {
            return i.vec2.set(e, -t[1], t[0]),
            e
        }
        function l(e, t, n, i) {
            e.push(t[0], t[1], n[0], n[1], i, t[0], t[1], n[0], n[1], -i)
        }
        function u(e, t, n) {
            return i.vec2.subtract(e, t, n),
            i.vec2.normalize(e, e),
            e
        }
        function c(e, t, n, r, o) {
            return i.vec2.add(e, n, r),
            i.vec2.normalize(e, e),
            i.vec2.set(t, -e[1], e[0]),
            i.vec2.set(a, -n[1], n[0]),
            o / i.vec2.dot(t, a)
        }
        this.make = function(e, a) {
            var d, h = [];
            a && (e = e.slice()).push(e[0]);
            for (var f = e.length, p = 1; p < f; p++) {
                var y = e[p - 1]
                  , m = e[p]
                  , v = p < f - 1 ? e[p + 1] : null;
                if (i.vec2.subtract(t, m, y),
                i.vec2.normalize(t, t),
                d || s(d = i.vec2.create(), t),
                1 === p && l(h, y, d, 1),
                v) {
                    u(n, v, m);
                    var g = c(r, o, t, n, 1);
                    l(h, m, o, g)
                } else
                    s(d, t),
                    l(h, m, d, 1)
            }
            if (e.length > 2 && a) {
                var _ = e[f - 2]
                  , b = e[0]
                  , w = e[1];
                u(t, b, _),
                u(n, w, b),
                s(d, t);
                var O = c(r, o, t, n, 1)
                  , S = 5 * (f - 1) * 2;
                h[S + 2] = h[2] = h[S + 2 + 5] = h[7] = o[0],
                h[S + 3] = h[3] = h[S + 3 + 5] = h[8] = o[1],
                h[S + 4] = h[4] = O,
                h[S + 4 + 5] = h[9] = -O
            }
            return new Float32Array(h)
        }
        ,
        this.draw = function(t, n, r, o, a) {
            n || (n = 1);
            r || (r = [0, 0, 0, 1]),
            a || (i.mat4.ortho(w, 0, e.canvas.width, e.canvas.height, 0, 0, 1),
            a = w),
            o || (o = O),
            e.bindBuffer(e.ARRAY_BUFFER, h),
            e.bufferData(e.ARRAY_BUFFER, t, e.DYNAMIC_DRAW);
            var s = e.getParameter(e.CURRENT_PROGRAM);
            if (s !== d) {
                if (null != s)
                    for (var l = e.getProgramParameter(s, e.ACTIVE_ATTRIBUTES), u = 1; u < l; u++)
                        e.disableVertexAttribArray(u);
                e.useProgram(d),
                e.bindBuffer(e.ARRAY_BUFFER, h),
                e.enableVertexAttribArray(f),
                e.vertexAttribPointer(f, 2, e.FLOAT, false, 20, 0),
                e.enableVertexAttribArray(p),
                e.vertexAttribPointer(p, 2, e.FLOAT, false, 20, 8),
                e.enableVertexAttribArray(y),
                e.vertexAttribPointer(y, 1, e.FLOAT, false, 20, 16)
            }
            var c = o[0]
              , k = o[1]
              , P = Math.sqrt(c * c + k * k)
              , E = n + 2 / P
              , T = E * P;
            i.vec4.copy(S, r),
            e.uniformMatrix4fv(v, false, o),
            e.uniformMatrix4fv(m, false, a),
            e.uniform1f(g, E),
            e.uniform4fv(_, S),
            T = Math.max(0, (T / 2 - 1) / (T / 2)),
            e.uniform1f(b, T),
            e.drawArrays(e.TRIANGLE_STRIP, 0, t.length / 5)
        }
        ;
        var d, h, f, p, y, m, v, g, _, b, w = i.mat4.create(), O = i.mat4.create(), S = i.vec4.create();
        !function() {
            h = e.createBuffer();
            var t = ["attribute vec2 position;", "attribute vec2 normal;", "attribute float miter; ", "uniform mat4 projection;", "uniform mat4 modelView;", "uniform float thickness;", "varying float edge;", "void main()", "{", "  edge = sign(miter);", "  vec2 pointPos = position.xy + vec2(normal * thickness/2.0 * miter);", "  gl_Position = projection * modelView * vec4(pointPos, 0.0, 1.0);", "}"].join("\n")
              , n = ["#ifdef GL_ES", "precision highp float;", "#endif", "uniform vec4 color;", "uniform float inner;", "varying float edge;", "void main()", "{", "  float v = abs(edge);", "  v = max(0.0, v-inner)/(1.0-inner);// = smoothstep(0.65, 0.7, v); ", "  gl_FragColor =  mix(color, vec4(color.xyz, 0.0), v);//vec4(1.0, 1.0, 1.0, v);//", "}"].join("\n");
            d = e.createProgram();
            var i = e.createShader(e.VERTEX_SHADER);
            e.shaderSource(i, t),
            e.compileShader(i, t),
            e.getShaderParameter(i, e.COMPILE_STATUS) ? (t = i,
            i = e.createShader(e.FRAGMENT_SHADER),
            e.shaderSource(i, n),
            e.compileShader(i, n),
            e.getShaderParameter(i, e.COMPILE_STATUS) ? (n = i,
            e.attachShader(d, t),
            e.attachShader(d, n),
            e.linkProgram(d),
            e.getProgramParameter(d, e.LINK_STATUS) ? (e.useProgram(d),
            -1 == (f = e.getAttribLocation(d, "position")) && console.log("Could not find attribute position for lines shader."),
            -1 == (p = e.getAttribLocation(d, "normal")) && console.log("Could not find attribute normal for lines shader."),
            -1 == (y = e.getAttribLocation(d, "miter")) && console.log("Could not find attribute miter for lines shader."),
            -1 == (m = e.getUniformLocation(d, "projection")) && console.log("Could not find projection uniform for lines shader."),
            -1 == (v = e.getUniformLocation(d, "modelView")) && console.log("Could not find modelView uniform for lines shader."),
            -1 == (g = e.getUniformLocation(d, "thickness")) && console.log("Could not find thickness uniform for lines shader."),
            -1 == (_ = e.getUniformLocation(d, "color")) && console.log("Could not find color uniform for lines shader."),
            -1 == (b = e.getUniformLocation(d, "inner")) && console.log("Could not find inner uniform for lines shader."),
            e.useProgram(null)) : console.log("Could not link lines shader", e.getProgramInfoLog(d))) : console.log("Line vertex shader", e.getShaderInfoLog(i))) : console.log("Line vertex shader", e.getShaderInfoLog(i))
        }()
    }
    ;
    var i = n(2)
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = function(e) {
        this.make = function(e, t, n, i) {
            t || (t = 3),
            i || (i = 0),
            n || (n = t);
            for (var r = [], o = e.length / n / 3, a = i, s = [[1, 0, 0], [0, 1, 0], [0, 0, 1]], l = 0; l < o; l++)
                for (var u = 0; u < 3; u++) {
                    var c = void 0;
                    for (c = 0; c < t; c++)
                        r.push(e[a + c]);
                    for (; c < 3; )
                        r.push(0),
                        c++;
                    var d = s[u];
                    r.push(d[0], d[1], d[2]),
                    a += n
                }
            return new Float32Array(r)
        }
        ,
        this.draw = function(y, m, v, g, _, b) {
            m || (m = 1.5),
            v || (v = [0, 0, 0, 1]),
            g || (g = [0, 0, 0, .4]),
            b || (i.mat4.ortho(t, 0, e.canvas.width, e.canvas.height, 0, 0, 1),
            b = t),
            _ || (_ = n),
            e.bindBuffer(e.ARRAY_BUFFER, s),
            e.bufferData(e.ARRAY_BUFFER, y, e.DYNAMIC_DRAW);
            var w = e.getParameter(e.CURRENT_PROGRAM);
            if (w !== a) {
                if (null != w)
                    for (var O = e.getProgramParameter(w, e.ACTIVE_ATTRIBUTES), S = 1; S < O; S++)
                        e.disableVertexAttribArray(S);
                e.useProgram(a),
                e.bindBuffer(e.ARRAY_BUFFER, s),
                e.enableVertexAttribArray(l),
                e.vertexAttribPointer(l, 3, e.FLOAT, false, 24, 0),
                e.enableVertexAttribArray(u),
                e.vertexAttribPointer(u, 3, e.FLOAT, false, 24, 12)
            }
            i.vec4.copy(r, v),
            i.vec4.copy(o, g),
            e.uniformMatrix4fv(d, false, _),
            e.uniformMatrix4fv(c, false, b),
            e.uniform1f(h, m),
            e.uniform4fv(f, r),
            e.uniform4fv(p, o),
            e.drawArrays(e.TRIANGLES, 0, y.length / 6)
        }
        ;
        var t = i.mat4.create()
          , n = i.mat4.create()
          , r = i.vec4.create()
          , o = i.vec4.create()
          , a = void 0
          , s = void 0
          , l = void 0
          , u = void 0
          , c = void 0
          , d = void 0
          , h = void 0
          , f = void 0
          , p = void 0;
        !function() {
            e.getExtension("OES_standard_derivatives"),
            s = e.createBuffer();
            var t = ["attribute vec3 position;", "attribute vec3 barycentric;", "uniform mat4 projection;", "uniform mat4 modelView;", "varying vec3 bc;", "void main()", "{", "  bc = barycentric;", "  gl_Position = projection * modelView * vec4(position, 1.0);", "}"].join("\n")
              , n = ["#ifdef GL_ES", "precision highp float;", "#endif", "#extension GL_OES_standard_derivatives : enable", "uniform vec4 edgeColor;", "uniform vec4 innerColor;", "uniform float thickness;", "varying vec3 bc;", "void main()", "{", "\tvec3 d = fwidth(bc);", "\tvec3 a3 = smoothstep(vec3(0.0), d*thickness, bc);", "\tfloat edgeFactor = min(min(a3.x, a3.y), a3.z);", "\tgl_FragColor = mix(edgeColor, innerColor, edgeFactor);", "}"].join("\n");
            a = e.createProgram();
            var i = e.createShader(e.VERTEX_SHADER);
            e.shaderSource(i, t),
            e.compileShader(i, t),
            e.getShaderParameter(i, e.COMPILE_STATUS) ? (t = i,
            i = e.createShader(e.FRAGMENT_SHADER),
            e.shaderSource(i, n),
            e.compileShader(i, n),
            e.getShaderParameter(i, e.COMPILE_STATUS) ? (n = i,
            e.attachShader(a, t),
            e.attachShader(a, n),
            e.linkProgram(a),
            e.getProgramParameter(a, e.LINK_STATUS) ? (e.useProgram(a),
            -1 == (l = e.getAttribLocation(a, "position")) && console.log("Could not find attribute position for wireframe shader."),
            -1 == (u = e.getAttribLocation(a, "barycentric")) && console.log("Could not find attribute barycentric for wireframe shader."),
            -1 == (c = e.getUniformLocation(a, "projection")) && console.log("Could not find projection uniform for wireframe shader."),
            -1 == (d = e.getUniformLocation(a, "modelView")) && console.log("Could not find modelView uniform for wireframe shader."),
            -1 == (h = e.getUniformLocation(a, "thickness")) && console.log("Could not find thickness uniform for wireframe shader."),
            -1 == (f = e.getUniformLocation(a, "edgeColor")) && console.log("Could not find edge color uniform for wireframe shader."),
            -1 == (p = e.getUniformLocation(a, "innerColor")) && console.log("Could not find inner color uniform for wireframe shader."),
            e.useProgram(null)) : console.log("Could not link wireframe shader", e.getProgramInfoLog(a))) : console.log("Line vertex shader", e.getShaderInfoLog(i))) : console.log("Line vertex shader", e.getShaderInfoLog(i))
        }()
    }
    ;
    var i = n(2)
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = function() {
        var e = this
          , t = e.gl;
        t.getExtension("OES_standard_derivatives");
        var n, i = new Float32Array([1, 1, 1, 1]), o = r.mat4.create(), s = r.mat4.create(), l = e.initializeShader({
            name: "PieShader",
            vertex: "Pie.vs",
            fragment: "Pie.fs",
            attributes: {
                Position: {
                    name: "Position",
                    size: 2,
                    stride: 36,
                    offset: 0
                },
                Color: {
                    name: "Color",
                    size: 4,
                    stride: 36,
                    offset: 8
                },
                Rotation: {
                    name: "Rotation",
                    size: 1,
                    stride: 36,
                    offset: 24
                },
                Thickness: {
                    name: "Thickness",
                    size: 1,
                    stride: 36,
                    offset: 28
                },
                Angle: {
                    name: "Angle",
                    size: 1,
                    stride: 36,
                    offset: 32
                }
            },
            uniforms: {
                ProjectionMatrix: "ProjectionMatrix",
                ViewMatrix: "ViewMatrix",
                Size: "Size",
                Antialias: "Antialias"
            }
        }), u = e.initializeShader({
            name: "ColorCodedSkinShader",
            vertex: "ColorCodedSkin.vs",
            fragment: "ColorCodedSkin.fs",
            attributes: {
                VertexPosition: {
                    name: "VertexPosition",
                    size: 2,
                    stride: 16,
                    offset: 0
                }
            },
            attributes2: {
                VertexPosition: {
                    name: "VertexBoneIndices",
                    size: 4,
                    stride: 32,
                    offset: 0
                },
                VertexNormal: {
                    name: "VertexWeights",
                    size: 4,
                    stride: 32,
                    offset: 16
                }
            },
            uniforms: {
                ProjectionMatrix: "ProjectionMatrix",
                WorldMatrix: "WorldMatrix",
                Opacity: "Opacity",
                BoneColors: "BoneColors"
            }
        }), c = e.initializeShader({
            name: "ColorCodedSkinShader",
            vertex: "ColorCodedSkinDeformed.vs",
            fragment: "ColorCodedSkin.fs",
            attributes: {
                VertexPosition: {
                    name: "VertexPosition",
                    size: 2,
                    stride: 16,
                    offset: 0
                }
            },
            attributes2: {
                VertexBoneIndices: {
                    name: "VertexBoneIndices",
                    size: 4,
                    stride: 32,
                    offset: 0
                },
                VertexWeights: {
                    name: "VertexWeights",
                    size: 4,
                    stride: 32,
                    offset: 16
                }
            },
            attributes3: {
                PaintBoneIndices: {
                    name: "PaintBoneIndices",
                    size: 4,
                    stride: 32,
                    offset: 0
                },
                PaintWeights: {
                    name: "PaintWeights",
                    size: 4,
                    stride: 32,
                    offset: 16
                }
            },
            uniforms: {
                ProjectionMatrix: "ProjectionMatrix",
                ViewMatrix: "ViewMatrix",
                WorldMatrix: "WorldMatrix",
                Opacity: "Opacity",
                BoneColors: "BoneColors",
                BoneMatrices: "BoneMatrices"
            }
        }), d = e.initializeShader({
            name: "TexturedShader",
            vertex: "Textured.vs",
            fragment: "Textured.fs",
            attributes: {
                VertexPosition: {
                    name: "VertexPosition",
                    size: 2,
                    stride: 16,
                    offset: 0
                },
                VertexNormal: {
                    name: "VertexTexCoord",
                    size: 2,
                    stride: 16,
                    offset: 8
                }
            },
            uniforms: {
                ProjectionMatrix: "ProjectionMatrix",
                WorldMatrix: "WorldMatrix",
                TextureSampler: "TextureSampler",
                Opacity: "Opacity",
                Color: "Color"
            }
        }), h = e.initializeShader({
            name: "TexturedSkinShader",
            vertex: "TexturedSkin.vs",
            fragment: "Textured.fs",
            attributes: {
                VertexPosition: {
                    name: "VertexPosition",
                    size: 2,
                    stride: 16,
                    offset: 0
                },
                VertexTexCoord: {
                    name: "VertexTexCoord",
                    size: 2,
                    stride: 16,
                    offset: 8
                }
            },
            attributes2: {
                VertexPosition: {
                    name: "VertexBoneIndices",
                    size: 4,
                    stride: 32,
                    offset: 0
                },
                VertexWeights: {
                    name: "VertexWeights",
                    size: 4,
                    stride: 32,
                    offset: 16
                }
            },
            uniforms: {
                ProjectionMatrix: "ProjectionMatrix",
                ViewMatrix: "ViewMatrix",
                WorldMatrix: "WorldMatrix",
                TextureSampler: "TextureSampler",
                Opacity: "Opacity",
                Color: "Color",
                BoneMatrices: "BoneMatrices"
            }
        }), f = e.initializeShader({
            name: "ContouredSkinShader",
            vertex: "TexturedSkin.vs",
            fragment: "Contoured.fs",
            attributes: {
                VertexPosition: {
                    name: "VertexPosition",
                    size: 2,
                    stride: 16,
                    offset: 0
                },
                VertexNormal: {
                    name: "VertexTexCoord",
                    size: 2,
                    stride: 16,
                    offset: 8
                }
            },
            attributes2: {
                VertexPosition: {
                    name: "VertexBoneIndices",
                    size: 4,
                    stride: 32,
                    offset: 0
                },
                VertexNormal: {
                    name: "VertexWeights",
                    size: 4,
                    stride: 32,
                    offset: 16
                }
            },
            uniforms: {
                ProjectionMatrix: "ProjectionMatrix",
                ViewMatrix: "ViewMatrix",
                WorldMatrix: "WorldMatrix",
                TextureSampler: "TextureSampler",
                Opacity: "Opacity",
                Color: "Color",
                BoneMatrices: "BoneMatrices",
                ContourScale: "ContourScale"
            }
        }), p = e.initializeShader({
            name: "TexturedShader",
            vertex: "Textured.vs",
            fragment: "TexturedTint.fs",
            attributes: {
                VertexPosition: {
                    name: "VertexPosition",
                    size: 2,
                    stride: 16,
                    offset: 0
                },
                VertexNormal: {
                    name: "VertexTexCoord",
                    size: 2,
                    stride: 16,
                    offset: 8
                }
            },
            uniforms: {
                ProjectionMatrix: "ProjectionMatrix",
                WorldMatrix: "WorldMatrix",
                TextureSampler: "TextureSampler",
                Opacity: "Opacity",
                Color: "Color"
            }
        }), y = e.initializeShader({
            name: "ContourShader",
            vertex: "Textured.vs",
            fragment: "Contoured.fs",
            attributes: {
                VertexPosition: {
                    name: "VertexPosition",
                    size: 2,
                    stride: 16,
                    offset: 0
                },
                VertexNormal: {
                    name: "VertexTexCoord",
                    size: 2,
                    stride: 16,
                    offset: 8
                }
            },
            uniforms: {
                ProjectionMatrix: "ProjectionMatrix",
                WorldMatrix: "WorldMatrix",
                TextureSampler: "TextureSampler",
                Opacity: "Opacity",
                Color: "Color",
                ContourScale: "ContourScale"
            }
        }), m = e.initializeShader({
            name: "GridShader",
            vertex: "Grid.vs",
            fragment: "Grid.fs",
            attributes: {
                VertexPosition: {
                    name: "VertexPosition",
                    size: 2,
                    stride: 16,
                    offset: 0
                },
                VertexNormal: {
                    name: "VertexTexCoord",
                    size: 2,
                    stride: 16,
                    offset: 8
                }
            },
            uniforms: {
                ProjectionMatrix: "ProjectionMatrix",
                WorldMatrix: "WorldMatrix",
                Opacity: "Opacity",
                DiagonalIntensity: "DiagonalIntensity",
                SmallIntensity: "SmallIntensity"
            }
        }), v = e.initializeShader({
            name: "GridShader",
            vertex: "Grid.vs",
            fragment: "GridAxis.fs",
            attributes: {
                VertexPosition: {
                    name: "VertexPosition",
                    size: 2,
                    stride: 16,
                    offset: 0
                },
                VertexNormal: {
                    name: "VertexTexCoord",
                    size: 2,
                    stride: 16,
                    offset: 8
                }
            },
            uniforms: {
                ProjectionMatrix: "ProjectionMatrix",
                WorldMatrix: "WorldMatrix",
                Opacity: "Opacity",
                DiagonalIntensity: "DiagonalIntensity",
                SmallIntensity: "SmallIntensity"
            }
        }), g = e.initializeShader({
            name: "GridShader",
            vertex: "Grid.vs",
            fragment: "GridSubdivisions.fs",
            attributes: {
                VertexPosition: {
                    name: "VertexPosition",
                    size: 2,
                    stride: 16,
                    offset: 0
                },
                VertexNormal: {
                    name: "VertexTexCoord",
                    size: 2,
                    stride: 16,
                    offset: 8
                }
            },
            uniforms: {
                ProjectionMatrix: "ProjectionMatrix",
                WorldMatrix: "WorldMatrix",
                Opacity: "Opacity",
                DiagonalIntensity: "DiagonalIntensity",
                SmallIntensity: "SmallIntensity"
            }
        }), _ = t.createBuffer();
        t.bindBuffer(t.ARRAY_BUFFER, _),
        t.bufferData(t.ARRAY_BUFFER, n = new Float32Array([0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0]), t.DYNAMIC_DRAW);
        var b = r.mat4.create();
        var w = null;
        function O(n, i) {
            var r = t.createFramebuffer()
              , o = t.createTexture();
            t.bindTexture(t.TEXTURE_2D, o),
            t.texParameteri(t.TEXTURE_2D, t.TEXTURE_MAG_FILTER, t.NEAREST),
            t.texParameteri(t.TEXTURE_2D, t.TEXTURE_MIN_FILTER, t.NEAREST),
            t.texParameteri(t.TEXTURE_2D, t.TEXTURE_WRAP_S, t.CLAMP_TO_EDGE),
            t.texParameteri(t.TEXTURE_2D, t.TEXTURE_WRAP_T, t.CLAMP_TO_EDGE);
            var a = n || e.viewportWidth
              , s = i || e.viewportHeight;
            t.texImage2D(t.TEXTURE_2D, 0, t.RGBA, a, s, 0, t.RGBA, t.UNSIGNED_BYTE, null),
            t.bindTexture(t.TEXTURE_2D, null),
            t.bindFramebuffer(t.FRAMEBUFFER, r),
            t.framebufferTexture2D(t.FRAMEBUFFER, t.COLOR_ATTACHMENT0, t.TEXTURE_2D, o, 0),
            t.bindFramebuffer(t.FRAMEBUFFER, null);
            var l = null
              , u = 0
              , c = 0;
            this.bind = function(n, i) {
                w !== r && (l = w,
                u = e.viewportWidth,
                c = e.viewportHeight),
                n || (n = e.viewportWidth),
                i || (i = e.viewportHeight),
                a == n && s == i || (a = n,
                s = i,
                t.bindTexture(t.TEXTURE_2D, o),
                t.texImage2D(t.TEXTURE_2D, 0, t.RGBA, n, i, 0, t.RGBA, t.UNSIGNED_BYTE, null),
                t.bindTexture(t.TEXTURE_2D, null)),
                e.setViewport(n, i),
                t.viewport(0, 0, n, i),
                t.bindFramebuffer(t.FRAMEBUFFER, r),
                t.clearColor(.3628, .3628, .3628, 0),
                t.clear(t.COLOR_BUFFER_BIT),
                w = r
            }
            ,
            this.__defineGetter__("texture", (function() {
                return o
            }
            )),
            this.unbind = function() {
                t.bindFramebuffer(t.FRAMEBUFFER, l),
                e.setViewport(u, c),
                w = l
            }
            ,
            this.destroy = function() {
                t.deleteFramebuffer(r),
                t.deleteTexture(o)
            }
            ,
            this.read = function() {
                var e = new Uint8Array(a * s * 4);
                return t.readPixels(0, 0, a, s, t.RGBA, t.UNSIGNED_BYTE, e),
                e
            }
        }
        this.makeFrameBuffer = function(e, t) {
            return new O(e,t)
        }
        ,
        this.drawGrid = function(i, r, o, a, s, l, u, c, d) {
            var h;
            if (i && r)
                h = m;
            else if (i)
                h = v;
            else {
                if (!r)
                    return t.clearColor(.3628, .3628, .3628, 1),
                    void t.clear(t.COLOR_BUFFER_BIT);
                h = g
            }
            var f = e.viewportWidth
              , p = e.viewportHeight;
            n[0] = 0,
            n[1] = p,
            n[4] = 0,
            n[5] = 0,
            n[8] = f,
            n[9] = p,
            n[12] = f,
            n[13] = 0;
            var y = h.uniforms;
            e.bind(h, _),
            t.bufferData(t.ARRAY_BUFFER, n, t.DYNAMIC_DRAW),
            t.uniform1f(y.Opacity, u),
            t.uniform1f(y.DiagonalIntensity, c),
            t.uniform1f(y.SmallIntensity, d),
            b[0] = f / s,
            b[5] = p / l,
            b[12] = -o / s,
            b[13] = -a / l,
            t.uniformMatrix4fv(y.WorldMatrix, false, b),
            t.uniformMatrix4fv(y.ProjectionMatrix, false, e.projection),
            t.drawArrays(t.TRIANGLE_STRIP, 0, 4)
        }
        ,
        this.drawColorCodedSkin = function(n, i, r, a, s, l) {
            o[0] = n[0],
            o[1] = n[1],
            o[4] = n[2],
            o[5] = n[3],
            o[12] = n[4],
            o[13] = n[5],
            e.bind(u, i.id, r.id);
            var c = u.uniforms;
            t.uniform1f(c.Opacity, l),
            t.uniform4fv(c.BoneColors, s),
            t.uniformMatrix4fv(c.WorldMatrix, false, o),
            t.uniformMatrix4fv(c.ProjectionMatrix, false, e.projection),
            t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, a.id),
            t.drawElements(t.TRIANGLES, a.size, t.UNSIGNED_SHORT, 0)
        }
        ,
        this.drawColorCodedSkinDeformed = function(n, i, r, a, l, u, d, h, f) {
            s[0] = n[0],
            s[1] = n[1],
            s[4] = n[2],
            s[5] = n[3],
            s[12] = n[4],
            s[13] = n[5],
            o[0] = i[0],
            o[1] = i[1],
            o[4] = i[2],
            o[5] = i[3],
            o[12] = i[4],
            o[13] = i[5],
            e.bind(c, r.id, a.id, l.id);
            var p = c.uniforms;
            t.uniform1f(p.Opacity, f),
            t.uniform3fv(p.BoneMatrices, d),
            t.uniform4fv(p.BoneColors, h),
            t.uniformMatrix4fv(p.WorldMatrix, false, o),
            t.uniformMatrix4fv(p.ViewMatrix, false, s),
            t.uniformMatrix4fv(p.ProjectionMatrix, false, e.projection),
            t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, u.id),
            t.drawElements(t.TRIANGLES, u.size, t.UNSIGNED_SHORT, 0)
        }
        ,
        this.drawContouredSkin = function(n, r, a, l, u, c, d, h, p, y) {
            s[0] = n[0],
            s[1] = n[1],
            s[4] = n[2],
            s[5] = n[3],
            s[12] = n[4],
            s[13] = n[5],
            o[0] = r[0],
            o[1] = r[1],
            o[4] = r[2],
            o[5] = r[3],
            o[12] = r[4],
            o[13] = r[5],
            e.bind(f, a.id, l.id);
            var m = p[3] * h;
            i[0] = p[0] * m,
            i[1] = p[1] * m,
            i[2] = p[2] * m,
            i[3] = m;
            var v = f.uniforms;
            t.uniform1f(v.Opacity, h),
            t.uniform1f(v.ContourScale, d),
            t.uniform4fv(v.Color, i),
            t.uniform3fv(v.BoneMatrices, c),
            t.uniformMatrix4fv(v.WorldMatrix, false, o),
            t.uniformMatrix4fv(v.ViewMatrix, false, s),
            t.uniformMatrix4fv(v.ProjectionMatrix, false, e.projection),
            t.activeTexture(t.TEXTURE0),
            t.bindTexture(t.TEXTURE_2D, y),
            t.uniform1i(v.TextureSampler, 0),
            t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, u.id),
            t.drawElements(t.TRIANGLES, u.size, t.UNSIGNED_SHORT, 0)
        }
        ,
        this.drawTextured = function(n, r, a, s, l, u) {
            o[0] = n[0],
            o[1] = n[1],
            o[4] = n[2],
            o[5] = n[3],
            o[12] = n[4],
            o[13] = n[5],
            e.bind(d, r.id);
            var c = l[3] * s;
            i[0] = l[0] * c,
            i[1] = l[1] * c,
            i[2] = l[2] * c,
            i[3] = c;
            var h = d.uniforms;
            t.uniform1f(h.Opacity, s),
            t.uniform4fv(h.Color, i),
            t.uniformMatrix4fv(h.WorldMatrix, false, o),
            t.uniformMatrix4fv(h.ProjectionMatrix, false, e.projection),
            t.activeTexture(t.TEXTURE0),
            t.bindTexture(t.TEXTURE_2D, u),
            t.uniform1i(h.TextureSampler, 0),
            t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, a.id),
            t.drawElements(t.TRIANGLES, a.size, t.UNSIGNED_SHORT, 0)
        }
        ,
        this.drawTexturedSkin = function(n, r, a, l, u, c, d, f, p) {
            s[0] = n[0],
            s[1] = n[1],
            s[4] = n[2],
            s[5] = n[3],
            s[12] = n[4],
            s[13] = n[5],
            o[0] = r[0],
            o[1] = r[1],
            o[4] = r[2],
            o[5] = r[3],
            o[12] = r[4],
            o[13] = r[5],
            e.bind(h, a.id, l.id);
            var y = f[3] * d;
            i[0] = f[0] * y,
            i[1] = f[1] * y,
            i[2] = f[2] * y,
            i[3] = y;
            var m = h.uniforms;
            t.uniform1f(m.Opacity, d),
            t.uniform4fv(m.Color, i),
            t.uniform3fv(m.BoneMatrices, c),
            t.uniformMatrix4fv(m.WorldMatrix, false, o),
            t.uniformMatrix4fv(m.ViewMatrix, false, s),
            t.uniformMatrix4fv(m.ProjectionMatrix, false, e.projection),
            t.activeTexture(t.TEXTURE0),
            t.bindTexture(t.TEXTURE_2D, p),
            t.uniform1i(m.TextureSampler, 0),
            t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, u.id),
            t.drawElements(t.TRIANGLES, u.size, t.UNSIGNED_SHORT, 0)
        }
        ,
        this.drawTexturedTint = function(n, r, a, s, l, u) {
            o[0] = n[0],
            o[1] = n[1],
            o[4] = n[2],
            o[5] = n[3],
            o[12] = n[4],
            o[13] = n[5],
            e.bind(p, r.id);
            var c = l[3] * s;
            i[0] = l[0] * c,
            i[1] = l[1] * c,
            i[2] = l[2] * c,
            i[3] = c;
            var d = p.uniforms;
            t.uniform1f(d.Opacity, s),
            t.uniform4fv(d.Color, i),
            t.uniformMatrix4fv(d.WorldMatrix, false, o),
            t.uniformMatrix4fv(d.ProjectionMatrix, false, e.projection),
            t.activeTexture(t.TEXTURE0),
            t.bindTexture(t.TEXTURE_2D, u),
            t.uniform1i(d.TextureSampler, 0),
            t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, a.id),
            t.drawElements(t.TRIANGLES, a.size, t.UNSIGNED_SHORT, 0)
        }
        ,
        this.drawContoured = function(n, r, a, s, l, u, c) {
            o[0] = n[0],
            o[1] = n[1],
            o[4] = n[2],
            o[5] = n[3],
            o[12] = n[4],
            o[13] = n[5],
            e.bind(y, r.id);
            var d = u[3] * l;
            i[0] = u[0] * d,
            i[1] = u[1] * d,
            i[2] = u[2] * d,
            i[3] = d;
            var h = y.uniforms;
            t.uniform1f(h.Opacity, l),
            t.uniform1f(h.ContourScale, s),
            t.uniform4fv(h.Color, i),
            t.uniformMatrix4fv(h.WorldMatrix, false, o),
            t.uniformMatrix4fv(h.ProjectionMatrix, false, e.projection),
            t.activeTexture(t.TEXTURE0),
            t.bindTexture(t.TEXTURE_2D, c),
            t.uniform1i(h.TextureSampler, 0),
            t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, a.id),
            t.drawElements(t.TRIANGLES, a.size, t.UNSIGNED_SHORT, 0)
        }
        ,
        this.loadBitmapTexture = function(e, n) {
            var i = t.createTexture()
              , r = 0 != (n & a.default.LinearFilter)
              , o = 0 != (n & a.default.ClampToEdge)
              , s = 0 != (n & a.default.MipMapped);
            i.width = e.width,
            i.height = e.height;
            var l = !(0 == e.width || e.width & e.width - 1 || 0 == e.height || e.height & e.height - 1);
            t.bindTexture(t.TEXTURE_2D, i),
            0 != (n & a.default.MultiplyAlpha) ? t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true) : t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false),
            t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL, 0 != (n & a.default.FlipY)),
            t.pixelStorei(t.UNPACK_ALIGNMENT, 1);
            var u = t.RGBA;
            switch (e.channels) {
            case 1:
                u = t.ALPHA;
                break;
            case 3:
                u = t.RGB
            }
            return t.texImage2D(t.TEXTURE_2D, 0, u, e.width, e.height, 0, u, t.UNSIGNED_BYTE, e.bytes),
            t.texParameteri(t.TEXTURE_2D, t.TEXTURE_MAG_FILTER, r ? t.LINEAR : t.NEAREST),
            t.texParameteri(t.TEXTURE_2D, t.TEXTURE_MIN_FILTER, r ? l && s ? t.LINEAR_MIPMAP_LINEAR : t.LINEAR : t.NEAREST),
            t.texParameteri(t.TEXTURE_2D, t.TEXTURE_WRAP_S, l && !o ? t.REPEAT : t.CLAMP_TO_EDGE),
            t.texParameteri(t.TEXTURE_2D, t.TEXTURE_WRAP_T, l && !o ? t.REPEAT : t.CLAMP_TO_EDGE),
            r && l && s && t.generateMipmap(t.TEXTURE_2D),
            t.bindTexture(t.TEXTURE_2D, null),
            i
        }
        ,
        this.deleteTexture = function(e) {
            t.deleteTexture(e)
        }
        ,
        this.drawPies = function(n, i, r, o) {
            s[0] = n[0],
            s[1] = n[1],
            s[4] = n[2],
            s[5] = n[3],
            s[12] = n[4],
            s[13] = n[5],
            e.bind(l, i.id);
            var a = l.uniforms;
            t.uniform1f(a.Size, o),
            t.uniform1f(a.Antialias, .75),
            t.uniformMatrix4fv(a.ProjectionMatrix, false, e.projection),
            t.uniformMatrix4fv(a.ViewMatrix, false, s),
            t.drawArrays(t.POINTS, 0, r)
        }
    }
    ;
    var i, r = n(2), o = n(444), a = (i = o) && i.__esModule ? i : {
        default: i
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }()
      , r = a(n(475))
      , o = a(n(729));
    function a(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function s(e, t) {
        if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function")
    }
    function l(e, t) {
        if (!e)
            throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    var u = function(e) {
        function t() {
            return s(this, t),
            l(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments))
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        i(t, [{
            key: "makeActor",
            value: function() {
                return new o.default
            }
        }, {
            key: "isCaptureUpsideDown",
            get: function() {
                return true
            }
        }, {
            key: "product",
            get: function() {
                return "nima"
            }
        }]),
        t
    }(r.default);
    t.default = u
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = l(n(12)), a = l(n(1)), s = l(n(713));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var u, c, d, h, f, p, y = (i = function(e) {
        function t() {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var e = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this));
            return e._Images = [],
            e._IsDrawOrderDirty = false,
            e._ChildrenChanged = false,
            e
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "onDrawOrderChange",
            value: function() {
                this._IsDrawOrderDirty = true
            }
        }, {
            key: "forceUpdate",
            value: function() {
                this.onDrawOrderChange()
            }
        }, {
            key: "advance",
            value: function() {
                var e = false;
                return this._ChildrenChanged && (this.dispatch("childrenChanged"),
                e = true,
                this._ChildrenChanged = false),
                this._IsDrawOrderDirty && ((0,
                s.default)(this._Images, (function(e, t) {
                    return e.drawOrder - t.drawOrder
                }
                )),
                this.dispatch("childrenChanged"),
                e = true,
                this._IsDrawOrderDirty = false),
                e
            }
        }, {
            key: "addImage",
            value: function(e) {
                return -1 === this._Images.indexOf(e) && (e.addEventListener("drawOrderChange", this.onDrawOrderChange),
                e.rigDrawOrder || (e.rigDrawOrder = this.maxDrawOrder + 1),
                this._Images.push(e),
                (0,
                s.default)(this._Images, (function(e, t) {
                    return e.rigDrawOrder - t.rigDrawOrder
                }
                )),
                this._ChildrenChanged = true,
                true)
            }
        }, {
            key: "updateDrawOrder",
            value: function() {
                (0,
                s.default)(this._Images, (function(e, t) {
                    return e.rigDrawOrder - t.rigDrawOrder
                }
                ));
                for (var e = 0; e < this._Images.length; e++)
                    this._Images[e].rigDrawOrder = e + 1
            }
        }, {
            key: "removeImage",
            value: function(e) {
                var t = this._Images.indexOf(e);
                return -1 !== t && (e.removeEventListener("drawOrderChange", this.onDrawOrderChange),
                this._Images.splice(t, 1),
                this._ChildrenChanged = true,
                true)
            }
        }, {
            key: "uiHierIconClass",
            get: function() {
                return "HierarchyOrderIcon"
            }
        }, {
            key: "uiIcon",
            get: function() {
                return "icon-order"
            }
        }, {
            key: "images",
            get: function() {
                return this._Images
            }
        }, {
            key: "hierarchyChildren",
            get: function() {
                return this._Images.slice(0).reverse()
            }
        }, {
            key: "maxDrawOrder",
            get: function() {
                for (var e = -1, t = 0; t < this._Images.length; t++)
                    e = Math.max(e, this._Images[t].rigDrawOrder);
                return e
            }
        }]),
        t
    }(o.default),
    u = i.prototype,
    c = "onDrawOrderChange",
    d = [a.default],
    h = Object.getOwnPropertyDescriptor(i.prototype, "onDrawOrderChange"),
    f = i.prototype,
    p = {},
    Object.keys(h).forEach((function(e) {
        p[e] = h[e]
    }
    )),
    p.enumerable = !!p.enumerable,
    p.configurable = !!p.configurable,
    ("value"in p || p.initializer) && (p.writable = true),
    p = d.slice().reverse().reduce((function(e, t) {
        return t(u, c, e) || e
    }
    ), p),
    f && void 0 !== p.initializer && (p.value = p.initializer ? p.initializer.call(f) : void 0,
    p.initializer = void 0),
    void 0 === p.initializer && (Object.defineProperty(u, c, p),
    p = null),
    i);
    t.default = y
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    });
    var i = function(e, t) {
        if (Array.isArray(e))
            return e;
        if (Symbol.iterator in Object(e))
            return function(e, t) {
                var n = []
                  , i = true
                  , r = false
                  , o = void 0;
                try {
                    for (var a, s = e[Symbol.iterator](); !(i = (a = s.next()).done) && (n.push(a.value),
                    !t || n.length !== t); i = true)
                        ;
                } catch (e) {
                    r = true,
                    o = e
                } finally {
                    try {
                        !i && s.return && s.return()
                    } finally {
                        if (r)
                            throw o
                    }
                }
                return n
            }(e, t);
        throw new TypeError("Invalid attempt to destructure non-iterable instance")
    }
      , r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }();
    var o = function() {
        function e(t) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e),
            this._Graph = new Map,
            this._Root = t,
            this._Order = null,
            this._DirtMask = null,
            this._IsDirty = false,
            this._DirtDepth = 0,
            this._IsExceeding = false
        }
        return r(e, [{
            key: "addDependency",
            value: function(e, t) {
                var n = this._Graph
                  , i = n.get(t);
                return i || (i = [],
                n.set(t, i)),
                -1 === i.indexOf(e) && (i.push(e),
                true)
            }
        }, {
            key: "removeDependency",
            value: function(e, t) {
                var n = this._Graph.get(t);
                if (!n)
                    return false;
                var i = n.indexOf(e);
                return -1 !== i && (n.splice(i, 1),
                this.sort(),
                true)
            }
        }, {
            key: "remove",
            value: function(e) {
                var t = this._Graph;
                t.delete(e);
                var n = true
                  , r = false
                  , o = void 0;
                try {
                    for (var a, s = t[Symbol.iterator](); !(n = (a = s.next()).done); n = true)
                        for (var l = a.value, u = i(l, 2), c = (u[0],
                        u[1]), d = 0; d < c.length; d++)
                            c[d] === e && (c.splice(d, 1),
                            d--)
                } catch (e) {
                    r = true,
                    o = e
                } finally {
                    try {
                        !n && s.return && s.return()
                    } finally {
                        if (r)
                            throw o
                    }
                }
                return this.sort(),
                true
            }
        }, {
            key: "sort",
            value: function() {
                var e = this._Graph
                  , t = new Set
                  , n = new Set
                  , i = [];
                if (!function r(o) {
                    if (t.has(o))
                        return true;
                    if (n.has(o))
                        return false;
                    n.add(o);
                    var a = e.get(o);
                    if (a) {
                        var s = true
                          , l = false
                          , u = void 0;
                        try {
                            for (var c, d = a[Symbol.iterator](); !(s = (c = d.next()).done); s = true) {
                                if (!r(c.value))
                                    return false
                            }
                        } catch (e) {
                            l = true,
                            u = e
                        } finally {
                            try {
                                !s && d.return && d.return()
                            } finally {
                                if (l)
                                    throw u
                            }
                        }
                    }
                    return t.add(o),
                    i.unshift(o),
                    true
                }(this._Root))
                    return console.warn("Dependency cycle detected."),
                    false;
                this._Order = i;
                var r = new Uint8Array(i.length);
                r.fill(255),
                this._DirtMask = r;
                for (var o = 0; o < i.length; o++) {
                    i[o]._GraphOrder = o
                }
                return this._IsDirty = true,
                true
            }
        }, {
            key: "addDirtRecursive",
            value: function(e, t) {
                this.addDirt(e, t, true)
            }
        }, {
            key: "addDirtToDependents",
            value: function(e, t) {
                var n = this._Graph.get(e);
                if (n) {
                    var i = true
                      , r = false
                      , o = void 0;
                    try {
                        for (var a, s = n[Symbol.iterator](); !(i = (a = s.next()).done); i = true) {
                            var l = a.value;
                            this.addDirt(l, t, true)
                        }
                    } catch (e) {
                        r = true,
                        o = e
                    } finally {
                        try {
                            !i && s.return && s.return()
                        } finally {
                            if (r)
                                throw o
                        }
                    }
                }
            }
        }, {
            key: "getDependents",
            value: function(e) {
                return this._Graph.get(e)
            }
        }, {
            key: "getDirt",
            value: function(e) {
                var t = e._GraphOrder;
                return this._DirtMask[t]
            }
        }, {
            key: "addDirt",
            value: function(e, t, n) {
                if (this._DirtMask) {
                    var i = e._GraphOrder
                      , r = this._DirtMask[i];
                    if ((r & t) === t)
                        return false;
                    var o = this._Graph;
                    if (r |= t,
                    this._IsDirty = true,
                    this._DirtMask[i] = r,
                    e.onDirty(r),
                    i < this._DirtDepth && (this._DirtDepth = i),
                    !n)
                        return true;
                    var a = o.get(e);
                    if (a) {
                        var s = true
                          , l = false
                          , u = void 0;
                        try {
                            for (var c, d = a[Symbol.iterator](); !(s = (c = d.next()).done); s = true) {
                                var h = c.value;
                                this.addDirt(h, t, n)
                            }
                        } catch (e) {
                            l = true,
                            u = e
                        } finally {
                            try {
                                !s && d.return && d.return()
                            } finally {
                                if (l)
                                    throw u
                            }
                        }
                    }
                    return true
                }
            }
        }, {
            key: "subUpdate",
            value: function(e) {
                if (!this._IsDirty)
                    return false;
                for (var t = this._DirtMask, n = this._Order, i = 0; i <= e._GraphOrder; i++) {
                    var r = t[i];
                    if (0 !== r) {
                        var o = n[i];
                        t[i] = 0,
                        o.update(this, r)
                    }
                }
            }
        }, {
            key: "update",
            value: function() {
                if (!this._IsDirty)
                    return false;
                for (var e = this._Order, t = e.length, n = this._DirtMask, i = 0; this._IsDirty && i < 100; ) {
                    this._IsDirty = false;
                    for (var r = 0; r < t; r++) {
                        this._DirtDepth = r;
                        var o = n[r];
                        if (0 !== o) {
                            var a = e[r];
                            if (n[r] = 0,
                            a.update(this, o),
                            this._DirtDepth < r)
                                break
                        }
                    }
                    i++
                }
                return i >= 100 ? this._IsExceeding || (this._IsExceeding = true,
                console.warn("Exceeded max steps.")) : this._IsExceeding && (this._IsExceeding = false,
                console.warn("No longer exceeding max steps.")),
                true
            }
        }]),
        e
    }();
    t.default = o
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = n(203);
    var o = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n.isVisible = false,
            n.isFake = true,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        t
    }(((i = r) && i.__esModule ? i : {
        default: i
    }).default);
    t.default = o
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = G(n(12)), a = n(2), s = G(n(1)), l = G(n(9)), u = G(n(693)), c = G(n(512)), d = G(n(3)), h = G(n(447)), f = G(n(586)), p = G(n(590)), y = G(n(592)), m = G(n(593)), v = G(n(591)), g = G(n(507)), _ = G(n(588)), b = G(n(410)), w = G(n(612)), O = G(n(587)), S = G(n(697)), k = G(n(606)), P = G(n(473)), E = G(n(397)), T = G(n(370)), C = G(n(381)), x = G(n(201)), I = G(n(372)), D = G(n(243)), M = G(n(371)), A = G(n(1220)), j = G(n(261)), L = G(n(609)), R = G(n(610)), F = G(n(611)), B = G(n(589)), V = G(n(608)), N = G(n(383)), z = G(n(583)), W = G(n(699)), H = G(n(726)), U = G(n(584)), K = G(n(700));
    function G(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function X(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var J = (X((i = function(e) {
        function t(e, n, i) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var r = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this));
            r._AppContext = e,
            r._Graphics = i,
            r._CursorElement = document.createElement("img"),
            r._CursorElement.style.position = "absolute",
            r._CursorElement.style.pointerEvents = "none",
            r._Settings = {
                highlightColor: [1, 1, 1, 1],
                selectionColor: [0, .4, 1, 1],
                contourOpacity: .5,
                contourThickness: .125,
                showGridAxis: true,
                showGridSubdivisions: true,
                disableImageContour: e.getPreference("disableImageContour")
            },
            r._Translation = a.vec2.create(),
            r._TranslationTarget = a.vec2.create(),
            r._Scale = .01,
            r._ScaleTarget = 1,
            r._ViewTransform = a.mat2d.create(),
            r._InverseViewTransform = a.mat2d.create(),
            r._TransformSpace = c.default.Local,
            r._White = [1, 1, 1, 1],
            r._Black = [0, 0, 0, 1],
            r._ForceRedraw = false,
            r._WasAnimatingView = false,
            r._States = {},
            r._CursorState = null,
            r._HoverItem = null,
            r._LastDispatchedHoverItem = null,
            r._SelectedItems = [],
            r._AllTools = [],
            r._CurrentTool = null,
            r._SelectionFilter = new P.default,
            r._DisabledSelectionFilter = null,
            r._CurrentToolClicked = false,
            r._CurrentOperation = null,
            r._ActiveDragTool = null,
            r._MouseX,
            r._MouseY,
            r._MouseDragged = false,
            r._SelectionsChanged = false,
            r._MouseDownSelected = false,
            r._MinZoom = .15,
            r._MaxZoom = 8,
            r._WorldMouse = a.vec2.create(),
            r._LastClickedItem = null,
            r._QueuedRemove = [],
            r._QueuedAdd = [],
            r._SelectionLineBuffer = i.makeVertexBuffer([0, 0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0]),
            r._RenderTransform = a.mat2d.create(),
            r._StageItems = [],
            r._StageDrawLayers = [],
            r._IsSelectionDisabled = false,
            r._IsDragDisabled = false,
            r._IsMouseOverStage = false,
            r._SuppressPanning = false,
            r._IsDraggingMarquee = false,
            r._DraggedMarquee = false,
            r._MarqueeStart = a.vec2.create(),
            r._MarqueeEnd = a.vec2.create(),
            r._PreMarqueeSelection = [],
            r._MarqueeStrokeColor = [87 / 255, 165 / 255, 224 / 255, 1],
            r._MarqueeFillColor = [87 / 255, 165 / 255, 224 / 255, .3],
            r._GuideBackgroundColor = [42 / 255, 42 / 255, 42 / 255, .9],
            r._HighlightItems = [];
            r._MarqueeVertexBuffer = i.makeVertexBuffer([0, 0, 1, 0, 1, 1, 0, 1]),
            r._MarqueeIndexBuffer = i.makeIndexBuffer([0, 1, 2, 2, 3, 0]),
            r._SelectionReRoute = null,
            r._SelectionReRouteCanMarquee = false,
            r._IsSmallSize = false,
            r._ScreenScale = 1,
            r._OriginTransform = null,
            r._OriginTranslation = a.vec2.create(),
            r._OriginTranslationTarget = a.vec2.create(),
            r._OriginRotation = 0,
            r._OriginRotationTarget = 0,
            r._SoloStrength = 0,
            r._SoloFrameBuffer = null,
            r._SoloVertexBuffer = null,
            r._SoloIndexBuffer = null,
            r._SoloTransform = null,
            r._PreSoloScaleTarget = 1,
            r._PreSoloTranslationTarget = a.vec2.create(),
            r._SoloZoomed = false,
            r._SoloItems = null,
            r._HoverFallthrough = 0,
            r._RenderCaptureTarget = null,
            r._RenderCaptureWidth = null,
            r._RenderCaptureHeight = null,
            r._RenderCaptureView = null,
            r._RenderCaptureCallback = null,
            r._MarqueeSilentChanges = [],
            r._MouseDownTime = Date.now(),
            r._MouseMoveAccum = a.vec2.create(),
            r._IsPreDrag = false,
            r._ReRoutedSelection = false,
            r._MoveTriggersPan = false,
            r._IsMouseDown = false,
            r._RegisteredStageItems = [],
            r._LayerOptions = {},
            r._ContextLookup = new Map,
            r._MaxDrawLayer = 0,
            r._BreakCapture = false,
            r._RegisteredItems = [],
            r._RegisteredTools = [p.default, y.default, m.default, v.default, g.default, _.default, b.default, w.default, h.default, f.default, O.default, S.default, k.default],
            r.registerItem(E.default, 4),
            r.registerItem(T.default, 5),
            r.registerItem(C.default, 8),
            r.registerItem(L.default, 2),
            r.registerItem(R.default, 2),
            r.registerItem(F.default, 2),
            r.registerItem(x.default, 2),
            r.registerItem(I.default, 7),
            r.registerItem(D.default, 3),
            r.registerItem(M.default, 6),
            r.registerItem(A.default, 3),
            r.registerItem(j.default, 0),
            r.registerItem(B.default, 4),
            r.registerItem(V.default, 1),
            r.registerItem(N.default, 3),
            r.registerItem(z.default, 4),
            r.registerItem(W.default, 4),
            r.registerItem(H.default, 4),
            r.registerItem(K.default, 4),
            r.registerItem(U.default, 4);
            for (var o = 0; o < r._RegisteredItems.length; o++) {
                var s = r._RegisteredItems[o]
                  , l = {
                    constructor: s.constructor,
                    context: {},
                    drawLayer: s.drawLayer
                };
                s.drawLayer > r._MaxDrawLayer && (r._MaxDrawLayer = s.drawLayer),
                r._ContextLookup.set(s.constructor, l),
                r._RegisteredStageItems.push(l);
                var u = l.constructor.initializeStageContext;
                u && u.constructor === Function && u(i, l.context, r)
            }
            r._StageDrawLayers = [];
            for (var d = 0; d <= r._MaxDrawLayer; d++)
                r._StageDrawLayers.push([]);
            for (var G = 0; G < r._RegisteredTools.length; G++)
                r._AllTools.push(new r._RegisteredTools[G](r));
            return r
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "dispatchHoverItemChange",
            value: function() {
                this._LastDispatchedHoverItem !== this._HoverItem && (this._LastDispatchedHoverItem && this._LastDispatchedHoverItem.dispatch("hoverChange"),
                this._HoverItem && this._HoverItem.dispatch("hoverChange"),
                this._LastDispatchedHoverItem = this._HoverItem)
            }
        }, {
            key: "registerItem",
            value: function(e, t) {
                this._RegisteredItems.push({
                    constructor: e,
                    drawLayer: t || 0
                })
            }
        }, {
            key: "isEnabled",
            value: function(e) {
                return true === this._States[e]
            }
        }, {
            key: "enableState",
            value: function(e) {
                return true !== this._States[e] && (this._States[e] = true,
                this.updateCursorState(),
                this._ForceRedraw = true,
                true)
            }
        }, {
            key: "disableState",
            value: function(e) {
                return true === this._States[e] && (this._States[e] = false,
                this.updateCursorState(),
                this._ForceRedraw = true,
                true)
            }
        }, {
            key: "screenScaleRect",
            value: function(e) {
                return 1 != this._ScreenScale && (e = {
                    width: e.width * this._ScreenScale,
                    height: e.height * this._ScreenScale,
                    bottom: e.bottom * this._ScreenScale,
                    top: e.top * this._ScreenScale,
                    left: e.left * this._ScreenScale
                }),
                e
            }
        }, {
            key: "getVisibleStageArea",
            value: function() {
                var e = this._AppContext.getStageRect();
                return 1 != this._ScreenScale && (e = {
                    width: e.width * this._ScreenScale,
                    height: e.height * this._ScreenScale,
                    bottom: e.bottom * this._ScreenScale,
                    top: e.top * this._ScreenScale,
                    left: e.left * this._ScreenScale
                }),
                e
            }
        }, {
            key: "rectToWorld",
            value: function(e) {
                var t = this._Scale;
                return {
                    left: (e.left - this._Translation[0]) / t,
                    width: e.width / t,
                    height: e.height / t,
                    bottom: (e.bottom - this._Translation[1] - e.height) / t
                }
            }
        }, {
            key: "rerouteSelection",
            value: function(e, t) {
                this._SelectionReRouteCanMarquee = true === t,
                this._SelectionReRoute = e
            }
        }, {
            key: "clearRerouteSelection",
            value: function(e) {
                this._SelectionReRoute == e && (this._SelectionReRoute = null)
            }
        }, {
            key: "setSize",
            value: function(e, t, n, i) {
                var r = false;
                this._ScreenScale = n || 1;
                var o = this._Graphics.viewportWidth
                  , a = this._Graphics.viewportHeight;
                if (this._Graphics.setSize(e, t)) {
                    this._ForceRedraw = true,
                    r = true;
                    var s = this._Translation[0] - o / 2
                      , l = this._Translation[1] - a / 2;
                    this._TranslationTarget[0] = this._Translation[0] = s + e / 2,
                    this._TranslationTarget[1] = this._Translation[1] = l + t / 2,
                    this._IsSmallSize ? e > 720 && t > 810 && (this.zoomTo(e / 2, t / 2, this._ScaleTarget / (440 / 680)),
                    this._IsSmallSize = false) : (e < 720 || t < 810) && (this.zoomTo(e / 2, t / 2, this._ScaleTarget * (440 / 680)),
                    this._IsSmallSize = true)
                }
                if (0 == this._Scale) {
                    this._Scale = .5,
                    this._ScaleTarget = 1;
                    var u = this.getVisibleStageArea();
                    u ? (this._TranslationTarget[0] = this._Translation[0] = u.left + u.width / 2,
                    this._TranslationTarget[1] = this._Translation[1] = .33333 * u.height) : (this._TranslationTarget[0] = this._Translation[0] = e / 2,
                    this._TranslationTarget[1] = this._Translation[1] = .33333 * t),
                    this.dispatch("zoomChanged", this._ScaleTarget)
                }
                return r
            }
        }, {
            key: "getZoomFitViewTransform",
            value: function(e, t) {
                for (var n, i = this._StageItems, r = 0; r < i.length; r++) {
                    var o = i[r];
                    o.isVisible && o.isSelectable && (o.constructor !== N.default && (n ? n.combine(o.aabb) : (n = new u.default).set(o.aabb.min, o.aabb.max)))
                }
                var s = a.mat2d.create();
                if (!n)
                    return s;
                var l = n.center
                  , c = Math.min(e / n.boxWidth, t / n.boxHeight);
                return s[0] = c,
                s[3] = c,
                s[4] = e / 2 - l[0] * c,
                s[5] = t / 2 - l[1] * c,
                s
            }
        }, {
            key: "filterItems",
            value: function(e) {
                for (var t = [], n = 0; n < this._StageItems.length; n++) {
                    var i = this._StageItems[n];
                    e(i) && t.push(i)
                }
                return t
            }
        }, {
            key: "getCombinedAABB",
            value: function(e) {
                var t;
                e || (e = this._StageItems);
                for (var n = null !== this._SoloItems, i = 0; i < e.length; i++) {
                    var r = e[i];
                    r.isVisible && (!n || r.isSolo || r.parent && r.parent.isSolo) && (r.constructor !== N.default && (r.constructor === j.default && (r.node.updateDeform(true),
                    r.updateMesh()),
                    t ? t.combine(r.aabb) : (t = new u.default).set(r.aabb.min, r.aabb.max)))
                }
                return t
            }
        }, {
            key: "zoomFit",
            value: function(e) {
                e || (e = this._MaxZoom);
                var t = this._SelectedItems
                  , n = null !== this._SoloItems
                  , i = void 0;
                if (n && this._OriginTransform) {
                    e = 1;
                    var r = Number.MAX_VALUE
                      , o = Number.MAX_VALUE
                      , s = -Number.MAX_VALUE
                      , l = -Number.MAX_VALUE
                      , c = this.soloItem
                      , d = [a.vec2.create(), a.vec2.create(), a.vec2.create(), a.vec2.create()]
                      , h = c.min
                      , f = c.max
                      , p = [a.vec2.set(d[0], h[0], h[1]), a.vec2.set(d[1], f[0], h[1]), a.vec2.set(d[2], f[0], f[1]), a.vec2.set(d[3], h[0], f[1])]
                      , y = c.renderTransform
                      , m = a.mat2d.create();
                    a.mat2d.fromTranslation(m, this._OriginTranslationTarget),
                    y = a.mat2d.mul(a.mat2d.create(), m, y),
                    a.mat2d.fromRotation(m, this._OriginRotationTarget),
                    y = a.mat2d.mul(a.mat2d.create(), m, y);
                    for (var v = 0; v < p.length; v++) {
                        var g = p[v]
                          , _ = a.vec2.transformMat2d(g, g, y);
                        _[0] < r && (r = _[0]),
                        _[1] < o && (o = _[1]),
                        _[0] > s && (s = _[0]),
                        _[1] > l && (l = _[1])
                    }
                    (i = new u.default).set([r, o], [s, l])
                } else {
                    0 == t.length && (t = this._StageItems);
                    for (var b = 0; b < t.length; b++) {
                        var w = t[b];
                        w.isVisible && w.isSelectable && (!n || w.isSolo || w.parent && w.parent.isSolo) && (w.constructor !== N.default && (i ? i.combine(w.aabb) : (i = new u.default).set(w.aabb.min, w.aabb.max)))
                    }
                }
                if (i) {
                    var O = i.center
                      , S = this.getVisibleStageArea();
                    this._ScaleTarget = Math.min(e, Math.max(this._MinZoom, Math.min(S.width / i.boxWidth, S.height / i.boxHeight))),
                    this._TranslationTarget[0] = S.left + S.width / 2 - O[0] * this._ScaleTarget,
                    this._TranslationTarget[1] = this._Graphics.viewportHeight - S.bottom + S.height / 2 - O[1] * this._ScaleTarget,
                    this.dispatch("zoomChanged", this._ScaleTarget)
                }
            }
        }, {
            key: "zoomTo",
            value: function(e, t, n) {
                var i = this._MinZoom;
                this._IsSmallSize && (i /= 4),
                n = Math.min(this._MaxZoom, Math.max(i, n));
                var r = this._ScaleTarget;
                this._ScaleTarget = n;
                var o = this._ScaleTarget / r
                  , a = e - this._TranslationTarget[0]
                  , s = t - this._TranslationTarget[1]
                  , l = a * o
                  , u = s * o;
                this._TranslationTarget[0] += a - l,
                this._TranslationTarget[1] += s - u,
                this.dispatch("zoomChanged", this._ScaleTarget)
            }
        }, {
            key: "updateWorldMousePosition",
            value: function() {
                this._WorldMouse[0] = this._MouseX * this._ScreenScale,
                this._WorldMouse[1] = this._Graphics.viewportHeight - this._MouseY * this._ScreenScale,
                a.vec2.transformMat2d(this._WorldMouse, this._WorldMouse, this._InverseViewTransform);
                var e = this.canSelect
                  , t = this._HoverItem;
                if (!this.isEnabled(Y.Drag) && !this._IsSelectionDisabled && this._IsMouseOverStage) {
                    var n = 0 != this._SoloStrength;
                    this._HoverItem = null;
                    for (var i = null, r = 0, o = this._HoverFallthrough, s = this._StageDrawLayers.length - 1; s >= 0 && null == this._HoverItem; s--) {
                        var l = this._StageDrawLayers[s]
                          , u = this._LayerOptions[s];
                        if (u) {
                            if (u.disableSelection)
                                continue;
                            u.overrideItems && (l = u.overrideItems(l, this))
                        }
                        for (var c = l.length - 1; c >= 0; c--) {
                            var d = l[c];
                            if (e(d) && d.isVisible && d.isSelectable && (!n || d.drawAfterSelections || d.isSolo || d.parent && d.parent.isSolo) && d.isPointOver(this._WorldMouse[0], this._WorldMouse[1])) {
                                if (!(r < o)) {
                                    this._HoverItem = d;
                                    break
                                }
                                r++,
                                null === i && (i = d)
                            }
                        }
                    }
                    this._HoverItem || null === i || (this._HoverItem = i,
                    this._HoverFallthrough = 0)
                }
                t !== this._HoverItem && (this._ForceRedraw = true,
                this._CurrentTool && this._CurrentTool.hoverItemChange && this._CurrentTool.hoverItemChange(this._HoverItem)),
                this.dispatchHoverItemChange()
            }
        }, {
            key: "advance",
            value: function(e) {
                var t = this._ScaleTarget - this._Scale
                  , n = this._TranslationTarget[0] - this._Translation[0]
                  , i = this._TranslationTarget[1] - this._Translation[1]
                  , r = Math.min(1, 15 * e)
                  , o = false;
                if (this._ForceRedraw && (o = true,
                this._ForceRedraw = false),
                Math.abs(t) > 1e-5 && (t *= r,
                o = true),
                Math.abs(n) > .01 && (n *= r,
                o = true),
                Math.abs(i) > .01 && (i *= r,
                o = true),
                this._Scale += t,
                this._Translation[0] += n,
                this._Translation[1] += i,
                this._OriginTranslation && a.mat2d.identity(this._ViewTransform),
                this._ViewTransform[0] = this._Scale,
                this._ViewTransform[3] = this._Scale,
                this._ViewTransform[4] = this._Translation[0],
                this._ViewTransform[5] = this._Translation[1],
                this._OriginTransform) {
                    var s = this._OriginTranslationTarget[0] - this._OriginTranslation[0]
                      , l = this._OriginTranslationTarget[1] - this._OriginTranslation[1]
                      , u = this._OriginRotationTarget - this._OriginRotation;
                    Math.abs(u) > 1e-5 && (u *= r,
                    o = true),
                    Math.abs(s) > .01 && (s *= r,
                    o = true),
                    Math.abs(l) > .01 && (l *= r,
                    o = true),
                    this._OriginRotation += u,
                    this._OriginTranslation[0] += s,
                    this._OriginTranslation[1] += l,
                    a.mat2d.fromRotation(this._OriginTransform, this._OriginRotation),
                    a.mat2d.mul(this._ViewTransform, this._ViewTransform, this._OriginTransform),
                    a.mat2d.fromTranslation(this._OriginTransform, this._OriginTranslation),
                    a.mat2d.mul(this._ViewTransform, this._ViewTransform, this._OriginTransform),
                    o || 0 != this._OriginTranslation[0] || 0 != this._OriginTranslation[1] || 0 != this._OriginRotation || (this._OriginTransform = null)
                }
                if (a.mat2d.invert(this._InverseViewTransform, this._ViewTransform),
                0 != this._SoloStrength || this._SoloItems) {
                    var c = 3.22 * e;
                    1 == this._SoloStrength && this._SoloItems || (o = true),
                    o && (this._SoloStrength += this._SoloItems ? c : -c,
                    this._SoloStrength = Math.min(1, Math.max(0, this._SoloStrength))),
                    0 != this._SoloStrength || this._SoloItems || (this._SoloFrameBuffer.destroy(),
                    this._SoloFrameBuffer = null,
                    this._SoloTransform = null)
                }
                return this._WasAnimatingView && !o && this.updateWorldMousePosition(),
                this._WasAnimatingView = o,
                o
            }
        }, {
            key: "setSoloItems",
            value: function(e, t) {
                if (this._SoloItems)
                    for (var n = 0; n < this._SoloItems.length; n++)
                        this._SoloItems[n].isSolo = false;
                this._SoloItems = e.slice(0);
                for (var i = 0; i < this._SoloItems.length; i++)
                    this._SoloItems[i].isSolo = true;
                if (!this._SoloFrameBuffer && (this._SoloFrameBuffer = this._Graphics.makeFrameBuffer(),
                this._SoloTransform = a.mat2d.create(),
                !this._SoloVertexBuffer)) {
                    this._SoloVertexBuffer = this._Graphics.makeVertexBuffer([0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0]),
                    this._SoloIndexBuffer = this._Graphics.makeIndexBuffer([0, 1, 2, 2, 3, 0])
                }
                t && (this._SoloZoomed || (this._PreSoloScaleTarget = this._ScaleTarget,
                a.vec2.copy(this._PreSoloTranslationTarget, this._TranslationTarget)),
                this._SoloZoomed = true,
                this.zoomFit(1),
                this.dispatch("zoomChanged", this._ScaleTarget))
            }
        }, {
            key: "clearSoloItems",
            value: function() {
                if (this._SoloItems) {
                    for (var e = 0; e < this._SoloItems.length; e++)
                        this._SoloItems[e].isSolo = false;
                    this._SoloItems = null,
                    this._SoloZoomed && (this._SoloZoomed = false,
                    this._ScaleTarget = this._PreSoloScaleTarget,
                    a.vec2.copy(this._TranslationTarget, this._PreSoloTranslationTarget),
                    this.dispatch("zoomChanged", this._ScaleTarget))
                }
            }
        }, {
            key: "setViewOrigin",
            value: function(e) {
                this._OriginTransform = a.mat2d.create(),
                e ? (this._OriginTranslationTarget[0] = -e[4],
                this._OriginTranslationTarget[1] = -e[5],
                this._OriginRotationTarget = -a.mat2d.getRotation(e)) : (a.vec2.set(this._OriginTranslationTarget, 0, 0),
                this._OriginRotationTarget = 0)
            }
        }, {
            key: "setLayerOptions",
            value: function(e, t) {
                var n = this._ContextLookup.get(e);
                if (!n)
                    return null;
                var i = n && n.drawLayer || 0;
                this._LayerOptions[i] = t,
                this.dispatch("updateLayerOptions")
            }
        }, {
            key: "setLayerRenderExtensions",
            value: function(e, t) {
                this._LayerOptions[e] = t
            }
        }, {
            key: "getLayerOptions",
            value: function(e) {
                var t = this._ContextLookup.get(e);
                if (!t)
                    return null;
                var n = t && t.drawLayer || 0
                  , i = this._LayerOptions[n];
                return i || (i = this._LayerOptions[n] = {}),
                i
            }
        }, {
            key: "setRenderCapture",
            value: function(e, t, n, i) {
                this._RenderCaptureTarget || (this._RenderCaptureTarget = this._Graphics.makeFrameBuffer(e, t)),
                this._RenderCaptureCallback = i,
                this._RenderCaptureWidth = e,
                this._RenderCaptureHeight = t,
                this._RenderCaptureView = a.mat2d.clone(n),
                this._ForceRedraw = true
            }
        }, {
            key: "clearRenderCapture",
            value: function() {
                this._BreakCapture = true,
                this._RenderCaptureCallback = null
            }
        }, {
            key: "addRenderCapture",
            value: function(e) {
                this._RenderCaptureCallback && this._RenderCaptureCallback.constructor === Array || (this._RenderCaptureCallback = []),
                this._RenderCaptureCallback.push(e),
                this._RenderCaptureTarget || (this._RenderCaptureTarget = this._Graphics.makeFrameBuffer(128, 128)),
                this._ForceRedraw = true
            }
        }, {
            key: "drawRenderCapture",
            value: function(e) {
                e.setup && (e.context = e.setup()),
                e.context && (e.context.renderWidth && (this._RenderCaptureWidth = e.context.renderWidth),
                e.context.renderHeight && (this._RenderCaptureHeight = e.context.renderHeight)),
                this._RenderCaptureTarget.bind(this._RenderCaptureWidth, this._RenderCaptureHeight),
                e.context && e.context.renderView ? this._ViewTransform = e.context.renderView : this._ViewTransform = this._RenderCaptureView,
                a.mat2d.invert(this._InverseViewTransform, this._ViewTransform),
                this.drawTo(this._RenderCaptureTarget, this._RenderCaptureWidth, this._RenderCaptureHeight);
                var t = this._RenderCaptureTarget.read();
                e.complete ? e.complete(t, this._RenderCaptureWidth, this._RenderCaptureHeight, e.context) : e(t),
                e.cleanup && e.cleanup(e.context),
                e = null
            }
        }, {
            key: "draw",
            value: function() {
                if (this._RenderCaptureCallback) {
                    var e = this._ViewTransform;
                    if (this._RenderCaptureCallback.constructor === Array) {
                        this._BreakCapture = false;
                        var t = this._RenderCaptureCallback.slice(0);
                        this._RenderCaptureCallback = null;
                        for (var n = 0; !this._BreakCapture && n < t.length; n++) {
                            var i = t[n];
                            this.drawRenderCapture(i)
                        }
                    } else {
                        var r = this._RenderCaptureCallback;
                        this._RenderCaptureCallback = null,
                        this.drawRenderCapture(r)
                    }
                    this._RenderCaptureTarget.unbind(),
                    this._ViewTransform = e,
                    a.mat2d.invert(this._InverseViewTransform, this._ViewTransform)
                }
                this.drawTo(null)
            }
        }, {
            key: "drawTo",
            value: function(e, t, n) {
                var i = false
                  , r = null
                  , o = this._IsSelectionDisabled
                  , s = this.canSelect;
                if (!e) {
                    this._Graphics.disableBlending();
                    var l = Math.min(1, Math.pow(this._Scale, 2.4))
                      , u = Math.min(1, Math.pow(this._Scale, .7));
                    this._Graphics.drawGrid(this._Settings.showGridAxis, this._Settings.showGridSubdivisions, this._Translation[0], this._Translation[1], 128 * this._Scale, 128 * this._Scale, 1, l, u),
                    this._SoloStrength > 0 && (i = true,
                    r = [],
                    this._SoloFrameBuffer.bind())
                }
                this._Graphics.enableBlending();
                for (var c = this.isEnabled(Y.Pan) || this.isEnabled(Y.PanModifier), d = [], h = 0; h < this._StageDrawLayers.length; h++) {
                    var f = this._StageDrawLayers[h]
                      , p = this._LayerOptions[h]
                      , y = true;
                    if (p && (p.overrideItems && (f = p.overrideItems(f, this)),
                    p.drawPrep && (f = p.drawPrep.call(p, f, this._Graphics, this)),
                    p.disableDraw && (y = false)),
                    f && y)
                        for (var m = 0; m < f.length; m++) {
                            var v = f[m];
                            v.isVisible && (i && (v.isSolo || v.parent && v.parent.isSolo) ? r.push(v) : v.drawAfterSelections ? d.push(v) : v.draw(this._Graphics, v == this._HoverItem && !c, !o && v.isSelected && s(v)))
                        }
                    p && p.drawCleanup && p.drawCleanup.call(p, this._Graphics)
                }
                if (i) {
                    this._SoloFrameBuffer.unbind(),
                    a.mat2d.fromScaling(this._SoloTransform, [this._Graphics.viewportWidth, this._Graphics.viewportHeight]);
                    var g = .15 + .85 * (1 - this._SoloStrength);
                    this._Graphics.drawTextured(this._SoloTransform, this._SoloVertexBuffer, this._SoloIndexBuffer, 1, [1, 1, 1, g], this._SoloFrameBuffer.texture);
                    for (var _ = 0; _ < r.length; _++) {
                        var b = r[_];
                        b.draw(this._Graphics, b == this._HoverItem && !c)
                    }
                }
                if (!o)
                    for (var w = 0; w < this._SelectedItems.length; w++) {
                        var O = this._SelectedItems[w];
                        s(O) && O.drawSelection(this._Graphics, O == this._HoverItem && !c)
                    }
                if (c || !this._HoverItem || !this._IsSelectionDisabled && this._HoverItem.isSelected || this._HoverItem.drawSelection(this._Graphics),
                this._CurrentTool && this._CurrentTool.drawPrep(this._Graphics),
                !this._IsSelectionDisabled)
                    for (var S = this.canSelect, k = 0; k < d.length; k++) {
                        var P = d[k];
                        S(P) && P.draw(this._Graphics, P == this._HoverItem && !c)
                    }
                if (this._DraggedMarquee) {
                    this._Graphics.enableBlending();
                    var E = this._MarqueeStart[0] < this._MarqueeEnd[0]
                      , T = this._MarqueeStart[1] < this._MarqueeEnd[1]
                      , C = E ? this._MarqueeStart[0] : this._MarqueeEnd[0]
                      , x = T ? this._MarqueeStart[1] : this._MarqueeEnd[1]
                      , I = E ? this._MarqueeEnd[0] : this._MarqueeStart[0]
                      , D = T ? this._MarqueeEnd[1] : this._MarqueeStart[1]
                      , M = this._Graphics.makeThickLine([[C, x], [I, x], [I, D], [C, D]], true)
                      , A = a.mat2d.fromScaling(a.mat2d.create(), [I - C, D - x]);
                    A[4] = C,
                    A[5] = x,
                    this._Graphics.drawColor(A, this._MarqueeVertexBuffer, this._MarqueeIndexBuffer, .5, this._MarqueeFillColor),
                    this._Graphics.drawThickLine(a.mat2d.create(), M, 1, 1, this._MarqueeStrokeColor)
                }
            }
        }, {
            key: "drawGuides",
            value: function(e) {
                for (var t = a.mat2d.create(), n = [87 / 255, 165 / 255, 224 / 255, 1], i = 0; i < e.length; i++) {
                    var r = e[i]
                      , o = a.mat2d.fromScaling(t, [r.w, r.h]);
                    o[4] = r.x,
                    o[5] = r.y,
                    this._Graphics.drawColor(o, this._MarqueeVertexBuffer, this._MarqueeIndexBuffer, r.o, n)
                }
            }
        }, {
            key: "updateCustomCursorPosition",
            value: function(e) {
                e && (this._MouseX = e.clientX,
                this._MouseY = e.clientY),
                this._CursorElement.parentNode && (this._CursorElement.style.left = this._MouseX - this._CursorElement.width / 2 + "px",
                this._CursorElement.style.top = this._MouseY - this._CursorElement.height / 2 + "px")
            }
        }, {
            key: "updateCursorState",
            value: function() {
                for (var e = document.body, t = 0; t < q.length; t++) {
                    var n = q[t];
                    if (this.isEnabled(n.state)) {
                        if (n.cursor.constructor == Array)
                            for (var i = 0; i < n.cursor.length; i++)
                                e.style.cursor = n.cursor[i];
                        else
                            e.style.cursor = n.cursor;
                        return n.custom && (this._CursorElement.src = n.custom,
                        this._CursorElement.width = n.width,
                        this._CursorElement.height = n.height,
                        this._CursorElement.parentNode || document.body.appendChild(this._CursorElement),
                        this.updateCustomCursorPosition()),
                        true
                    }
                }
                return this._CursorElement.parentNode && (this._CursorElement.src = "",
                this._CursorElement.parentNode.removeChild(this._CursorElement)),
                e.style.cursor = "",
                false
            }
        }, {
            key: "clearSelections",
            value: function(e, t) {
                var n = this.canSelect;
                0 != this._SelectedItems.length && (this._ForceRedraw = true);
                for (var i = 0; i < this._SelectedItems.length; i++) {
                    var r = this._SelectedItems[i];
                    (t || n(r)) && (this._SelectedItems[i].isSelected = false,
                    this._SelectedItems.splice(i, 1),
                    i--)
                }
                if (!e) {
                    var o = this.getFilteredSelectedItems();
                    this._CurrentTool && (this._CurrentTool.updateSelection(o),
                    this._CurrentTool.clearSelections()),
                    this.dispatch("selectionChanged", o)
                }
                this.dispatch("selectionCleared"),
                this.doUpdateHighlights()
            }
        }, {
            key: "markMouseDown",
            value: function() {
                this._IsMouseDown = true
            }
        }, {
            key: "onMouseDown",
            value: function(e) {
                if (!this._IsMouseDown)
                    if (this._IsPreDrag = true,
                    this._MouseDownTime = Date.now(),
                    this._MouseMoveAccum[0] = 0,
                    this._MouseMoveAccum[1] = 0,
                    this._IsMouseDown = true,
                    this._SelectionsChanged = false,
                    this._MouseDownSelected = false,
                    this._MouseDragged = false,
                    this._ReRoutedSelection = false,
                    2 !== e.button) {
                        this._MoveTriggersPan = false,
                        this._LastClickedItem = this._HoverItem;
                        var t = e.altKey
                          , n = l.default.isMultiSelect(e) || e.shiftKey || t
                          , i = this._SelectedItems.indexOf(this._HoverItem)
                          , r = this._HoverItem && -1 != i
                          , o = this.isEnabled(Y.PanModifier);
                        this._MouseDownSelected = null !== this._HoverItem,
                        !o && this._HoverItem && this._HoverItem.customSelectionAction && this._HoverItem.customSelectionAction(this._HoverItem, e.shiftKey) && (r = true);
                        var a = false;
                        this._SelectionReRoute || !this._HoverItem || n || r || o || (this.clearSelections(true),
                        a = true),
                        r && n && (this._HoverItem.isSelected = false,
                        -1 != i && this._SelectedItems.splice(i, 1));
                        var s = this.getFilteredSelectedItems();
                        if (this.isEnabled(Y.PanModifier))
                            this.enableState(Y.Pan);
                        else if (this._HoverItem || r || !(0 == s.length || n || this._SelectionReRoute && this._SelectionReRouteCanMarquee || this._CurrentTool && this._CurrentTool.alwaysMarquee) || this._CurrentTool && this._CurrentTool.blockMarquee(e))
                            if (t || !this._HoverItem || r) {
                                if (this._SelectionReRoute) {
                                    this._ReRoutedSelection = true;
                                    var u = this._SelectionReRoute;
                                    this._SelectionReRoute = null,
                                    u(null, l.default.isMultiSelect(e) || e.shiftKey)
                                }
                            } else {
                                if (this._MouseDownSelected = true,
                                this._SelectionReRoute) {
                                    this._ReRoutedSelection = true;
                                    var c = this._SelectionReRoute;
                                    this._SelectionReRoute = null,
                                    c(this._HoverItem, l.default.isMultiSelect(e) || e.shiftKey)
                                } else
                                    -1 === this._SelectedItems.indexOf(this._HoverItem) && (this._SelectedItems.push(this._HoverItem),
                                    this._CurrentTool && this._CurrentTool.updateSelection(this.getFilteredSelectedItems()),
                                    a = true,
                                    this._HoverItem.isSelected = true);
                                this._ForceRedraw = true
                            }
                        else {
                            if (this._SelectionReRoute && !this._SelectionReRouteCanMarquee) {
                                this._ReRoutedSelection = true;
                                var d = this._SelectionReRoute;
                                this._SelectionReRoute = null,
                                d(false, l.default.isMultiSelect(e) || e.shiftKey)
                            }
                            n || this._SelectionReRouteCanMarquee ? this._PreMarqueeSelection = this._SelectedItems.slice(0) : (this._SelectedItems.length && (this.clearSelections(true),
                            a = true),
                            this._PreMarqueeSelection = this.getFilteredSelectedItems(true)),
                            this._IsDraggingMarquee = true,
                            this._DraggedMarquee = false,
                            this._MarqueeStart[0] = this._MouseX * this._ScreenScale,
                            this._MarqueeStart[1] = this._Graphics.viewportHeight - this._MouseY * this._ScreenScale,
                            this._CurrentTool && this._CurrentTool.marqueeStarted && this._CurrentTool.marqueeStarted()
                        }
                        if (!this.isEnabled(Y.PanModifier) && !this._IsDragDisabled) {
                            var h = false;
                            /*!_MouseDownSelected && */
                            this._CurrentTool && (this._CurrentToolClicked = true,
                            this._CurrentTool.click(this._WorldMouse, this._MouseDownSelected, e) && (this._IsDraggingMarquee = false),
                            this._CurrentTool.allowDrag && !this._CurrentTool.allowDrag() && (h = true)),
                            h || this.enableState(Y.Drag)
                        }
                        a && this.dispatchSelectionChanged()
                    } else
                        this._MoveTriggersPan = true
            }
        }, {
            key: "dispatchSelectionChanged",
            value: function(e) {
                this.updateHighlights(),
                this.dispatch("selectionChanged", this.getFilteredSelectedItems(), e)
            }
        }, {
            key: "onItemVisibilityChanged",
            value: function(e) {
                e.isVisible || this.deSelectItem(e),
                this.dispatch("itemVisibilityChanged", e)
            }
        }, {
            key: "selectContextMenuNode",
            value: function(e) {
                e.stageItem && this.selectItem(e.stageItem)
            }
        }, {
            key: "onMouseUp",
            value: function(e) {
                if (this._IsMouseDown) {
                    var t = false
                      , n = this.isEnabled(Y.Pan)
                      , i = this.canSelect;
                    if (n)
                        this.disableState(Y.Pan),
                        this._MoveTriggersPan && this.disableState(Y.PanModifier);
                    else if (2 === e.button) {
                        for (var r = 0 != this._SoloStrength, o = [], a = [], s = [], u = new Set, c = this._StageDrawLayers.length - 1; c >= 0; c--) {
                            var d = this._StageDrawLayers[c]
                              , h = this._LayerOptions[c];
                            if (h) {
                                if (h.disableSelection)
                                    continue;
                                h.overrideItems && (d = h.overrideItems(d, this))
                            }
                            for (var f = d.length - 1; f >= 0; f--) {
                                var p = d[f];
                                if (i(p) && p.isVisible && p.isSelectable && (!r || p.drawAfterSelections || p.isSolo || p.parent && p.parent.isSolo) && p.isPointOver(this._WorldMouse[0], this._WorldMouse[1])) {
                                    var y = p.node;
                                    if (!y)
                                        continue;
                                    if (u.has(y))
                                        continue;
                                    u.add(y),
                                    o.push({
                                        name: y.name,
                                        node: y,
                                        stageItem: p,
                                        isActive: p.isSelected,
                                        select: this.selectContextMenuNode
                                    }),
                                    p.isSelected || void 0 === y.rigDrawOrder || (a.push({
                                        name: y.name,
                                        node: y,
                                        stageItem: p,
                                        select: this.appContext.contextMenuSendBehind
                                    }),
                                    s.push({
                                        name: y.name,
                                        node: y,
                                        stageItem: p,
                                        select: this.appContext.contextMenuBringOver
                                    }))
                                }
                            }
                        }
                        1 === this._SelectedItems.length && this._SelectedItems[0].node && void 0 !== this._SelectedItems[0].node.rigDrawOrder && (a.length || s.length) && (o.push({
                            type: "Divider"
                        }),
                        a.length && o.push({
                            type: "SubMenu",
                            name: "Send Behind",
                            items: a
                        }),
                        s.length && o.push({
                            type: "SubMenu",
                            name: "Bring Over",
                            items: s
                        })),
                        o.length > 0 && (t = true,
                        this.appContext.showContextMenu({
                            x: e.clientX,
                            y: e.clientY,
                            items: o
                        }))
                    }
                    this._MoveTriggersPan && (this._MoveTriggersPan = false),
                    this.disableState(Y.Drag),
                    this.updateWorldMousePosition();
                    var m = this._CurrentTool;
                    if (m && m.doesCustomSelection || t || this._SelectionReRoute || this._ReRoutedSelection || this._SelectionsChanged || this._MouseDragged || this._MouseDownSelected || n || this._DraggedMarquee ? this._MouseDragged && (this._ActiveDragTool && (this._ActiveDragTool.endDrag(),
                    this._ActiveDragTool = null),
                    this._ForceRedraw = true) : this.clearSelections(),
                    this._CurrentOperation && this._CurrentOperation.mouseUp ? this._CurrentOperation.mouseUp(this._WorldMouse) : m && this._CurrentToolClicked && (this._CurrentToolClicked = false,
                    m.release(this._WorldMouse, this._DraggedMarquee || this._MouseDragged, e)),
                    this._IsMouseDown = false,
                    this._DraggedMarquee) {
                        if (this._SelectionReRoute) {
                            var v = [];
                            for (c = 0; c < this._SelectedItems.length; c++) {
                                var g = this._SelectedItems[c];
                                -1 === this._PreMarqueeSelection.indexOf(g) && (v.push(g),
                                g.isSelected = false,
                                this._SelectedItems.splice(c, 1),
                                c--)
                            }
                            this._ReRoutedSelection = true;
                            var _ = this._SelectionReRoute;
                            this._SelectionReRoute = null,
                            this._CurrentTool && this._CurrentTool.updateSelection(this.getFilteredSelectedItems()),
                            _(v, l.default.isMultiSelect(e) || e.shiftKey)
                        } else {
                            this.dispatchSelectionChanged();
                            for (var b = 0; b < this._MarqueeSilentChanges.length; b++) {
                                this._MarqueeSilentChanges[b].dispatchSelectionChanged()
                            }
                        }
                        this._MarqueeSilentChanges.length = 0
                    } else if (this._SelectionReRoute) {
                        this._ReRoutedSelection = true;
                        var w = this._SelectionReRoute;
                        this._SelectionReRoute = null,
                        w(false, l.default.isMultiSelect(e) || e.shiftKey)
                    }
                    this._IsDraggingMarquee = false,
                    this._DraggedMarquee = false
                }
            }
        }, {
            key: "setExtraSelectionFilter",
            value: function(e) {
                this._ExtraFilter = e,
                this._ForceRedraw = true
            }
        }, {
            key: "clearExtraSelectionFilter",
            value: function() {
                this._ExtraFilter = null,
                this._ForceRedraw = true
            }
        }, {
            key: "canSelect",
            value: function(e) {
                var t = this._SelectionFilter
                  , n = this._ExtraFilter;
                return !(t && !t.canSelect(e)) && !(n && !n(e))
            }
        }, {
            key: "getFilteredSelectedItems",
            value: function(e) {
                for (var t = [], n = this._SelectedItems, i = this.canSelect, r = 0; r < n.length; r++) {
                    var o = n[r]
                      , a = i(o);
                    (a && !e || !a && e) && t.push(o)
                }
                return t
            }
        }, {
            key: "onMouseMove",
            value: function(e, t, n) {
                if (e.clientX != this._MouseX || e.clientY != this._MouseY) {
                    if (this._MoveTriggersPan && !this.isEnabled(Y.Pan) && (this.enableState(Y.PanModifier),
                    this.enableState(Y.Pan)),
                    this._IsPreDrag)
                        if (Date.now() - this._MouseDownTime < 110) {
                            if (this._MouseMoveAccum[0] += t,
                            this._MouseMoveAccum[1] += n,
                            !(a.vec2.length(this._MouseMoveAccum) > 20))
                                return;
                            t = this._MouseMoveAccum[0],
                            n = this._MouseMoveAccum[1],
                            this._IsPreDrag = false
                        } else
                            t += this._MouseMoveAccum[0],
                            n += this._MouseMoveAccum[1],
                            this._IsPreDrag = false;
                    this._MouseX = e.clientX,
                    this._MouseY = e.clientY;
                    var i = a.vec2.clone(this._WorldMouse);
                    if (this.updateCustomCursorPosition(),
                    this.updateWorldMousePosition(),
                    this.isEnabled(Y.Pan) && !this._SuppressPanning && (e.stopPropagation(),
                    e.preventDefault(),
                    this._TranslationTarget[0] += t * this._ScreenScale,
                    this._TranslationTarget[1] -= n * this._ScreenScale,
                    this._ForceRedraw = true),
                    this.isEnabled(Y.Drag)) {
                        e.stopPropagation(),
                        e.preventDefault(),
                        this._ForceRedraw = true;
                        var r = a.vec2.subtract(a.vec2.create(), this._WorldMouse, i);
                        if (this._IsDraggingMarquee)
                            this._DraggedMarquee = true,
                            this._MarqueeEnd[0] = this._MouseX * this._ScreenScale,
                            this._MarqueeEnd[1] = this._Graphics.viewportHeight - this._MouseY * this._ScreenScale,
                            this.updateMarqueeSelections(e.altKey, l.default.isMultiSelect(e));
                        else {
                            this._MouseDragged || (this._MouseDragged = true,
                            this._ActiveDragTool = this._CurrentTool,
                            this._CurrentTool && this._CurrentTool.startDrag(this._LastClickedItem, this.getFilteredSelectedItems()) && (this._ActiveDragTool = this._CurrentTool));
                            var o = a.vec2.set(a.vec2.create(), t, n);
                            this._ActiveDragTool && !this._IsSelectionDisabled && this._ActiveDragTool.advanceDrag(o, r, this._WorldMouse, i)
                        }
                    } else if (this._CurrentOperation && this._CurrentOperation.mouseMove)
                        e.stopPropagation(),
                        e.preventDefault(),
                        this._ForceRedraw = true,
                        this._CurrentOperation.mouseMove(this._WorldMouse);
                    else if (this._CurrentTool && this._CurrentTool.mouseMove) {
                        e.stopPropagation(),
                        e.preventDefault();
                        var s = a.vec2.set(a.vec2.create(), t, n)
                          , u = a.vec2.subtract(a.vec2.create(), this._WorldMouse, i);
                        this._CurrentTool.mouseMove(s, u, this._WorldMouse, i) && (this._ForceRedraw = true)
                    }
                }
            }
        }, {
            key: "updateMarqueeSelections",
            value: function(e, t) {
                for (var n = a.vec2.clone(this._MarqueeStart), i = a.vec2.clone(this._MarqueeEnd), r = n[0] < i[0], o = n[1] < i[1], s = r ? n[0] : i[0], l = o ? n[1] : i[1], u = r ? i[0] : n[0], c = o ? i[1] : n[1], d = [a.vec2.set(a.vec2.create(), s, l), a.vec2.set(a.vec2.create(), u, l), a.vec2.set(a.vec2.create(), u, c), a.vec2.set(a.vec2.create(), s, c)], h = 0; h < 4; h++) {
                    var f = d[h];
                    a.vec2.transformMat2d(f, f, this._InverseViewTransform)
                }
                for (var p = this.canSelect, y = this._SelectedItems, m = 0; m < y.length; m++) {
                    var v = y[m];
                    v.setSelected(false, true) && -1 === this._MarqueeSilentChanges.indexOf(v) && this._MarqueeSilentChanges.push(v)
                }
                y.length = 0;
                var g = 0 != this._SoloStrength;
                if (e)
                    for (var _ = 0; _ < this._PreMarqueeSelection.length; _++) {
                        var b = this._PreMarqueeSelection[_];
                        p(b) && b.rectIntersects(d) || (y.push(b),
                        b.setSelected(true, true) && -1 === this._MarqueeSilentChanges.indexOf(b) && this._MarqueeSilentChanges.push(b))
                    }
                else {
                    var w = this._PreMarqueeSelection;
                    t && (w = w.slice(0));
                    for (var O = this._StageDrawLayers.length - 1; O >= 0; O--) {
                        var S = this._StageDrawLayers[O]
                          , k = this._LayerOptions[O];
                        if (!k || !k.disableSelection && !k.disableDraw) {
                            for (var P = S.length - 1; P >= 0; P--) {
                                var E = S[P];
                                if ((!g || E.isSolo || E.parent && E.parent.isSolo) && (p(E) && E.isVisible && E.isSelectable && !E.isHandle && E.rectIntersects(d))) {
                                    if (t) {
                                        var T = w.indexOf(E);
                                        if (-1 !== T) {
                                            w.splice(T, 1);
                                            continue
                                        }
                                    }
                                    E.setSelected(true, true) && -1 === this._MarqueeSilentChanges.indexOf(E) && this._MarqueeSilentChanges.push(E),
                                    y.push(E)
                                }
                            }
                            this._ForceRedraw = true
                        }
                    }
                    for (var C = 0; C < w.length; C++) {
                        var x = w[C];
                        x.isSelected || (x.isSelected = true,
                        y.push(x))
                    }
                }
                this._CurrentTool && this._CurrentTool.updateSelection(this.getFilteredSelectedItems(), {
                    isDeselect: e,
                    isToggle: t,
                    rect: d
                })
            }
        }, {
            key: "onMouseEnterStage",
            value: function(e) {
                this._IsMouseOverStage = true,
                this._CurrentOperation && this._CurrentOperation.mouseEnterStage && this._CurrentOperation.mouseEnterStage(this._WorldMouse)
            }
        }, {
            key: "onMouseLeaveStage",
            value: function(e) {
                this._IsMouseOverStage = false,
                this._ActiveDragTool || (this._HoverItem = null,
                this._CurrentTool && this._CurrentTool.hoverItemChange && this._CurrentTool.hoverItemChange(this._HoverItem)),
                this._ForceRedraw = true,
                this._CurrentOperation && this._CurrentOperation.mouseLeaveStage && this._CurrentOperation.mouseLeaveStage(this._WorldMouse),
                this.dispatchHoverItemChange()
            }
        }, {
            key: "onMouseEnter",
            value: function(e) {
                this._CursorElement.style.display = "",
                this._ForceRedraw = true
            }
        }, {
            key: "onMouseLeave",
            value: function(e) {
                this._CursorElement.style.display = "none",
                this._HoverItem = null,
                this._CurrentTool && this._CurrentTool.hoverItemChange && this._CurrentTool.hoverItemChange(this._HoverItem),
                this._ForceRedraw = true,
                this.dispatchHoverItemChange()
            }
        }, {
            key: "cycleHover",
            value: function() {
                this._HoverFallthrough++,
                this.updateWorldMousePosition()
            }
        }, {
            key: "onMouseWheel",
            value: function(e) {
                e.preventDefault();
                var t = -function(e) {
                    var t = 0
                      , n = 0
                      , i = 0
                      , r = 0;
                    "detail"in e && (n = e.detail);
                    "wheelDelta"in e && (n = -e.wheelDelta / 120);
                    "wheelDeltaY"in e && (n = -e.wheelDeltaY / 120);
                    "wheelDeltaX"in e && (t = -e.wheelDeltaX / 120);
                    "axis"in e && e.axis === e.HORIZONTAL_AXIS && (t = n,
                    n = 0);
                    i = 10 * t,
                    r = 10 * n,
                    "deltaY"in e && (r = e.deltaY);
                    "deltaX"in e && (i = e.deltaX);
                    (i || r) && e.deltaMode && (1 == e.deltaMode ? (i *= 40,
                    r *= 40) : (i *= 800,
                    r *= 800));
                    i && !t && (t = i < 1 ? -1 : 1);
                    r && !n && (n = r < 1 ? -1 : 1);
                    return {
                        spinX: t,
                        spinY: n,
                        pixelX: i,
                        pixelY: r
                    }
                }(e).spinY / 20;
                return e.ctrlKey && (t /= 15),
                this._IsSmallSize && (t /= 10),
                this.zoomTo(e.clientX * this._ScreenScale, this._Graphics.viewportHeight - e.clientY * this._ScreenScale, this._ScaleTarget + t),
                true
            }
        }, {
            key: "onKeyDown",
            value: function(e) {
                return 18 === e.keyCode && this.cycleHover(),
                !(!this._CurrentTool || !this._CurrentTool.onKeyDown) && this._CurrentTool.onKeyDown(e)
            }
        }, {
            key: "onKeyUp",
            value: function(e) {
                return !(!this._CurrentTool || !this._CurrentTool.onKeyUp) && this._CurrentTool.onKeyUp(e)
            }
        }, {
            key: "addItem",
            value: function(e) {
                this._StageItems.push(e);
                var t = this._ContextLookup.get(e.constructor)
                  , n = t && t.drawLayer || 0;
                this._StageDrawLayers[n].push(e),
                this._ForceRedraw = true,
                this.dispatch("add", e)
            }
        }, {
            key: "removeItem",
            value: function(e) {
                var t = this._ContextLookup.get(e.constructor)
                  , n = t && t.drawLayer || 0
                  , i = (n = this._StageDrawLayers[n]).indexOf(e);
                -1 != i && n.splice(i, 1),
                this._HoverItem == e && (this._HoverItem = null,
                this._CurrentTool && this._CurrentTool.hoverItemChange && this._CurrentTool.hoverItemChange(this._HoverItem)),
                -1 != (i = this._StageItems.indexOf(e)) && this._StageItems.splice(i, 1),
                -1 != (i = this._SelectedItems.indexOf(e)) && (this._SelectedItems.splice(i, 1),
                this._CurrentTool && this._CurrentTool.updateSelection(this.getFilteredSelectedItems()),
                this.dispatchSelectionChanged()),
                e.isSelected = false,
                this._ForceRedraw = true,
                this.dispatch("remove", e),
                this.dispatchHoverItemChange()
            }
        }, {
            key: "getStageItemContext",
            value: function(e) {
                var t = this._ContextLookup.get(e.constructor);
                return t ? t.context : null
            }
        }, {
            key: "redraw",
            value: function() {
                this._ForceRedraw = true
            }
        }, {
            key: "findTool",
            value: function(e) {
                for (var t = 0; t < this._AllTools.length; t++) {
                    var n = this._AllTools[t];
                    if (n instanceof e)
                        return n
                }
                return console.log("DID NOT FIND TOOL", e, this._AllTools),
                null
            }
        }, {
            key: "selectTool",
            value: function(e) {
                var t = this.findTool(e);
                if (t) {
                    if (t.validate && !t.validate())
                        return console.log("TOOL NOT VALID", t),
                        false;
                    this._CurrentTool && this._CurrentTool.disable(),
                    this._ActiveDragTool = null,
                    t.enable();
                    var n = this.toolType;
                    return this._CurrentTool = t,
                    this._CurrentTool && this._CurrentTool.updateSelection(this.getFilteredSelectedItems()),
                    this.dispatch("toolChanged", {
                        from: n,
                        to: e
                    }),
                    true
                }
                return false
            }
        }, {
            key: "updateToolSelection",
            value: function() {
                this._CurrentTool && this._CurrentTool.updateSelection(this.getFilteredSelectedItems())
            }
        }, {
            key: "selectAll",
            value: function() {
                var e = null
                  , t = false
                  , n = [];
                if (this._SelectedItems)
                    for (var i = 0; i < this._SelectedItems.length; i++) {
                        var r = this._SelectedItems[i];
                        if (null === e)
                            e = r.constructor;
                        else if (e !== r.constructor) {
                            if (e === x.default && r.constructor === D.default || e === D.default && r.constructor === x.default)
                                continue;
                            e = null;
                            break
                        }
                    }
                e === x.default || e === D.default ? n.push(x.default, D.default) : n.push(e);
                for (var o = null !== this._SoloItems, a = 0; a < this._StageItems.length; a++) {
                    var s = this._StageItems[a];
                    if (!s.isSelected && s.isVisible && (null === e || -1 !== n.indexOf(s.constructor))) {
                        if (o && !s.isSolo && (!s.parent || !s.parent.isSolo))
                            continue;
                        this._SelectedItems.push(s),
                        s.isSelected = true,
                        t = true
                    }
                }
                if (null !== e && !t)
                    for (var l = 0; l < this._StageItems.length; l++) {
                        var u = this._StageItems[l];
                        !u.isSelected && u.isVisible && (this._SelectedItems.push(u),
                        u.isSelected = true,
                        t = true)
                    }
                this._CurrentTool && this._CurrentTool.updateSelection(this.getFilteredSelectedItems()),
                this.dispatchSelectionChanged(),
                this._ForceRedraw = true
            }
        }, {
            key: "deSelectItem",
            value: function(e, t) {
                var n = this._SelectedItems.indexOf(e);
                -1 != n && (this._SelectedItems.splice(n, 1),
                e.isSelected = false,
                this.dispatchSelectionChanged(t),
                this._ForceRedraw = true),
                this._CurrentTool && this._CurrentTool.updateSelection(this.getFilteredSelectedItems())
            }
        }, {
            key: "selectItems",
            value: function(e, t, n, i) {
                this._SelectionsChanged = true,
                !t && this._SelectedItems.length && this.clearSelections(true);
                for (var r = 0; r < e.length; r++) {
                    var o = e[r];
                    o.isSelected || (this._SelectedItems.push(o),
                    o.isSelected = true)
                }
                this._CurrentTool && this._CurrentTool.updateSelection(this.getFilteredSelectedItems()),
                n || (this.dispatchSelectionChanged(i),
                this._ForceRedraw = true)
            }
        }, {
            key: "selectItem",
            value: function(e, t, n, i) {
                if (!e)
                    throw new Error("Cannot select a non object");
                if (this._SelectionReRoute) {
                    var r = this._SelectionReRoute;
                    return this._SelectionReRoute = null,
                    void r(e, t)
                }
                e.isSelected || (this._SelectionsChanged = true,
                !t && this._SelectedItems.length && this.clearSelections(true),
                this._SelectedItems.push(e),
                e.isSelected = true,
                this._CurrentTool && this._CurrentTool.updateSelection(this.getFilteredSelectedItems()),
                n || (this.dispatchSelectionChanged(i),
                this._ForceRedraw = true))
            }
        }, {
            key: "isItemSelected",
            value: function(e) {
                return -1 !== this._SelectedItems.indexOf(e)
            }
        }, {
            key: "startOperation",
            value: function(e) {
                this._CurrentOperation && this._CurrentOperation.end(),
                this._CurrentOperation = e
            }
        }, {
            key: "endOperation",
            value: function(e) {
                (this._CurrentOperation == e || !e && this._CurrentOperation) && (this._CurrentOperation = null,
                e.silent || this.appContext.captureJournalEntry())
            }
        }, {
            key: "cancel",
            value: function() {
                this._CurrentOperation ? (this._CurrentOperation.cancel && this._CurrentOperation.cancel(),
                this._CurrentOperation.end()) : this._ActiveDragTool && (this._ActiveDragTool.endDrag(),
                this._ActiveDragTool = null,
                this._AppContext.captureJournalEntry(),
                this._AppContext.undo()),
                this._CurrentTool && this._CurrentTool.cancel()
            }
        }, {
            key: "getTypeItems",
            value: function(e) {
                e.constructor !== Array && (e = [e]);
                for (var t = [], n = 0; n < this._StageItems.length; n++) {
                    var i = this._StageItems[n];
                    -1 !== e.indexOf(i.constructor) && t.push(i)
                }
                return t
            }
        }, {
            key: "clear",
            value: function() {
                this.clearSelections(),
                this._HoverItem = this._LastClickedItem = null,
                this._StageItems.length = 0;
                for (var e = 0; e < this._StageDrawLayers.length; e++)
                    this._StageDrawLayers[e].length = 0;
                this._PreMarqueeSelection.length = 0,
                this.dispatchHoverItemChange()
            }
        }, {
            key: "queueRemove",
            value: function(e) {
                var t = this._QueuedAdd.indexOf(e);
                -1 === t ? -1 === this._QueuedRemove.indexOf(e) && this._QueuedRemove.push(e) : this._QueuedAdd.splice(t, 1)
            }
        }, {
            key: "queueAdd",
            value: function(e) {
                var t = this._QueuedRemove.indexOf(e);
                -1 === t ? -1 === this._QueuedAdd.indexOf(e) && this._QueuedAdd.push(e) : this._QueuedRemove.splice(t, 1)
            }
        }, {
            key: "resetQueuedAddRemove",
            value: function() {
                this._QueuedRemove.length = 0,
                this._QueuedAdd.length = 0
            }
        }, {
            key: "processQueuedAddRemove",
            value: function() {
                for (var e = 0; e < this._QueuedRemove.length; e++) {
                    this._QueuedRemove[e].removeFromStage()
                }
                for (var t = 0; t < this._QueuedAdd.length; t++) {
                    this._QueuedAdd[t].addToStage(this)
                }
                this._QueuedRemove.length = 0,
                this._QueuedAdd.length = 0,
                this.updateHighlights()
            }
        }, {
            key: "updateSettings",
            value: function() {
                this._Settings.disableImageContour = this._AppContext.getPreference("disableImageContour"),
                this.redraw()
            }
        }, {
            key: "doUpdateHighlights",
            value: function() {
                var e = this._HighlightItems
                  , t = e.slice(0);
                (e.length = 0,
                1 === this._SelectedItems.length) && this._SelectedItems[0].updateHighlights(this);
                var n = true
                  , i = false
                  , r = void 0;
                try {
                    for (var o, a = t[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                        var s = o.value;
                        -1 === e.indexOf(s) && (s.highlight = false)
                    }
                } catch (e) {
                    i = true,
                    r = e
                } finally {
                    try {
                        !n && a.return && a.return()
                    } finally {
                        if (i)
                            throw r
                    }
                }
            }
        }, {
            key: "highlight",
            value: function(e) {
                this._HighlightItems.push(e),
                e.highlight = true
            }
        }, {
            key: "updateHighlights",
            value: function() {
                clearTimeout(this.hltimeout),
                this.hltimeout = setTimeout(this.doUpdateHighlights, 33)
            }
        }, {
            key: "isDraggingMarquee",
            get: function() {
                return this._IsDraggingMarquee
            }
        }, {
            key: "soloItem",
            get: function() {
                return this._SoloItems && this._SoloItems.length && this._SoloItems[0]
            }
        }, {
            key: "stageItems",
            get: function() {
                return this._StageItems.slice(0)
            }
        }, {
            key: "isMouseOver",
            get: function() {
                return this._IsMouseOverStage
            }
        }, {
            key: "suppressPanning",
            get: function() {
                return this._SuppressPanning
            },
            set: function(e) {
                this._SuppressPanning = e
            }
        }, {
            key: "transformSpace",
            get: function() {
                return this._TransformSpace
            },
            set: function(e) {
                this._TransformSpace != e && (this._TransformSpace = e,
                this.dispatch("transformSpaceChanged", e),
                this._ForceRedraw = true)
            }
        }, {
            key: "selectedItems",
            get: function() {
                return this._SelectedItems.slice(0)
            }
        }, {
            key: "isDragDisabled",
            get: function() {
                return this._IsDragDisabled
            },
            set: function(e) {
                this._IsDragDisabled = e
            }
        }, {
            key: "willSelectionsDraw",
            get: function() {
                return !this._IsSelectionDisabled
            }
        }, {
            key: "isSelectionDisabled",
            get: function() {
                return !(!this._IsSelectionDisabled && !this._ActiveDragTool)
            },
            set: function(e) {
                this._HoverItem = null,
                this._IsSelectionDisabled = e,
                this._ForceRedraw = true
            }
        }, {
            key: "isPanning",
            get: function() {
                return this.isEnabled(Y.PanModifier)
            },
            set: function(e) {
                e ? this.enableState(Y.PanModifier) : this.disableState(Y.PanModifier)
            }
        }, {
            key: "isGrabbing",
            get: function() {
                return this.isEnabled(Y.Pan)
            },
            set: function(e) {
                e ? this.enableState(Y.Pan) : this.disableState(Y.Pan)
            }
        }, {
            key: "zoom",
            get: function() {
                return this._ScaleTarget
            },
            set: function(e) {
                var t = this.getVisibleStageArea();
                this.zoomTo(t.left + t.width / 2, t.bottom - t.height / 2, e)
            }
        }, {
            key: "appContext",
            get: function() {
                return this._AppContext
            }
        }, {
            key: "graphics",
            get: function() {
                return this._Graphics
            }
        }, {
            key: "toolType",
            get: function() {
                return this._CurrentTool && this._CurrentTool.constructor || null
            },
            set: function(e) {
                this.selectTool(e)
            }
        }, {
            key: "tool",
            get: function() {
                return this._CurrentTool
            }
        }, {
            key: "selectionFilter",
            get: function() {
                return this._SelectionFilter
            },
            set: function(e) {
                if (this.disableSelectionFilter)
                    console.log("Changing the selection filter is currently disabled.");
                else {
                    this._SelectionFilter = e,
                    this._CurrentTool && this._CurrentTool.updateSelection(this.getFilteredSelectedItems()),
                    this.dispatchSelectionChanged();
                    for (var t = this.canSelect, n = 0; n < this._StageItems.length; n++) {
                        var i = this._StageItems[n];
                        i.isFiltered = !t(i)
                    }
                    this.dispatch("selectionFilterChanged", e)
                }
            }
        }, {
            key: "disableSelectionFilter",
            set: function(e) {
                e ? (this._DisabledSelectionFilter = this._SelectionFilter,
                this._SelectionFilter = new P.default) : this._DisabledSelectionFilter && (this._SelectionFilter = this._DisabledSelectionFilter,
                this._DisabledSelectionFilter = null)
            },
            get: function() {
                return !!this._DisabledSelectionFilter
            }
        }, {
            key: "currentOperation",
            get: function() {
                return this._CurrentOperation
            }
        }, {
            key: "viewTransform",
            get: function() {
                return this._ViewTransform
            }
        }, {
            key: "scale",
            get: function() {
                return this._Scale
            }
        }, {
            key: "screenScale",
            get: function() {
                return this._ScreenScale
            }
        }, {
            key: "translation",
            get: function() {
                return this._Translation
            }
        }, {
            key: "worldMouse",
            get: function() {
                return this._WorldMouse
            }
        }, {
            key: "settings",
            get: function() {
                return this._Settings
            }
        }, {
            key: "hoverItem",
            get: function() {
                return this._HoverItem
            },
            set: function(e) {
                this._HoverItem != e && (this._HoverItem = e,
                this._ForceRedraw = true,
                this.dispatchHoverItemChange())
            }
        }]),
        t
    }(o.default)).prototype, "onMouseDown", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "onMouseDown"), i.prototype),
    X(i.prototype, "selectContextMenuNode", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "selectContextMenuNode"), i.prototype),
    X(i.prototype, "onMouseUp", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "onMouseUp"), i.prototype),
    X(i.prototype, "canSelect", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "canSelect"), i.prototype),
    X(i.prototype, "onMouseMove", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "onMouseMove"), i.prototype),
    X(i.prototype, "onMouseEnterStage", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "onMouseEnterStage"), i.prototype),
    X(i.prototype, "onMouseLeaveStage", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "onMouseLeaveStage"), i.prototype),
    X(i.prototype, "onMouseEnter", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "onMouseEnter"), i.prototype),
    X(i.prototype, "onMouseLeave", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "onMouseLeave"), i.prototype),
    X(i.prototype, "onMouseWheel", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "onMouseWheel"), i.prototype),
    X(i.prototype, "onKeyDown", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "onKeyDown"), i.prototype),
    X(i.prototype, "onKeyUp", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "onKeyUp"), i.prototype),
    X(i.prototype, "doUpdateHighlights", [s.default], Object.getOwnPropertyDescriptor(i.prototype, "doUpdateHighlights"), i.prototype),
    i);
    t.default = J;
    var Y = {
        PanModifier: 1,
        Pan: 2,
        Drag: 3
    }
      , q = [{
        state: Y.Pan,
        cursor: "none",
        custom: d.default.make("/images/cursor-grabbing.png"),
        width: 17,
        height: 16
    }, {
        state: Y.PanModifier,
        cursor: "none",
        custom: d.default.make("/images/cursor-grab.png"),
        width: 20,
        height: 20
    }]
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = l(n(1)), a = n(2), s = l(n(203));
    function l(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    var u, c, d, h, f, p, y = [1, 1, 1, .5], m = [1, 1, 1, 1], v = [0, 139 / 255, 1, .8], g = [1, 1, 1, 1], _ = [10 / 255, 10 / 255, 10 / 255, .7], b = (i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n._ActorNode = e,
            n.drawAfterSelections = false,
            n.hitDetectOnMesh = false,
            n.isSelectable = true,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "onAddedToStage",
            value: function() {
                this.setMesh(this.stageContext.points, 2, this.stageContext.index),
                this._ActorNode.addEventListener("worldTransform", this.updateTransform),
                this._ActorNode.resetSolver(),
                this.updateTransform()
            }
        }, {
            key: "onRemovedFromStage",
            value: function(e) {
                this._ActorNode.removeSolver(),
                this._ActorNode.removeEventListener("worldTransform", this.updateTransform)
            }
        }, {
            key: "updateTransform",
            value: function() {
                this.renderTransform = this._ActorNode.worldTransform
            }
        }, {
            key: "customHitDetect",
            value: function(e, n) {
                var i = Math.sqrt(e * e + n * n);
                return Math.abs(t.radius - i) <= t.proximityThreshold
            }
        }, {
            key: "draw",
            value: function(e, t, n) {
                if (!n) {
                    var i = this.renderViewTransform
                      , r = this.stageContext
                      , o = this._ActorNode.hasContrast
                      , a = t ? g : o ? _ : y;
                    e.drawColor(i, r.vertexBuffer, r.indexBuffer, 1, a),
                    e.drawThickLine(i, r.line, 1 * this.stage.screenScale, 1, a)
                }
            }
        }, {
            key: "drawSelection",
            value: function(e, t) {
                var n = this.stageContext
                  , i = m;
                if (this._ActorNode.solver && 1 != this._ActorNode.strength) {
                    var r = this._ActorNode.solver
                      , o = r.getChain()
                      , s = r.getWorld()
                      , l = r.getWorld()
                      , u = a.mat2d.create();
                    if (o)
                        for (var c = a.vec2.create(), d = a.vec2.create(), h = o.length - 1; h >= 0; h--) {
                            var f = o[h];
                            a.mat2d.getTranslation(c, l),
                            a.mat2d.fromRotation(u, f.angle),
                            a.mat2d.scale(u, u, f.bone.scale),
                            l = a.mat2d.mul(l, l, u),
                            a.mat2d.fromTranslation(u, [f.bone.length, 0]),
                            l = a.mat2d.mul(l, l, u),
                            a.mat2d.getTranslation(d, l);
                            var p = e.makeThickLine([c, d], false);
                            e.drawThickLine(this.stage.viewTransform, p, .5 / this.stage.scale * this.stage.screenScale, 1, i),
                            a.mat2d.getTranslation(c, s),
                            a.mat2d.fromRotation(u, f.angleIK),
                            a.mat2d.scale(u, u, f.bone.scale),
                            s = a.mat2d.mul(s, s, u),
                            a.mat2d.fromTranslation(u, [f.bone.length, 0]),
                            s = a.mat2d.mul(s, s, u),
                            a.mat2d.getTranslation(d, s);
                            var y = e.makeThickLine([c, d], false);
                            e.drawThickLine(this.stage.viewTransform, y, .5 / this.stage.scale * this.stage.screenScale, 1, v)
                        }
                }
                var g = this.renderViewTransform;
                e.drawColor(g, n.vertexBuffer, n.indexBuffer, 1, i),
                e.drawThickLine(g, n.line, 1 * this.stage.screenScale, 1, i)
            }
        }], [{
            key: "radius",
            get: function() {
                return 15
            }
        }, {
            key: "proximityThreshold",
            get: function() {
                return 5
            }
        }]),
        t
    }(s.default),
    u = i.prototype,
    c = "updateTransform",
    d = [o.default],
    h = Object.getOwnPropertyDescriptor(i.prototype, "updateTransform"),
    f = i.prototype,
    p = {},
    Object.keys(h).forEach((function(e) {
        p[e] = h[e]
    }
    )),
    p.enumerable = !!p.enumerable,
    p.configurable = !!p.configurable,
    ("value"in p || p.initializer) && (p.writable = true),
    p = d.slice().reverse().reduce((function(e, t) {
        return t(u, c, e) || e
    }
    ), p),
    f && void 0 !== p.initializer && (p.value = p.initializer ? p.initializer.call(f) : void 0,
    p.initializer = void 0),
    void 0 === p.initializer && (Object.defineProperty(u, c, p),
    p = null),
    i);
    t.default = b,
    b.initializeStageContext = function(e, t) {
        var n = b.proximityThreshold + b.radius
          , i = [-n, n, n, n, -n, -n, n, -n];
        t.points = i,
        t.index = [0, 1, 2, 1, 3, 2];
        var r = b.radius
          , o = b.radius + .25 * b.radius
          , a = b.radius
          , s = [-1, o, 1, o, 1, a, -1, a, -1, -o, 1, -o, 1, -a, -1, -a, -o, -1, -o, 1, -a, 1, -a, -1, o, -1, o, 1, a, 1, a, -1];
        t.vertexBuffer = e.makeVertexBuffer(s),
        t.indexBuffer = e.makeIndexBuffer([0, 1, 2, 2, 3, 0, 4, 5, 6, 6, 7, 4, 8, 9, 10, 10, 11, 8, 12, 13, 14, 14, 15, 12]);
        for (var l = [], u = 2 * Math.PI / 30, c = 0, d = 0; d < 30; d++) {
            var h = Math.cos(c) * r
              , f = Math.sin(c) * r;
            l.push([h, f]),
            c += u
        }
        t.line = e.makeThickLine(l, true)
    }
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = s(n(1)), a = s(n(428));
    function s(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function l(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var u = (l((i = function() {
        function e(t) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e),
            this._Nima = t,
            this._Journal = [],
            this._JournalIndex = -1,
            this._LastAnimationList = null,
            this._LastSelectedAnimation = null,
            this._LastState = new Map
        }
        return r(e, [{
            key: "activate",
            value: function() {
                this._Nima.setSelectionCallbacks(this.selectAnimationIndex, this.selectNextAnimation, this.selectPreviousAnimation)
            }
        }, {
            key: "deactivate",
            value: function() {
                this._Nima.setSelectionCallbacks(null, null, null)
            }
        }, {
            key: "selectAnimationIndex",
            value: function(e) {
                var t = this._Nima.actor;
                e >= 0 && e < t.animations.length && this._Nima.selectItem(t.animations[e])
            }
        }, {
            key: "selectNextAnimation",
            value: function() {
                var e = this._Nima.actor;
                this.selectAnimationIndex(e.animations.indexOf(this._Nima.editingAnimation) + 1)
            }
        }, {
            key: "selectPreviousAnimation",
            value: function() {
                var e = this._Nima.actor;
                this.selectAnimationIndex(e.animations.indexOf(this._Nima.editingAnimation) - 1)
            }
        }, {
            key: "getJournalEntry",
            value: function() {
                var e = this._Nima.actor
                  , t = this._Nima.editingAnimation
                  , n = t.captureJournalEntry();
                n && (n = {
                    animation: t,
                    animationEntry: n
                });
                var i = true;
                if (this._LastAnimationList && e.animations.length == this._LastAnimationList.length) {
                    for (var r = 0; r < e.animations.length; r++)
                        if (e.animations[r] != this._LastAnimationList[r]) {
                            i = false;
                            break
                        }
                } else
                    i = false;
                i || (n || (n = {}),
                n.listTo = e.animations.slice(0),
                n.listFrom = this._LastAnimationList,
                this._LastAnimationList = e.animations.slice(0)),
                this._LastSelectedAnimation != t && (n || (n = {}),
                n.selectedAnimationFrom = this._LastSelectedAnimation,
                n.selectedAnimationTo = t,
                this._LastSelectedAnimation = t);
                var o = new Map
                  , s = this._LastState
                  , l = []
                  , u = true
                  , c = false
                  , d = void 0;
                try {
                    for (var h, f = e.animations[Symbol.iterator](); !(u = (h = f.next()).done); u = true) {
                        var p = h.value
                          , y = p.serializeInteractive();
                        o.set(p, y);
                        var m = s.get(p);
                        if (m)
                            for (var v in y) {
                                var g = true
                                  , _ = y[v]
                                  , b = m[v];
                                if (void 0 !== _ && void 0 !== b) {
                                    if (null === _)
                                        g = _ === b;
                                    else
                                        switch (_.constructor) {
                                        case Boolean:
                                        case Number:
                                        case String:
                                            _ !== b && (g = false);
                                            break;
                                        case Array:
                                        case Float32Array:
                                            if (b && _.length === b.length) {
                                                for (var w = 0; w < _.length; w++)
                                                    if (_[w] !== b[w]) {
                                                        g = false;
                                                        break
                                                    }
                                            } else
                                                g = false;
                                            break;
                                        default:
                                            _ != b && (g = false)
                                        }
                                    g || l.push(new a.default(p,v,b,_))
                                }
                            }
                    }
                } catch (e) {
                    c = true,
                    d = e
                } finally {
                    try {
                        !u && f.return && f.return()
                    } finally {
                        if (c)
                            throw d
                    }
                }
                return this._LastState = o,
                l.length && (n || (n = {}),
                n.stateChanges = l),
                n
            }
        }, {
            key: "captureJournalEntry",
            value: function() {
                var e = this.getJournalEntry();
                e && (this._JournalIndex != this._Journal.length - 1 && this._Journal.splice(this._JournalIndex + 1, this._Journal.length - (this._JournalIndex + 1)),
                this._Journal.push(e),
                this._JournalIndex = this._Journal.length - 1,
                this._Nima.actor.revise())
            }
        }, {
            key: "undo",
            value: function() {
                if (this.captureJournalEntry(),
                -1 != this._JournalIndex) {
                    var e = this._Journal[this._JournalIndex];
                    this._JournalIndex--,
                    e.animation && e.animationEntry && e.animation.applyEntry(e.animationEntry, true),
                    e.listFrom && (this._Nima.actor.animations = e.listFrom),
                    e.animation ? this.setEditingAnimation(e.animation) : e.selectedAnimationFrom && this.setEditingAnimation(e.selectedAnimationFrom);
                    var t = e.stateChanges;
                    if (t) {
                        var n = true
                          , i = false
                          , r = void 0;
                        try {
                            for (var o, a = t[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                                o.value.undo()
                            }
                        } catch (e) {
                            i = true,
                            r = e
                        } finally {
                            try {
                                !n && a.return && a.return()
                            } finally {
                                if (i)
                                    throw r
                            }
                        }
                    }
                    this.getJournalEntry(),
                    this._Nima.actor.revise()
                }
            }
        }, {
            key: "setEditingAnimation",
            value: function(e) {
                -1 !== this._Nima.actor.animations.indexOf(e) ? this._Nima.editingAnimation = e : this._Nima.actor.animations.length && (this._Nima.editingAnimation = this._Nima.actor.animations[0])
            }
        }, {
            key: "redo",
            value: function() {
                if (this.captureJournalEntry(),
                !(this._JournalIndex + 1 > this._Journal.length - 1)) {
                    this._JournalIndex++;
                    var e = this._Journal[this._JournalIndex];
                    e.animation && e.animationEntry && e.animation.applyEntry(e.animationEntry, false),
                    e.listTo && (this._Nima.actor.animations = e.listTo),
                    e.animation ? this.setEditingAnimation(e.animation) : e.selectedAnimationTo && this.setEditingAnimation(e.selectedAnimationTo);
                    var t = e.stateChanges;
                    if (t) {
                        var n = true
                          , i = false
                          , r = void 0;
                        try {
                            for (var o, a = t[Symbol.iterator](); !(n = (o = a.next()).done); n = true) {
                                o.value.redo()
                            }
                        } catch (e) {
                            i = true,
                            r = e
                        } finally {
                            try {
                                !n && a.return && a.return()
                            } finally {
                                if (i)
                                    throw r
                            }
                        }
                    }
                    this.getJournalEntry(),
                    this._Nima.actor.revise()
                }
            }
        }]),
        e
    }()).prototype, "selectAnimationIndex", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "selectAnimationIndex"), i.prototype),
    l(i.prototype, "selectNextAnimation", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "selectNextAnimation"), i.prototype),
    l(i.prototype, "selectPreviousAnimation", [o.default], Object.getOwnPropertyDescriptor(i.prototype, "selectPreviousAnimation"), i.prototype),
    i);
    t.default = u
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i = a(n(314))
      , r = n(2)
      , o = a(n(237));
    a(n(208));
    function a(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function s(e, t) {
        if (!e)
            throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !t || "object" != typeof t && "function" != typeof t ? e : t
    }
    var l = function(e) {
        function t(e, n, i, a) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var l = s(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e, n))
              , u = l._Stage.selectedItems;
            if (0 == u.length)
                return s(l);
            for (var c = null, d = Number.MAX_SAFE_INTEGER, h = [], f = r.vec2.create(), p = 0; p < u.length; p++) {
                var y = u[p];
                if ((!y.node || y.node.constructor !== o.default) && (y.node && -1 == h.indexOf(y))) {
                    r.vec2.add(f, f, y.node.worldTranslation),
                    h.push(y.node);
                    var m = y.node.parent.treeDepth;
                    (null == c || m < d) && (d = m,
                    c = y.node.parent)
                }
            }
            if (null === c)
                return s(l);
            r.vec2.scale(f, f, 1 / u.length);
            var v = r.mat2d.invert(r.mat2d.create(), c.worldTransform)
              , g = r.vec2.transformMat2d(r.vec2.create(), f, v)
              , _ = l._Actor.addNodeType(i, c, null);
            if (!_)
                return s(l);
            _.name = a || "New Group",
            _.translation = g,
            _.stageItem.addToStage(l._Stage);
            for (var b = 0; b < h.length; b++) {
                var w = h[b];
                _.add(w),
                w.compensate()
            }
            return l._Stage.selectItem(_.stageItem),
            l
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        t
    }(i.default);
    t.default = l
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = function(e, t, n) {
        for (var u = [], c = [], d = 0; d < e.length; d++) {
            var h = e[d]
              , f = l(n(e[d]));
            -1 === t.indexOf(f) ? u.push(h) : c.push(h)
        }
        for (var p = {}, y = 0; y < c.length; y++) {
            var m = c[y]
              , v = n(c[y]);
            if ((v = s(v)).match(i)) {
                var g = v.replace(i, "");
                p[g] ? p[g].push(m) : p[g] = [m]
            } else
                p[v] = [m]
        }
        var _ = {};
        for (var b in p) {
            var w = a(n(p[b][0]));
            if (w.length)
                if (w.length < 2) {
                    for (var O = 0; O < p[b].length; O++) {
                        var S = p[b][O];
                        _[b] ? _[b].array.push(S) : (_[b] = {},
                        _[b].array = [S],
                        _[b].idx = 0)
                    }
                    _[b] = o(_[b], n)
                } else {
                    var k = r(p[b], n);
                    for (var P in k)
                        _[P] = o(k[P], n)
                }
            else
                _[b] = [p[b][0]]
        }
        var E = [];
        for (var T in _)
            E.push({
                name: T,
                items: _[T]
            });
        for (var C = 0; C < u.length; C++)
            E.push({
                name: n(u[C]),
                items: [u[C]]
            });
        return E
    }
    ;
    var i = /([-_.:])?([0-9]+)/g;
    function r(e, t) {
        for (var n = {}, r = new RegExp(i), o = 0; o < e.length; o++) {
            var a = void 0
              , l = t(e[o]);
            for (n[l] = []; null != (a = r.exec(l)); ) {
                var u = l.substring(0, a.index) + l.substring(a.index + a[0].length, l.length)
                  , c = {
                    trimmed_filename: u = s(u),
                    object: e[o]
                };
                n[l].push(c)
            }
        }
        for (var d = Object.keys(n), h = {}, f = 0; f < d.length; f++) {
            for (var p = false, y = d[f], m = 0; m < n[y].length; m++) {
                var v = n[y][m].trimmed_filename;
                if (h[v])
                    h[v].array.push(n[y][m].object),
                    h[v].array.idx = m,
                    p = true;
                else
                    for (var g = 0; g < d.length; g++) {
                        var _ = d[g];
                        if (y != _)
                            for (var b = 0; b < n[_].length; b++)
                                if (v == n[_][b].trimmed_filename) {
                                    h[v] = {},
                                    h[v].array = [n[y][m].object],
                                    h[v].idx = m,
                                    p = true;
                                    break
                                }
                    }
            }
            p || (h[y] = {},
            h[y].array = [n[y][0].object],
            h[y].idx = 0)
        }
        return h
    }
    function o(e, t) {
        for (var n = new RegExp(i), r = [], o = 0; o < e.array.length; o++) {
            var a = {};
            a.obj = e.array[o];
            for (var s = void 0, l = 0, u = t(a.obj); null != (s = n.exec(u)); )
                l == e.idx && (a.val = s[2],
                r.push(a)),
                l++
        }
        return r.sort((function(e, t) {
            return e.val - t.val
        }
        )),
        r.map((function(e) {
            return e.obj
        }
        ))
    }
    function a(e) {
        var t = e.match(/[0-9]+/g);
        return t ? t.map((function(e) {
            return e
        }
        )) : []
    }
    function s(e) {
        var t = e.lastIndexOf(".");
        return -1 == t ? e : e.substring(0, t)
    }
    function l(e) {
        var t = e.lastIndexOf(".");
        return -1 === t ? null : e.substr(t + 1).toLowerCase()
    }
}
, , , function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    });
    var i = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }();
    var r = new Map
      , o = function() {
        function e(t, n, i, o) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, e),
            this._Label = t,
            this._Title = n,
            this._Description = i,
            this._HelpLink = o,
            r.set(t, this)
        }
        return i(e, [{
            key: "toString",
            value: function() {
                return this._Label
            }
        }, {
            key: "title",
            get: function() {
                return this._Title
            }
        }, {
            key: "description",
            get: function() {
                return this._Description
            }
        }, {
            key: "helpLink",
            get: function() {
                return this._HelpLink
            }
        }], [{
            key: "fromString",
            value: function(t) {
                return r.get(t) || e.Unknown
            }
        }]),
        e
    }();
    t.default = o,
    o.Unknown = new o(null,"Error occurred.","Please make sure you are running a supported browser.","https://www.2dimensions.com/b/55-browser-support"),
    o.WebGLDisabled = new o("webgl-disabled","WebGL is disabled.","WebGL is required to run Nima. Please enable it in your browser settings.","https://medium.com/2dimensions/webgl-and-nima-c0ff97ef2359")
}
, , function(e, t, n) {
    "use strict";
    (function(e) {
        var t = r(n(19))
          , i = r(n(1229));
        function r(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }
        (0,
        t.default)(e, i.default, true)
    }
    ).call(this, n(163)(e))
}
, function(e, t, n) {
    "use strict";
    Object.defineProperty(t, "__esModule", {
        value: true
    }),
    t.default = void 0;
    var i, r = function() {
        function e(e, t) {
            for (var n = 0; n < t.length; n++) {
                var i = t[n];
                i.enumerable = i.enumerable || false,
                i.configurable = true,
                "value"in i && (i.writable = true),
                Object.defineProperty(e, i.key, i)
            }
        }
        return function(t, n, i) {
            return n && e(t.prototype, n),
            i && e(t, i),
            t
        }
    }(), o = function e(t, n, i) {
        null === t && (t = Function.prototype);
        var r = Object.getOwnPropertyDescriptor(t, n);
        if (void 0 === r) {
            var o = Object.getPrototypeOf(t);
            return null === o ? void 0 : e(o, n, i)
        }
        if ("value"in r)
            return r.value;
        var a = r.get;
        return void 0 !== a ? a.call(i) : void 0
    }, a = u(n(1)), s = u(n(690)), l = u(n(361));
    function u(e) {
        return e && e.__esModule ? e : {
            default: e
        }
    }
    function c(e, t, n, i, r) {
        var o = {};
        return Object.keys(i).forEach((function(e) {
            o[e] = i[e]
        }
        )),
        o.enumerable = !!o.enumerable,
        o.configurable = !!o.configurable,
        ("value"in o || o.initializer) && (o.writable = true),
        o = n.slice().reverse().reduce((function(n, i) {
            return i(e, t, n) || n
        }
        ), o),
        r && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(r) : void 0,
        o.initializer = void 0),
        void 0 === o.initializer && (Object.defineProperty(e, t, o),
        o = null),
        o
    }
    var d = (c((i = function(e) {
        function t(e) {
            !function(e, t) {
                if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function")
            }(this, t);
            var n = function(e, t) {
                if (!e)
                    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return !t || "object" != typeof t && "function" != typeof t ? e : t
            }(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e));
            return n._TestCB = null,
            n
        }
        return function(e, t) {
            if ("function" != typeof t && null !== t)
                throw new TypeError("Super expression must either be null or a function, not " + typeof t);
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            }),
            t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t)
        }(t, e),
        r(t, [{
            key: "componentWillMount",
            value: function() {
                o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "componentWillMount", this).call(this),
                this.nima.revisionManager.addEventListener("stateChanged", this.onRMStateChanged)
            }
        }, {
            key: "componentDidMount",
            value: function() {
                o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "componentDidMount", this).call(this),
                window.tests = {},
                window.tests.importPSD = this.importPSD.bind(this)
            }
        }, {
            key: "componentWillUnmount",
            value: function() {
                o(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "componentWillUnmount", this).call(this),
                this.nima.revisionManager.removeEventListener("stateChanged", this.onRMStateChanged)
            }
        }, {
            key: "onRMStateChanged",
            value: function(e) {
                if (this._TestCB && e.state === l.default.Idle) {
                    var t = this._TestCB;
                    this._TestCB = null,
                    t("DONE")
                }
            }
        }, {
            key: "importPSD",
            value: function(e) {
                return this._TestCB = e,
                "trying..."
            }
        }]),
        t
    }(s.default)).prototype, "componentWillMount", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "componentWillMount"), i.prototype),
    c(i.prototype, "componentDidMount", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "componentDidMount"), i.prototype),
    c(i.prototype, "componentWillUnmount", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "componentWillUnmount"), i.prototype),
    c(i.prototype, "onRMStateChanged", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "onRMStateChanged"), i.prototype),
    c(i.prototype, "importPSD", [a.default], Object.getOwnPropertyDescriptor(i.prototype, "importPSD"), i.prototype),
    i);
    t.default = d
}
])]);
//# sourceMappingURL=NimaBase.64c5842622ab469779e1.js.map
